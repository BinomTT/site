"use strict";var ASC=ASC||{},__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i=i||Promise)(function(r,o){function s(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof i?t:new i(function(e){e(t)})}(t.value).then(s,a)}l((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}};!function(ASC){function windowOpenINP(t){if("chrome"==ASC.browser){var e=$j("<a target='_blank' rel='noreferrer'>").attr("href",t).text(t);e.appendTo(document.body),e[0].click(),e.remove()}else window.open(t)}function createChild(t,e,i,n){var r=document.createElement(e);return t.appendChild(r),i&&setClass(r,i),n&&(r.style.cssText=n),r}function createDiv(t,e,i){return ASC.createChild(t,"div",e,i)}function createSpan(t,e,i){return ASC.createChild(t,"span",e,i)}function createText(t,e){var i=document.createTextNode(e);return t.appendChild(i),i}function createSpanText(t,e,i,n){var r=ASC.createSpan(t,i,n);return ASC.createText(r,e),r}function createAnchor(t,e,i,n,r,o){var s=$j("<span>").appendTo(t).text(e).css({cursor:"pointer",textDecoration:"underline"}).click(n,function(t){i(t,t.data)});return r&&s.addClass(r),o&&(s.get(0).style.cssText+=o),s.get(0)}function createTable(t,e,i,n,r){var o={table:ASC.createChild(t,"table",n,r),tbody:null,rows:[],cells:[]};o.tbody=ASC.createChild(o.table,"tbody");for(var s=0;s<i;s++){o.cells[s]=[];var a=ASC.createChild(o.tbody,"tr");o.rows[s]=a;for(var l=0;l<e;l++)o.cells[s][l]=ASC.createChild(a,"td")}return o}function createMiniIcon(t,e,i){void 0===i&&(i={}),i=$j.extend({type:"edit"},i);var n=$j("<div>").addClass("mini "+i.type).css(i.right?"right":"left","0").hide();return $j(t).addClass("miniContainer").mouseover(function(t){n.show()}).mouseout(function(t){n.hide()}).click(function(t){e(t)}).append(n),n}function jscFieldsParams(t,e){for(var i="",n=0,r=e;n<r.length;n++){var o=r[n];t[o]&&(i+=(i?"&":"")+o+"="+encodeURIComponent(t[o].value))}return i}function jscSetFieldValue(t,e,i){var n=t[e];n&&(n.ASC_set?n.ASC_set(i):n.value=i)}function createUploadFile(t,e,i,n){var r=$j("<form>").appendTo(t).attr({id:"form_"+ASC_newId(),method:"post",enctype:"multipart/form-data"}).css("display","inline");function o(t){if(0<r.parents("html").length){var o=new FormData(r.get(0)),s=e;i.params&&(s+="&"+jscFieldsParams(n,i.params)),ASC_action(s,o,$j.extend({timeout:72e5,cache:!1,global:!1,contentType:!1,processData:!1},i))}else r.remove()}return r.append('<input type="file" name="uploadfile">'),o.form=r,o.input=r.find("input"),r.find(":file").on("change submit",o),o}function setClass(t,e,i){void 0===i&&(i=!0),$j(t).toggleClass(e,!!i)}function type(t){var e={undefined:"undefined",number:"number",boolean:"boolean",string:"string","[object Function]":"function","[object RegExp]":"regexp","[object Array]":"array","[object Date]":"date","[object Error]":"error"};return e[typeof t]||e[Object.prototype.toString.call(t)]||(t?"object":null)}function isArray(t){return!!t&&"array"===ASC.type(t)}function isString(t){return"string"===ASC.type(t)}function isJQuery(t){return!!(t.get&&t.on&&t.off)}function assert(t,e){if(void 0===e&&(e="Assertion failed"),!t)throw e}function strippedBackground(t,e,i,n,r){void 0===r&&(r=!1);var o="";if(r){var s=5;n&&(s=Math.min(n,s)),o="linear-gradient(rgba(255,255,255,0.5),rgba(0,0,0,0) "+s+"px)"}if(0<e.length&&(o?t.style.cssText=t.style.cssText+";background:"+o+","+e[0]:t.style.backgroundColor=e[0]),1<e.length){d=e[0];var a=45;3<=i&&3<=n&&(a=Math.atan2(n,i/(e.length-1))/Math.PI*180);for(var l="linear-gradient("+(180-a)+"deg,"+d,c=1;c<e.length;c++){var u=1/e.length*c;l+=","+d+" "+100*u+"%";var d=e[c];l+=","+d+" "+100*u+"%"}l+=")",o&&(l=o+","+l),t.style.cssText=t.style.cssText+";background:"+l}}function json_dc(t){var e=t[0],i=t[1],n=[],r=0,o=function(){var t=e[r++];switch(t){case-1:for(var s=e[r++],a=[],l=0;l<s;l++)a.push(o());return a;case-2:s=e[r++];var c={},u=[];for(l=0;l<s;l++)u.push(o());for(n.push(u),l=0;l<s;l++)c[u[l]]=o();return c;case-3:return[];case-4:return[o()];case-5:return[o(),o()]}if(t<0){for(u=n[-t-10],c={},l=0;l<u.length;l++)c[u[l]]=o();return c}var d=i[t];return ASC.isArray(d)&&(d=d.slice(0)),d};return o()}ASC.langasc={},ASC.ttlangasc={},ASC.loadedJSLibs=0,ASC.windowOpenINP=windowOpenINP,ASC.createChild=createChild,ASC.createDiv=createDiv,ASC.createSpan=createSpan,ASC.createText=createText,ASC.createSpanText=createSpanText,ASC.createAnchor=createAnchor,ASC.createTable=createTable,ASC.createMiniIcon=createMiniIcon,ASC.jscFieldsParams=jscFieldsParams,ASC.jscSetFieldValue=jscSetFieldValue,ASC.createUploadFile=createUploadFile,ASC.setClass=setClass,ASC.type=type,ASC.isArray=isArray,ASC.isString=isString,ASC.isJQuery=isJQuery,ASC.assert=assert,ASC.strippedBackground=strippedBackground,ASC.json_dc=json_dc;var timer_last=0;function timer_start(){timer_last=Date.now()}function timer_dump(t,e){var i=Date.now();console.log(t+"="+(i-timer_last)),e&&e.append("<br/>"+t+"="+(i-timer_last)),timer_last=i}ASC.timer_start=timer_start,ASC.timer_dump=timer_dump;var todo_read_buffer=[],todo_write_buffer=[];function todo(t){todo_read_buffer.push(t)}function todo_read(t){todo_read_buffer.push(t)}function todo_write(t){todo_write_buffer.push(t)}function todo_finish(){if(0!=todo_read_buffer.length||0!=todo_write_buffer.length){var t=todo_read_buffer;todo_read_buffer=[];for(var e=0;e<t.length;e++)t[e]();for(t=todo_write_buffer,todo_write_buffer=[],e=0;e<t.length;e++)t[e]();todo_finish()}}function todo_flipText(t,e,i,n){if(ASC.isArray(t))for(var r=0;r<t.length;r++)ASC.flipText(t[r],e,i,n);else todo_read(function(){var r=t.clientWidth;"get"===i&&(i=$j(t).height()),i=i||90,todo_write(function(){e||(e=ASC.textContent(t),t.innerHTML=""),todo_write(function(){var o=ASC.createDiv(t,"","width:"+i+"px;"),s=ASC.createDiv(o,"flip-text"+(n?" center":""),"");ASC.createText(s,e),todo_read(function(){var e=s.clientHeight;todo_write(function(){s.style.height=i+"px",isIE(9)&&(s.style.cssText+=";-ms-writing-mode:tb-lr;padding-top:1px;padding-left:0;"),window.getComputedStyle&&todo_read(function(){var i=window.getComputedStyle(t),n=ASC.getStyleValuePixels(i.paddingLeft),o=ASC.getStyleValuePixels(i.paddingRight);r-n-o<e&&todo_write(function(){r<e&&(s.style.lineHeight="85%",e*=.85);var i=Math.round(Math.min(r,e)),n=Math.round((r-i)/2),o=r-i-n;3!=n||3!=o&&2!=o||15!=i?(t.style.paddingLeft=n+"px",t.style.paddingRight=o+"px",t.style.width=i+"px"):$j(t).addClass("fix315")})})})})})})})}function flipText(t,e,i,n){todo_flipText(t,e,i,n),todo_finish()}function ls_skcz(t,e){return"cz"==ASC.lang?e:t}function ls_skczen(t,e,i){return"cz"==ASC.lang?e:"sk"==ASC.lang?t:i}function lang_getLocale(t){var e=(t=t||ASC.school_country||"en").toLowerCase();switch(t){case"cz":e="cs";break;case"at":e="de";break;case"us":e="en"}return e+"-"+t.toUpperCase()}function getSchoolYear(t){if(!t)throw new Error;return ASC.req.getSchoolYear(t)}function vyskrtni(t,e,i){void 0===e&&(e="/"),void 0===i&&(i=1);var n=$j(t);n.html(""),n.css("vertical-align","top"),n.css("overflow","hidden"),n.css("padding","0px");var r=1,o=t.offsetWidth,s=t.offsetHeight;0<o&&(r=Math.atan2(s,o),"\\"==e&&(r=-r),"-"==e&&(r=0)),$j("<div>").appendTo(t).css({borderTop:i+"px solid black",margin:(n.height()-i)/2+"px -100% 0% -100%",height:i+"px",transform:"rotate(-"+r+"rad)"})}function getCssCrossBrowser(t,e,i){var n={};return n[t]=i?e:"",n["-webkit-"+t]=n[t],n["-moz-"+t]=n[t],n["-ms-"+t]=n[t],n["-o-"+t]=n[t],n}ASC.todo=todo,ASC.todo_read=todo_read,ASC.todo_write=todo_write,ASC.todo_finish=todo_finish,ASC.todo_flipText=todo_flipText,ASC.flipText=flipText,ASC.ls_skcz=ls_skcz,ASC.ls_skczen=ls_skczen,ASC.lang_getLocale=lang_getLocale,ASC.getSchoolYear=getSchoolYear,ASC.ASC_sy2str||(ASC.ASC_sy2str=function(t){if(!t||""==t)return"";var e=parseInt(t,10);return ASC.req.getSchoolYearName(e)}),ASC.vyskrtni=vyskrtni,ASC.getCssCrossBrowser=getCssCrossBrowser;var showContextMenu_menu=null;function showContextMenu(t,e,i){void 0===i&&(i={}),hideContextMenu();var n={};try{n=i instanceof HTMLElement||ASC.isJQuery(i)?{cd:i}:i}catch(t){n=$j.extend({},i,{cd:document.body})}if(n.handler){var r=function(t){if(ASC.isArray(t))for(var e=0;e<t.length;e++)r(t[e]);else t.cmd&&(t.onclick||(t.onclick=function(){n.handler(t)})),t.submenu&&r(t.submenu)};r(t)}var o=n.cd,s=$j(o).parents(".ui-front, .ui-dialog"),a={container:s.length?s:document.body,cssClass:n.cssClass,minWidth:n.minWidth};return void 0!==n.clickToHide&&(a.clickToHide=n.clickToHide),showContextMenu_menu=new ASC.ui.ContextMenu(t,a),n.header&&showContextMenu_menu.cfg.setProperty("header",n.header),n.footer&&showContextMenu_menu.cfg.setProperty("footer",n.footer),n.onHide&&(showContextMenu_menu.config.onHide=n.onHide),showContextMenu_menu.show(o||e),e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault(),showContextMenu_menu}function showContextMenuOpened(t){return showContextMenu_menu&&showContextMenu_menu.$menu.is(":visible")&&(!t||showContextMenu_menu.$trigger&&showContextMenu_menu.$trigger.is(t))}function hideContextMenu(){showContextMenu_menu&&(showContextMenu_menu.hide(),showContextMenu_menu.destroy(),showContextMenu_menu=null)}function hidePopups(t){var e;e=t&&t.stopPropagation?((t=t).preventDefault(),t.stopPropagation(),t.target):t,$j(".reactPopup").each(function(t,i){return i.ASC_hide(e)}),hideContextMenu(),0==$j(e).closest(".dropDownBtn").length&&0==$j(e).closest(".dropDown").length&&($j(".dropDown").fadeOut(150).trigger("closed"),$j(".dropDownBtn").not(".asc").children("a").removeClass("icon-button-active"),$j(".dropDownBtn").not(".asc").removeClass("btnSelected"))}if(ASC.showContextMenu=showContextMenu,ASC.showContextMenuOpened=showContextMenuOpened,ASC.hideContextMenu=hideContextMenu,ASC.hidePopups=hidePopups,"undefined"!=typeof document){var cb=function(t){return hidePopups(t.target)};document.addEventListener("click",cb),document.addEventListener("contextmenu",cb)}var sentErrors=0;function dieError(t,e){console.error("Error",t),void 0!==e&&console.log(e),alert("ErrorJS: "+t);var i=new Error(""+t);throw sendErrorJS(""+t,"dieError\n"+(i.stack||"")+"\n\n"+e),i}function sendErrorJS(t,e){var i;console.log(e+"\n\n"+navigator.userAgent+"\n"+window.location.href+"\n"+((null===(i=ASC.req)||void 0===i?void 0:i.loggedUser)||""))}function logProblem(t,e){console.warn("Problem",t),void 0!==e&&console.log(e)}function logError(t,e){}function checkRequiredFields(t,e,i){for(var n,r,o={msg:ASC.ls(2724)},s=0,a=e;s<a.length;s++){var l=a[s],c=$j(t[l]);if(c.hasClass("required")&&!validateField(l,c.val(),o))return void 0!==i&&!i||(ASC.ascdebug&&console.log(l,c),ASC.flashMessage(o.msg,{border_error:(n=c,r=void 0,r=n[0].ASC_uiElement,r=r||(n.is(":hidden")?n.parent().get(0):n.get(0)))})),!1}return!0}function validateField(t,e,i){if(void 0===i&&(i={}),""!=e&&null!=e&&null!=e){if(!(0<=t.search("email"))||validatorEmail(e))return!0;i.msg=ASC.ls(3535)}return!1}function removeDiacritics(t){var e="Ã¡=a,Ã=a,Ã¤=a,Ä=c,ÄŒ=C,Ä=d,ÄŽ=D,Ã©=e,Ã‰=E,Ã­=i,Ã=I,Äº=l,Ä¹=L,Ä¾=l,Ä½=L,Åˆ=n,Å‡=N,Ã³=o,Ã“=O,Ã´=o,Ã”=O,Å•=r,Å”=R,Å¡=s,Å =S,Å¥=t,Å¤=T,Ãº=u,Ãš=U,Ã½=y,Ã=Y,Å¾=z,Å½=Z";return e+=",Ä…=a,Ä„=a,Ä‡=c,Ä†=C,Ä™=e,Ä˜=E,Å‚=l,Å=L,Å„=n,Åƒ=N,Ã³=o,Ã“=O,Å›=s,Åš=S,Å¼=z,Å»=Z,Åº=z,Å¹=Z",e+=",Ã¼=u,ÃŸ=ss,Ã¶=o",e+=",Å™=r,Å˜=R",t.replace(/[Ã¡ÃÃ¤ÄÄŒÄÄŽÃ©Ã‰Ã­ÃÄºÄ¹Ä¾Ä½ÅˆÅ‡Ã³Ã“Ã´Ã”Å•Å”Å¡Å Å¥Å¤ÃºÃšÃ½ÃÅ¾Å½Ä…Ä„Ä‡Ä†Ä™Ä˜Å‚ÅÅ„ÅƒÃ³Ã“Å›ÅšÅ¼Å»ÅºÅ¹Ã¼ÃŸÃ¶Å™Å˜]/g,function(t){var i=e.search(t);return e.substr(i+2,e.indexOf(",",i+2)-i-2)})}function setFieldValidator(t,e){function i(){ASC.setClass(t,"asc-badfieldvalue",!e(t.value))}i(),$j(t).change(i),$j(t).keyup(i)}function validatorRC(t){if(""==t)return!0;switch(ASC.school_country){case"cz":return!!/^[0-9]{2}([05][1-9]|[16][0-2])([0-2][0-9]|3[0-1])\/[0-9XY][0-9]{2,3}$/i.test(t)&&(0<=t.indexOf("X")||0<=t.indexOf("Y")||t.substr(0,2)<="53"&&9==t.replace("/","").length||parseInt(t.replace("/",""))%11==0);case"sk":return!!/^[0-9]{6}\/[0-9XY][0-9]{2,3}$/i.test(t)&&parseInt(t.replace("/",""))%11==0;case"tr":if(!/[1-9][0-9]{10}$/i.test(t))return!1;for(var e=0,i=1e3,n=0;n<9;n++){var r=parseInt(t[n]);e+=r,n%2==0?i+=7*r:i-=r}return i%10==parseInt(t[9])&&(e+=parseInt(t[9]))%10==parseInt(t[10])}return!0}function validatorEmail(t){return""==t||/^([\w-+]+(?:\.[\w-+]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i.test(t)&&(!t.endsWith||!t.endsWith("@gmail.sk")&&!t.endsWith("@gmail.cz")&&!t.endsWith("@gamil.com")&&!t.endsWith("@gmial.com")&&!t.endsWith("@gmal.com")&&!t.endsWith("@gmil.com")&&!t.endsWith("@gmali.com")&&!t.endsWith("@gmila.com")&&!t.endsWith("vgmail.com")&&!t.endsWith("vcentrum.sk"))}function validatorRequire(t){return"string"!=typeof t&&t.call?function(e){return""!=e&&t(e)}:""!=t}function isIE(t){if(ASC.browser&&"ie"==ASC.browser.substr(0,2))return!(6<t)||parseInt(ASC.browser.substr(2))<=t;var e=navigator.appVersion.indexOf("MSIE");if(-1==e)return!1;if(6<t){var i=navigator.appVersion.substr(e+4,5);return parseInt(i)<=t}return!0}function reloadPage(){window.location.reload()}function date_today(){return date_js2sql(new Date)}function date_delta(t,e){var i=date_sql2js(t);return date_js2sql(new Date(i.getTime()+864e5*e))}function date_diff(t,e){var i=date_sql2js(t).getTime()-date_sql2js(e).getTime();return Math.round(i/864e5)}function date_interval_array(t,e){for(var i=[],n=t;n<=e;n=date_delta(n,1))i.push(n),5e3<i.length&&ASC.dieError("3834191212");return i}function date_js2sql(t){var e=t.getDate(),i=t.getMonth()+1;return t.getFullYear()+"-"+(i<10?"0":"")+i+"-"+(e<10?"0":"")+e}function time_js2sql(t){var e=t.getHours(),i=t.getMinutes(),n=t.getSeconds();return(e<10?"0":"")+e+":"+(i<10?"0":"")+i+":"+(n<10?"0":"")+n}function datetime_js2sql(t){return ASC.date_js2sql(t)+" "+ASC.time_js2sql(t)}function date_sql2js(t){return t instanceof Date?new Date(t.toString()):new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),11)}function timezone_isWeekend(t){return!!t&&ASC.boolVal(ASC.timezone_isWeekend_day(ASC.date_sql2js(t).getDay()))}function ASC_date2str(t,e){if(void 0===e&&(e=!0),!t||""==t)return"";if((t=""+t).length<10)return t;var i=parseInt(t.substr(8,2),10),n=parseInt(t.substr(5,2),10),r=parseInt(t.substr(0,4),10),o=(i<10?"0":"")+i,s=(n<10?"0":"")+n;switch(ASC.lang){case"sk":case"cz":return i+". "+n+"."+(e?" "+r:"");case"de":return o+"."+s+"."+(e?r:"");case"pl":return i+"."+n+"."+(e?r:"");case"hu":return(e?r+".":"")+" "+n+". "+i;default:return"us"==ASC.school_country?n+"/"+i+(e?"/"+r:""):o+"/"+s+(e?"/"+r:"")}}function ASC_date2str_day(t){if(!t||""==t)return"";var e=parseInt(t.substr(8,2),10),i=parseInt(t.substr(5,2),10),n=parseInt(t.substr(0,4),10);return ASC.ui.DatePicker.getDayNamesShort()[new Date(n,i-1,e).getDay()]}function ASC_time2str(t,e){if(void 0===e&&(e={}),!t||""==t)return"";":"==t[1]&&(t="0"+t);var i=!!e.short,n=void 0===e.ajSekundy?!i:e.ajSekundy,r=parseInt(t.substr(0,2),10),o=parseInt(t.substr(3,2),10),s=parseInt(t.substr(6,2),10),a=(r<10?"0":"")+r,l=(o<10?"0":"")+o,c=(s<10?"0":"")+s;switch(ASC.lang){case"de":return a+":"+l+(n?":"+c:"");case"en":var u=":"+l+(n?":"+c:"");return 0==r?"12"+u+(i?"":" AM"):r<12?r+u+(i?"":" AM"):12==r?"12"+u+(i?"":" PM"):r-12+u+(i?"":" PM");default:return r+":"+l+(n?":"+c:"")}}function ASC_str2time(t){var e=t.split(":"),i=["00","00","00"];if(t){var n=e[e.length-1]+"",r=0;for(var o in e)r=parseInt(2<e[o].length?e[o].substr(0,2):e[o],10),isNaN(r)||(i[o]=(r<10?"0":"")+r);0<=n.toLowerCase().indexOf("pm")&&parseInt(i[0])<12&&(i[0]=""+(parseInt(i[0])+12)%24),0<=n.toLowerCase().indexOf("am")&&12==parseInt(i[0])&&(i[0]="00")}return i.join(":")}function currentTimeMillis(){return(new Date).getTime()}function date_week_end(t){return date_delta(date_week_start(t),6)}function date_week_start(t){for(var e=ASC.ui.DatePicker.getSettings().firstDay,i=date_sql2js(t),n=6;0<n&&i.getDay()!=e;n--)i.setDate(i.getDate()-1);return ASC.date_js2sql(i)}function ASC_monthName(t){return 0<=t&&t<ASC.ui.DatePicker.monthNames.length?ls(ASC.ui.DatePicker.monthNames[t]):t}function ASC_dayName(t){return 0<=t&&t<ASC.ui.DatePicker.dayNames.length?ls(ASC.ui.DatePicker.dayNames[t]):t}function date_firstDayOfWeek(t,e){var i;void 0===e&&(e=1),void 0===e&&(e=1);var n=!1;"string"==typeof t?i=ASC.date_sql2js(t):(i=t,n=!0);var r=i.getDay();return r!=e&&(r=r<e?i.getDate()-(6-r):i.getDate()-(r-e),i.setDate(r)),n?i:ASC.date_js2sql(i)}function date_week_getNumber(t){var e=ASC.date_sql2js(t);e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);var i=new Date(e.getFullYear(),0,4);return 1+Math.round(((e.getTime()-i.getTime())/864e5-3+(i.getDay()+6)%7)/7)}function indexOf(t,e,i){void 0===i&&(i=0);for(var n=t.length;i<n;i++)if(i in t&&t[i]===e)return i;return-1}function indexOf2(t,e,i){void 0===i&&(i=0);for(var n=t.length;i<n;i++)if(i in t&&t[i]==e)return i;return-1}function remove(t,e){var i=ASC.indexOf(t,e);0<=i&&t.splice(i,1)}function trim(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function length(t){return t.length?parseInt(t.length):ASC.count(t)}function count(t){var e=0;if(t)for(var i in t)e++;return e}function strEquals(t,e){return""+t==""+e}function emailIsValid(t){return!((t+="").length<5||t.indexOf("@")<0)&&/^[a-zA-Z0-9]+[a-zA-Z0-9\._\-\+]*@([a-zA-Z0-9_\-]+\.)+[a-zA-Z]+$/i.test(t)}function loadTTLang(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return ASC.count(ASC.ttlangasc)<2e3?[2,new Promise(function(t){return barJsLibraryLoad("/static/js/ttlang_"+ASC.lang+".js?dummy=1",t)})]:[2]})})}function ttls(t){return ASC.ttlangasc[t]?ASC.ttlangasc[t]:""+t}function ls(t){return"undefined"!=typeof Langs&&Langs&&Langs[t]?Langs[t]:""+t}function lsf(t,e){var i=parseInt(t)?ls(parseInt(t)):t;if(e)for(var n in e){var r=e[n];for(i=i.replace("{"+n+"}",r+"");;){var o=i.indexOf("{"+n+":");if(!(0<=o))break;var s=o+2+n.length,a=i.indexOf("}",s),l=i.substring(s,a).split("|"),c=1;switch(ASC.lang){case"sk":case"cz":c=1==r?1:2<=r&&r<5?2:3;break;default:c=1==r?1:2;case"hr":var u=Math.abs(parseInt(r+""));c=u%10==1&&u%100!=11?1:2<=u%10&&u%10<5&&(u%100<10||20<=u%100)?2:3}1==l.length&&(l=["",l[0],l[0]]),2==l.length&&(l=[l[0],l[1],l[1]]),i=i.substr(0,o)+l[c-1]+i.substr(a+1)}}return i}function clone(t){return JSON.parse(JSON.stringify(t))}function cloneArray(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i]);return e}function ToString(t){if(null==t)return"";var e=""+t;switch(ASC.type(t)){case"object":for(var i in e="{",t)"{"!=e&&(e+=", "),e+=i+": "+ASC.ToString(t[i]);e+="}";break;case"array":e="";for(var n=0;n<t.length;n++)0<n&&(e+=", "),e+=ASC.ToString(t[n])}return e}function textContent(t){return $j(t).text()}function getStyleValuePixels(t){var e=t.length;return 2<e&&"px"==t.substr(e-2)?parseInt(t.substr(0,e-2)):0}ASC.dieError=dieError,ASC.sendErrorJS=sendErrorJS,ASC.logProblem=logProblem,ASC.logError=logError,ASC.checkRequiredFields=checkRequiredFields,ASC.validateField=validateField,ASC.removeDiacritics=removeDiacritics,ASC.setFieldValidator=setFieldValidator,ASC.validatorRC=validatorRC,ASC.validatorEmail=validatorEmail,ASC.validatorRequire=validatorRequire,ASC.isIE=isIE,ASC.reloadPage=reloadPage,ASC.date_today=date_today,ASC.date_delta=date_delta,ASC.date_diff=date_diff,ASC.date_interval_array=date_interval_array,ASC.date_js2sql=date_js2sql,ASC.time_js2sql=time_js2sql,ASC.datetime_js2sql=datetime_js2sql,ASC.date_sql2js=date_sql2js,ASC.timezone_isWeekend=timezone_isWeekend,ASC.ASC_date2str=ASC_date2str,ASC.ASC_date2str_day=ASC_date2str_day,ASC.ASC_time2str=ASC_time2str,ASC.ASC_str2time=ASC_str2time,ASC.currentTimeMillis=currentTimeMillis,ASC.date_week_end=date_week_end,ASC.date_week_start=date_week_start,ASC.ASC_monthName=ASC_monthName,ASC.ASC_dayName=ASC_dayName,ASC.date_firstDayOfWeek=date_firstDayOfWeek,ASC.date_week_getNumber=date_week_getNumber,ASC.indexOf=indexOf,ASC.indexOf2=indexOf2,ASC.remove=remove,ASC.trim=trim,ASC.length=length,ASC.count=count,ASC.strEquals=strEquals,ASC.emailIsValid=emailIsValid,ASC.loadTTLang=loadTTLang,ASC.ttls=ttls,ASC.ls=ls,ASC.lsf=lsf,ASC.clone=clone,ASC.cloneArray=cloneArray,ASC.ToString=ToString,ASC.textContent=textContent,ASC.getStyleValuePixels=getStyleValuePixels;var ASC_nextId=1,flashDiv;function ASC_newId(){return"ASC_ID_"+ASC_nextId++}function ASC_response(response,options){if(void 0===options&&(options={}),"OK"!=response)if("JS:"==response.substr(0,3)){var cmd=""+response.substr(3);try{eval(cmd)}catch(t){var msg=ASC.isString(t)?t:ASC_response_getErrorMsg(cmd,t);options.silent||ASC.ASC_messageBox(msg),options.failure&&options.failure(msg)}}else options.silent||ASC.ASC_messageBox(response)}function ASC_response_getErrorMsg(t,e){function i(t){0<=t&&(n=0<=n?Math.min(n,t):t)}var n=-1;return i(t.indexOf("\nWarning")),i(t.indexOf("\n<b>Warning</b>:")),i(t.indexOf("\nFatal error")),i(t.indexOf("\n<b>Fatal error</b>")),i(t.indexOf("\nCatchable fatal error")),i(t.indexOf("\n<b>Catchable fatal error</b>")),n<0&&("Unexpected end of input"==e.message.substr(0,23)||"Unexpected identifier"==e.message.substr(0,21))&&i(t.lastIndexOf("Error")),(0<=n?t.substr(n,200):""+e.message).trim()}function ASC_action(t,e,i){void 0===i&&(i={});var n=null;function r(){n&&(n.$div.parent().fadeOut(),n.$div.dialog("destroy"),n=null)}"object"!=typeof i&&(i={modal:!!i}),(i=__assign({modal:!0},i)).modal&&(n=new ASC.ui.Dialog({resizable:!1,draggable:!1,width:"180px",title:ASC.ls(2568)+"...",show:!0,dialogClass:"asc-dialog-mask",open:function(t){$j(this).parent().hide(),$j(this).parent().prev(".ui-widget-overlay").attr("style","opacity:0 !important;")}}),setTimeout(function(){n&&(n.$div.parent().fadeIn(),n.$div.parent().prev(".ui-widget-overlay").attr("style",""))},1e3)),"string"==typeof e&&(e+="&_LJSL="+ASC.loadedJSLibs);var o=i.success;delete i.success;var s=i.success2;if(delete i.success2,e instanceof FormData){var a=$j.ajax($j.extend({url:t,type:"POST",data:e,timeout:6e4,global:!1,success:function(t,e,n){r(),o&&o(),ASC_response(t,{failure:i.failure,silent:i.silent}),s&&s()},error:function(n,o,s){if(r(),i.retry&&0<i.retry){i.retry--;var l=ASC_action(t,e,i);a.ASC_abort=l.ASC_abort}else i.failure?i.failure(n):"gcall"==t?(alert("The operation failed: "+o),logError(6887245346,{status:o,error:s,data:e})):alert("Error connecting to: "+t+"\n"+o)},complete:function(){ASC.remove(ASC.ASC_action_requests,a)}},i));return ASC.ASC_action_requests.push(a),a.ASC_abort=function(){a.abort(),r()},a}var l=new XMLHttpRequest;if(e&&"object"==typeof e){var c=[];for(var u in e){var d=e[u];void 0!==d&&c.push(u+"="+encodeURIComponent(d))}e=c.join("&")}function h(t){ASC.remove(ASC.ASC_action_requests,l),l.onload=null,l.onprogress=null,r(),o&&o(),ASC_response(t,{failure:i.failure,silent:i.silent}),s&&s()}function p(n){if(r(),i.retry&&0<i.retry){i.retry--;var o=ASC_action(t,e,i);l.ASC_abort=o.ASC_abort}else i.failure?i.failure(l):alert("Error connecting to: "+t+"\n"+n)}return l.onload=function(){l.status&&200==l.status?h(l.response):p(l.status+" "+l.statusText)},l.onerror=function(){return p("onerror")},l.onprogress=function(){var t=""+l.response,e=t.indexOf(" /*\"'ASC-LONGOP'\"*/");0<=e&&h(t.substr(0,e)),1e6<t.length&&(l.onprogress=null)},l.open("POST",t),l.timeout=6e4,l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.send(e),l.ASC_abort=function(){l.abort(),r()},ASC.ASC_action_requests.push(l),l}function alertMSG(t,e){void 0===e&&(e="Edupage");var i=new ASC.ui.Dialog({width:"1000px",title:e,autoOpen:!1}),n=$j("<div>").css({maxHeight:"500px",overflow:"auto",whiteSpace:"pre"}).html(t);return i.setBody(n),i.center(),i.show(),i}function ASC_messageBox(t){if(ASC.ui&&ASC.ui.Dialog){var e=new ASC.ui.Dialog({title:"Edupage",width:300,buttons:["OK"]});e.setBody(escapeHTML(t).replace(/\n/g,"<br>")),e.$ft.find(".asc-button").focus()}else alert(t)}function messageBox(t,e,i){void 0===i&&(i={}),(!i.type||ASC.indexOf(["warning","succes","info","error","customize"],i.type)<0)&&(i.type="succes");var n=$j("<div>").addClass("messageBox "+i.type).appendTo(t).html(e);return i.style&&(n.get(0).style.cssText=i.style),$j("<div>").appendTo(n).addClass("close").click(function(t){n.hide(),i.fn&&"function"==ASC.type(i.fn)&&i.fn(t)}).attr("title",i.fn?ASC.ls(1038):ASC.ls(1567)),n.get(0)}function flashMessage(t,e){if(void 0===e&&(e={}),ASC.req.isApp())barShowMessageEx(escapeHTML(t));else{flashDiv&&0!=$j(flashDiv).parents("html").length||(flashDiv=ASC.createDiv(document.body,"flash-message-container"));var i=5e3,n=ASC.createSpan(flashDiv),r=ASC.createDiv(n,"flash-message");ASC.createChild(n,"br");var o=$j(e.border_error);if(e.border_error&&(o=findBorderErrorEl(o)).addClass("border_error"),e.auto_column_label){var s=findTextClosest(o,"label");s&&(t=ASC.lsf(1840,{f:s}))}40<t.length&&(i=7e3),80<t.length&&(i=1e4),1<=e.timeout&&(i=e.timeout),r.innerHTML=t,setTimeout(function(){o.length&&o.removeClass("border_error"),n.parentNode&&n.parentNode.removeChild(n)},i)}}function findBorderErrorEl(t){if(t.is(":hidden")){var e=t.next(":visible").first();e.length&&!e.is(":hidden")||(e=t.prev(":visible").first()),t=e}return t.is(".asc-autocomplete")&&(t=t.find(".ui-autocomplete-input")),t}function findTextClosest(t,e){var i=t.prevAll(e).first().text();return(i=(i=i||t.parent().prevAll(e).first().text())||t.find(e).text())||t.closest(e).text()}ASC.ASC_newId=ASC_newId,ASC.ASC_response=ASC_response,ASC.ASC_response_getErrorMsg=ASC_response_getErrorMsg,ASC.ASC_action_requests=[],ASC.ASC_action=ASC_action,ASC.alertMSG=alertMSG,ASC.ASC_messageBox=ASC_messageBox,ASC.messageBox=messageBox,ASC.flashMessage=flashMessage;var Mask=(Rg.prototype.hide=function(){this.mask.hide(),this.mask=null},Rg);function Rg(){var t=this;this.mask=new ASC.ui.Dialog({autoOpen:!1,resizable:!1,draggable:!1,width:"150px",title:ASC.ls(2568)+"...",show:!0,dialogClass:"asc-dialog-mask"}),setTimeout(function(){t.mask&&(t.mask.$div.dialog("open"),$j(".ui-widget-overlay.ui-front").css({opacity:0}))},500)}ASC.Mask=Mask;var PaginatedDiv=(Tg.prototype.paginate=function(){return this.stack=[],this.result.format=this.getFormatByClassName(),this.result.pages=[],this.result.map=[],this.maxY=this.$div.offset().top+this.pageHeight+parseFloat(this.$div.css("padding-top")),0<this.pageHeight?this.paginateNormal():this.$div.hasClass("print-sheet")?this.result.pages.push(ASC.outerHTML(this.$div.get(0))):this.paginateManual(),this.createHTMLResult(),this.result},Tg.prototype.getFormatByClassName=function(){var t={"a4-portrait":"print-a4-portrait","a4-landscape":"print-a4-landscape","a5-portrait":"print-a5-portrait","a5-landscape":"print-a5-landscape"};for(var e in t)if(this.$div.hasClass(t[e])||0<this.$div.find("."+t[e]).length)return e;return"a4-portrait"},Tg.prototype.paginateNormal=function(){var t=this.addStackItem(this.$div);this.watermark&&(t.content+=this.nodeHTML(this.watermark.get(0)),t.headers=t.headers.add(this.watermark));try{this.traverse(t)}catch(t){alert(t)}t.needed&&this.emitPage()},Tg.prototype.paginateManual=function(){var t=this,e=this.$div.html();this.options.addprintsheet&&(e="<div class='print-sheet'>"+e+"</div>"),this.result.pages.push(e),this.$div.children(".print-sheet-manual").each(function(e,i){t.result.format="custom";var n=$j(i);t.result.height=n.height(),t.result.width=n.width();var r=i.ASC_px2mm;r&&(t.result.px2mm=r)})},Tg.prototype.createHTMLResult=function(){var t=this,e="",i="custom"==this.result.format,n=0<this.result.format.indexOf("-landscape");e+='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">\n',e+="<html"+(i?"  mozNoMarginBoxes ":"")+"><head>",e+="<meta http-equiv='Content-Type' content='text/html; charset=utf-8'/>";var r=[];function o(t){return t.sheet||t.styleSheet}$j("LINK").each(function(i,n){if(o(n))if(t.options.css_inline)r.push(n);else{var s=n.getAttribute("href");e+="<link href='"+s+"' type='text/css' rel='stylesheet'/>"}}),$j("STYLE").each(function(t,e){r.push(e)});for(var s=0,a=r;s<a.length;s++){var l=o(a[s]);if(e+="<style type='text/css'>","cssText"in l)e+=l.cssText;else try{var c=l.cssRules;for(var u in c){var d=c[u];d&&d.cssText&&(e+=d.cssText+"\n")}}catch(i){console.warn(i)}e+="</style>"}n&&(e+="<style type='text/css'>@page {size:landscape;}</style>"),i&&(e+="<style type='text/css'>@page {margin: 0px;margin-bottom: -5cm;}</style>"),e+="<title>"+escapeHTML(ASC.school_name)+"</title>",e+="</head>",e+="<body style='margin:0px;padding:0px'><div class='g_echobody' style='margin:0px; padding:0px'>",this.result.html_begin=e,this.result.html_pages=this.result.pages.join(""),this.result.html_end="</div></body></html>",this.result.html=this.result.html_begin+this.result.html_pages+this.result.html_end},Tg.prototype.computePageHeight=function(){this.pageHeight=0,this.$div.hasClass("print-sheet")&&(this.pageHeight=parseFloat(this.$div.css("min-height"))-parseFloat(this.$div.css("padding-bottom"))-parseFloat(this.$div.css("padding-top")),(this.pageHeight<400||2e3<this.pageHeight)&&(this.pageHeight=1e3))},Tg.prototype.createWatermark=function(){this.watermark=$j("<div>").css({position:"absolute",right:"50px",bottom:"50px",width:"300px",height:"100px",padding:"10px",color:"#000",backgroundColor:"#fff",fontSize:"30px"}).addClass("print-header").text("Unregistered version of Timetables Online")},Tg.fixInputValues=function(t){t.find("INPUT").each(function(t,e){e.setAttribute("value",e.value)})},Tg.prototype.addStackItem=function(t){var e={el:t,content:"",headers:$j(),needed:!0};return this.stack.push(e),e},Tg.prototype.nodeHTML=function(t){try{if(t instanceof HTMLElement||t instanceof SVGElement){var e=ASC.outerHTML(t);return this.options.minify?this.minify(e):e}return"textContent"in t?t.textContent:""+t}catch(e){return t}},Tg.prototype.minify=function(t){var e=t.match(this.pattern);if(e)for(var i=0;i<e.length;i++){var n=e[i].match(this.replace),r=ASC.indexOf2(this.result.map,n[1]);r<0&&(r=this.result.map.length,this.result.map.push(n[1])),t=t.replace(n[1],"*"+r)}return t},Tg.prototype.emitPage=function(){for(var t=this,e="",i="",n=0,r=this.stack;n<r.length;n++){var o=r[n],s=tagHTML(o.el.get(0));e+=s[0]+o.content,i=s[1]+i,o.needed=!1,o.content="",o.headers.each(function(e,i){o.content+=t.nodeHTML(i)})}this.result.pages.push(e+i)},Tg.prototype.getElementType=function(t){if(1!=t.nodeType)return 0;switch(t.tagName.toLowerCase()){case"div":case"table":case"tbody":return(e=$j(t)).is(":hidden")||e.hasClass("print-skip")?-1:e.hasClass("print-nobreak")?7:e.hasClass("print-header")?3:e.hasClass("print-pagebreak")?4:e.hasClass("print-nobreakafter")?5:e.hasClass("print-pagebreak-even")?6:e.hasClass("print-breakbefore")?8:0<e.children().length?2:1;case"thead":case"colgroup":case"style":return 3;case"tr":var e;return(e=$j(t)).hasClass("print-header")?3:e.hasClass("print-pagebreak")?4:e.hasClass("print-nobreakafter")?5:e.hasClass("print-breakbefore")?8:e.hasClass("print-skip")?-1:1;case"h1":case"h2":case"h3":case"h4":if($j(t).hasClass("print-header"))return 3;break;case"script":return-1}return 1},Tg.prototype.traverse=function(t){for(var e=t.el.get(0).firstChild;e;e=e.nextSibling)switch(this.getElementType(e)){case-1:break;case 0:t.content+=this.nodeHTML(e),t.needed=!0;break;case 1:var i=$j(e);this.isItemOverflowed(i)&&this.stack.find(function(t){return t.content})&&(this.emitPage(),this.setMaxY(i)),t.content+=this.nodeHTML(e),t.needed=!0;break;case 7:if(i=$j(e),!this.isItemOverflowed(i)){t.content+=this.nodeHTML(e),t.needed=!0;break}case 8:t.content.trim()&&(this.emitPage(),this.setMaxY($j(e)));case 2:var n=this.addStackItem($j(e));if(this.extraSpace.push(parseFloat(n.el.css("padding-bottom"))+parseFloat(n.el.css("margin-bottom"))+parseFloat(n.el.css("border-bottom-width"))),this.traverse(n),this.extraSpace.pop(),n.needed){var r=ASC.tagHTML(n.el.get(0));t.content+=r[0]+n.content+r[1],t.needed=!0}this.stack.pop();break;case 3:t.content+=this.nodeHTML(e),t.headers=t.headers.add(e),t.needed=!0;break;case 4:this.emitPage(),this.setMaxY($j(e),!0);break;case 5:for(var o=$j(e).offset(),s=this.nodeHTML(e),a=e;a.nextSibling;){var l=a.nextSibling,c=this.getElementType(l);if(5!=c&&2!=c){if(1==c||7==c){a=l,s+=this.nodeHTML(a);break}if(4==c){a=l.previousSibling;break}if(a=e,s=this.nodeHTML(e),"ascpalino"==ASC.edupage)return void alert("Error6257088380");break}a=l,s+=this.nodeHTML(a)}if(this.isItemOverflowed($j(a))){var u=this.getHeaderHeight();this.emitPage(),this.maxY=o.top-u+this.pageHeight}t.content+=s,t.needed=!0,e=a;break;case 6:this.emitPage(),this.result.pages.length%2&&this.emitPage(),this.setMaxY($j(e),!0)}},Tg.prototype.isItemOverflowed=function(t){var e=t.outerHeight(!0),i=t.offset();return 0<=e&&i.top+e+this.extraSpace.reduce(function(t,e){return t+e})>this.maxY},Tg.prototype.setMaxY=function(t,e){void 0===e&&(e=!1);var i=t.offset(),n=this.getHeaderHeight(),r=e?t.outerHeight(!0)-parseFloat(t.css("margin-top")):0;this.maxY=i.top+r+this.pageHeight-n},Tg.prototype.getHeaderHeight=function(){for(var t=0,e=0,i=this.stack;e<i.length;e++)i[e].headers.filter("DIV,TABLE,TR,THEAD").each(function(e,i){var n=$j(i).outerHeight(!0);0<n&&i.parentNode&&(t+=n)});return t},Tg.convertToA3=function(t){var e;$j(".print-sheet",t).each(function(i,n){i%2==0&&(e=$j("<div class='print-sheet A3'>").appendTo(t)),e.append(n)})},Tg);function Tg(t,e){this.options=e,this.maxY=0,this.extraSpace=[0],this.result={pages:[],format:"a4-portrait",html:"",html_begin:"",html_pages:"",html_end:"",map:[],height:0,width:0,px2mm:0},this.$div=$j(t),"auto"==e.pageHeight?this.computePageHeight():this.pageHeight=e.pageHeight,e.watermark&&this.createWatermark(),e.minify&&(this.pattern=/<[a-zA-Z]+ ([^>]+)>/g,this.replace=/<[a-zA-Z]+ ([^>]+)>/),Tg.fixInputValues(this.$div)}function outerHTML(t){if("outerHTML"in t)return t.outerHTML;if(!t.tagName){var e=t.textContent;return void 0===e&&(e=t.data),escapeHTML(e)}if("BR"==t.tagName)return"<BR/>";var i=ASC.tagHTML(t);return i[0]+t.innerHTML+i[1]}function tagHTML(t){var e=t.tagName,i="";return t.className&&(i+=" class="+ASC.escapeAttr(t.className)),t.style.cssText&&(i+=" style="+ASC.escapeAttr(t.style.cssText)),t.rowSpan&&(i+=" rowspan="+ASC.escapeAttr(t.rowSpan)),t.colSpan&&(i+=" colspan="+ASC.escapeAttr(t.colSpan)),t.type&&(i+=" type="+ASC.escapeAttr(t.type)),t.checked&&(i+=" checked="+ASC.escapeAttr(t.checked)),t.src&&"IMG"==t.tagName&&(i+=" src="+ASC.escapeAttr(t.src)),["<"+e+i+">","</"+e+">"]}function escapeAttr(t){return'"'+escapeHTML(t).replace(/"/g,"&quot;")+'"'}function escapeHTML(t){return(t=""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ribbonCombo_fixMenu(t,e){void 0===e&&(e={});for(var i=!1,n=0;n<t.length;n++)if(t[n]&&ASC.isArray(t[n])){i=!0;break}if(i){var r=[],o=[];for(n=0;n<t.length;n++)if(t[n]){var s=t[n];if(ASC.isArray(s))if(0==s.length)0<o.length&&(r.push(o),o=[]);else{r.push(o),o=[];for(var a=0;a<s.length;a++)o.push(s[a])}else o.push(s)}for(0<o.length&&r.push(o),n=t.length=0;n<r.length;n++)t[n]=r[n]}for(n=0;n<t.length;n++)(s=t[n])&&(ASC.isArray(s)?ASC.ribbonCombo_fixMenu(s,e):(s.icon&&!e.mobile&&(s.text="<img src='"+staticUrl(s.icon)+"' style='vertical-align:middle; max-height:16px; margin-top: -5px; margin-bottom: -5px; margin-left: -18px;'/>"+s.text,s.icon=void 0),s.onclick&&"function"==ASC.type(s.onclick)&&(s.onclick={fn:s.onclick}),s.submenu&&(s.submenu.id=ASC.ASC_newId(),ASC.ribbonCombo_fixMenu(s.submenu.itemdata,e))))}function paginateDiv(t,e,i){return void 0===i&&(i={}),i.pageHeight=e,t&&t.children&&1==t.children.length&&t.children[0].classList.contains("print-sheet")&&(t=t.children[0]),new PaginatedDiv(t,i).paginate()}function printDiv(t,e){if(void 0===e&&(e={}),t.ASC_print)return t.ASC_print();var i=$j(t).hasClass("print-sheet"),n=null;if(!i||!ASC.isIE()||e.preview||confirm(ASC.ls(1899))){e.header&&(n=$j("<h2 class='print-header'>").text(e.header).prependTo(t));var r=ASC.paginateDiv(t,i?"auto":0,{addprintsheet:e.addprintsheet,watermark:e.watermark});n&&n.remove();var o=e.window?e.window:window.open("about:blank","_blank"),s=o.document;if(s.open(),s.write(r.html),s.close(),!e.preview){var a=Math.max(200,20*r.pages.length);ASC.todo_write(function(){o.print()}),$j(o).load(function(){o.setTimeout(function(){ASC.todo_finish()},a)})}}}function getUIParam(t,e,i){var n=t;return(void 0===n||n&&(n.target||n.clientX||n.innerHTML))&&(void 0===(n=e)||n&&(n.target||n.clientX||n.innerHTML))&&(n=i),n}function isVisible(t){var e=$j(t),i=e.is(":visible")&&"hidden"!=e.css("visibility");return i&&0<e.parents(".yui-hidden").length&&(i=!1),e.parents().each(function(t,e){"hidden"==$j(e).css("visibility")&&(i=!1)}),i}function onVisible(t,e){var i=$j(t),n=setInterval(function(){if(isVisible(i))e();else if(0<i.parents("html").length)return;clearInterval(n)},200)}function strVal(t){return void 0===t||!1===t||null===t?"":!0===t?"1":""+t}function boolVal(t){return!(!t||ASC.isArray(t)&&0==t.length||"0"==ASC.strVal(t))}function strEmpty(t){return""==strVal(t)}function addActionEnter(t,e,i){$j(t).keydown(function(t){13==t.keyCode&&(t.preventDefault(),e(t,i))})}function deepEquals(t,e){if(t==e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(!ASC.deepEquals(t[i],e[i]))return!1;return!0}if("object"!=typeof t)return!1;for(var n in t){if(!(n in e))return!1;if(!ASC.deepEquals(t[n],e[n]))return!1}for(var n in e)if(!(n in t))return!1;return!0}ASC.PaginatedDiv=PaginatedDiv,ASC.outerHTML=outerHTML,ASC.tagHTML=tagHTML,ASC.escapeAttr=escapeAttr,ASC.escapeHTML=escapeHTML,ASC.ribbonCombo_fixMenu=ribbonCombo_fixMenu,ASC.paginateDiv=paginateDiv,ASC.printDiv=printDiv,ASC.getUIParam=getUIParam,ASC.isVisible=isVisible,ASC.onVisible=onVisible,ASC.strVal=strVal,ASC.boolVal=boolVal,ASC.strEmpty=strEmpty,ASC.addActionEnter=addActionEnter,ASC.deepEquals=deepEquals;var ASC_ce=(Bj.prototype.subscribe=function(t,e){void 0===e&&(e={}),this.$el.on({ASC_ce:t},e)},Bj.prototype.fire=function(t){this.$el.trigger("ASC_ce",t)},Bj),Compare,ak,bk,ck,tt,Dk,changeEvents,lang_add_nbsp_regex;function Bj(t){this.$el=$j(t)}function Dialog(t,e,i,n){var r;void 0===n&&(n={}),(r=new ASC.ui.Dialog({width:n.width?n.width:"30em",autoOpen:!1,buttons:d,modal:!0})).setHeader(t),r.setBody(e);var o=function(){r.hide()};if("function"==ASC.type(n.okfunc)?o=n.okfunc:n.okfunc&&(o=function(){var t="";for(var e in n.inputs){var o=n.inputs[e];o.id in i&&(o.combo&&o.id+"_combo"in i&&i[o.id+"_combo"]?(t+="&"+o.id+"_combo="+i[o.id+"_combo"],0==i[o.id+"_combo"].indexOf("_not:")&&(t+=i[o.id].value)):t+="&"+o.id+"="+i[o.id].value)}r.hide(),i.ASC_action(n.okfunc,"ok=1"+t)}),n.inputs){var s=document.createElement("div");for(var a in r.$bd.append(s),n.inputs){var l,c=n.inputs[a],u=ASC.createDiv(s,"","display:inline-block;width:150px");ASC.createSpanText(u,c.label),c.type,(l=ASC.createChild(s,"input")).type="text",l.value=c.combo&&c.value in c.combo?"":c.value+"",0==(c.value+"").indexOf("_not:")&&(l.value=c.value.substr(5)),ASC.addActionEnter(l,o),l.id=c.id,i[c.id]=l,c.combo&&function(t,e){function n(n){e.readOnly=!!n&&(n+"").indexOf("_not:")<0,ASC.setClass(e,"sivepozadie",e.readOnly),i[t.id+"_combo"]=n}var r=t.value in t.combo?t.value:0==(t.value+"").indexOf("_not:")?"_not:":"";new ASC.ui.ComboBox(s,r,t.combo,{fn:n}),n(r)}(c,l)}$j("input",s).focus()}var d=[];for(var a in n.buttons||(n.buttons=["ok","close"]),n.buttons){var h=n.buttons[a];if("object"==ASC.type(h))h.handler&&!h.onclick&&(h.onclick=h.handler),d.push(h);else switch(h){case"close":d.push(ASC.ls(1567));break;case"cancel":d.push(ASC.ls(1038));break;case"ok":d.push({text:ASC.ls(1573),onclick:o,type:"default"})}}return r.setButtons(d),r.show(),r}function ek(t,e,i){var n=typeof(t=fk(t)),r=typeof(e=fk(e));return n!=r?ek(n,r,i):t<e?i?1:-1:e<t?i?-1:1:0}function fk(t){return null==t?t="":t.constructor==String?isNaN(t)?t=t.toLowerCase():""!=t&&(t*=1):t.constructor==Boolean&&(t=""+t),t}function hk(t,e,i){if(ASC.isArray(t))return hk(t[0],e,i);if(ASC.isArray(e))return hk(t,e[0],i);if(null===ck&&(ck=ASC.school_country||"en",bk=ASC.lang_getLocale()),"en"!=ck&&t&&t.constructor==String&&e&&e.constructor==String){if(t==e)return 0;var n={numeric:!1};if(isNaN(t)&&isNaN(e))return i?e.localeCompare(t,bk,n):t.localeCompare(e,bk,n)}return ek(t,e,i)}function getSessionStorage(t,e){void 0===e&&(e="array");var i=null;if(sessionStorage&&(i=sessionStorage.getItem(t))){try{i=JSON.parse(i)}catch(e){sessionStorage.setItem(t,""),ASC.logError(9174973301,i),i=!1}ASC.type(i)!=e&&(sessionStorage.setItem(t,""),ASC.logError(9174973302,i),i=!1)}return i}function subscribeToggleBox(t,e,i){void 0===i&&(i={});var n=$j(e);$j(t).addClass("toggleBox"+(i.active?" active":"")).click(function(){n.toggle(i.easing||"slide"),$j(this).toggleClass("active")}),i.active||n.hide()}function scaleDown(t){var e=t.scrollHeight,i=t.clientHeight,n=i/e;if(n<1){var r=(i-e)/2;$j(t).css("transform","scale("+n+", "+n+") translateY("+r+"px)"),ASC.ascdebug&&console.log("transform","scale("+n+", "+n+") translateY("+r+"px)")}}function lang_add_nbsp(t){return lang_add_nbsp_regex=lang_add_nbsp_regex||/\b(0.|1.|2.|3.|4.|5.|6.|7.|8.|9.|a|i|bez|bezo|cez|cezo|do|k|ku|medzi|mimo|na|nad|o|od|odo|po|pod|popod|popri|pre|pri|s|so|u|v|vo|z|za|zo|mgr.|rndr.|prof.|doc.|ing.|phdr.|Ä.|veÄ¾mi| Â§|Ä…|des|du|de|Å•|z.|y|la|en|der|die|das|nr.|dipl.|â€ždipl.|the|on|Ã¢|Å„|Ã®) /gi,t.replace(lang_add_nbsp_regex,"$1Â ")}function ucfirst(t){return t?t.substr(0,1).toUpperCase()+t.substr(1):""}function getHelpUrl(t,e,i){return i=i||ASC.lang||ASC.req.lang||(ASC.school_country||"").toLocaleLowerCase()||"en","edupage"==e||["e","t","a","u"].includes(t[0])?"https://help.edupage.org/"+i+"/"+t:"tt"==e?"http://help.asctimetables.com/text.php?id="+t+"&lang="+i:"agenda"==e?"http://pomoc.skoly.org/text.php?lang=sk&id="+t:"http://help.asctimetables.com/text.php?id="+t+"&lang="+i}function unmountReactChildren(t){if(t._reactRootContainer)ASC.require("react-dom").unmountComponentAtNode(t);else for(var e=t.firstElementChild;e;e=e.nextElementSibling)e instanceof HTMLElement&&ASC.unmountReactChildren(e)}ASC.ASC_ce=ASC_ce,ASC.Dialog=Dialog,ak=Compare=ASC.Compare||(ASC.Compare={}),bk=null,ck=null,ak.compareBase=function(t,e,i){return null==t||!1===t?null==e||!1===e?0:i?1:-1:null===e||null==e||!1===e?i?-1:1:null},ak.compareSimple=ek,ak.compareCombo=function(t,e,i,n){if(!n||!n.length)return hk(t,e,i);var r=1e6,o=1e6;t=ASC.strVal(t),e=ASC.strVal(e);for(var s=n.length-1;0<=s;s--){var a=ASC.strVal(n[s].value);t==a&&(r=s),e==a&&(o=s)}return ek(r,o,i)},ak.compare=hk,Dk=tt=ASC.tt||(ASC.tt={}),Dk.addEs=function(t){return"s"==t.substring(t.length-1)?t+"es":t+"s"},Dk.removeEs=function(t){return"types"==t.substring(t.length-5)?t.substring(0,t.length-1):"es"==t.substring(t.length-2)?t.substring(0,t.length-2):t.substring(0,t.length-1)},Dk.StudentPresenceState=function(t,e){void 0===e&&(e="");var i=0;switch(e){case"P":i=1;break;case"A":i=2;break;case"L":i=3;break;case"E":i=4;break;default:i=ASC.presence_P?0:1}var n=-16*i+"px 0px";if(t.style&&""!=t.style.backgroundPosition)t.style.backgroundPosition=n;else{var r=ASC.createDiv(t,"sspicker-state");1<e.indexOf("px")?r.style.backgroundPosition=e:r.style.backgroundPosition=n}},function(t){function e(e,i){e=$j(e)[0];for(var n=0;n<t.handlers.length;n++){var r=t.handlers[n];r.$div[0]==e&&(i&&r.key!=i||t.handlers.splice(n,1))}}t.watch=function(e,i,n){void 0===n&&(n={}),e=e||{};var r=[];for(var o in e)r.push(new u(o,document.body,i,e[o],n));return function(){for(var e=0,i=r;e<i.length;e++){var n=i[e],o=t.handlers.indexOf(n);0<=o&&t.handlers.splice(o,1)}}},t.on=function(t,e,i,n,r){new u(e,t,i,n,r)},t.off=e;var i=!(t.handlers=[]),n=null;function r(){return ASC.currentTimeMillis()/1e3}function o(){if(!i){i=!0,$j(window).on("blur focus mousemove touchstart touchend keydown",function(){t.user_alive_time=r()}),t.my_id="t"+Math.round(999e6*Math.random()),t.my_ls_key="changeEvents_"+t.my_id,a();try{window.addEventListener("storage",function(e){if(e.key&&"changeEvents"==e.key.substr(0,12)){if(!e.newValue)return;var i=JSON.parse(e.newValue);if(!i||!i.time||!i.my_id)return;if(5<r()-i.time)return;i.my_keys&&i.my_next_time&&i.my_gpids&&(t.others[i.my_id]={time:i.time,my_keys:i.my_keys,my_next_time:i.my_next_time,my_gpids:i.my_gpids}),i.ce_data&&c(i.ce_data,i.ce_payload||{})}})}catch(t){console.warn(t)}}}function s(){var t=[];return $j(".asc-gadget-jsc").each(function(e,i){i.ASC_gjsc&&i.ASC_gjsc.ASC_gpid&&t.push(i.ASC_gjsc.ASC_gpid)}),t}function a(){var e;if(setTimeout(a,800+400*Math.random()),function(){var t;return!(null===(t=ASC.req)||void 0===t||!t.loggedUser)||!!document.location.href.includes("/infoscreen")}()){for(var i=r(),o=t.handlers.length-1;0<=o;o--)t.handlers[o].valid()||t.handlers.splice(o,1);for(var c=0,u=t.handlers;c<u.length;c++)(C=u[c]).maybecall();if(0!=t.handlers.length){for(var d=0,h=0,p=t.handlers;h<p.length;h++){var f=(C=p[h]).next_time();f&&(d=d?Math.min(d,f):f)}if(d&&d<i&&!n){for(var v=0,g=t.handlers;v<g.length;v++)g[v].last_time=r();for(var m=[],b=0,y=t.handlers;b<y.length;b++){var C=y[b];m.indexOf(C.key)<0&&m.push(C.key)}var _=s();for(var $ in t.others){var S=t.others[$];if(5<i-S.time)delete t.others[$];else{for(var w=0,x=S.my_keys;w<x.length;w++){var A=x[w];m.indexOf(A)<0&&m.push(A)}$j.merge(_,S.my_gpids)}}(n=$j.ajax("/pollChangeEvents"+(ASC.ESID?"?ESID="+ASC.ESID:""),{type:"POST",data:{keys:m.join(","),gpids:_.join(","),edupage:ASC.edupage,user:(null===(e=ASC.req)||void 0===e?void 0:e.loggedUser)||void 0},dataType:"json",success:function(t){if(t){var e=t.ce_data,i=t.ce_payload;l(e=e||t.data,i=i||{}),t.reload&&setTimeout(function(){return window.location.reload()},5e3)}},complete:function(){n=null},error:function(t,e,i){console.log([t,e,i])}})).isErrorHandled=!0}else{for(var k=[],j=0,T=t.handlers;j<T.length;j++)C=T[j],k.indexOf(C.key)<0&&k.push(C.key);try{window.localStorage.setItem(t.my_ls_key,JSON.stringify({time:r(),my_id:t.my_id,my_next_time:d,my_keys:k,my_gpids:s()})),window.localStorage.removeItem(t.my_ls_key)}catch(e){console.warn(e)}}}}}function l(e,i){void 0===i&&(i={}),c(e,i),function(e,i){try{var n=ASC.currentTimeMillis()/1e3;window.localStorage.setItem(t.my_ls_key,JSON.stringify({time:n,my_id:t.my_id,ce_data:e,ce_payload:i})),window.localStorage.removeItem(t.my_ls_key)}catch(e){console.warn(e)}}(e,i)}function c(e,i){var n;for(var r in e){var o=e[r];if(o){var s=t.current[r];if(!(o<s&&s<=o+100)){t.current=__assign(__assign({},t.current),((n={})[r]=o,n));for(var a=0,l=t.handlers;a<l.length;a++){var c=l[a];c.key==r&&c.received(o,i[r])}}}}}t.user_alive_time=r(),t.others={},t.current={},t.post=function(t,e,i){var n,r;void 0===i&&(i=null),l(((n={})[t]=e,n),((r={})[t]=i,r))},t.received=l;var u=(d.prototype.next_time=function(){var e=this.prefInterval;return!function(){var t,e;return!((null===(t=ASC.req)||void 0===t?void 0:t.isAdmin())||(null===(e=ASC.req)||void 0===e?void 0:e.isUcitel())||document.location.href.includes("/infoscreen"))}()&&r()-t.user_alive_time<600||(e=Math.max(e,this.maxInterval)),this.last_time+e},d.prototype.received=function(t,e){var i=this;if(void 0===e&&(e=null),(!this.last||t<=this.last||t>this.last+100)&&!this.payload)return this.last=t,this.last_payload=null,void(this.last_time=r());this.last=t,this.last_payload=e,this.last_time=r(),this.dirty=!0,setTimeout(function(){i.maybecall()},0)},d.prototype.valid=function(){return 0<this.$div.parents("html").length},d.prototype.maybecall=function(){if(this.dirty){this.dirty=!1;try{this.callback(this.key,this.last_payload,this.last)}catch(t){console.log(t)}}},d);function d(i,n,s,a,l){void 0===l&&(l={}),this.callback=null,this.last=null,this.last_payload=null,this.last_time=0,this.prefInterval=5,this.maxInterval=60,this.dirty=!1,this.key=i,this.$div=$j(n),this.callback=s,this.last_time=r(),n!=document.body&&e(n,i),a&&(this.last=a),!0===l.interactive&&(this.prefInterval=5),!1===l.interactive&&(this.prefInterval=30),l.payload&&(this.payload=!0),t.handlers.push(this),o()}t.Handler=u}(changeEvents=ASC.changeEvents||(ASC.changeEvents={})),ASC.getSessionStorage=getSessionStorage,ASC.subscribeToggleBox=subscribeToggleBox,ASC.scaleDown=scaleDown,ASC.lang_add_nbsp=lang_add_nbsp,ASC.ucfirst=ucfirst,ASC.getHelpUrl=getHelpUrl,ASC.unmountReactChildren=unmountReactChildren}(ASC=ASC||{});var __awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i=i||Promise)(function(r,o){function s(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){t.done?r(t.value):function(t){return t instanceof i?t:new i(function(e){e(t)})}(t.value).then(s,a)}l((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},__spreadArrays=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),r=0;for(e=0;e<i;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)n[r]=o[s];return n};!function(t){t.ESID="";var e=(i.get=function(e){var n=t._modules[e];return n||(t._modules[e]=n=new i(e)),n},i.prototype.required=function(){if(!this.loaded){if(this.error)throw this.error;if(void 0===this.exports){if(!this.sourceFunc)return this.exports=null,void t.sendErrorJS("7508620812",this.url);this.exports={};try{this.sourceFunc(this.exports,this.require,this)}catch(t){throw this.error=t}this.loaded=!0}}},i.prototype.implementRpc=function(e){for(var i=this,n=function(e){r.exports[e]=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return __awaiter(i,void 0,void 0,function(){var i;return __generator(this,function(r){switch(r.label){case 0:return[4,t.requireAsync("/asc/edurequest")];case 1:return i=this.url,"getTTViewerData"!=e&&"regularttGetData"!=e||(i=i.replace("/timetable/server/ttviewer.js","/timetable/list.json").replace("/timetable/server/regulartt.js","/timetable/"+n[1]+".json")),r.sent().EduRequest_Client,t.ESID&&(i+="&ESID="+t.ESID),[2,new Promise(function(e,n){var r=new XMLHttpRequest;r.open("GET",i),r.onload=function(){try{e(function(e){var i;try{i=JSON.parse(e)}catch(r){var n=/Error([0-9]{1,16})/g.exec(""+e);throw n&&n[1]?new Error("RPC Error"+n[1]):r}if(i.reload)throw setTimeout(function(){i.en&&i.em&&alert(i.em+" (Error"+i.en+")"),"hard"==i.reload?window.location.href="/":window.location.reload()},5e3),"Reload";if(i.e){if(i.en&&i.em){var r=new Error(i.en);throw r.errNumber=i.en,r.msg=i.em,r}throw i.e}return i.ce&&setTimeout(function(){for(var e in i.ce)t.changeEvents.post(e,i.ce[e],i.cep&&i.cep[e])},0),i.r}(r.responseText))}catch(t){n(t)}},r.onerror=function(t){n(new Error(""+t))},r.send()})]}})})}},r=this,o=0,s=e;o<s.length;o++)n(s[o])},i.resolveUrl=function(e,i){var n,r=e.replace("\\","/");"."==r[0]&&(r=i.url.substr(0,i.url.lastIndexOf("/")+1)+r),r=r.replace(/\/\.\//g,"/");for(var o=0;o<10&&!(r.indexOf("..")<0);o++)r=r.replace(/\/[^\/\.]+\/\.\.\//,"/");if("/"!=r[0]&&"app/"==r.substr(0,4)&&(r="/"+r),"/"!=r[0]){if(0<=["crypto","@tensorflow/tfjs-node","@tensorflow/tfjs-node-gpu"].indexOf(e))throw new Error("Module not supported on client: "+e);r="/node_modules/"+r,(t.ascdevelop||t.ascdebug)&&"bundled"!=(null===(n=t.req)||void 0===n?void 0:n.jsmodulemode)&&(r+=".development"),r+=".js"}else".js"!=r.substr(-3)&&(r+=".js");return r},i);function i(e){var n=this;this.url=e,this.node_module="",this.exports=void 0,this.require=null,this.loaded=!1,this.sourceFunc=null,this.source=null,this.error=null,t._modules[e]=this;var r=e.indexOf("/node_modules/");0<=r&&(this.node_module=e.substring(r+14,Math.min(e.indexOf(".development"),e.length-4))),this.require=function(e){if("tslib"==e)return f;var r=i.resolveUrl(e,n);return t.require(r)}}t.require=function(i,n){void 0===n&&(n=!1);var r=(i=function(e){if("."!=e[0])return e;var i=e.lastIndexOf("..");return i<0&&t.dieError("2599963543"),e.substr(i+2)}(i)).indexOf("#");if(0<=r){var o=i.substr(r+1),s=t.require(i.substr(0,r),n);return"function"==typeof s.then?s.then(function(t){return t[o]}):s[o]}i=e.resolveUrl(i,null);var a=e.get(i);if(!n){if(a.sourceFunc||a.error)return a.required(),a.exports;console.log("Module: "+i+" is not loaded - returning Promise")}return c(a).then(function(){return a.required(),a.exports})},t._modules={},t.requireAsync=function(e){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(i){return[2,t.require(e,!0)]})})};var n=[],r=new Map,o=0,s=null,a=null;function l(t){var e,i=null===(e=window.ascSrcVer)||void 0===e?void 0:e[t.toLocaleLowerCase()];return i&&(t+="?"+i),t}function c(i){if(i.sourceFunc||i.error)return Promise.resolve();if(n.includes(i))return s;n.push(i),s=s||new Promise(function(e){a=function(){r.size<n.length||0<o||(r.forEach(function(e,i){var n=e[0],r=e[1];i.sourceFunc||(r?i.error=r:(i.source=n,i.sourceFunc=t.module2sourceFunc(i)))}),a=s=null,n.length=0,r.clear(),o=0,e())}});var d=[];for(var h in u)d.push(u[h]);return Promise.all(d).then(function(){if(i.sourceFunc)return r.set(i,[null,null]),void a();var n=new XMLHttpRequest,s=t.module2getUrl(i);if(n.open("GET",s),Date.now()/1e3<1676451474&&!s.includes("?")){var u=null===performance||void 0===performance?void 0:performance.navigation;u&&u.type==u.TYPE_RELOAD&&(console.log("RELOAD: "+s),n.setRequestHeader("Cache-Control","no-cache"))}n.onload=function(){var t=n.responseText,s=[],u=!0;if(i.node_module){var d={"react-dom":["react"],"@tensorflow/tfjs":[]}[i.node_module];d&&(s=__spreadArrays(d),u=!1)}if(u){for(var h=/(return|=>|)\s{0,3}\brequire\(['"]([^'"]+)['"]\)/g,p=void 0;null!==(p=h.exec(t));)"return"!=p[1]&&"=>"!=p[1]&&"tslib"!=p[2]&&s.push(p[2]);for(h=/importLegacyJsLib\(['"]([^'"]+)['"]\)/g;null!==(p=h.exec(t));){o++;var f=p[1].replace("{lang}","undefined"!=typeof EdubarUtils?EdubarUtils.getLang():"en");barJsLibraryLoad(l(f),function(){o--,a()})}for(h=/importCss\(['"]([^'"]+)['"]\)/g;null!==(p=h.exec(t));)barCssLoad(l(p[1]))}for(var v=0,g=s;v<g.length;v++){var m=g[v];c(e.get(e.resolveUrl(m,i)))}r.set(i,[t,null]),a()},n.onerror=function(){r.set(i,[null,new Error("Error loading module: "+i.url)]),a()},n.send()}),s}t.module2sourceFunc=function(t){return new Function("exports","require","module",t.source+"\n//@ sourceURL="+t.url)},t.module2getUrl=function(t){return l(t.url)},t.fetchModuleSource=c;var u={main:Promise.resolve()},d={main:function(){}};t.installBundle=function(i,n,r){return __awaiter(this,void 0,void 0,function(){var o,s,a;return __generator(this,function(l){switch(l.label){case 0:return 0<n.length?[4,Promise.all(n.map(function(e){return t.loadBundle(e)}))]:[3,2];case 1:l.sent(),l.label=2;case 2:for(o in r)s=r[o],null===(a=e.get(o)).sourceFunc&&(a.sourceFunc=s,a.source=s.toString());return d[i](),[2]}})})},t.loadBundle=function(e){var i,n=null===(i=t.req)||void 0===i?void 0:i.jsmodulemode;if(!n||"bundled"==n){if(!u[e]){var r=!t.ascdebug;u[e]=new Promise(function(t){return d[e]=t}),p("/static/js/bundle_"+e+(r?".min.js":".js")+"?v="+t.bundle_v)}return u[e]}};var h={};function p(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return h[t]||(h[t]=new Promise(function(e){barJsLibraryLoad(t,e)})),[2,h[t]]})})}t.loadJsLib=p,t.blockUI=function(e,i){return void 0===i&&(i={}),__awaiter(this,void 0,void 0,function(){var n,r,o;return __generator(this,function(s){switch(s.label){case 0:n=$j("<div class='loadingDiv loading-background' style='display:block;z-index:1000'/>").appendTo(document.body),i.simle&&n.toggleClass("simple"),r=null,s.label=1;case 1:return s.trys.push([1,3,4,5]),"function"==typeof e&&(e=e()),[4,e];case 2:return r=s.sent(),[3,5];case 3:throw o=s.sent(),t.showError(o),o;case 4:return n.remove(),[7];case 5:return[2,r]}})})},t.isBlockedUI=function(){return 0<document.getElementsByClassName("loadingDiv").length};var f,v,g,m=null,b=0;function y(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,r,o=i.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)s.push(n.value)}catch(t){r={error:t}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}t.showError=function(e){if(!(e==m&&b+2e3>Date.now())){m=e,b=Date.now(),console.error(e);var i="";e instanceof Error&&(i=e.message+"\n\n("+e.name+")",e.errNumber&&e.msg&&(i=e.msg+"\n\n(Error"+e.errNumber+")")),i=(i=i||""+e)||"Unknown error",t.ASC_messageBox(i)}},v=f=f||{},g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},v.__extends=function(t,e){function i(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},v.__assign=function(){return v.__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t},v.__assign.apply(this,arguments)},v.__rest=function(t,e){var i={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(i[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(t);r<n.length;r++)e.indexOf(n[r])<0&&(i[n[r]]=t[n[r]])}return i},v.__awaiter=function(t,e,i,n){return new(i=i||Promise)(function(r,o){function s(t){try{l(n.next(t))}catch(t){o(t)}}function a(t){try{l(n.throw(t))}catch(t){o(t)}}function l(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(s,a)}l((n=n.apply(t,e||[])).next())})},v.__generator=function(t,e){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=0<(r=s.trys).length&&r[r.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},v.__values=function(t){var e="function"==typeof Symbol&&t[Symbol.iterator],i=0;return e?e.call(t):{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}}},v.__read=y,v.__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(y(arguments[e]));return t},v.__spreadArrays=function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;var n=Array(t),r=0;for(e=0;e<i;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)n[r]=o[s];return n},v.__spreadArray=function(t,e,i){if(i||2===arguments.length)for(var n,r=0,o=e.length;r<o;r++)!n&&r in e||((n=n||Array.prototype.slice.call(e,0,r))[r]=e[r]);return t.concat(n||Array.prototype.slice.call(e))},v.__await=function t(e){return this instanceof t?(this.v=e,this):new t(e)},v.__importDefault=function(t){return t&&t.__esModule?t:{default:t}}}(ASC=ASC||{}),window.require=function(t){return ASC.require(t)};var __extends=this&&this.__extends||function(){var t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(e,i)};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};!function(t){var e;!function(i){function n(t,e,i,n){void 0===e&&(e=75),void 0===i&&(i="\n"),void 0===n&&(n=0);var r,o,s,a,l,c=e,u=i,d=n;if(t+="",c<1)return t;for(r=-1,s=(l=t.split(/\r\n|\n|\r/)).length;++r<s;l[r]+=a)for(a=l[r],l[r]="";a.length>c;l[r]+=a.slice(0,o)+((a=a.slice(o)).length?u:""))o=2==d||(o=a.slice(0,c+1).match(/\S*(\s)?$/))[1]?c:o.input.length-o[0].length||1==d&&c||o.input.length+(o=a.slice(c).match(/^\S*/))[0].length;return l.join("\n")}function r(e,i,n){void 0===n&&(n=!1);var r="";return i.icon&&(r="<img src='"+staticUrl(i.icon)+"' height='16px'/> "),r+=n?e:t.escapeHTML(e),i.iconRight&&(r+=" <img src='"+staticUrl(i.iconRight)+"' height='16px'/> "),r}i.getFocusedDialog=function(){var t=$j("div.ui-dialog,div.yui-dialog");return 0!=t.length?t.last().get(0):null},i.autocomplete_data2items=function(e){for(var i=[],n=0;n<e.length;n++){var r=t.clone(e[n]),o=""+r.name;r.code&&(o+=" "+r.code),r.code2&&(o+=" "+r.code2),r.label=o,i.push(r)}return i},i.autocomplete_renderItem=function(t,e){var i=$j("<li class='ui-menu-item' role='presentation'>"),n=$j("<a class='ui-corner-all' tabindex='-1'>").appendTo(i);if(n.text(e.name),e.subname&&$j("<span style='font-size:85%; color:#888; margin-left:5px'>").text(e.subname).appendTo(n),e.code||e.code2){var r=$j("<span style='display: block; font-size:85%; color:#888'>").appendTo(n);e.code&&r.text(e.code),e.code2&&$j("<span style='float:right'>").prependTo(r).text(e.code2)}return i.appendTo(t),i},i.addAutoComplete=function(e,i,n){void 0===n&&(n={}),$j.widget("ui.autocomplete",$j.ui.autocomplete,{_renderItem:function(t,e){return $j("<li>").append("<a>"+e.label+"</a>").appendTo(t)}});var r=[];if("object"==t.type(i))for(var o in i)r.push({value:i[o],label:o});return $j(e).autocomplete($j.extend({minLength:0,autoFocus:!0,source:r.length?r:i},n))},i.autocapitalize=function(e){["sk","cz","de","at"].indexOf(t.school_country)<0||$j(e).on("DOMAttrModified textInput input keypress paste focus",function(){var t=$j(this).val();if(1==t.length&&1==this.selectionStart){var e=t.charCodeAt(0);if(!(55296<=e&&e<=56319)){var i=t.slice(0,1).toUpperCase()+t.slice(1);i!=t&&$j(this).val(i)}}})},i.getTextWithIcon=r;var o=(s.prototype.setButtons=function(e){var i=this;void 0===e&&(e=[]);for(var n=this.$ft.find(".ui-dialog-buttonset").detach().html(""),r=0,o=e;r<o.length;r++){var s=o[r];t.isArray(s)&&0==s.length?n.append("<span style='display:inline-block; width:15px'>"):(t.isString(s)&&(s={text:s,onclick:function(){i.hide()},type:"ok"==s.toLowerCase()?"default":""}),$j.extend(s,{container:n,label:s.text}),s.onclick&&("function"==typeof s.onclick?s.onclick={fn:s.onclick,scope:this}:s.onclick.scope=this),new a(s))}n.appendTo(this.$ft)},s.prototype.setBody=function(t){this.$bd.html(""),this.$bd.append(t)},s.prototype.appendToFooter=function(t){this.$ft.append(t)},s.prototype.center=function(){this.$div.dialog("option","position",{my:"center",at:"center",of:window});var t=this.$div.dialog("option","maxWidth");this.$div.dialog("option","width")>t&&this.$div.dialog("option","width",t),this.$div.dialog("widget").draggable("option","containment","none"),$j(window).resize()},s.prototype.setHeader=function(t){this.$div.dialog("option","title",t)},s.prototype.show=function(){this.$div.dialog("open")},s.prototype.isVisible=function(){return this.$div.is(":visible")},s.prototype.hide=function(){this.$div.is(":visible")&&this.$div.dialog("close")},s.prototype.setMaximizeBtn=function(e,i){function n(){"function"==t.type(e)?e():s.makeFitHeight(e),o=!0}var r=this,o=!1,a=this.setHeaderBtn("maximize","ui-icon-arrowthick-2-ne-sw",function(){o||n(),r.toggleMaximize()});$j(function(){"function"!=t.type(e)&&($j(e).is("textarea")||i)&&$j(e).get(0).scrollHeight>$j(e).outerHeight()&&($j(e).height($j(e).get(0).scrollHeight),r.center()),window.setTimeout(function(){r.$div.outerWidth()>document.body.clientWidth?(console.log("out of view - maximizing"),a.click()):(r.$div.outerHeight()>document.body.clientHeight||r.$div.data("origSize"))&&n()},50)})},s.prototype.setMaximizeTabElements=function(e,i){this.setMaximizeBtn(function(){for(var n=e.$labels.find(".selected").index(),r=0;r<e.tabs.length;r++)e.selectTab(r);e.selectTab(n);for(var o=0,a=i;o<a.length;o++){var l=a[o];l instanceof t.ui.dt.DataTable&&(l=l.$container),$j(l).addClass("fitHeight"),s.makeFitHeight(l)}})},s.prototype.toggleMaximize=function(){var t={width:0,height:0},e=this.$div.data("origSize")||{};if(!e.width){var i=$j(window);t.width=this.$div.dialog("option","width"),t.height=this.$div.dialog("option","height"),e.width=i.width()-10,e.height=i.innerHeight()-10}this.$div.dialog("option","width",e.width),this.$div.dialog("option","height",e.height),this.$div.data("origSize",t),this.$div.trigger("dialogresize"),this.$div.trigger("resize"),this.center()},s.prototype.setPinBtn=function(t){var e=this,i=this.setHeaderBtn("toggle pin","ui-icon-pin-w",function(){if(i.find(".ui-icon-pin-w").length){var n=$j(".ui-icon-pin-s");e.$div.dialog("option","position",{my:t,at:t,of:window,within:n.length?n.last():window,collision:"fit none"})}else e.center();i.find(".ui-icon-pin-w, .ui-icon-pin-s").toggleClass("ui-icon-pin-w ui-icon-pin-s")});if(!this.$div.dialog("option","modal")){var n=function(t){e.$div&&e.$div.parent().length?$j.contains(e.$div.parent().get(0),t.target)||$j(t.target).is(".ui-widget-overlay.ui-front")||!i.find(".ui-icon-pin-w").length||e.hide():$j(document.body).off("click",n)};$j(document.body).click(n)}},s.prototype.setHeaderBtn=function(e,i,n){var r=this.getTitleBar().find("."+i);r.length&&r.parent().remove();var o=this.getTitleBar().find(".ui-dialog-titlebar-close"),s=o.last();return(r=s.clone().insertBefore(s).attr("title",e).css(t.rtl("right","left"),2*o.length+"em")).find(".ui-icon-closethick").removeClass("ui-icon-closethick").addClass(i),r.find(".ui-button-text").text(e),r.click(n).hover(function(){$j(this).toggleClass("ui-state-hover")}),r},s.prototype.getTitleBar=function(){return this.$div.dialog("widget").find(".ui-dialog-titlebar")},s.prototype.setTitleBarIconBtn=function(t,e){return $j("<button class='ui-button ui-button-icon-only'>").append("<span class='ui-button-icon-primary ui-icon "+t+"'>").css({width:"21px",border:"none",margin:"-3px 0 0",background:"transparent"}).appendTo(this.getTitleBar().find(".ui-dialog-title")).hover(function(){$j(this).toggleClass("ui-state-hover")}).click(e)},s.makeFitHeight=function(e){t.ui.dt&&e instanceof t.ui.dt.DataTable&&(e=e.$container);var i=$j(e),n=i.parents(".ui-dialog-content");if(0!=n.length){var r=n.dialog("option","height");for(r&&"auto"!=r||n.dialog("option","height",n.parent().height());0!=i.length&&!i.hasClass("ui-dialog-content");){var o=i.parent(),s=o.children(":visible");"block"==o.css("display")&&1<s.length&&o.css({display:"flex","flex-direction":"column"}),"flex"==o.css("display")&&"column"==o.css("flex-direction")?i.css({flex:"1 1 100px",height:"100px"}):i.css("height","100%"),i=o}}},s.areYouSureDlg=function(e){return new Promise(function(i){var n=new t.ui.Dialog({title:"Edupage"}),r=!1;n.setButtons([{text:t.ls(1573),type:"default",onclick:function(){r=!0,n.hide()}},t.ls(1038)]),n.setBody(t.escapeHTML(e).replace(/\n/g,"<br>")+" - "+t.ls(1054)),n.$div.on("dialogclose",function(){i(r)})})},s);function s(e){var i=this,n=$j.extend({modal:!0,minHeight:50,maxWidth:$j(window).innerWidth()-14,width:"auto",destroyOnClose:!0,close:function(e,i){t.hidePopups()}},e);n.buttons=[{}],this.$div=$j("<div style='overflow:visible'>").dialog(n),(this.$div.get(0).ASC_dlg=this).$div.parent().css("overflow","visible"),n.destroyOnClose&&this.$div.on("dialogclose",function(){i.dlg_jsc&&i.dlg_jsc.ASC_cn(),i.$div.dialog("destroy"),i.$div.detach()}),this.$bd=$j("<div>").appendTo(this.$div),this.$ft=this.$div.siblings(".ui-dialog-buttonpane"),this.body=this.$bd.get(0),this.footer=this.$ft.get(0),this.cfg={queueProperty:function(t,e){switch(t){case"width":i.$div.dialog("option","width",parseInt(e));break;case"buttons":i.setButtons(e);break;case"maximizeEl":i.setMaximizeBtn(e);break;case"maximizeTabElements":i.setMaximizeTabElements(e[0],e.slice(1))}}},this.cfg.queueProperty("buttons",e.buttons),e.pin&&this.setPinBtn(e.pin)}i.Dialog=o;var a=(l.prototype.label=function(e){this.label_html(t.escapeHTML(e))},l.prototype.label_html=function(t){this.$element.html(t)},l.prototype.set=function(t,e){switch(t){case"disabled":this.$element.attr("disabled",e).toggleClass("button-disabled",e)}},l);function l(e){var i=this;this.onclick=null,this.radio_field=null,this.radio_value="";var n=$j('<div class="asc-button-container">').appendTo(e.container);this.$element=$j("<button class='asc-button'>").appendTo(n);var o="button-gray";if("default"==e.type?o="button-green":e.type&&(o="button-"+e.type),e.cssClass&&(o=e.cssClass),e.disabled&&(o+=" button-disabled"),this.$element.addClass(o),e.disabled&&this.$element.attr("disabled","disabled"),e.style&&(this.$element.get(0).style.cssText=e.style),e.onclick&&("function"==typeof e.onclick?this.onclick={fn:e.onclick}:this.onclick=e.onclick),e.menu&&this.$element.addClass("menu"),e.title&&n.attr("title",e.title),this.label_html(r(e.label,e,!0)),this.$element.click(function(n){n.preventDefault(),n.stopPropagation(),e.menu&&($j(document).click(),i.menu=t.showContextMenu(e.menu,n,{cd:i.$element,minWidth:i.$element.outerWidth(!1)})),i.onclick&&i.onclick.fn.call(i.onclick.scope||i,n,i.onclick.obj),i.radio_field&&(i.radio_field.val(i.radio_value),i.radio_field.trigger("change"))}).mousedown(function(t){t.preventDefault(),document.activeElement.blur()}),e.radio_field){this.radio_field=$j(e.radio_field),this.radio_value=t.strVal(e.radio_value);var s=function(){i.$element.toggleClass("selected",i.radio_field.val()==i.radio_value)};this.radio_field.change(s),s()}}i.Button=a;var c=(u.prototype.check=function(t){return void 0===t&&(t=!this.$input.prop("checked")),this.$input.prop("checked",t),this.button.$element.toggleClass("button-blue",t).toggleClass("button-gray",!t),t},u);function u(t,e,i){var n=this;this.$input=$j('<input type="checkbox">').appendTo(t).hide(),this.button=new a({container:t,label:e,onclick:function(t){var e=n.check();i.onclick&&(i.onclick.fn?i.onclick.fn(t,e,i.onclick.obj):i.onclick(t,e))}}),i.checked&&this.check()}i.CheckboxButton=c;var d=(h.prototype.setValue=function(t){var e,i;e=t&&"0"!=t?(i=!this.options.inverted,"1"):(i=this.options.inverted,"0"),this.input.checked=i,this.input.value=e},h.prototype.updateValue=function(){this.input.value=!this.input.checked==!this.options.inverted?"0":"1"},h);function h(e,i,n,r){var o=this;void 0===r&&(r={}),this.options=r;var s=this.$input=$j("<input type='checkbox'>").appendTo(e),a=this.input=s.get(0);(a.ASC_cb=this).options=$j.extend({inverted:!1,readonly:!1},r),this.options.readonly&&s.attr("disabled",1),this.setValue(i);var l,c=a.checked;s.click(function(){o.options.readonly?a.checked=c:(o.updateValue(),s.trigger("ASC_ce"))}),a.ASC_ce=new t.ASC_ce(s),this.ASC_ce=a.ASC_ce,r.slider&&(l=$j('<label class="checkbox-slider"><span class="checkbox-slider-body"><span class="checkbox-slider-switch"/><span class="checkbox-slider-track"><span class="checkbox-slider-bgd"/><span class="checkbox-slider-bgd checkbox-slider-bgd-negative"/></span></span></label>').appendTo(e).prepend(s).toggleClass("slider-small",!!r.small),"green"==r.cssClass&&l.find(".checkbox-slider-bgd").first().addClass("green")),r.cssClass&&s.addClass(r.cssClass);var u=null;n&&(t.isString(n)?(u=$j("<span>").text(n).appendTo(l||e).css("cursor","pointer").click(function(t){s.click(),t.preventDefault()}),this.options.style&&(u[0].style.cssText+=";"+this.options.style),this.options.html&&(console.log(this.options),u.prepend(this.options.html))):u=$j(n).css("cursor","pointer").click(function(t){s.click(),t.preventDefault()})),r.title&&u&&u.attr("title",r.title),r.fn&&this.ASC_ce.subscribe(function(){r.fn(o.input.value)})}i.Checkbox=d;var p=(f.prototype.val=function(){return this.$div.slider("value")/this.mul},f.prototype.updateInput=function(){this.input.value=""+this.val()},f.prototype.updateLbl=function(){this.value_format&&this.$lbl.text(this.value_format(this.val()))},f);function f(e,i,n,r,o){var s=this;this.options=o,this.mul=1,this.value_format=null,this.input=$j("<input style='display:none'>").appendTo(e)[0],o.mul&&(this.mul=o.mul);var a={min:i*this.mul,max:n*this.mul,value:r*this.mul},l=200;o.width&&(l=1*o.width),this.$div=$j("<div style='display:inline-block;width:"+l+"px;vertical-align:middle'>").appendTo(e).slider(a),o.style&&(this.$div[0].style.cssText+=";"+o.style),o.value_format&&(this.value_format=o.value_format,this.$lbl=$j("<span style='display:inline-block;margin-left:10px;color:#808080'>").appendTo(e)),this.ASC_ce=this.input.ASC_ce=new t.ASC_ce(this.$div),this.input.value=""+r,this.updateLbl(),this.$div.on("slidechange",function(){s.updateInput(),s.updateLbl(),s.ASC_ce.fire()}),this.$div.on("slide",function(){s.updateLbl()})}i.Slider=p;var v=(g.prototype.addRibbon=function(t,e){var i=this;this.keys.push(t),this.$labels[t]=$j("<span class='label'>").appendTo(this.$top).text(e).click(function(){i.select(t)});var n=new m(this.$bottom);return n.$container.parent().hide(),this.ribbons[t]=n,""==this.active&&this.select(t),n},g.prototype.select=function(t){var e=this.active;t!=e&&(this.$labels[e]&&this.$labels[e].removeClass("selected"),this.ribbons[e]&&this.ribbons[e].$container.parent().hide(),this.$labels[t].addClass("selected"),this.ribbons[t].$container.parent().show(),this.ribbons[t].options.autoResize&&$j(window).resize(),this.active=t)},g.prototype.findButton=function(t){for(var e=null,i=0;i<this.keys.length&&!(e=this.ribbons[this.keys[i]].findButton(t));i++);return e},g.prototype.findCombo=function(t){for(var e=null,i=0;i<this.keys.length&&!(e=this.ribbons[this.keys[i]].findCombo(t));i++);return e},g.prototype.findButtonsByCmd=function(t){for(var e=[],i=0,n=this.keys;i<n.length;i++)for(var r=n[i],o=0,s=this.ribbons[r].buttons;o<s.length;o++){var a=s[o];a.cmd==t&&e.push(a)}return e},g);function g(t){this.keys=[],this.$labels={},this.ribbons={},this.active="",this.$div=$j("<div class='asc-ribbon-menu'/>").appendTo(t),this.$top=$j("<div class='top'>").appendTo(this.$div),this.$right=$j("<div class='right'>").appendTo(this.$top),this.$bottom=$j("<div class='bottom'>").appendTo(this.$div),this.$div.get(0).ASC_rm=this}i.RibbonMenu=v;var m=(b.prototype.findButton=function(t){for(var e=null,i=0;i<this.buttons.length;i++)if((e=this.buttons[i]).id==t)return e;return null},b.prototype.findCombo=function(t){for(var e=0;e<this.combos.length;e++){var i=this.combos[e];if(i.id==t)return i}return null},b.prototype.resize=function(){if(this.$container.is(":visible")&&"row"==this.$container.css("flex-direction")){this.$container.removeClass("fullScreen");var t=this.$container.find(".asc-ribbon-group:not(.toggler):not(:has(.asc-ribbon-div))").get(),e=this.countAvailableWidth();if(e<0){t.sort(function(t,e){return parseInt($j(t).data("level"))<parseInt($j(e).data("level"))?-1:1});for(var i=0,n=t;i<n.length;i++){var r=n[i];if(!(e<0))break;this.minimizeGroup($j(r)),e=this.countAvailableWidth()}if(e<0&&(this.toggleMiniText(t,e,!1),e=this.countAvailableWidth()),e<0)for(var o=0,s=t;o<s.length&&(r=s[o],e<0);o++)this.minimizeGroup($j(r),{single:!0}),e=this.countAvailableWidth();e<0&&(this.toggleMiniText(t,e,!1),e=this.countAvailableWidth()),e<0&&(e=this.toggleTitles(!1,e))}else if(20<e&&20<(e=this.toggleTitles(!0,e))){t.sort(function(t,e){return parseInt($j(t).data("level"))>parseInt($j(e).data("level"))?-1:1}),this.toggleMiniText(t,e,!0);for(var a=0,l=t;a<l.length&&(r=l[a],20<(e=this.countAvailableWidth()));a++)this.maximizeGroup($j(r))}}},b.prototype.countAvailableWidth=function(){var t=this.$container.width();return this.$container.find(".asc-ribbon-group:not(.toggler)").each(function(e,i){t-=i.clientWidth}),t},b.prototype.toggleMiniText=function(t,e,i){for(var n=0,r=t;n<r.length;n++){var o=r[n],s=$j(o).find(".asc-ribbon-minigroup").get();i||s.reverse();for(var a=0,l=s;a<l.length;a++){var c=l[a];if($j(c).toggleClass("no-text",!i),e=this.countAvailableWidth(),i&&e<100||!i&&0<e)break}if(i&&e<100||!i&&0<e)break}},b.prototype.minimizeGroup=function(t,e){void 0===e&&(e={});var i=t.find("> .asc-ribbon-button");if(i.length>(e.single?0:1))for(var n=Math.ceil(i.length/3);0<=n&&!(0<this.countAvailableWidth());n--){var r=t.find(".asc-ribbon-minigroup.temp"),o=$j('<div class="asc-ribbon-minigroup temp">').append(i.eq(3*n+0)).append(i.eq(3*n+1)).append(i.eq(3*n+2));r&&r.length?o.insertBefore(r.first()):o.appendTo(t)}},b.prototype.maximizeGroup=function(t){var e=t.find("> .asc-ribbon-minigroup.temp");if(e.length)for(var i=0;i<e.length;i++){var n=e.eq(i).find(".asc-ribbon-button"),r=0;if(n.each(function(t,e){r+=$j(e).data("origWidth")}),!(this.countAvailableWidth()>r))break;e.eq(i+1).length?n.insertBefore(e.eq(i+1)):n.appendTo(t),e.eq(i).remove()}},b.prototype.toggleTitles=function(t,e){var i=this.$container.find(".asc-ribbon-group:not(.toggler):has(.asc-ribbon-title:has(img))").get();t||i.reverse();for(var n=0;n<i.length;n++){var r=$j(i[n]).find(".asc-ribbon-title");if(t||r.data("origWidth")||r.data("origWidth",r.outerWidth()),t&&r.hasClass("no-text")&&r.data("origWidth")>e+r.outerWidth())return 0;if(r.toggleClass("no-text",!t),e=this.countAvailableWidth(),!t&&0<e||t&&n<i.length&&e<$j(i[n+1]).find(".asc-ribbon-title").data("outerWidth"))return e}return e},b.prototype.fixWhiteSpace=function(){if(this.$container.width()>this.$container.parent().width())for(var t=0;t<this.buttons.length;t++){var e=this.buttons[t],i=e.$label.text();i=i.replace(" ","\n"),e.$label.text(i)}},b);function b(t,i){var n=this;void 0===i&&(i={}),this.options=i,this.menu=null,this.buttons=[],this.combos=[],"autoResize"in i||(i.autoResize=!0);var r=$j("<div>").appendTo(t).css("position","relative");this.$container=$j("<div class='asc-ribbon'/>").appendTo(r),this.$container.get(0).ASC_r=this,i.autoResize&&$j(window).resize(function(){clearTimeout(n.resizeHandler),n.resizeHandler=setTimeout(function(){n.resize()},100,n)}),this.$div=$j("<div class='left'>").appendTo(this.$container),this.$right=$j("<div class='right'>").appendTo(this.$container);var o=new e.RibbonGroup(this);o.$div.addClass("toggler");var s=new e.RibbonButton(o,"","",function(){n.$container.toggleClass("fullScreen"),$j(window).resize(),s.selected(n.$container.hasClass("fullScreen"))});s.$middle.find("img").remove(),s.$middle.append('<i class="fa fa-bars fa-fw" aria-hidden="true">')}i.Ribbon=m;var y=(C.prototype.addDiv=function(){return $j("<div class='asc-ribbon-div'>").appendTo(this.$div).get(0)},C.prototype.remove=function(){this.$div.children("div").each(function(t,e){var i=e.ASC_ri;i&&i.remove()}),this.$div.remove()},C);function C(t,e){void 0===e&&(e={}),this.ribbon=t,this.lastItem=null,this.$div=$j("<div class='asc-ribbon-group'/>").appendTo(e.right?this.ribbon.$right:this.ribbon.$div),this.$div.get(0).ASC_rg=this,e.level&&this.$div.data("level",e.level)}i.RibbonGroup=y;var _=function(t,e){void 0===e&&(e={}),this.group=t,this.items=[],this.$div=$j("<div class='asc-ribbon-minigroup'>").appendTo(t.$div),t.ribbon.options.autoResize&&this.$div.data("level",e.level||-1)};i.MiniGroup=_,i.AnchorMenu=function(e,i,n,r){var o=this;this.menu=n,this.$a=$j("<a>").appendTo(e).text(i),r.style&&(this.$a.get(0).style.cssText+=";"+r.style),this.$a.click(function(e){t.showContextMenu(o.menu,e,o.$a)})};var $=(S.prototype.remove=function(){this.$div.remove(),this.group.lastItem==this&&(this.group.lastItem=null)},S);function S(t,e){this.group=t,this.mini=null,this.$div=$j("<div>"),this.$div.get(0).ASC_ri=this,e?(t.lastItem&&t.lastItem.mini&&t.lastItem.mini.items.length<3?this.mini=t.lastItem.mini:(this.mini=new _(t),this.mini.items.push(this)),this.$div.appendTo(this.mini.$div)):this.$div.appendTo(t.$div),t.lastItem=this}var w,x=(__extends(A,w=$),A.prototype.enabled=function(t){return void 0!==t&&this.$div.toggleClass("disabled",!t),!this.$div.hasClass("disabled")},A.prototype.selected=function(t){return void 0!==t&&this.$div.toggleClass("selected",!!t),this.$div.hasClass("selected")},A.prototype.icon=function(t){this.$img.attr("src",staticUrl(t))},A.prototype.label=function(t){for(var e,i,r=15;;){i=n(t,r);for(var o=e=0;o<i.length;o++)"\n"==i.charAt(o)&&e++;if(e<=2)break;if(100<=r)break;r++}this.$label.empty(),1<e?this.$label.text(i).css("display","inline-block"):0==e&&12<=t.length?this.$label.text(t):this.$label.text(i),this.$label.toggleClass("mini",1<e||0==e&&12<=t.length)},A.prototype.remove=function(){w.prototype.remove.call(this);var t=this.group.ribbon;t.buttons.splice(t.buttons.indexOf(this),1)},A);function A(e,i,n,r,o){void 0===o&&(o={});var s=w.call(this,e,o.mini)||this;return s.onclick=r,s.id="",s.cmd="",s.nowrap=!1,s.menu=null,e.ribbon.buttons.push(s),s.$div.addClass("asc-ribbon-button"),s.$middle=$j("<div class='middle'/>").appendTo(s.$div),s.$img=$j("<img>").attr("src",n&&staticUrl(n)).appendTo(s.$middle),s.$label=$j("<span>").appendTo(s.$middle),s.$div.mousedown(function(t){t.preventDefault()}),s.$div.click(function(i){s.enabled()&&(0==s.$div.parents(".toggler").length&&e.ribbon.$container.removeClass("fullScreen"),s.menu?(s.$div.addClass("tmp-selected"),t.showContextMenu(s.menu,i,s.$div)):s.enabled()&&s.onclick&&s.onclick())}),o.id&&(s.id=o.id),o.cmd&&(s.cmd=o.cmd),o.nowrap&&(s.nowrap=!0),o.selected&&s.$div.addClass("selected"),o.menu&&(s.$div.addClass("menu"),s.menu=o.menu),!1!==o.enabled&&(o.menu||s.onclick)&&!o.disabled||s.$div.addClass("disabled"),s.label(i),o.tooltip&&s.$div.attr("title",o.tooltip),e.ribbon.options.autoResize&&(s.$div.data("origWidth",s.$div.outerWidth()),$j(function(){$j(window).resize()})),o.notification&&$j("<div class='notification'>").text(o.notification).appendTo(s.$middle),s}i.RibbonButton=x;var k,j=(__extends(T,k=$),T.prototype.setItems=function(t){this.combo.setItems(t)},T.prototype.setValue=function(t,e){void 0===e&&(e=!1),this.combo.ASC_set(t,e)},T.prototype.setVisible=function(t){this.$div.toggle(!!t)},T.prototype.remove=function(){k.prototype.remove.call(this);var t=this.group.ribbon;t.combos.splice(t.combos.indexOf(this),1)},T);function T(t,e,i){void 0===i&&(i={});var n=k.call(this,t,!0)||this;n.id="";var r={fn:function(i){t.ribbon.$container.removeClass("fullScreen"),e(i)}};return i.multi?n.combo=new V(n.$div,[],i.items||[],r):n.combo=new N(n.$div,"",i.items||[],r),n.combo.$div.addClass("asc-ribbon-combo").width(i.width||100).attr("title",i.title),i.id&&(n.id=i.id),t.ribbon.combos.push(n),n}i.RibbonCombo=j;var I=(D.prototype.setSelectedId=function(t){for(var e=0;e<this.groups.length;e++)this.groups[e].setSelectedId(t)},D);function D(t){this.groups=[],this.$div=$j("<div class='asc-accordion'/>").appendTo(t)}i.Accordion=I;var M=(F.prototype.setSelectedId=function(t){var e=this;this.buttons.forEach(function(i){var n=i.id==t;i.selected(n),n&&e.collapsed(!1)})},F.prototype.collapsed=function(t){return void 0!==t&&this.$div.toggleClass("collapsed",!!t),this.$div.hasClass("collapsed")},F.prototype.hideIfEmpty=function(){0==this.buttons.length&&this.$div.hide()},F);function F(t,e,i){var n=this;void 0===i&&(i={}),this.accordion=t,this.buttons=[],t.groups.push(this),this.$div=$j("<div class='asc-accordion-group'/>").appendTo(t.$div),this.$top=$j("<div class='top'/>").appendTo(this.$div),this.$label=$j("<span class='label'/>").appendTo(this.$top),this.$label.text(e),this.$bottom=$j("<div class='bottom'/>").appendTo(this.$div),i.collapsed&&this.collapsed(!0),this.$top.click(function(){n.collapsed(!n.collapsed())})}i.AccordionGroup=M;var E=(L.prototype.selected=function(t){return void 0!==t&&(t?this.$div.addClass("selected"):this.$div.removeClass("selected")),this.$div.hasClass("selected")},L);function L(t,e,i,n,r){void 0===r&&(r={}),this.group=t,this.id="",t.buttons.push(this),this.$div=$j("<div class='asc-accordion-button'/>").appendTo(t.$bottom),(this.$div.get(0).ASC_obj=this).$icon=$j("<img/>").attr("src",staticUrl(i)).appendTo(this.$div),this.$label=$j("<span/>").text(e).appendTo(this.$div),r.id&&(this.id=r.id),n&&!r.disabled&&this.$div.click(n),r.disabled&&this.$div.addClass("disabled")}i.AccordionButton=E;var P=(O.prototype.select=function(t){if("string"==typeof t&&(t=this.findItem(t)),this.selected!=t){var e=!0;this.selected&&(this.selected.$row.removeClass("selected"),e=!1),this.selected=t,this.selected&&(this.selected.$row.addClass("selected"),e&&this.$div.parent().scrollTop(this.selected.$row.position().top-this.$div.parent().height()/2)),this.$div.trigger("select",this.selected)}},O.prototype.on=function(t,e){this.$div.on(t,e)},O.prototype.findItem=function(t){for(var e=0,i=this.rootItems;e<i.length;e++){var n=i[e].findItem(t);if(n)return n}return null},O.prototype.removeAll=function(){this.rootItems.splice(0,this.rootItems.length),this.$div.html("")},O);function O(t,e){var i=this;void 0===e&&(e={}),this.rootItems=[],this.flat=!1,this.selected=null,this.$div=$j("<div class='tree-view'>").appendTo(t),e.flat&&(this.flat=!0,this.$div.addClass("flat")),this.$div.on("select",function(t,e){i.$div.trigger("select_id",e.id)})}i.TreeView=P;var H=(q.prototype.updatePlus=function(){this.$plus.attr("src",staticUrl("/static/pics/"+(this.expanded?"tree_minus.png":"tree_plus.png"))),this.expanded?this.$sub.show():this.$sub.hide()},q.prototype.setExpanded=function(e){this.expanded=t.boolVal(e),this.updatePlus(),this.expanded&&this.firstexpand&&(this.firstexpand=!1,this.tree.$div.trigger("firstexpand_id",this.id),this.tree.$div.trigger("firstexpand",this))},q.prototype.findItem=function(t){if(t==this.id)return this;for(var e=0,i=this.children;e<i.length;e++){var n=i[e].findItem(t);if(n)return n}return null},q);function q(e,i,n,r){var o=this;if(void 0===r&&(r={}),this.parent=null,this.children=[],this.leaf=!1,this.expanded=!1,this.firstexpand=!0,this.id="",this.data=null,e instanceof P)this.tree=e,this.tree.rootItems.push(this);else{if(!(e instanceof q))throw"Error4474294123";this.parent=e,this.tree=this.parent.tree,e.children.push(this)}this.leaf=t.boolVal(r.leaf),r.expanded&&!this.leaf&&(this.expanded=!0),this.$div=$j("<div>").appendTo(this.parent?this.parent.$sub:this.tree.$div),this.$row=$j("<div class='item'>").appendTo(this.$div),this.$plus=$j("<img class='plus'>").appendTo(this.$row),n&&(this.$icon=$j("<img class='icon'>").appendTo(this.$row).attr("src",staticUrl(n))),this.$label=$j("<span class='label'>").appendTo(this.$row).text(i),r.style&&(this.$label[0].style.cssText+=";"+r.style),this.$sub=$j("<div class='sub'>").appendTo(this.$div),this.updatePlus(),this.$row.click(function(){o.tree.select(o)}),this.leaf?this.$plus.css("visibility","hidden"):(this.$row.dblclick(function(){o.setExpanded(!0)}),this.$plus.click(function(t){o.setExpanded(!o.expanded),t.stopImmediatePropagation()})),r.id&&(this.id=r.id),"data"in r&&(this.data=r.data)}i.TreeViewItem=H;var z=(B.prototype.addTab=function(t){var e=this;t.index=this.tabs.length,this.tabs.push(t),t.$label.appendTo(this.$labels).click(function(){e.selectTab(t.index)}),this.lazyLoad||t.$container.appendTo(this.$content).trigger("load")},B.prototype.selectTab=function(t){var e=this;if(this.tabs.length&&(0<this.counter||600<window.innerWidth)){var i=this.tabs[t];this.$labels.find(">div.selected").removeClass("selected"),i.$label.addClass("selected");var n=this.$content.find(">div.active").removeClass("active");this.lazyLoad&&0==i.$container.parents(".asc-tab-view").length&&i.$container.appendTo(this.$content).trigger("load"),this.$content.addClass("active"),i.$container.addClass("active").trigger("visible"),$j(document.body).addClass("some-content-active"),!this.options.skipFixDimensions&&600<window.innerWidth&&600<window.innerHeight&&window.setTimeout(function(){0==i.$container.find(".fitHeight").length&&e.fixDimensions(i,0==n.length)},100)}this.counter++},B.prototype.selectTabByElement=function(e){for(var i=t.isArray(e)?e:[e],n=0,r=this.tabs;n<r.length;n++){for(var o=r[n],s=!1,a=0,l=i;a<l.length;a++){var c=l[a];$j.contains(o.$container[0],c)&&(s=!0)}if(s)return this.selectTab(o.index),!0}return!1},B.prototype.fixDimensions=function(t,e){this.maxHeight=Math.max(t.$container.outerHeight(),this.maxHeight),this.maxWidth=Math.max(t.$container.outerWidth(),this.maxWidth);var i=this.$div.parents(".ui-dialog"),n=i.get(0)&&"auto"==i.get(0).style.width,r=i.innerWidth();if(10<this.maxHeight){var o=window.innerHeight-this.$div.position().top-1;this.$content.css("min-height",Math.min(o,this.maxHeight)+"px")}e||n&&100<this.maxWidth&&this.maxWidth<r&&this.$content.css("min-width",this.maxWidth+"px"),i.length&&i.outerHeight()+i.position().top>window.innerHeight&&i.find(".ui-dialog-content").get(0).ASC_dlg.center()},B.prototype.set=function(t,e){switch(t){case"orientation":this.$div.toggleClass("orientation-left","left"==e);break;case"lazyLoad":this.lazyLoad=e}},B);function B(e,i){void 0===i&&(i={}),this.options=i,this.maxHeight=0,this.maxWidth=0,this.lazyLoad=!1,this.counter=0,this.$div=$j("<div class='asc-tab-view'>").appendTo(e),this.$labels=$j("<div class='labels'>").appendTo(this.$div),this.$content=$j("<div class='content'>").appendTo(this.$div),$j("<div class='close-btn'>").text(t.ls(1567)).appendTo(this.$div).click(function(){var t=$j(".asc-tab-view .content.active");t.last().removeClass("active"),$j(".asc-tab-view .labels .selected").last().removeClass("selected"),t.length<=1&&$j(document.body).removeClass("some-content-active")}),this.tabs=[]}i.TabView=z,i.Tab=function(t){this.options=t,this.$container=$j("<div>").html(t.content),this.$label=$j("<div>").text(t.label),t.icon&&$j("<img>").attr("src",staticUrl(t.icon)).prependTo(this.$label)};var N=(R.prototype.createElement=function(){var t=$j("<a href='#'>");this.btn=t.get(0),this.$label=$j("<span class='button-title'>").appendTo(t),t.appendTo(this.$div)},R.prototype.setItems=function(t){this.items=this.convertToMenu(R.fixItems(t)),this.$label&&this.$label.length&&this.update()},R.prototype.isOpen=function(){return t.showContextMenuOpened(this.$div)},R.prototype.open=function(e){if(!this.isOpen()){var i=t.showContextMenu(this.items,e,{cd:this.$div,clickToHide:!1,cssClass:"asc-combo"});this.fixMenu(i)}},R.prototype.fixMenu=function(t){t.$menu.find(".asc-context-menu").removeClass("asc-context-menu")},R.prototype.click=function(t){this.ASC_set(t),this.hide()},R.prototype.hide=function(){t.hideContextMenu(),this.$div.find("a").focus()},R.prototype.ASC_set=function(t,e){void 0===e&&(e=!0),this.value=t,this.update(),this.linked_field&&(this.linked_field.value=this.value),e&&this.$div.trigger("ASC_ce",this.value)},R.prototype.update=function(){var e=this,i=[],n={};if(this.walkItems(function(t,r){var o=e.isChecked(t.value);(t[e.checkProperty]=o)&&!n[t.value]&&(n[t.value]=!0,i.push(e.getItemName(t)))}),0<this.maxLabelItems&&i.length>this.maxLabelItems){var r=i.length;(i=i.slice(0,this.maxLabelItems)).push(" ... ("+r+")")}if(!this.fixedLabel){var o=i.join(", ");0!=i.length||t.isArray(this.value)||(o=t.strVal(this.value)),this.$label.html(o+"Â "),this.$label.attr("title",this.$label.text())}},R.fixItems=function(e){if("length"in e)for(var i in e)try{if(!("value"in e[i]))break}catch(i){e=R.convertToCombo(e)}else e=R.convertToCombo(e);return t.clone(e)},R.convertToCombo=function(t){var e=[];for(var i in t)e.push({value:i,name:t[i]});return e},R.prototype.convertToMenu=function(t){var e=this;return _t.convertCombo(t,this.value,function(t,i){e.click(i)})},R.prototype.getTexts=function(t){for(var e=[],i=0,n=this.getLabelItems(t);i<n.length;i++){var r=n[i];e.push(this.getItemName(r))}return e},R.prototype.getLabelItems=function(t){for(var e=[],i=0;i<t.length;i++)e=e.concat(this.findItems(t[i]));return e},R.prototype.getItemName=function(t){return t.text?t.text:t.html?yt.renderContent($j("<li>"),t).html():""},R.prototype.setDefaultItem=function(e){this.walkItems(function(i,n){"value"in i&&""==i.value&&(i.text=t.ls(1858)+(e?" ("+e+")":""))}),this.update()},R.prototype.isChecked=function(e){return t.strEquals(this.value,e)},R.prototype.findItems=function(e,i){void 0===i&&(i="value");var n=[];return this.walkItems(function(r,o){t.strEquals(r[i],e)&&n.push(r)}),n},R.prototype.walkItems=function(e){for(var i=0,n=0,r=0;r<this.items.length;r++)"object"==t.type(this.items[r])?e(this.items[r],i++,n):(n++,i=0)},R.prototype.getValue_label=function(){return this.getTexts([this.value])[0]},R.prototype.setValue_label=function(e){var i=this,n=!1;return this.walkItems(function(r,o){!n&&t.strEquals(i.getItemName(r),e)&&(i.ASC_set(r.value),n=!0)}),n},R);function R(e,i,n,r){var o=this;void 0===r&&(r={}),this.items=[],this.maxLabelItems=0,this.fixedLabel=!1,this.checkProperty="selected",this.$div=$j("<div class='dropDownBtn asc-combo'>"),this.$div.get(0).ASC_combo=this,r.anchor&&(this.$div.addClass("anchor"),r.anchor.length&&$j("<label>").text(r.anchor).appendTo(this.$div)),r.style&&("object"==typeof r.style?this.$div.css(r.style):this.$div.get(0).style.cssText+=r.style),this.value=null===i?"":i,this.setItems(n),this.createElement(),this.$div.click(function(t){t.preventDefault(),t.stopImmediatePropagation(),o.isOpen()?o.hide():o.open(t)}),r.maxWidth&&this.$label.css({maxWidth:r.maxWidth}).addClass("ellipsis"),r.fixedLabel&&(this.$label.html(r.fixedLabel),this.fixedLabel=!0),r.linked_field&&(this.linked_field=r.linked_field,(this.linked_field.ASC_combo=this).linked_field.ASC_uiElement=this.$div,this.linked_field.ASC_set=function(t,e){o.ASC_set(t,e)},this.linked_field.ASC_ce=new t.ASC_ce(this.$div)),r.fn&&this.$div.on("ASC_ce",function(){r.fn(o.value)}),r.disabled&&this.$div.off().click(function(t){t.preventDefault(),t.stopPropagation()}).css("background-color","initial"),this.ASC_set(this.value,!1),this.$div.appendTo(e)}i.ComboBox=N;var W,V=(__extends(U,W=N),U.prototype.fixMenu=function(t){return t&&(W.prototype.fixMenu.call(this,t),t.$menu.find(".dropDownPanel").addClass("checkPanel"),this.options.controls&&t.cfg.setProperty("header",this.getControlsHTML())),this.menu=t},U.prototype.isChecked=function(e){return 0<=t.indexOf2(this.value,e)},U.prototype.click=function(e){var i=this,n=t.indexOf2(this.value,e);if(n<0){var r=this.findItems(e);if(1!=r.length)throw"Error9970882172";if("radiogroup"in r[0]){var o=r[0].radiogroup;this.walkItems(function(e,n){if(e.radiogroup==o){var r=t.indexOf2(i.value,e.value);0<=r&&i.value.splice(r,1)}})}this.value.push(e)}else this.value.splice(n,1);this.ASC_set(this.value),this.menu.items=this.menu.initItems(this.items),this.menu.renderItems(),this.fixMenu(this.menu)},U.prototype.convertToMenu=function(t){for(var e={},i=0,n=t;i<n.length;i++){var r=n[i];r&&"value"in r&&(e[r.value]=!0)}for(var o=!1,s=0;s<this.value.length;s++)this.value[s]in e||(o||(o=!0,t.push([])),t.push({name:this.value[s],value:this.value[s]}));return W.prototype.convertToMenu.call(this,t)},U.prototype.update=function(){this.checkProperty="checked",W.prototype.update.call(this)},U.prototype.getControlsHTML=function(){var e=this,i=$j("<div>");return $j("<img>").appendTo(i).attr({src:staticUrl("/asc/pics/icons/check_16.png"),height:"10px",title:t.ls(4288)}).click(function(){var t=[];e.walkItems(function(e){t.push(e.value)}),e.ASC_set(t)}),$j("<img>").appendTo(i).attr({src:staticUrl("/asc/pics/icons/delete_16.png"),title:t.ls(4289)}).click(function(){e.ASC_set([])}),$j("<img>").appendTo(i).attr({src:staticUrl("/asc/pics/icons/refresh_16.png"),title:t.ls(6626)}).click(function(){var i=[];e.walkItems(function(n){t.indexOf(e.value,n.value)<0&&i.push(n.value)}),e.ASC_set(i)}),i.find("img").css({marginRight:"0.5em",verticalAlign:"middle",height:"16px"}),i},U);function U(e,i,n,r){void 0===r&&(r={});var o=W.call(this,e,i,n,r)||this;if(o.options=r,!t.isArray(o.value)){if(o.value)throw"Error5374882239";o.value=[]}return 0<r.maxLabelItems&&(o.maxLabelItems=r.maxLabelItems),o.ASC_set(o.value,!1),o}i.ComboBoxMulti=V;var Y=(J.prototype.ASC_set=function(t,e){void 0===e&&(e=!0),this.value=t,this.update(),this.linked_field&&(this.linked_field.value=this.value),e&&this.$input.trigger("ASC_ce",this.value)},J.prototype.update=function(){for(var t=this.value,e=!1,i=0;i<this.items.length;i++)this.items[i].value==this.value&&(e=!0,t=this.items[i].label);this.$input.val(t),this.options.addFn&&this.$container.find("a.add").toggle(!e&&""!=t)},J.prototype.fixItems=function(t){return N.fixItems(t).map(function(t){var e=__assign(__assign({},t),{text:t.text||t.name,label:""});return e.label=e.text,e})},J.prototype.getSource=function(e){if(this.options.getItems)var i=this.options.getItems(e);else{var n=new RegExp($j.ui.autocomplete.escapeRegex(e),"i");i=$j.grep(this.items,function(t){return n.test(t.label)})}return 0==i.length&&""!=e&&this.options.addFn&&i.push({text:t.ls(3572),label:t.ls(3572),value:this.value,add:e+""}),i},J.prototype.setNewItem=function(t){this.items.push(t),this.items=this.fixItems(this.items),this.$input.blur(),this.ASC_set(t.value)},J);function J(e,i,n,r){var o=this;function s(t,e){return e.item&&o.$input.val(e.item.text),!1}this.options=r,this.$container=$j("<span>").appendTo(e).addClass("asc-autocomplete"),this.items=this.fixItems(n),$j.widget("ui.autocomplete",$j.ui.autocomplete,{_renderItem:function(t,e){var i=$j("<li>").appendTo(t);return yt.renderContent(i,e),i.find("img").css({paddingRight:".5em",verticalAlign:"middle"}),i}}),$j.widget("ui.menu",$j.ui.menu,{_isDivider:function(t){return"-"!=t.text()&&this._super(t)}});var a=!1;this.$input=$j("<input>").appendTo(this.$container).autocomplete({minLength:0,source:function(t,e){e(o.getSource(t.term))},select:function(t,e){return e.item&&e.item.add&&r.addFn?(r.addFn(t,e.item.add+"",o),o.ASC_set(o.value,!1)):o.ASC_set(e.item?e.item.value:o.value,!1),!1},focus:function(t,e){return s(0,e),o.$input.select(),!1},close:s,change:function(t,e){return e.item||o.items&&o.items.find(function(t){return""==t.value})&&(o.value=""),o.ASC_set(e.item?e.item.value:o.value),!1}}).css("padding-right","1em").focus(function(){""==o.value&&o.$input.val("")}).blur(function(){""==o.value&&""==o.$input.val()&&o.update()});var l=this.$input.height();$j("<a>").appendTo(this.$container).attr("tabIndex",-1).attr("title",t.ls(3196)).addClass("show-all").css({left:this.$input.width(),width:l,height:l}).mousedown(function(){a=o.$input.autocomplete("widget").is(":visible")}).click(function(){o.$input.focus(),a||o.$input.autocomplete("search","")}),r.style&&(this.$input.get(0).style.cssText+=";"+r.style),r.cssClass&&this.$input.addClass(r.cssClass),r.linked_field&&(this.linked_field=r.linked_field,(this.linked_field.ASC_combo=this).linked_field.ASC_uiElement=this.$input,this.linked_field.ASC_set=function(t,e){o.ASC_set(t,e)},this.linked_field.ASC_ce=new t.ASC_ce(this.$input)),this.ASC_set(i,!1)}i.ComboBoxAutoComplete=Y;var G=(X.prototype.setValue=function(e){(this.value=e)?this.$field.datepicker("setDate",t.date_sql2js(e)):this.$field.val(this.nodate),this.linked_field&&(this.linked_field.value=e,this.$field.change()),this.$field.removeClass("asc-badfieldvalue")},X);function X(e,i,n){var r=this;if(void 0===n&&(n={}),this.value="",this.$field=$j("<input type='text' class='asc-textfield asc-datefield'>").appendTo(e),this.nodate=n.nodate||"",n.style&&(this.$field.get(0).style.cssText=n.style),n.nodate&&(n.showButtonPanel=!0,n.closeText=n.nodate,n.onClose=function(t,e){e.dpDiv.find("button.ui-datepicker-close").hasClass("ui-state-hover")&&(r.setValue(""),r.$field.trigger("change"))}),"week"==n.calendarmode&&(n.beforeShow=function(t,e){return setTimeout(function(){e.dpDiv.find("a.ui-state-active").parents("tr").addClass("selected-range-day")},100),n}),n.navigator&&(n.changeMonth=!0,n.changeYear=!0),n.highlightdates2)throw"Error6802836505 - TODO highlight dates";this.dp=new Z(this.$field,n),this.$field.change(function(){var e=r.$field.val(),i=!0;if(""==e)r.value="";else try{$j.datepicker.parseDate(r.$field.datepicker("option","dateFormat"),e)?r.value=t.date_js2sql(r.$field.datepicker("getDate")):i=!1}catch(e){i=!1}r.linked_field&&$j(r.linked_field).val(r.value),t.setClass(r.$field.get(0),"asc-badfieldvalue",!i)}),n.linked_field&&(this.linked_field=n.linked_field,this.linked_field.ASC_uiElement=this.$field,this.linked_field.ASC_set=function(t){r.setValue(t)},this.linked_field.ASC_cal=this.dp,this.linked_field.ASC_ce={subscribe:function(t){r.$field.change(function(e){t(e,r.value)})}}),this.setValue(i),n.highlightdates&&this.dp.fillRenderers(n.highlightdates)}i.DateField=G;var Z=(K.getDateFormat=function(){return t.req_props.dtFormats.date},K.getDayNamesShort=function(){return K.dayShort.map(function(e){return t.ls(e)})},K.getSettings=function(){var e=[];for(var i in K.monthNames)e.push(t.ls(K.monthNames[i]));return{dateFormat:K.getDateFormat(),dayNames:K.dayNames,dayNamesMin:K.getDayNamesShort(),monthNames:e,firstDay:t.timezone_firstDayOfWeek()%7,currentText:t.ls(6136),weekHeader:"KW",beforeShow:function(t,e){setTimeout(function(){e.dpDiv.css("z-index",99999999999999)},0)}}},K.prototype.subscribe=function(t){var e=this;this.$container.datepicker("option","onSelect",function(i,n){t(e.getSqlDate(),n)})},K.prototype.setRenderer=function(t){this.$container.datepicker("option","beforeShowDay",t)},K.prototype.getSqlDate=function(t){return $j.datepicker.formatDate("yy-mm-dd",t||this.$container.datepicker("getDate"))},K.prototype.fillRenderers=function(e){if(e){var i=Array.isArray(e)?e:[e];this.setRenderer(function(e){for(var n=[!0,"",""],r=t.date_js2sql(e),o=0,s=i;o<s.length;o++){var a=s[o];a.dates&&0<=a.dates.indexOf(r)&&(n=[a.selectable||!0,a.class,a.tooltip||""])}return n})}},K.dayShort=[9583,9577,9578,9579,9580,9581,9582],K.dayNames=[1709,1703,1704,1705,1706,1707,1708],K.monthNames=[1711,1712,1713,1714,1715,1716,1717,1718,1719,1720,1721,1722],K);function K(t,e){e=$j.extend({},K.getSettings(),e),this.$container=$j(t).datepicker(e)}i.DatePicker=Z;var Q=(tt.prototype.initField=function(e){var i=this;if(this.inputs.push($j("<input type='hidden'>").appendTo(e)),this.options.dateInput){var n=$j("<input type='text'>").appendTo(e).css("margin","0 5px").keyup(function(){for(var e=!1,n=!0,r=0;r<i.fields.length;r++){if(i.fields[r].val().length%10!=0)return;if(i.inputs[r].val()!=i.fields[r].val()){var o=t.date_sql2js(i.fields[r].val());0==r?(i.datefrom=t.date_js2sql(o),i.datefrom>i.dateto&&(i.dateto=t.date_js2sql(o),n=!1)):(i.dateto=t.date_js2sql(o),i.datefrom>i.dateto&&(i.datefrom=t.date_js2sql(o),n=!1)),e=!0}}e&&(i.refresh(),i.setState(),n&&i.ok())});this.fields.push(n)}},tt.prototype.setState=function(){this.state=this.datefrom&&this.dateto?2:this.datefrom||this.dateto?1:0},tt.prototype.ok=function(){this.options.okfunc&&this.options.okfunc(this.datefrom,this.dateto)},tt.prototype.select=function(){var t=this.datePicker.getSqlDate();"datefrom"==this.selectNext?(t==this.datefrom?this.dateto=t:t>this.dateto?(this.datefrom=t,this.dateto=t):this.datefrom=t,this.selectNext="dateto"):(t==this.dateto?this.datefrom=t:(t<this.datefrom&&(this.datefrom=t),this.dateto=t),this.selectNext="datefrom"),this.refresh(t),this.ok()},tt.prototype.refresh=function(e){if(!e&&0<this.state&&(e=this.datefrom?this.datefrom:this.dateto),e&&((!this.datefrom||e<this.dateto)&&(this.datefrom=e),(!this.dateto||this.datefrom&&e>this.datefrom)&&(this.dateto=e)),this.datefrom&&this.dateto&&(this.inputs[0].val(this.datefrom),this.inputs[1].val(this.dateto),this.fields.length))for(var i=0;i<this.fields.length;i++)this.fields[i].val(this.inputs[i].val()),this.fields[i].toggleClass("border_error","datefrom"==this.selectNext&&0==i||"dateto"==this.selectNext&&1==i);this.datePicker.$container.datepicker("setDate",t.date_sql2js(this.dateto)),this.datePicker.$container.datepicker("setDate",t.date_sql2js(this.datefrom))},tt);function tt(e,i,n,r){var o=this;void 0===r&&(r={}),this.options=r,this.inputs=[],this.fields=[],this.selectNext="datefrom",r.multi_select=!0,r.numberOfMonths=2;var s=t.createDiv(e,r.cssClass,"margin:10px 0;"+r.style);if(this.initField(s),this.initField(s),this.datePicker=new Z(s,r),i&&n&&n<i){var a=i+"";i=n,n=a}this.datefrom=i||"",this.dateto=n||"",this.setState(),this.datePicker.subscribe(function(t,e){o.select()}),this.datePicker.setRenderer(function(t){var e=[!0,"",""],i=o.datePicker.getSqlDate(t);return i>=o.datefrom&&i<=o.dateto&&(e[1]="selected-range-day"),e}),this.refresh()}i.DatePickerDiv=Q;var et=(it.prototype.init=function(t){var e=this;this.$panel=$j("<div>").appendTo(t).hide().blur(function(){e.hide()})},it.prototype.popup=function(){this.needRefill()&&this.fill(),this.$panel.show()},it.prototype.needRefill=function(){return!this.$panel.html()},it.prototype.fill=function(){this.$panel.empty()},it.prototype.hide=function(){this.$panel.fadeOut()},it);function it(t,e){void 0===e&&(e={}),this.options=e,this.init(t)}i.Popup=et;var nt,rt=(__extends(ot,nt=et),ot.prototype.init=function(e){var i=this,n=t.createDiv(e,"inputComplete");nt.prototype.init.call(this,n),this.$panel.addClass("asc-scrollbar"),this.$ui=$j("<input>").appendTo(n).focus(function(){i.popup()}).keydown(function(t){switch(t.keyCode){case 13:var e=i.$panel.find(".selected").index(),n=0;for(var r in i.items){if(e==n){i.set(r),i.hide();break}n++}break;case 38:case 40:t.preventDefault(),t.stopPropagation();var o=i.$panel.find(".selected").removeClass("selected");o.length&&(o=38==t.keyCode?o.prev():o.next()),o.length||(o=38==t.keyCode?i.$panel.find("span:first-child"):i.$panel.find("span:last-child")),o.addClass("selected")}}).keyup(function(t){switch(t.keyCode){case 13:case 38:case 40:break;default:i.timeHandler&&clearInterval(i.timeHandler),i.timeHandler=setInterval(function(){clearInterval(i.timeHandler),i.scroll()},100)}}).blur(function(e){if(t.isIE())return!1;$j(e.relatedTarget).is(".ui-dialog")?$j(e.relatedTarget).click(function(){$j(e.relatedTarget).off("click"),i.onblur(e)}):i.onblur(e)})},ot.prototype.onblur=function(t){this.hide()},ot.prototype.popup=function(){$j(".asc-scrollbar").not(this.$panel).fadeOut(),nt.prototype.popup.call(this),this.scroll()},ot.prototype.fill=function(){var t=this;for(var e in nt.prototype.fill.call(this),this.items){var i=this.items[e]+(this.options.setItemLabel?" ("+e+")":""),n=$j("<span>").text(i).appendTo(this.$panel);!function(e){n.click(function(){t.set(e),t.hide()})}(e)}},ot.prototype.set=function(e){this.options.setItemLabel&&(e=this.items[e]),this.$ui.val(e),"function"==t.type(this.options.fn)&&this.options.fn(e)},ot.prototype.scroll=function(){this.$panel.show();var t=this.$ui.val().trim();this.$panel.html()&&t&&(this.$panel.children().removeClass("selected"),this.$panel.scrollTop(0),this.scrollTo(t).addClass("selected"))},ot.prototype.scrollTo=function(t){var e,i,n=0,r=t.length,o=t.substr(0,3)+"00";for(var s in this.items){if(this.matchValue(s,t,r)||this.matchValue(this.items[s],t,r)){e=this.$panel.children().eq(n);break}(this.matchValue(s,o,r)||this.matchValue(this.items[s],o,r))&&(i=this.$panel.children().eq(n)),n++}return e?this.$panel.scrollTop(e.position().top-Math.floor(this.options.rows/2)*e.height()):i&&this.$panel.scrollTop(i.position().top-Math.floor(this.options.rows/2)*i.height()),e||$j()},ot.prototype.matchValue=function(t,e,i){function n(t){return(t+"").toLowerCase().substr(0,i)}return n(t)==n(e)},ot);function ot(t,e,i){void 0===i&&(i={});var n=nt.call(this,t,i)||this;return n.items=e,n}i.InputComplete=rt;var st,at,lt=(__extends(ct,st=rt),ct.prototype.init=function(t){this.options=$j.extend({},{step:1800,rows:7},this.options),this.options.ajSekundy=!!this.options.ajSekundy||this.options.step<60,this.$el=$j('<input type="hidden">').appendTo(t),st.prototype.init.call(this,t),this.$panel.css({"max-height":16*this.options.rows+"px","text-align":"left"}).parent().addClass("timePicker")},ct.prototype.onblur=function(e){st.prototype.onblur.call(this,e);var i=this.options.emptyString&&""==this.$ui.val().trim()?"":t.ASC_str2time(this.$ui.val());this.set(i),this.send()},ct.prototype.scroll=function(){st.prototype.scroll.call(this),this.get()||this.options.getFromField||this.scrollTo(this.options.scrollTo||"8:00")},ct.prototype.get=function(t){void 0===t&&(t=!1);var e=this.$el.val();return t?e:e.substring(0,5)},ct.prototype.set=function(e,i){e=t.strVal(e),this.options.valBezSekund&&(e=e.substr(0,5)),this.$el.val(e),this.$ui.val(t.ASC_time2str(e,{ajSekundy:this.options.ajSekundy})),i||"function"!=t.type(this.options.fn)||this.options.fn(e),this.send()},ct.prototype.duration=function(e,i){var n=this.time2seconds(i)-this.time2seconds(e),r=this.seconds2time(n),o=r[1]+Math.round(r[2]/6)/10;return 0<r[0]?t.lsf(3147,{n:r[0]})+(o?" "+t.lsf(1959,{n:1*o}):""):0<r[1]?t.lsf(1959,{n:1*o}):r[2]||this.options.ajSekundy?t.lsf(3148,{n:r[2]}):t.lsf(1959,{n:0})},ct.prototype.seconds2time=function(t){var e=[0,0,0];return e[0]=Math.floor(t/3600),e[1]=Math.floor((t-3600*e[0])/60),e[2]=t-3600*e[0]-60*e[1],e},ct.prototype.time2seconds=function(e){return"array"!=t.type(e)&&(e=t.ASC_str2time(e).split(":")),3600*e[0]+60*e[1]+1*e[2]},ct.prototype.needRefill=function(){return st.prototype.needRefill.call(this)||this.options.getFromField},ct.prototype.fill=function(){this.items={};var e=0;for(this.options.getFromField&&this.options.getFromField.value&&(e=this.time2seconds(this.options.getFromField.value));e<=86400;e+=this.options.step){var i=t.ASC_str2time(this.seconds2time(e).join(":")),n=t.ASC_time2str(i,{ajSekundy:this.options.ajSekundy});if(this.options.getFromField)n+=" ("+this.duration(this.options.getFromField.value,i)+")";else if(86400==e)continue;this.items[i]=n}st.prototype.fill.call(this)},ct.prototype.send=function(){this.ASC_ce.fire()},ct);function ct(e,i,n){void 0===n&&(n={});var r=st.call(this,e,{},n)||this;return r.ASC_ce=new t.ASC_ce(r.$el),i&&r.set(t.ASC_str2time(i),!0),r}function ut(e,i){var n=e.find("tr").map(function(e,n){if(e<i)return $j(n).addClass("fixed"),$j("td, th",n).each(function(e,i){t.todo_read(function(){var e=pt(i);t.todo_write(function(){$j(i).css(e)})})}).get()});return t.todo_finish(),n}function dt(t,e){var i=0,n=0;return t.find("tr").map(function(t,r){var o=$j(r).find("td, th");if(0<n&&--n,o.length){var s=n;return o.map(function(t,r){if(t<e-(s?i||1:-i))return 1<r.rowSpan&&(n+=r.rowSpan),i+=r.colSpan-1,ht(r),r}).get()}})}function ht(t){$j(t).css(pt(t))}function pt(t){var e=$j(t),i=ft(e.css("background-color"));return{backgroundColor:"white"==i?ft(e.parent().css("background-color")):i}}function ft(t){if(!t||0<=t.indexOf("transparent")||0<=t.indexOf("none")||"rgba(0, 0, 0, 0)"==t)t="white";else if(0<=t.indexOf("rgba")){var e=t.substr(5,t.length-6).split(", "),i=parseFloat(e[3]),n=0;for(var r in e)if(r<"3"){var o=parseInt(e[r]),s=o*i+255*(1-i);e[r]=s+"",n+=o}t=10<n?"rgb("+e[0]+","+e[1]+","+e[2]+")":"white"}return t}function vt(t,e,i){var n=t.get(0).offsetLeft+t.get(0).clientLeft+parseInt(t.css("border-left-width"))||0;i&&(n-=$j(i).get(0).offsetLeft+$j(i).get(0).clientLeft-Math.max(t.offsetParent().get(0).offsetLeft,0));var r=t.width()-t.find("tr").first().children().get(e).offsetLeft,o=$j(i||window).scrollLeft()-n;return 0<o&&o<r?o:0}function gt(t,e,i){var n=t.get(0).offsetTop+t.get(0).clientTop+parseInt(t.css("border-top-width"))||0;i&&(n-=i.offsetTop+i.clientTop);var r=t.height()-t.find("tr").get(e).offsetTop,o=$j(i||window).scrollTop()-n;return 0<o&&o<r?o:0}function mt(e,i,n){void 0===n&&(n=0);var r=0<i||0<n;e.css(t.getCssCrossBrowser("transform","translate("+i+"px, "+n+"px)",r)).toggleClass("fixed",r)}function bt(t,e,i){$j(i||window).off("scroll.fixtable."+e).on("scroll.fixtable."+e,function(n){i&&0==$j(i).parents("html").length?(console.log("scroll.fixtable."+e,"detached",i),$j(i).off("scroll.fixtable."+e)):t(n)})}i.TimePicker=lt,(at=i.FixedTable||(i.FixedTable={})).fixBoth=function(e,i,n,r){var o=$j(e).addClass("fixed");"chrome"!=t.browser&&o.addClass("noChrome");var s=ut(o,i),a=dt(o,n),l=s.filter(a);a=a.not(l),s=s.not(l),l.addClass("both"),bt(function(){var t=gt(o,i,r),e=vt(o,n,r);mt(l,e,t),mt(s,0,t),mt(a,e)},"both",r)},at.fixColumns=function(t,e,i){var n=$j(t).addClass("fixed"),r=dt(n,e);bt(function(){var t=vt(n,e,i);mt(r,t)},"left",i),$j(t).change(function(t){r.each(function(t,e){$j(e).css("background-color",""),ht(e)})})},at.fixRows=function(t,e,i){var n=$j(t).addClass("fixed"),r=ut(n,e);bt(function(){var t=gt(n,e,i);mt(r,0,t)},"top",i)};var yt=(Ct.prototype.render=function(t){var e=this;t.off().empty().addClass(this.config.CSS_CLASS_NAME).toggleClass("disabled",!!this.config.disabled).toggleClass("checked",!!this.config.checked).toggleClass("marked",!!this.config.selected),Ct.renderContent(t,this.config),this.$srcElement=t,!this.config.disabled&&this.config.onclick&&this.config.onclick.fn?t.click(function(t){t.stopPropagation();var i="obj"in e.config.onclick?e.config.onclick.obj:e.config;e.config.onclick.fn(t,i,i),e.parent.config.clickToHide&&e.parent.hide()}):t.click(function(t){return t.stopPropagation()}),this.config.submenu&&t.addClass("submenu").click(function(t){t.preventDefault(),e.config.disabled||e.showSubmenu()}).hover(function(){e.config.disabled||(t.addClass("focused"),setTimeout(function(){t.hasClass("focused")&&e.showSubmenu()},200))},function(){e.config.disabled||(t.removeClass("focused"),setTimeout(function(){t.hasClass("focused")||e.hideSubmenu()},600))}),this.submenu&&this.initSubmenu()},Ct.renderContent=function(t,e){var i=$j("<a>").addClass(e.CSS_LABEL_CLASS_NAME).toggleClass("elementDisabled",!!e.disabled).html(e.html||e.text||String.fromCharCode(160));return e.icon&&$j("<img>").addClass("asc-icon-label").attr("src",staticUrl(e.icon)).prependTo(i),e.color&&$j("<i>").addClass("asc-color-label").css({backgroundColor:e.color}).prependTo(i),e.style&&(i.get(0).style.cssText+=e.style),e.indent&&i.css("padding-left",e.indent+"em"),i.appendTo(t)},Ct.prototype.getLabel=function(){return this.config.html&&this.config.text?this.config.text:this.$srcElement.find("a").html()},Ct.prototype.getText=function(){return this.$srcElement.find("a").text()},Ct.prototype.showSubmenu=function(){if(this.submenu||this.initSubmenu(),!this.submenu.$menu.is(":visible")){this.parent.$menu.find(".submenu .dropDown").not(this.submenu.$menu).hide(),this.fixSubmenuOffset(),this.submenu.$menu.css({display:"block",visibility:"hidden"});var t=this.submenu.fixOffset();this.submenu.$menu.css({display:"none",visibility:"visible"}),t?this.submenu.$menu.show("slide",{direction:"down"},150):this.submenu.$menu.slideDown(150,"swing")}},Ct.prototype.fixSubmenuOffset=function(){var e=this.$srcElement.offset(),i=$j(window);this.submenu.cfg.setProperty("xy",[e.left+t.rtl(this.$srcElement.outerWidth(),0)-i.scrollLeft(),e.top-i.scrollTop()])},Ct.prototype.hideSubmenu=function(){this.submenu&&this.submenu.$menu.slideUp(100,"swing")},Ct.prototype.initSubmenu=function(){if(this.submenu)this.submenu.render();else{var t=this.config.submenu.itemdata||this.config.submenu;this.submenu=new wt(t,{container:this.$srcElement,clickToHide:this.parent.config.clickToHide}),this.submenu.parent=this.parent}this.submenu.$menu.off().click(function(t){t.preventDefault(),t.stopPropagation()})},Ct.fix=function(t){t.text=r(t.text,t,!0),delete t.icon,t.style&&(t.text='<span style="'+t.style+'">'+t.text+"</span>",delete t.style),t.color&&(t.text='<span style="display:inline-block;width:15px;height:15px;vertical-align:middle;background-color:'+t.color+';">&nbsp</span> '+t.text,delete t.color),t.indent&&(t.text=new Array(t.indent+1).join("&nbsp;")+t.text,delete t.indent),t.handler&&!t.onclick&&(t.onclick=t.handler),"function"==typeof t.onclick&&(t.onclick={fn:t.onclick}),t.submenu&&_t.fix(t.submenu)},Ct);function Ct(t){var e=this;this.config=t,Ct.fix(this.config),this.cfg={setProperty:function(t,i){switch(t){case"obj":case"fn":e.config.onclick[t]=i;default:e.config[t]=i}e.render(e.$srcElement),e.$srcElement.trigger("cfgChanged")},getProperty:function(t){return e.config[t]}}}i.MenuItem=yt;var _t=($t.prototype.initItems=function(e){var i=[[]],n=0;function r(){i[n].length&&(n++,i.push([]))}if(e)for(var o=0;o<e.length;o++){var s=e[o];if(s)if(s instanceof yt)i[n].push(s);else if(t.isArray(s)){var a=this.initItems(s);0<a.length&&0<a[0].length&&(r(),i[n]=a[0]),o<e.length-1&&r()}else i[n].push(new yt(s));else r()}return i[n].length||i.pop(),i},$t.prototype.render=function(){var e=this;this.$menu=$j("<div class='asc dropDown'>").addClass(this.config.cssClass).append("<div class='close-btn'>"+t.ls(1567)+"</div><div class='header'/><div class='body'/><div class='footer'/>"),this.config.minWidth&&this.$menu.css("min-width",this.config.minWidth),this.$menu.find(".close-btn").click(function(){e.hide()}),this.$body=this.$menu.find(">div.body").first(),this.renderItems(),new At(this.$menu,this.$body,function(){e.show()}),this.$menu.appendTo(this.$container)},$t.prototype.renderItems=function(){function t(){var t=null!=e;e=$j("<ul class='dropDownPanel asc-context-menu'>").appendTo(i.$body),t&&e.addClass("top-border")}var e,i=this;this.$body.empty(),t(),this.fixMissingIcon();for(var n=0;n<this.items.length;n++){for(var r=0;r<this.items[n].length;r++){var o=this.items[n][r];o.parent=this,o.groupIndex=n,o.index=r;var s=$j("<li>").appendTo(e);o.render(s)}n<this.items.length-1&&t()}},$t.prototype.fixMissingIcon=function(){for(var t=!1,e=0,i=this.items;e<i.length;e++)for(var n=0,o=i[e];n<o.length;n++)if(0<=(u=o[n]).config.text.indexOf("<img src")){t=!0;break}if(t)for(var s=0,a=this.items;s<a.length;s++)for(var l=0,c=a[s];l<c.length;l++){var u;(u=c[l]).config.text.indexOf("<img src")<0&&(u.config.icon=staticUrl("/static/pics/blank_32.png"),u.config.text=r(u.config.text,u.config,!0),delete u.config.icon)}},$t.prototype.show=function(){this.$menu.attr({tabIndex:0,autofocus:1}).show().focus()},$t.prototype.hide=function(){this.$menu.fadeOut(),$j(".tmp-selected").removeClass("tmp-selected"),this.parent&&this.parent.hide(),this.config.onHide&&this.config.onHide()},$t.prototype.getSubmenus=function(){var t=[];return this.items.forEach(function(e,i,n){e.forEach(function(e,i){!e.submenu&&e.config.submenu&&e.initSubmenu(),e.submenu&&t.push(e.submenu)})}),t},$t.prototype.getItem=function(t,e){return void 0===e&&(e=0),this.items[e]&&this.items[e][t]},$t.prototype.destroy=function(){this.$menu.remove()},$t.fix=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];yt.fix(n)}},$t.convertCombo=function(t,e,i){for(var n,r,o=[],s=0;s<t.length;s++)(n=t[s])&&!Array.isArray(n)&&void 0!==n.value?(r=$j.extend({text:n.name,checked:n.value==e,onclick:{fn:i,obj:n.value}},n),n.classname&&(r.CSS_CLASS_NAME=n.classname,delete r.classname),o.push(r)):o.push([]);return o},$t.addHandler=function(e,i){if(t.isArray(e))for(var n=0;n<e.length;n++)$t.addHandler(e[n],i);else e.cmd&&(e.onclick||(e.onclick=function(){i(e)})),e.submenu&&$t.addHandler(e.submenu,i)},$t);function $t(e,i){var n=this;this.config=i,this.config=$j.extend({},{clickToHide:!0,x:0,y:0},i),this.config.container?this.$container=$j(this.config.container):this.$container=$j("<div>").appendTo(document.body),this.items=this.initItems(e),this.render(),this.cfg={setProperty:function(e,i){switch(e){case"xy":n.config.x=i[0],n.config.y=i[1];break;default:n.config[e]=i}switch(e){case"x":case"y":case"xy":n.$menu.css(t.rtl({top:n.config.y,left:n.config.x},{top:n.config.y,left:n.config.x-n.$body.width(),right:"unset"}));break;case"header":case"footer":n.$menu.find(">."+e).html(i);break;default:n.$menu.trigger("cfgChanged")}},getProperty:function(t){return n.config[t]}}}i.Menu=_t;var St,wt=(__extends(xt,St=_t),xt.prototype.show=function(e){var i=this;if(e)if(e.clientX)this.cfg.setProperty("xy",[e.clientX,e.clientY]),this.fixOffset();else{var n=this.$trigger=$j(e),r=n.parents(".dropDownBtn");r.length&&r.first().hasClass(".dropDownBtn")&&(n=r.first());var o=n.offset(),s=$j(window);this.cfg.setProperty("xy",[o.left-s.scrollLeft()+t.rtl(0,n.outerWidth()),o.top+n.outerHeight()-s.scrollTop()]),this.fixOffset(n)}else this.cfg.setProperty("xy",[this.config.x,this.config.y]),this.fixOffset();window.setTimeout(function(){i.scrollToSelected()},10)},xt.prototype.scrollToSelected=function(){var t=this.$menu.find(".marked");t.length||(t=this.$menu.find(".checked"));var e=t.position();e&&this.$body.scrollTop(e.top-this.$menu.height()/2+t.height())},xt.prototype.fixOffset=function(e){this.parent||St.prototype.show.call(this);var i=[this.config.x,this.config.y],n=this.$menu.offset();this.$body.css("max-height","");var r=$j(window),o=null!=this.parent,s=!1,a={available:r.height(),menu:this.$menu.outerHeight(),body:this.$body.height(),top:n.top-r.scrollTop(),edubar:0,refEl:0},l=a.top+a.menu-a.available;if(0<l){a.refEl=o?-this.$container.height():e?e.outerHeight():0,a.edubar=$j("#edubar .edubarHeader").outerHeight()||0;var c=a.available-a.top,u=a.top-a.refEl-a.edubar;u>a.menu||c<u?(s=!0,i[1]=u+a.edubar-a.menu,l=a.menu-u,o?i[1]+=(a.menu-a.body)/2:a.refEl||(l+=r.scrollTop()),i[1]=Math.max(i[1],a.edubar+1)):(o&&(i[1]-=(a.menu-a.body)/2),l+=15)}else o&&(i[1]-=(a.menu-a.body)/2);if(0<l){var d=Math.max(30,a.body-l);this.$body.css({"max-height":d+"px","overflow-x":"hidden"}),this.$menu.data("autoheight",!0).css({"overflow-y":"auto"}),""!=t.browser&&"firefox"!=t.browser||this.$body.width(this.$body.width()+20)}return this.cfg.setProperty("xy",[this.getLeftFixed(),i[1]]),s},xt.prototype.getLeftFixed=function(){var e,i=t.rtl(!1,!0),n=null!=this.parent,r=this.config.x;if(i){if((e=r-this.$menu.outerWidth())<0)return n?this.parent.config.x+this.$menu.outerWidth():r-e}else if(0<(e=r+this.$menu.outerWidth()-document.body.clientWidth))return n?this.parent.config.x-this.$menu.outerWidth():r-e;return r},xt);function xt(t,e){var i=St.call(this,t,e)||this;i.config.container||i.$container.css("position","inherit");var n=i.$container.position();return i.cfg.setProperty("y",[n.top]),i}i.ContextMenu=wt;var At=(kt.prototype.doKeyDown=function(t){var e=this.$dropdown,i=e.is(":visible");switch(t.keyCode){case 32:t.preventDefault(),this.openFn();break;case 13:t.preventDefault(),i?e.find(".marked a").click():this.openFn();break;case 38:case 40:t.preventDefault(),i?this.selectSibling(t,"marked"):this.openFn();break;case 37:var n=e.find(".marked .dropDown:visible");n.length||(n=e.find(".marked").closest(".dropDown").not(e)),n.length||(n=e.find(".dropDown:visible")),n.hide().find(".marked").removeClass("marked"),e.find(".marked").length||n.closest("li").addClass("marked"),e.find(".marked").closest(".dropDown").focus();break;case 39:e.find(".marked.submenu, .focused.submenu").click();break;case 27:t.stopPropagation(),t.preventDefault(),e.prev().click().focus();break;default:var r=this.getLetterPressed(t);if(r){t.preventDefault(),i||this.openFn();var o=e.data(),s=0;o.lastSearched+1e3>Date.now()&&(r=o.keyword+r),1<r.length&&r[0]==r[1]&&r[0]!=r[r.length-1]&&(r=r[r.length-1]),e.data({lastSearched:Date.now(),keyword:r}),1<r.length&&r[0]==r[1]&&(s=r.length-1,r=r[0]),this.search(r,s)}}},kt.prototype.getLetterPressed=function(t){var e="";return t.ctrlKey||t.altKey||(47<t.keyCode&&t.keyCode<57||95<t.keyCode&&t.keyCode<106?e+=95<t.keyCode?t.keyCode-96:t.keyCode-48:64<t.keyCode&&t.keyCode<91&&(e=String.fromCharCode(t.keyCode).toLowerCase())),e},kt.prototype.search=function(e,i){void 0===i&&(i=0);var n=this.$dropdown.find("li:visible").removeClass("marked").map(function(i,n){var r=$j(n).text().toLowerCase().trim();if(0==(r=t.removeDiacritics(r)).search(e))return n});if(n.length){var r=$j(n.get(Math.min(i%n.length)));r.addClass("marked"),this.$dropdown.scrollTop(0);var o=r.offset().top-this.$dropdown.offset().top-r.height()/2;this.$dropdown.scrollTop(Math.max(0,o))}},kt.prototype.selectSibling=function(t,e){var i=this.$dropdown.find("."+e);i.removeClass(e);var n=this.$dropdown.find("LI:visible"),r=n.index(i)+1;38==t.keyCode&&(r-=2),r=Math.min(r,n.length-1),r=Math.max(r,0);var o=n.eq(r).addClass(e).focus(),s=o.position(),a=this.$dropdown.scrollTop(),l=this.$dropdown.height(),c=o.height()/2;s&&s.top&&(s.top<0||s.top+c>l)&&(38==t.keyCode?this.$dropdown.scrollTop(a+c+s.top-l):this.$dropdown.scrollTop(a+s.top-c))},kt);function kt(t,e,i){var n=this;this.$dropdown=e,this.openFn=i,$j(t).keydown(function(t){9!=t.keyCode&&n.doKeyDown(t)})}i.MenuKeyNavigation=At;var jt=(Tt.prototype.up=function(){var t,e=this.$el.val();t=7==e.length&&"#"==e[0]?this.prefix+"<div style='display:inline-block;width:10px;height:10px;border:1px solid black;vertical-align:-2px;background-color:"+e+"'></div>":this.prefix+"",this.btn.label_html(t)},Tt.prototype.pick_palette=function(){var e=this;this.$d_pick.empty();var i,n,r=$j("<table>").appendTo(this.$d_pick),o=$j("<tbody>").appendTo(r);this.cds.length=0;for(var s=Tt.palette,a=0;a<s.length;a++)a%7==0&&(i=$j("<tr>").appendTo(o)),n=$j("<td>").appendTo(i).css("background-color",s[a]).attr("title",s[a]).data("color",s[a]).click(function(t){e.setV($j(t.target).data("color")+""),e.btn.menu.hide()}),this.cds.push(n);this.options.morecolors&&$j("<a href='#'>").text(t.ls(1239)).appendTo($j("<div style='text-align:right'>").appendTo(this.$d_pick)).click(function(t){e.pick_more(),t.stopPropagation(),t.preventDefault()})},Tt.prototype.pick_more=function(){var e=this;this.$d_pick.empty(),this.cds.length=0,$j("<div>").appendTo(this.$d_pick).ColorPicker({color:this.val(),flat:!0,showThemeColors:!1,showSubmitBtn:!1,showOrigSubmitBtn:!0,onSubmit:function(t,i,n,r){e.setV(("#"+i).toUpperCase()),e.btn.menu.hide()}}),$j("<a href='#'>").text(t.ls(4060)).appendTo($j("<div style='text-align:right'>").appendTo(this.$d_pick)).click(function(t){e.pick_palette(),t.stopPropagation(),t.preventDefault()})},Tt.prototype.val=function(){return this.$el.val()},Tt.prototype.setV=function(t){var e=this.$el.val()!=t;this.$el.val(t),this.$tf&&this.$tf.val(t);for(var i=0;i<this.cds.length;i++){var n=this.cds[i];n.toggleClass("selected",n.data("color")+""==t)}this.btn_nc&&this.btn_nc.check(""==t),this.up(),e&&this.ASC_ce.fire()},Tt.prototype.renderMenu=function(){var e=this,i=this.btn.menu,n=i.$menu.empty().css("padding","0px"),r=$j("<div>").addClass("asc-colorpicker").appendTo(n);n.off(),this.$tf=$j('<input type="text">').appendTo(r).on("blur change",function(){e.setV(t.trim(e.$tf.val()))}),this.$d_pick=$j("<div style='margin: 5px 0'>").appendTo(r),""==this.val()||0<=Tt.palette.indexOf(this.val())||!this.options.morecolors?this.pick_palette():this.pick_more(),this.options.nocolor&&(this.btn_nc=new c(r,t.ls(1642),{onclick:function(){e.setV(""),i.hide(),e.ASC_ce.fire()}}),this.btn_nc.button.$element.add(this.btn_nc.button.$element.parent()).css("width","100%")),this.setV(this.val())},Tt.palette=["#FFFFFF","#CCCCCC","#C0C0C0","#999999","#666666","#333333","#000000","#FFCCCC","#FF6666","#FF0000","#CC0000","#990000","#660000","#330000","#FFCC99","#FF9966","#FF9900","#FF6600","#CC6600","#993300","#663300","#FFFF99","#FFFF66","#FFCC66","#FFCC33","#CC9933","#996633","#663333","#FFFFCC","#FFFF33","#FFFF00","#FFCC00","#999900","#666600","#333300","#99FF99","#66FF99","#33FF33","#33CC00","#009900","#006600","#003300","#99FFFF","#33FFFF","#66CCCC","#00CCCC","#339999","#336666","#003333","#CCFFFF","#66FFFF","#33CCFF","#3366FF","#3333FF","#000099","#000066","#CCCCFF","#9999FF","#6666CC","#6633FF","#6600CC","#333399","#330099","#FFCCFF","#FF99FF","#CC66CC","#CC33CC","#993399","#663366","#330033"],Tt);function Tt(e,i,n){var r=this;this.options=n,this.$d_pick=null,this.cds=[],this.prefix="",this.$el=$j("<input>").attr("type","hidden").val(""+i).appendTo(e),this.ASC_ce=new t.ASC_ce(this.$el),this.btn=new a({container:$j("<span>").appendTo(e),label:"",menu:[],style:n.style,onclick:function(){r.renderMenu()}}),this.options.label&&(this.prefix="<span style='margin-right:5px'>"+t.escapeHTML(this.options.label)+"</span>"),this.up()}i.ColorPicker=jt;var It=(Dt.prototype.start=function(e){var i=this;void 0===e&&(e=0);for(var n=Date.now();e<this.todoFnList.length;e++){if(!this.checkSafetyCounter())return;var r=this.todoFnList[e];if("function"==t.type(r)?r():this.status(-1,r),e<this.todoFnList.length-1&&Date.now()-n>this.options.stepTime){setTimeout(function(){i.safetyCounter++,i.checkSafetyCounter()&&(i.setAutoTitle(e,i.todoFnList.length-1),i.status(e/i.todoFnList.length),i.start(e+1))},10);break}}e>=this.todoFnList.length-1&&this.stop()},Dt.prototype.stop=function(){if(!this.stopped)try{this.dlg.hide(),this.options.onStop&&this.options.onStop()}catch(t){console.log(t)}},Dt.prototype.status=function(t,e){e&&(this.options.title=e,this.dlg.setHeader(e)),0<=t&&Dt.update(this.dlg.$bd,100*t,this.options)},Dt.update=function(t,e,i){var n=Dt.getOrCreateBar(t);i=$j.extend({stepTime:isNaN(i)?1e3:i,animate:"linear"},i);var r=e/100*(n.parent().width()+1);i.subtitle&&$j(".subtitle",t).text(i.subtitle),0<r?(Math.ceil(r)<n.width()&&n.width(0),i.animate?n.animate({width:Math.ceil(r)+"px"},i.stepTime,i.animate):n.width(Math.ceil(r))):n.width(0)},Dt.getOrCreateBar=function(t){if($j(t).is(":empty")){var e=$j("<div>").appendTo(t).css({display:"inline-block",width:"90%",border:"1px solid black",overflow:"hidden"});return $j("<div class='subtitle'>").appendTo(t),$j("<div>").appendTo(e).css({display:"block",height:"8px",backgroundColor:"rgb(64, 152, 64)",width:"0"})}return $j("div > div",t)},Dt.prototype.checkSafetyCounter=function(){return!(this.stopped||this.safetyCounter>=this.safetyCounterMax&&(console.log("safety counter reached its maximum",this.safetyCounter),this.stop(),1))},Dt.prototype.setAutoTitle=function(t,e){var i=this.options.title+" "||"";switch(this.options.showInfoProgress){case"counter":i+=t+" / "+e;break;case"percentage":i+=Math.round(t/e*100)+" %";break;default:i=""}i&&this.dlg.setHeader(i)},Dt);function Dt(e,i){var n=this;this.todoFnList=e,this.options=i,this.safetyCounterMax=50,this.dlg=new t.ui.Dialog({resizable:!1,draggable:!1,width:"250px",title:t.ls(2568)+"...",show:!0,buttons:[{text:t.ls(1038),onclick:function(){n.stop(),n.options.onCancel&&n.options.onCancel()}}]}),this.options=$j.extend({stepTime:500},i),this.safetyCounter=0,this.status(0,this.options.title),this.todoFnList&&this.todoFnList.length&&this.start()}i.ProgressBar=It,i.FlexSplitPane=function(t,e){var i=this;void 0===e&&(e={}),this.vertical=!1,this.$div=$j(t),this.$div.hasClass("flex-split-pane")||(this.$div=$j("<div class='flex-split-pane'>").appendTo(t));var n=5;e.size&&(n=e.size),e.vertical&&(this.vertical=!!e.vertical),e.onmoved&&this.$div.on("moved",e.onmoved);var r=this.vertical?"width":"height";this.$div.css(r,n+"px"),this.$div.addClass(this.vertical?"vertical":"horizontal"),this.$div.mousedown(function(t){var e=0,n=i.vertical?"left":"top",r=i.vertical?"width":"height";function o(r){e=i.vertical?r.pageX-t.pageX:r.pageY-t.pageY,r.stopPropagation(),r.preventDefault(),i.$div.css(n,e+"px")}i.$div.addClass("dragging");var s=[i.$div.prev(),i.$div.next()],a=function(){if($j(document).off("mousemove",o).off("mouseup",a),i.$div.css(n,""),i.$div.removeClass("dragging"),0!=e){for(var t=0;t<2;t++){var l=s[t];if(!parseInt(l.css("flex-grow"))){var c=parseInt(l.css(r)),u=0==t?c+e:c-e;u=Math.max(u,20),l.css(r,u+"px")}}i.$div.trigger("moved")}};$j(document).mousemove(o).mouseup(a)})}}(e=t.ui||(t.ui={}))}(ASC=ASC||{}),ASC.installBundle("main",[],{"/asc/edurequest.js":function(t,e,i){t.__esModule=!0;var n=e("tslib"),r=e("./lib_date"),o=(s.prototype.initRequest=function(t){this.props=t;for(var e=0,i=["edupage","lang","firstDayOfWeek","weekendDays","school_country","school_state","schoolyear_turnover","custom_turnover","loggedUser","loggedUserRights","parent_studentid","sort_name_col","jsmodulemode"];e<i.length;e++){var n=i[e],r=t[n];void 0!==r&&(this[n]=r)}},s.prototype.getSchoolYear=function(t){void 0===t&&(t=this.timezone_date()),t&&this.schoolyear_turnover||ASC.dieError("8130146806");var e=parseInt(t.substr(0,4));return t<this.schoolYear_turnOver(e)&&e--,e},s.prototype.getSchoolYearName=function(t){return t?this.schoolYear_turnOver(t+1)<=t+1+"-02-01"?""+t:t+"/"+(t+1):""},s.prototype.schoolYear_turnOver=function(t){return this.custom_turnover[t]||t+"-"+this.schoolyear_turnover},s.prototype.schoolYear_turnOver_end=function(t){return r.date_delta(this.schoolYear_turnOver(t+1),-1)},s.prototype.isAdmin=function(){return"Admin"==this.loggedUser},s.prototype.isUcitel=function(){return"Ucitel"==this.loggedUser.substr(0,6)?this.loggedUser.substr(6):""},s.prototype.isStudent=function(){return"Student"==this.loggedUser.substr(0,7)?this.loggedUser.substr(7):""},s.prototype.isStudentOrParent=function(){return this.isStudent()||this.props.parent_studentid||""},s.prototype.isParent=function(){return"Rodic"==this.loggedUser.substr(0,5)?this.loggedUser.substr(5):""},s.prototype.isGuest=function(){return"Guest"==this.loggedUser.substr(0,5)?this.loggedUser.substr(5):""},s.prototype.isAscAdmin=function(){return!!this.props.ascadmin},s.prototype.isAscDebug=function(){return!!this.props.ascdebug},s.prototype.isAscDevelop=function(){return!!this.props.ascdevelop},s.prototype.isApp=function(){return!!this.props.app},s.prototype.hasRight=function(t){return this.isAdmin()?!["limited"].includes(t):this.loggedUserRights.includes(t)},s.prototype.jeZUS=function(){return!!this.props.jeZUS},s.prototype.isAgenda=function(){return!!this.props.isAgenda},s.prototype.uiError=function(t,e,i){"string"!=typeof e&&ASC.dieError("8358216710"),console.error("Error",t),e&&console.log(e),void 0!==i&&console.log(i);var n=new Error(""+t);throw n.errNumber=t,n.msg=e,n},s.prototype.ls=function(t){return this.edupageLangs&&this.edupageLangs[t]?this.edupageLangs[t]:ASC.ls(t)},s.prototype.lsf=function(t,e){return this.edupageLangs&&this.edupageLangs[t]&&(t=this.edupageLangs[t]),ASC.lsf(t,e)},s.prototype.ttls=function(t){return this.ttlangasc&&this.ttlangasc[t]?this.ttlangasc[t]:ASC.ttls(t)},s.prototype.ttlsf=function(t,e){var i=this.ttls(t);for(var n in e)i=i.replace("%"+n,e[n]);return i},s.prototype.uls=function(t,e){switch(e){case"tt":return this.ttls(t)}return this.ls(t)},s.prototype.localize=function(t){for(var e=0;e<10;e++){var i=/\{(?:|([a-z]{2}):)([0-9]{4,5})\}/g.exec(t);if(!i)break;t=t.replace(i[0],this.uls(parseInt(i[2]),i[1]))}return t},s.prototype.timezone_date=function(t){return void 0===t&&(t=void 0),this.timezone_datetime(t).substr(0,10)},s.prototype.timezone_datetime=function(t){void 0===t&&(t=void 0);var e,i="number"==typeof t?new Date(1e3*t):new Date;try{var n=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric",hour12:!1,timeZone:this.props.timezone}).format(i);e=/(\d+)\D+(\d+)\D+(\d+)\D+(\d+)\D+(\d+)\D+(\d+)/.exec(n)}catch(t){e=[0,i.getMonth()+1,i.getDate(),i.getFullYear(),i.getHours(),i.getMinutes(),i.getSeconds()]}function r(t,i){for(var n=""+e[t];n.length<i;)n="0"+n;return n}return r(3,4)+"-"+r(1,2)+"-"+r(2,2)+" "+r(4,2)+":"+r(5,2)+":"+r(6,2)},s.prototype.timezone_datetime2int=function(t){return Math.floor(r.datetime_sql2js(t).getTime()/1e3)},s.prototype.maindbi=function(t,i){return n.__awaiter(this,void 0,void 0,function(){var r,o,s=this;return n.__generator(this,function(a){switch(a.label){case 0:return[4,Promise.resolve().then(function(){return e("../rpr/dbi")})];case 1:return[4,a.sent().ClientDBI.newInstance(this,function(r){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.resolve().then(function(){return e("../rpr/server/maindbi")})];case 1:return[2,n.sent().mainDBIAccessor(null,t,{vt_filter:i.vt_filter,date:i.date},r)]}})})},i)];case 2:return r=a.sent(),o={showItemDlg:function(i,r){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.resolve().then(function(){return e("../rpr/maindbi_ui")})];case 1:return n.sent().showMainDbiItemDlg(t,i,r),[2]}})})},showRemoveDlg:function(i,r){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return 1!=r.length?[3,2]:[4,Promise.resolve().then(function(){return e("../rpr/maindbi_ui")})];case 1:return n.sent().showMainDbiRemoveDlg(t,i,r[0]),[3,3];case 2:ASC.dieError("5154220885"),n.label=3;case 3:return[2]}})})},showVyberDlg:function(t,i){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.resolve().then(function(){return e("../rpr/vyber")})];case 1:return[2,n.sent().showDBIVyberDlg(r,t,i)]}})})}},r.frontend=o,[2,r]}})})},s.prototype.substdbi=function(t,i){return void 0===i&&(i={}),n.__awaiter(this,void 0,void 0,function(){var r=this;return n.__generator(this,function(o){switch(o.label){case 0:return[4,Promise.resolve().then(function(){return e("../rpr/dbi")})];case 1:return[2,o.sent().ClientDBI.newInstance(this,function(i){return n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.resolve().then(function(){return e("../substitution/server/substdbi")})];case 1:return[2,n.sent().substDBIAccessor(null,t,i)]}})})},i)]}})})},s.prototype.timetabledbi=function(t,i){return void 0===i&&(i={}),n.__awaiter(this,void 0,void 0,function(){var r=this;return n.__generator(this,function(o){switch(o.label){case 0:return[4,Promise.resolve().then(function(){return e("../rpr/dbi")})];case 1:return[2,o.sent().ClientDBI.newInstance(this,function(i){return n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.resolve().then(function(){return e("../timetable/server/ttdbi")})];case 1:return[2,n.sent().timetableDBIAccessor(null,t,i)]}})})},i)]}})})},s.prototype.ttuidocdbi=function(t,i){return void 0===i&&(i={}),n.__awaiter(this,void 0,void 0,function(){var r,o,s=this;return n.__generator(this,function(a){switch(a.label){case 0:return[4,Promise.resolve().then(function(){return e("../rpr/dbi")})];case 1:return[4,a.sent().ClientDBI.newInstance(this,function(i){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.resolve().then(function(){return e("../timetable/app/server/ttdoc")})];case 1:return[2,n.sent().ttuidocDBIAccessor(null,t,i)]}})})},i)];case 2:return r=a.sent(),o={showItemDlg:function(i,r){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.resolve().then(function(){return e("../timetable/app/dlg")})];case 1:return[2,n.sent().showItemDlg(t,i,r)]}})})},showRemoveDlg:function(i,r){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.resolve().then(function(){return e("../timetable/app/dlg")})];case 1:return[2,n.sent().showRemoveDlg(t,i,r)]}})})},showVyberDlg:function(t,i){return n.__awaiter(s,void 0,void 0,function(){return n.__generator(this,function(n){switch(n.label){case 0:return[4,Promise.resolve().then(function(){return e("../timetable/app/ttdoc")})];case 1:return[2,n.sent().showTTDocVyberDlg(r,t,i)]}})})}},r.frontend=o,[2,r]}})})},s.prototype.memoize=function(t,e){var i=this._memoize_cache.get(t);return i||(i=e(),this._memoize_cache.set(t,i)),i},s);function s(){this.props=null,this.edupage="",this.lang="",this.firstDayOfWeek=1,this.weekendDays=[],this.school_country="",this.school_state="",this.schoolyear_turnover="",this.custom_turnover={},this.loggedUser="",this.loggedUserRights=[],this.sort_name_col="FSL",this.edupageLangs=null,this.ttlangasc=null,this._memoize_cache=new Map}t.EduRequest=o;var a,l=(a=o,n.__extends(c,a),c);function c(){var t,e=a.call(this)||this;e.lib_date=new r.Lib_date(e);var i=ASC.req_props;return a.prototype.initRequest.call(e,i||{}),i||window&&!(null===(t=window.MobileAppBridge)||void 0===t?void 0:t.isActive())&&ASC.sendErrorJS("9883465806",[ASC.edupage,ASC.school_country,(new Error).stack].join("|")),e}t.EduRequest_Client=l,t.client_req=new l,ASC.req=t.client_req},"/asc/lib_date.js":function(t,e,i){t.__esModule=!0;var n=e("tslib"),r=(o.prototype.date_week=function(t){return m(this.req,t)},o.prototype.week_start=function(t){return b(this.req,t)},o.prototype.week_end=function(t){return y(this.req,t)},o.prototype.week_year=function(t){return $(this.req,t)},o.prototype.week_delta=function(t,e){return C(this.req,t,e)},o.prototype.week_interval_array=function(t,e){return _(this.req,t,e)},o.prototype.timezone_datetime=function(t){return this.req.timezone_datetime(t)},o.prototype.timezone_date=function(){return this.req.timezone_date()},o.prototype.timezone_isWeekend=function(t){return w(this.req,t)},o.prototype.date_format_date=function(t,e){return void 0===e&&(e=!0),x(this.req,t,e)},o.prototype.date_format_2dates=function(t,e,i){return void 0===i&&(i=!0),ASC.ASC_date2str(t,i&&t.substr(0,4)!=e.substr(0,4))+" - "+ASC.ASC_date2str(e,i)},o.prototype.day_name=function(t,e){return void 0===e&&(e=!1),S(this.req,t,e)},o.prototype.month_name=function(t,e){return void 0===e&&(e={}),D(this.req,t,e)},o.prototype.date_format_day=function(t,e,i,n){return void 0===e&&(e=!0),void 0===i&&(i=!0),void 0===n&&(n=!1),T(this.req,t,e,i,n)},o.prototype.date_format_time=function(t,e){return void 0===e&&(e={}),I(this.req,t,e)},o.prototype.date_format_time0=function(t,e){return void 0===e&&(e={}),k(this.req,t,e)},o.prototype.date_format_2times=function(t,e,i){return j(this.req,t,e,i)},o);function o(t){this.req=t,this.date_day=d,this.datetime_js2sql=l,this.date_delta=c,this.date_diff=u,this.date_interval_array=h}function s(t){return t?v(t.getFullYear(),4)+"-"+v(t.getMonth()+1,2)+"-"+v(t.getDate(),2):""}function a(t){return t?new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),11):null}function l(t){return t?s(t)+" "+v(t.getHours(),2)+":"+v(t.getMinutes(),2)+":"+v(t.getSeconds(),2):""}function c(t,e){return 10!=t.length&&ASC.dieError("7021064479"),ASC.date_delta(t,e)}function u(t,e){return 10==t.length&&10==e.length||ASC.dieError("4915985971"),ASC.date_diff(t,e)}function d(t){return new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),11).getDay()}function h(t,e){for(var i=[],n=t;n<=e;n=ASC.date_delta(n,1))i.push(n),5e3<=i.length&&ASC.dieError("0121904859");return i}function p(t,e){var i=12*parseInt(t.substr(0,4))+parseInt(t.substr(5))+e-1;return v(Math.floor(i/12),4)+"-"+v(i%12+1,2)}function f(t){return t+"-01"}function v(t,e){for(t=""+t;t.length<e;)t="0"+t;return t}function g(t){return{6:2,7:1}[t.firstDayOfWeek]||0}function m(t,e){var i=a(e=c(e,g(t))).getDay()-1;i<0&&(i=6);var n=c(e,3-i),r=n.substr(0,4);return r+"-W"+v(Math.floor(u(n,r+"-01-01")/7)+1,2)}function b(t,e){var i=c(e.substr(0,4)+"-01-04",7*(parseInt(e.substr(6,2))-1)),n=a(i).getDay()-1;return n<0&&(n=6),c(i,-n-g(t))}function y(t,e){return c(b(t,e),6)}function C(t,e,i){return m(t,c(b(t,e),7*i))}function _(t,e,i){for(var n=[],r=e;r<=i;r=C(t,r,1))n.push(r),1e3<=n.length&&ASC.dieError("6721989579");return n}function $(t,e){return t.getSchoolYear(y(t,e))}function S(t,e,i){if(void 0===i&&(i=!1),"string"==typeof e){if(!e)return"";e=d(e)}var n=(e+6)%7,r=t.ls(1703+n);return i&&(r=t.ls(9577+n)),r}function w(t,e){return!!e&&t.props.weekendDays.includes(d(e))}function x(t,e,i){return void 0===i&&(i=!0),T(t,e,i,!1,!1)}function A(t,e,i,n){return void 0===n&&(n=!0),x(t,e,n&&e.substr(0,4)!=i.substr(0,4))+" - "+x(t,i,n)}function k(t,e,i){if(void 0===i&&(i={}),!e)return"";var n=t.lang,r=i.ajSekundy||void 0===i.ajSekundy,o=i.short,s=e.substr(0,2),a=e.substr(3,2),l=e.substr(6,2),c=parseInt(s);switch(n){case"de":return s+":"+a+(r?":"+l:"");case"en":return(c+11)%12+1+":"+a+(r?":"+l:"")+(o?"":c<12?" am":" pm");default:return c+":"+a+(r?":"+l:"")}}function j(t,e,i,n){return k(t,e,n)+(n.short?"-":" - ")+k(t,i,n)}function T(t,e,i,n,r){if(void 0===i&&(i=!0),void 0===n&&(n=!0),void 0===r&&(r=!1),!e)return"";var o=t.lang,s=t.props.dtFormats,a="short"==n,l=n?S(t,d(e),a):"",c=e.substr(8,2),u=""+parseInt(c),h=e.substr(5,2),p=parseInt(h),f=""+p,v="";r&&(v=D(t,p));var g=i?e.substr(0,4):"",m="";switch(s.date){case"dd.mm.yy":"de"==o?(n&&(m=l+", "),m+=c+"."+(v?" "+v+" ":h+".")+g):"pl"==o?(n&&(m=l+" "),m+=c+"."+(v?" "+v+" ":h+".")+g):(n&&(m=l+" "),m+=c+". "+(v?v+" ":h+". ")+g);break;case"yy.mm.dd":n&&(m=l+" "),i&&(m+=g+". "),m+=(v||h)+". "+c;break;case"m/d/yy":n&&(m=l+" "),m+=f+"/"+u,i&&(m+="/"+g);break;case"d/m/yy":n&&(m=l+" "),m+=u+"/"+f,i&&(m+="/"+g);break;case"dd/mm/yy":default:n&&(m=l+" "),m+=c+"/"+h,i&&(m+="/"+g)}for(;"."==m[0]||","==m[0];)m=m.substr(1);return m.trim()}function I(t,e,i){return void 0===i&&(i={}),e?T(t,e.substr(0,10),i.ajRok||null==i.ajRok,i.ajDenSlovom,i.ajMesiacSlovom)+" "+k(t,e.substr(11),i):""}function D(t,e,i){if(void 0===i&&(i={}),"string"==typeof e)return e?D(t,parseInt(e.substr(5,2)),i)+" "+e.substr(0,4):"";var n=t.ls(1710+e);return i.ucfirst&&(n=n.substr(0,1).toUpperCase()+n.substr(1)),n}t.Lib_date=r,t.date_js2sql=s,t.date_sql2js=a,t.datetime_js2sql=l,t.datetime_sql2js=function(t){return t?new Date(parseInt(t.substr(0,4),10),parseInt(t.substr(5,2),10)-1,parseInt(t.substr(8,2),10),parseInt(t.substr(11,2),10),parseInt(t.substr(14,2),10),parseInt(t.substr(17,2),10)):null},t.date_delta=c,t.date_diff=u,t.date_day=d,t.date_interval_array=h,t.date_month=function(t){return t?(10!=t.length&&ASC.dieError("3334885818"),t.substr(0,7)):""},t.month_delta=p,t.month_interval_array=function(t,e){for(var i=[],n=t;n<=e;n=p(n,1))i.push(n),1e3<i.length&&ASC.dieError("7117153443");return i},t.month_datefrom=f,t.month_dateto=function(t){return c(f(p(t,1)),-1)},t.date_parsedate=function(t,e){var i;if(!(e=e.trim()))return"";var n=t.props.dtFormats.date,r=n.includes("/")?"/":".",o=e.split(r).map(function(t){return parseInt(t)});if(3!=o.length)return"";for(var a=0,l=o;a<l.length;a++){var c=l[a];if(isNaN(c))return""}var u=o[0],d=o[1],h=o[2];if("y"==n[0]&&(h=o[0],u=o[1],d=o[2]),n.indexOf("d")>n.indexOf("m")&&(d=(i=[u,d])[0],u=i[1]),h<1e3||3e3<=h)return"";var p=new Date(h,d-1,u);return p.getDate()!=u||p.getMonth()!=d-1||p.getFullYear()!=h?"":s(p)},t.date_week=m,t.week_start=b,t.week_end=y,t.week_diff=function(t,e,i){return u(b(t,e),b(t,i))/7},t.week_delta=C,t.week_interval_array=_,t.week_year=$,t.date_day_name=S,t.date_isWeekend=w,t.date_format_date=x,t.date_format_2dates=A,t.date_format_dates=function(t,e,i){void 0===i&&(i={}),(e=n.__spreadArrays(e)).sort();for(var r=[],o="",s="",a=0,l=e;a<l.length;a++){var u=l[a];o?c(u,-1)==s?s=u:(r.push(A(t,o,s,i.ajRok)),o=s=u):o=s=u}return o&&r.push(A(t,o,s,i.ajRok)),r.join(", ")},t.date_format_time0=k,t.date_format_2times=j,t.date_format_day=T,t.date_format_time=I,t.month_name=D,t.date_time_delta=function(t,e,i){return t.timezone_datetime(t.timezone_datetime2int(e)+i)},t.time2minutes=function(t){if(!t)return-1;var e=60*parseInt(t.substr(0,2))+parseInt(t.substr(3,2));return 8<=t.length&&(e+=parseInt(t.substr(6,2))/60),e},t.minutes2time=function(t){if(t<0)return"";var e=Math.floor(t/60),i=Math.floor(t%60);return(e<10?"0":"")+e+":"+(i<10?"0":"")+i},t.datetime_join=function(t,e){return t&&e?(5==e.length&&(e+=":00"),t+" "+e):""},t.date_isdate=function(t){return"string"==typeof t&&/^[0-9]{4}-(0[1-9]|1[0-2])-([0-2][0-9]|3[0-1])$/.test(t)}}});