"use strict";ASC.installBundle("ttonline_base",["subst","dbi"],{"/timetable/app/online.js":function(t,e,i){t.__esModule=!0;var n,o,r=e("tslib"),a=e("react"),s=e("./rozview"),l=e("./tview"),c=e("./print"),m=e("./rokobject"),h=e("../../asc/asc_react"),_=e("../../asc/edurequest"),u=e("../../asc/actions"),d=e("./server/generator"),p=e("../../asc/asc_react2"),f=e("../timeoff_r");function v(t){t||ASC.logProblem("9576331351",t)}(o=n=n||{})[o.KONTROLAMODE_VYPNUTA=0]="KONTROLAMODE_VYPNUTA",o[o.KONTROLAMODE_KONTROLA=1]="KONTROLAMODE_KONTROLA",o[o.KONTROLAMODE_PODMIENKY=2]="KONTROLAMODE_PODMIENKY",o[o.KONTROLAMODE_CHANGE=3]="KONTROLAMODE_CHANGE",o[o.KONTROLAMODE_RUCNEINFO=4]="KONTROLAMODE_RUCNEINFO",o[o.KONTROLAMODE_PO_RIES=5]="KONTROLAMODE_PO_RIES",o[o.KONTROLAMODE_ADVISOR=6]="KONTROLAMODE_ADVISOR",t.startTTOnline=function(t,e){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(i){switch(i.label){case 0:return[4,ASC.loadTTLang()];case 1:return i.sent(),new b(t).Sync(e),[2]}})})},t.farby=[];var b=(y.get=function(){return document.getElementsByClassName("ttonline")[0].previousSibling.ASC_gjsc.app},y.prototype.checkPurchased=function(){return r.__awaiter(this,void 0,void 0,function(){var t,i=this;return r.__generator(this,function(n){switch(n.label){case 0:return this.jsc.unregistered?(t=_.client_req,[4,h.RDialog.show(a.createElement(h.RDialog,{width:400,buttons:[{label:t.ttls(2797),type:"green",onClick:function(){return r.__awaiter(i,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("../../asc/purchase")})];case 1:return[4,t.sent().showPurchaseEdupage()];case 2:return[2,t.sent()]}})})}},"cancel"]},a.createElement(p.DlgHeader,{title:t.ttls(2061),small:!0,icon:"/timetable/pics/app/office/purchase_32.png"}),a.createElement("div",null,t.ls(2016))))]):[2,!0];case 1:return n.sent(),[2,!1]}})})},y.prototype.trackEvent=function(t,e){if(!this.ttviewer){var i=window.ga;i&&("App"==t&&"initialized"==e?(i("ttonlineTracker.send","pageview"),i("ttonlineTracker.send","event",t,e,null,null,{nonInteraction:!0})):i("ttonlineTracker.send","event",t,e))}},y.prototype.InitRibbon_back=function(t){var e=this;new ASC.ui.RibbonButton(t,ASC.ls(1748),A.GetImage("back_32"),function(){e.ribbonMenu.select("main")})},y.prototype.InitRibbon_file=function(t,e){var i=this;new ASC.ui.RibbonButton(t,ASC.ls(6133),A.GetImage("file_new_32"),function(){i.ClickNew()}),new ASC.ui.RibbonButton(t,ASC.ls(6370),A.GetImage("open_32"),function(){h.openUrl("/timetable/admin.php")}),"file"==e&&this.InitRibbon_close(t),new ASC.ui.RibbonButton(t,ASC.ttls(2577),A.GetImage("save_32"),null,{menu:[{text:ASC.escapeHTML(ASC.ttls(2577)),onclick:function(){i.click_func("save")}},{text:ASC.escapeHTML(ASC.ttls(1589).replace("&","")),onclick:function(){i.click_func("save","saveas=1")}}]})},y.prototype.InitRibbon_demos=function(t){var i=this;new ASC.ui.RibbonButton(t,ASC.ttls(3045),A.GetImage("demofiles_32"),function(){return r.__awaiter(i,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("../demofiles")})];case 1:return t.sent().showTTDemoFiles(),[2]}})})})},y.prototype.InitRibbon_feedback=function(t){var e=this,i=_.client_req;new ASC.ui.RibbonButton(t,ASC.ls(1593),A.GetImage("help_32"),function(){"tr"==i.school_country?h.openUrl("https://ascturkiye.com/Index.aspx?cpc=4"):e.click_func("feedback")})},y.prototype.InitRibbon_close=function(t){var e=this;new ASC.ui.RibbonButton(t,ASC.ls(1567),A.GetImage("close_32"),function(){e.click_func("close")})},y.prototype.InitRibbon=function(){var t,i,n=this,o=_.client_req,s=this.ttgpid;if(!this.ttviewer){var l=function(t){new ASC.ui.RibbonButton(i,A.GetTableName(t),A.GetTableIcon(t),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(i){switch(i.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return e("./zadanie")})];case 1:return i.sent().showZadanieDlg(s,{table:t}),[2]}})})})};t=this.ribbonMenu.addRibbon("main",ASC.ttls(3222).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_file(i,"main"),this.jsc.ttfeedbackid&&new ASC.ui.RibbonButton(i,"FEEDBACK info",A.GetImage("print_preview_32"),function(){n.click_func("ttfeedback")},{}),new ASC.ui.RibbonButton(i,ASC.ttls(3351),A.GetImage("print_preview_32"),function(){n.ClickPrintPreview()},{cmd:"printpreview"}),i=new ASC.ui.RibbonGroup(t),this.$rg_pohlad_div=$j(i.addDiv()).css("margin-top","2px"),i=new ASC.ui.RibbonGroup(t),["subjects","classes","classrooms","teachers"].forEach(function(t){return l(t)}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3263),A.GetImage("seminar_32"),function(){return r.__awaiter(n,void 0,void 0,function(){var t=this;return r.__generator(this,function(i){switch(i.label){case 0:return 0!=this.m_pRok.TableObjects("students").length?[3,2]:[4,h.RDialog.showConfirm(a.createElement(a.Fragment,null,a.createElement("h1",null,ASC.ttls(2610)),a.createElement("span",{style:{whiteSpace:"pre-wrap"}},ASC.ttls(3258)+" "+ASC.ttls(3259),": ",a.createElement("a",{onClick:function(){return t.ShowHelp("seminarsdialog")},style:{cursor:"pointer"}},ASC.ttls(3263)))),{buttons:[{label:ASC.ttls(3260),action:"ok",type:"green"},"cancel"],width:400})];case 1:if(!i.sent())return[2];i.label=2;case 2:return[4,Promise.resolve().then(function(){return e("./students_dlg")})];case 3:return i.sent().showStudentsDlg(s),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(2614),A.GetImage("relation_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return e("./vztahy")})];case 1:return t.sent().showVztahyDlg(s),[2]}})})}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(2047),A.GetImage("test_32"),function(){n.ClickTest()}),new ASC.ui.RibbonButton(i,ASC.ttls(1090),A.GetImage("gener_32"),function(){n.ZrusKontrolu(),n.ClickGenerate()}),new ASC.ui.RibbonButton(i,o.ttls(4382),A.GetImage("gener_cloud_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./cloudgenerator")})];case 1:return t.sent().onClickCloudGenerator({ttgpid:s}),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(1616),A.GetImage("verification_32"),function(){n.ClickVerification("verification")},{cmd:"verification"}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3148),A.GetImage("school_32"),function(){n.ZrusKontrolu(),Promise.resolve().then(function(){return e("./school")}).then(function(t){return t.showSchoolDlg(s)})}),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_feedback(i),i=new ASC.ui.RibbonGroup(t),!ASC.ascdebug&&"ascpalo"!=ASC.edupage||(this.m_pSync.$debug=$j(i.addDiv())),i=new ASC.ui.RibbonGroup(t,{right:!0}),this.InitRibbon_close(i),t=this.ribbonMenu.addRibbon("files",ASC.ttls(1572).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_file(i,"file"),this.InitRibbon_demos(i),i=new ASC.ui.RibbonGroup(t);var c=[];c.push({text:"Edupage - "+o.ls(1394),onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./import")})];case 1:return[2,t.sent().showImportEdupage(s)]}})})}}),c.push({text:"Edupage - "+o.ls(1001)+" (beta)",onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./import")})];case 1:return[2,t.sent().showImportOtherTimetable(s)]}})})}}),c.push({text:o.ttls(2793),onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./import")})];case 1:return[2,t.sent().showImportClipboard(s)]}})})}}),c.push({text:o.ttls(1079)+" XML",onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./import")})];case 1:return[2,t.sent().showImportXML(s)]}})})}}),c.push([]),"de"!=o.school_country&&!o.props.ascdevelop||c.push({text:"Winprosa (beta)",onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./import")})];case 1:return[2,t.sent().showImportWinprosa(s)]}})})}}),new ASC.ui.RibbonButton(i,ASC.ls(1422),A.GetImage("import_32"),null,{menu:c});var m=[];m.push({text:o.ttls(1079)+" (*.roz)",onclick:function(){ASC.blockUI(function(){return r.__awaiter(n,void 0,void 0,function(){var t,i;return r.__generator(this,function(n){switch(n.label){case 0:return i=(t=window).open,[4,Promise.resolve().then(function(){return e("./server/generator")})];case 1:return[4,n.sent().rozExportDownloadLink(null,s)];case 2:return i.apply(t,[n.sent(),"_blank"]),[2]}})})})}}),m.push([]),m.push({text:"aSc Timetables XML",onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,this.checkPurchased()];case 1:return t.sent()?[4,Promise.resolve().then(function(){return e("./export ")})]:[3,3];case 2:t.sent().showExportAscTimetablesXML(s),t.label=3;case 3:return[2]}})})}}),m.push([]),m.push({text:o.ttls(1e3)+" - "+o.ttls(1008),onclick:function(){ASC.blockUI(function(){return r.__awaiter(n,void 0,void 0,function(){var t,i;return r.__generator(this,function(n){switch(n.label){case 0:return i=(t=window).open,[4,Promise.resolve().then(function(){return e("./server/export")})];case 1:return[4,n.sent().excelExportDownloadLink(null,s,"contracts")];case 2:return i.apply(t,[n.sent(),"_blank"]),[2]}})})})}}),m.push([]),m.push({text:"GP-Untis DIF ("+ASC.ls(1001)+")",onclick:function(){ASC.blockUI(function(){return r.__awaiter(n,void 0,void 0,function(){var t,i;return r.__generator(this,function(n){switch(n.label){case 0:return i=(t=window).open,[4,Promise.resolve().then(function(){return e("../../exports/de/server/untis_DIF")})];case 1:return[4,n.sent().untisDIFExportDownloadLink(null,s)];case 2:return i.apply(t,[n.sent(),"_self"]),[2]}})})})}}),m.push({text:"Atlantis (STDPLAN) - beta",onclick:function(){ASC.blockUI(function(){return r.__awaiter(n,void 0,void 0,function(){var t,i;return r.__generator(this,function(n){switch(n.label){case 0:return i=(t=window).open,[4,Promise.resolve().then(function(){return e("../../exports/de/server/atlantis_stdplan")})];case 1:return[4,n.sent().atlantisSTDPLANExportDownloadLink(null,s)];case 2:return i.apply(t,[n.sent(),"_self"]),[2]}})})})}}),m.push({text:"PowerSchool(Pearson) Excel Export",onclick:function(){ASC.blockUI(function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("../../exports/powerschool")})];case 1:return t.sent().showPowerSchoolExport(s),[2]}})})})}}),m.push({text:"NYC Excel Export",onclick:function(){ASC.blockUI(function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("../../exports/us/nyc_excel")})];case 1:return t.sent().showNYCExcelExport(s),[2]}})})})}}),"de"!=o.school_country&&!o.props.ascdevelop||(m.push({text:"Winprosa (beta)",onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./export ")})];case 1:return[2,t.sent().showExportWinprosa(s)]}})})}}),m.push({text:"KÃ¶ln UniterrichtsImport Schild (beta)",onclick:function(){return ASC.blockUI(function(){return r.__awaiter(n,void 0,void 0,function(){var t,i;return r.__generator(this,function(n){switch(n.label){case 0:return i=(t=window).open,[4,Promise.resolve().then(function(){return e("../../exports/de/server/kolin_schild")})];case 1:return[4,n.sent().kolinSchildExportDownloadLink(null,s)];case 2:return i.apply(t,[n.sent(),"_self"]),[2]}})})})}})),0<=["ascpalo","gsg-waldkirch-test","schillertest2"].indexOf(o.edupage)&&m.push({text:"ASV - Stundenplanprogramm->ASV",onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("../../exports/de_bw/asv_stdplan")})];case 1:return[2,t.sent().showExportStdplan(s)]}})})}}),["ascpalo","dasman","greenfieldsch"].includes(o.edupage)&&m.push({text:"Timetabler TTExport.TXT",onclick:function(){ASC.blockUI(function(){return r.__awaiter(n,void 0,void 0,function(){var t,i;return r.__generator(this,function(n){switch(n.label){case 0:return i=(t=window).open,[4,Promise.resolve().then(function(){return e("../../exports/server/timetabler")})];case 1:return[4,n.sent().timetableTTExportDownloadLink(null,s)];case 2:return i.apply(t,[n.sent(),"_self"]),[2]}})})})}}),new ASC.ui.RibbonButton(i,ASC.ls(1701),A.GetImage("export_32"),null,{menu:m}),new ASC.ui.RibbonButton(i,ASC.ttls(2819),A.GetImage("compare_32"),null,{menu:[{text:ASC.ttls(2820),onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./compare")})];case 1:return t.sent().showCompareDoc(this),[2]}})})}},{text:ASC.ttls(2821),onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./compare")})];case 1:return t.sent().showCompareDoc(this,!0),[2]}})})}}]}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3351),A.GetImage("print_preview_32"),function(){n.ClickPrintPreview()},{cmd:"printpreview"}),t=this.ribbonMenu.addRibbon("specification",ASC.ttls(1598).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(1599),A.GetImage("wizard_32"),function(){n.ZrusKontrolu(),Promise.resolve().then(function(){return e("./wizard")}).then(function(t){return t.showWizard(s)})}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3148),A.GetImage("school_32"),function(){n.ZrusKontrolu(),Promise.resolve().then(function(){return e("./school")}).then(function(t){return t.showSchoolDlg(s)})}),["subjects","classes","classrooms","teachers"].forEach(function(t){return l(t)}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(2614),A.GetImage("relation_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return e("./vztahy")})];case 1:return t.sent().showVztahyDlg(s),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(3719),A.GetImage("constraints_32"),function(){n.ClickVerification("listconstraints")},{cmd:"listconstraints"}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,A.GetTableName("lessons"),A.GetTableIcon("lessons"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return e("./lesson_dlg")})];case 1:return t.sent().showLessonsDlg(s),[2]}})})}),t=this.ribbonMenu.addRibbon("view",ASC.ttls(1149).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,A.StripStringTab(ASC.ttls(2629)),A.GetImage("undo_32"),function(){n.click_func("undo")},{mini:!1,id:"undo"}),new ASC.ui.RibbonButton(i,A.StripStringTab(ASC.ttls(2630)),A.GetImage("redo_32"),function(){n.click_func("undo","redo=1")},{mini:!1,id:"redo"}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,A.StripStringTab(ASC.ttls(3117)),A.GetImage("show_tabs_32"),function(){n.m_pPohladSwitcher.SetEnabled(!n.m_pPohladSwitcher.m_bEnabled)}),new ASC.ui.RibbonButton(i,ASC.ttls(2551),A.GetImage("zoom_32"),null,{menu:[{text:"50%",onclick:function(){n.Zoom("50%")}},{text:"100%",onclick:function(){n.Zoom("100%")}},{text:"200%",onclick:function(){n.Zoom("200%")}},[],{text:ASC.ttls(2551)+" +",onclick:function(){n.Zoom("+")}},{text:ASC.ttls(2551)+" -",onclick:function(){n.Zoom("-")}},[],{text:ASC.ttls(2829),onclick:function(){n.Zoom("/")}}]}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,A.StripStringTab(ASC.ttls(3303)),A.GetImage("view_define_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./dlg")})];case 1:return t.sent().showItemDlg(s,"ttviews",this.m_pTriedyView.m_pAktPohlad.m_Id),[2]}})})}),t=this.ribbonMenu.addRibbon("timetable",ASC.ttls(1502).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(2047),A.GetImage("test_32"),function(){n.ClickTest()}),new ASC.ui.RibbonButton(i,ASC.ttls(1090),A.GetImage("gener_32"),function(){n.ClickGenerate()}),new ASC.ui.RibbonButton(i,ASC.ttls(1613),A.GetImage("improve_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,this.checkPurchased()];case 1:return t.sent()?[4,Promise.resolve().then(function(){return e("./gener")})]:[3,3];case 2:t.sent().showImprove(s),t.label=3;case 3:return[2]}})})}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(1615),A.GetImage("parameters_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return e("./constraints")})];case 1:return t.sent().showTTDocConstraintsDlg(s,"globals","1"),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(3719),A.GetImage("constraints_32"),function(){n.ClickVerification("listconstraints")},{cmd:"listconstraints"}),new ASC.ui.RibbonButton(i,ASC.ttls(1616),A.GetImage("verification_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){return this.ClickVerification("verification"),[2]})})},{cmd:"verification"}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(1617),A.GetImage("assignclassrooms_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return e("./gener")})];case 1:return t.sent().showAssignClassrooms(s),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(1618),A.GetIconLocked(!0),function(){n.ZrusKontrolu(),n.click_func("cards","cmd=lock")}),new ASC.ui.RibbonButton(i,ASC.ttls(1619),A.GetIconLocked(!1),function(){n.ZrusKontrolu(),n.click_func("cards","cmd=unlock")}),new ASC.ui.RibbonButton(i,ASC.ttls(1201),A.GetImage("remove_32"),function(){n.ZrusKontrolu(),n.click_func("cards","cmd=delete")}),t=this.ribbonMenu.addRibbon("options",ASC.ttls(1578).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3148),A.GetImage("school_32"),function(){n.ZrusKontrolu(),Promise.resolve().then(function(){return e("./school")}).then(function(t){return t.showSchoolDlg(s)})}),new ASC.ui.RibbonButton(i,ASC.ttls(2968),"/static/pics/classroom_32.png",function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return e("./zadanie")})];case 1:return t.sent().showZadanieDlg(s,{table:"buildings"}),[2]}})})}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,u.action_name("tools"),u.action_icon("tools"),null,{menu:[{text:ASC.ttls(3296),onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./tools")})];case 1:return[2,t.sent().showMoveLessonsDlg(s)]}})})}},{text:ASC.ls(1641),onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./zadanie")})];case 1:return[2,t.sent().showZadanieDlg(s,{table:"ttreports"})]}})})}}]}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3316),A.GetImage("settings_basic_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return e("./settings")})];case 1:return t.sent().showSettingsDlg(s),[2]}})})}),t=this.ribbonMenu.addRibbon("help",ASC.ttls(2634).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_demos(i),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3204),A.GetImage("onlinehelp_32"),function(){var t="https://help.asctimetables.com/";"tr"==o.school_country&&(t="https://help.ascturkiye.com/"),window.open(t,"_blank")}),this.InitRibbon_feedback(i),this.jsc.asc_menu&&(i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,"ASC tools","/agenda/pics/online/files_back_32.png",null,{menu:r.__spreadArrays(this.jsc.asc_menu,[[],{text:"New dbForGen",onclick:function(){return r.__awaiter(n,void 0,void 0,function(){var t,i;return r.__generator(this,function(n){switch(n.label){case 0:return i=(t=console).log,[4,Promise.resolve().then(function(){return e("./server/generator")})];case 1:return[4,n.sent().ttdocDbForGen(null,s)];case 2:return[2,i.apply(t,[n.sent()])]}})})}},{text:"Restore deleted snapshot",onclick:function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./tools")})];case 1:return[2,t.sent().showRestoreDeletedSnapshotDlg()]}})})}},{text:"Anonymize TT",onclick:function(){return Promise.resolve().then(function(){return e("./asctools")}).then(function(t){return t.showAnonymizeTT(s)})}}])})),i=new ASC.ui.RibbonGroup(t,{right:!0}),this.InitRibbon_close(i)}if(t=this.ribbonMenu.addRibbon("printpreview",ASC.ttls(3351)),this.ribbonMenu.$labels.printpreview.addClass("special"),this.ribbonMenu.$labels.printpreview.hide(),this.ttviewer||(i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3349).replace(" ","\n"),A.GetImage("preview_back_32"),function(){n.m_pPrintPreview.PrevPage()},{cmd:"printpreview_prev"}),new ASC.ui.RibbonButton(i,ASC.ttls(3350).replace(" ","\n"),A.GetImage("preview_forward_32"),function(){n.m_pPrintPreview.NextPage()},{cmd:"printpreview_next"})),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ls(1638).replace(" ","\n"),A.GetImage("printer_32"),function(){n.m_pPrintPreview.Print()}),this.$rg_printpreview_div=$j(i.addDiv()).css("width","250px"),this.ttviewer||(i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3508),A.GetImage("filter_32"),function(){n.m_pPrintPreview.ClickFilter()}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3343),A.GetImage("preview_global_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./print_settings")})];case 1:return t.sent().showPrintGlobalSettingsDlg(s,this.m_pPrintPreview.m_pTlacZostava.m_Id),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(3342),A.GetImage("preview_modify_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./print_settings")})];case 1:return t.sent().showPrintStructureDlg(s,this.m_pPrintPreview.m_pTlacZostava.m_Id),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(3344),A.GetImage("preview_extracolumns_32"),function(){return r.__awaiter(n,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./extracolumns")})];case 1:return t.sent().showExtraColumnsDlg(s,this.m_pPrintPreview.m_pTlacZostava.m_Id),[2]}})})}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(1324),A.GetImage("preview_style_32"),function(){n.click_func("print_style")}),new ASC.ui.RibbonButton(i,ASC.ttls(3345),A.GetImage("preview_sizes_32"),function(){n.click_func("print_sizes","tzid="+n.m_pPrintPreview.m_pTlacZostava.m_Id)}),new ASC.ui.RibbonButton(i,ASC.ttls(3124),A.GetImage("preview_design_32"),function(){n.click_func("print_design","tzid="+n.m_pPrintPreview.m_pTlacZostava.m_Id)}),new ASC.ui.RibbonButton(i,ASC.ttls(3346),A.GetImage("preview_color_32"),function(){n.click_func("print_colors","tzid="+n.m_pPrintPreview.m_pTlacZostava.m_Id)}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3348),A.GetImage("turn_off_32"),function(){n.ZrusPrintPreview()})),this.ttviewer){t=this.ribbonMenu.addRibbon("ttviewer","Timetable viewer (aSc)"),this.ribbonMenu.$labels.ttviewer.addClass("special"),this.ribbonMenu.$labels.ttviewer.hide(),this.ttviewer_ribbon=t,i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ls(1170),A.GetImage("preview_back_32"),function(){n.m_pPrintPreview.PrevPage()},{mini:!0,cmd:"printpreview_prev"}),new ASC.ui.RibbonButton(i,ASC.ls(1171),A.GetImage("preview_forward_32"),function(){n.m_pPrintPreview.NextPage()},{mini:!0,cmd:"printpreview_next"}),this.ttviewer_options.kiosk||new ASC.ui.RibbonButton(i,ASC.ls(1638).replace(" ","\n"),A.GetImage("printer_32"),function(){n.m_pPrintPreview.Print({selected_page:!0})},{mini:!0}),i=new ASC.ui.RibbonGroup(t);for(var d=0,p=["subjects","classes","teachers","classrooms","students"];d<p.length;d++){var f=p[d];new ASC.ui.RibbonButton(i,A.GetTableName(f),A.GetTableIcon(f),null,{menu:[],cmd:"ttviewer_"+f})}i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ls(1250),"/global/pics/ui/summarytt_32.png",null,{menu:[],cmd:"ttviewer_summary"}),this.ttviewer_options.version_menu&&(i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,this.ttviewer_options.version_menu_label,"/global/pics/ui/ttversion_32.png",null,{menu:this.ttviewer_options.version_menu})),0<=["ascpalo","democz","test-democz","gjj","gvmyto","skolabn","spschrudim","zsnezamyslice","zsbrankovice"].indexOf(_.client_req.edupage)||["de","cz","at","ch","sk"].indexOf(_.client_req.school_country),this.ttviewer_options&&!this.ttviewer_options.kiosk&&(i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,_.client_req.ls(3964),"/global/pics/ui/try_new_32.svg",function(){return r.__awaiter(n,void 0,void 0,function(){var t,e;return r.__generator(this,function(i){switch(i.label){case 0:switch(e="",_.client_req.lang){case"sk":t=a.createElement("div",null,"DovoÄ¾te, aby sme vÃ¡m predstavili novÃ© zobrazenie rozvrhu. Odteraz v Åˆom neuvidÃ­te len Å¡tandardnÃ½ rozvrh, ale aj udalosti, suplovanie a odpadnutÃ© hodiny. Dokonca aj krÃºÅ¾ky a Å¡kolskÃ½ klub detÃ­ si viete jednoducho zobraziÅ¥ v pohÄ¾ade uÄiteÄ¾, Å¾iak, trieda. Tento novÃ½ pohÄ¾ad postupne nahradÃ­ ten pÃ´vodnÃ½.",a.createElement("br",null),"TeÅ¡Ã­me sa na vaÅ¡e postrehy."),e="https://help.edupage.org/text.php?id=3161&lang=sk";break;case"cz":t=a.createElement("div",null,"Dovolte, abychom vÃ¡m pÅ™edstavili novÃ© zobrazenÃ­ rozvrhu. OdteÄ v nÄ›m neuvidÃ­te jen standardnÃ­ rozvrh, ale i udÃ¡losti, suplovÃ¡nÃ­ a odpadlÃ© hodiny. Dokonce i krouÅ¾ky a Å¡kolnÃ­ klub dÄ›tÃ­ si umÃ­te jednoduÅ¡e zobrazit v pohledu uÄitel, Å¾Ã¡k, tÅ™Ã­da. Tento novÃ½ pohled postupnÄ› nahradÃ­ ten pÅ¯vodnÃ­. ",a.createElement("br",null),"TÄ›Å¡Ã­me se na vaÅ¡e postÅ™ehy."),e="https://help.edupage.org/text.php?id=3161&lang=sk";break;case"de":t=a.createElement("div",null,"Es ist soweit! Wir freuen uns, Ihnen hier unsere neue Stundenplanansicht zu prÃ¤sentieren.",a.createElement("br",null),"Ab sofort sehen Sie nicht nur die Stunden aus dem Stundenplan, sondern auch Termine, Vertretungen und entfallene Stunden. Auch die Interessensgruppen/AGs sehen Sie in der Lehrer-, SchÃ¼ler und Klassenansicht auf einen Blick. In KÃ¼rze wird diese Ansicht die alte Ansicht ersetzen.",a.createElement("br",null),"Wir freuen uns auf Ihr Feedback. (asc@raabe.de)"),e="https://help.edupage.org/text.php?id=3161&lang=de";break;default:t=a.createElement("div",null,"Let us introduce you to the new timetable viewer. From now you will not only be be able to view the standard timetable lessons but also events, substitution or cancelled lessons. Even interest or after-schoool clubs are available in the teacher, student or class view. This new viewer will eventualy replace the original one."),e="https://h.edupage.org/?p=u1/u3/u338/e3161"}return[4,h.RDialog.showConfirm(t,{width:500,footer:e&&(_.client_req.isAdmin()||_.client_req.isUcitel())?a.createElement(h.RButton,{label:u.action_name("help"),onClick:function(){return window.open(e,"_blank")}}):void 0})];case 1:return i.sent()&&(document.location.href="/timetable/current.php"),[2]}})})}))}this.ttviewer&&this.ribbonMenu.$top.hide()},y.prototype.UpdateButtons=function(){},y.prototype.ClickNew=function(){window.open("/timetable/online.php?cmd=new","_blank")},y.prototype.click_func=function(t,e){if(void 0===e&&(e=""),e+="&sync="+JSON.stringify(this.m_pSync.SendSyncData()),!this.m_pRadSelector.JeCelok()){for(var i=[],n=0,o=this.m_pRadSelector.m_Objects;n<o.length;n++){var r=o[n];i.push(r.m_Table+":"+r.m_Id)}e+="&rad_sel="+i.join(",")}this.ASC_action(t,e)},y.prototype.Sync=function(t){var e=this;"modified"in t&&(this.m_bModified=t.modified),"name"in t&&(this.m_DocName=t.name),"ss_ver"in t&&(this.m_ss_ver=t.ss_ver),this.m_pSync.ReceiveSyncData(t),this.UpdateWindowTitle(),this.ttviewer||(t.ce_ttdoc_last&&ASC.changeEvents.on(this.$content_d,"ttdoc:"+this.ttgpid,function(){e.SyncNow()},t.ce_ttdoc_last),t.ce_ttnum_last&&t.ttnum&&ASC.changeEvents.on(this.$content_d,"ttnum:"+t.ttnum,function(){e.SyncNow()},t.ce_ttnum_last))},y.prototype.SyncNow=function(){var t=this;return new Promise(function(e){t.jsc.closing?console.log("can't sync, closing."):(t.m_pSync.SetNeedsSync(),t.m_pSync.m_SyncCallbacks.push(e),t.m_pSync.SyncIfNeeded())})},y.prototype.OnResize=function(){},y.prototype.OnKeyDown=function(t){switch(t.keyCode){case 32:ASC.isBlockedUI()||this.ClickVerification("verification");break;case 65:if(t.ctrlKey)break;return!1;case 83:case 83:if(t.ctrlKey){this.click_func("save");break}return!1;case 84:if(t.ctrlKey){this.m_pPohladSwitcher.SetEnabled(!this.m_pPohladSwitcher.m_bEnabled);break}return!1;case 89:if(t.ctrlKey){this.click_func("undo","redo=1");break}return!1;case 90:if(t.ctrlKey){this.click_func("undo");break}return!1;default:return!1}return t.preventDefault(),t.stopPropagation(),!0},y.prototype.Zoom=function(t){this.m_pTriedyView.Zoom(t)},y.prototype.PodKurzorom=function(t){this.m_PodKurzoromMHodina.Equals(t)||(this.m_PodKurzoromMHodina.Set(t),this.m_pRozView.m_bInvalidPodKurzorom=!0,this.m_pTriedyView.m_bPreviewPodKurzorom&&(this.m_pTriedyView.m_bInvalidFarbyStlpcov=!0),this.Invalidate())},y.prototype.PodKurzoromClear=function(){var t=new l.CMHodina(this.m_pRok);this.PodKurzorom(t)},y.prototype.SetPreviewPodKurzorom=function(t){t!=this.m_pTriedyView.m_bPreviewPodKurzorom&&(this.m_pTriedyView.m_bPreviewPodKurzorom=t,this.m_pTriedyView.m_bInvalidFarbyStlpcov=!0,this.Invalidate())},y.prototype.OdhodKartu=function(){var t=new l.CMHodina(this.m_pRok);this.Chyt(t)},y.prototype.Chyt=function(t){this.PodKurzoromClear(),t.Equals(this.m_TahanaMHodina)||(this.m_TahanaMHodina.Set(t),this.InvalidateTahanaMHodina(),this.m_bTahanaDajKontrolu=!1)},y.prototype.ChytKartu=function(t,e){if(t){var i=new l.CMHodina(this.m_pRok);null!=e&&i.SetPozicia(e),i.Add(t),i.FinishAdding(),this.Chyt(i)}else this.OdhodKartu()},y.prototype.ChytKarty=function(t,e){if(0!=t.length){var i=new l.CMHodina(this.m_pRok);null!=e&&i.SetPozicia(e),i.Add_array(t),i.FinishAdding(),this.Chyt(i)}else this.OdhodKartu()},y.prototype.ChytSeminar=function(t,e){},y.prototype.SelectRiadok=function(t){this.m_pRadSelector.SetCelok(),t&&this.m_pRadSelector.AddRadObject(t)},y.prototype.ScrollToRiadok=function(t){if(t){var e=this.m_pTriedyView,i=e.GetPohladForTable(t.m_Table);i&&i!=e.m_pAktPohlad&&e.SetAktPohlad(i);var n=e.m_Riadky.find(function(e){return e.m_pRokObject==t});n&&e.ScrollToRiadky([n])}},y.prototype.InvalidateTahanaMHodina=function(){this.UpdateCursor(),this.m_pTriedyView.m_bInvalidFarbyRiadkov=!0,this.m_pTriedyView.m_bInvalidFarbyStlpcov=!0,this.Invalidate()},y.prototype.UpdateCursor=function(){var t=this.m_TahanaMHodina;if(!this.Cursor_Canvas){var e=ASC.createChild(document.body,"canvas","","display:none;position:absolute; pointer-events:none; z-index:1");this.Cursor_Canvas=e,this.Cursor_Canvas.width=32,this.Cursor_Canvas.height=32}if(t.IsEmpty())this.Cursor_Canvas.style.display="none",this.$content_d.css("cursor","default");else{var i=this.Cursor_Canvas.getContext("2d"),n=Math.min(this.m_pTriedyView.m_nSirkaPolicko,this.Cursor_Canvas.width-2),o=Math.min(this.m_pTriedyView.m_nVyskaRiadok,this.Cursor_Canvas.height-2);this.Cursor_Hotspot[0]=1+n/2,this.Cursor_Hotspot[1]=1+o/2,i.globalCompositeOperation="destination-out",i.fillRect(0,0,this.Cursor_Canvas.width,this.Cursor_Canvas.height),i.globalCompositeOperation="source-over",i.fillStyle="#808080",i.fillRect(0,0,n+2,o+2),i.globalCompositeOperation="destination-out",i.fillRect(1,1,n,o),i.globalCompositeOperation="source-over",this.m_pTriedyView.PaintMH(i,1,1,n,o,t);var r=this.$content_d.get(0),a="url("+this.Cursor_Canvas.toDataURL()+") "+this.Cursor_Hotspot[0]+" "+this.Cursor_Hotspot[1]+", crosshair";r.style.cursor=a}document.body.style.cursor="default"},y.prototype.CursorMove=function(t){this.CursorMove_Event=t,this.CursorMove_Validate()},y.prototype.CursorMove_Validate=function(){if(null!=this.CursorMove_Event){var t=this.CursorMove_Event;t.clientX,t.clientY,this.Cursor_Canvas&&(this.$content_d.css("cursor"),this.Cursor_Canvas.style.display="none"),this.CursorMove_Event=null}},y.prototype.InvalidateKarta=function(t,e){var i=new l.CMHodina(this.m_pRok);i.Add(t),i.FinishAdding(),this.InvalidateMHodina(i,e)},y.prototype.InvalidateDozor=function(t,e){this.m_pTriedyView.InvalidateObject(t.m_pUcebna),t.m_pUcitel&&this.m_pTriedyView.InvalidateObject(t.m_pUcitel),this.Invalidate(),e||this.m_pSync.AddLocalChange(t)},y.prototype.InvalidateHodina=function(t){var e=this;t.m_Karty.forEach(function(t){e.InvalidateKarta(t)})},y.prototype.InvalidateObject=function(t,e){t&&(t instanceof m.CKarta?this.InvalidateKarta(t,e):t instanceof m.CDozor?this.InvalidateDozor(t,e):t instanceof m.CHodina?this.InvalidateHodina(t):t instanceof m.CZiakPredmet?this.InvalidateObject(t.m_pZiak,e):(t instanceof S&&this.InvalidatePohladSwitcher(),this.m_pTriedyView.InvalidateObject(t)),0<=["ttreports","periods","breaks","cards","subjects"].indexOf(t.m_Table)&&this.InvalidatePrintPreview(),"globals"==t.m_Table&&this.InvalidatePrintPreview(),"classrooms"==t.m_Table&&this.m_pTriedyView.JePohladDozory()&&this.InvalidateTriedyView(),this.Invalidate(),e||this.m_pSync.AddLocalChange(t))},y.prototype.InvalidatePending=function(){this.m_pRozView.m_bInvalid=!0,this.Invalidate()},y.prototype.InvalidateTriedyView=function(){this.m_pTriedyView.m_bInvalidAll=!0,this.Invalidate()},y.prototype.InvalidateTriedyViewRiadky=function(){for(var t=0,e=this.m_pTriedyView.m_Riadky;t<e.length;t++)e[t].m_bInvalid=!0;this.Invalidate()},y.prototype.InvalidatePohladSwitcher=function(){this.m_pPohladSwitcher.m_bInvalid=!0,this.Invalidate()},y.prototype.InvalidatePrintPreview=function(){this.m_pPrintPreview&&(this.m_pPrintPreview.m_bInvalid=!0,this.Invalidate())},y.prototype.InvalidateSelector=function(){this.m_pTriedyView.m_bInvalidFarbyRiadkov=!0,this.InvalidatePending()},y.prototype.InvalidateMHodina=function(t,e){if(this.m_pTriedyView.InvalidateMHodina(t),this.m_pRozView.m_bInvalid=!0,this.Invalidate(),!e){for(var i=0,n=t.Karty();i<n.length;i++){var o=n[i];this.m_pSync.AddLocalChange(o)}for(var r=0,a=t.Hodiny();r<a.length;r++){var s=a[r];1<s.m_pObdobie.terms.m_BitovePole.length&&this.m_pSync.AddLocalChange(s)}}},y.prototype.Validate=function(){this.CursorMove_Validate(),this.m_pPohladSwitcher.Validate(),this.m_pTriedyView.Validate(),this.m_pRozView.Validate(),this.m_pSync.Validate(),this.m_pSync.UpdateDebug(),this.m_pPrintPreview&&this.m_pPrintPreview.Validate(),this.UpdateButtons()},y.prototype.Invalidate=function(){var t=this;this.Validate_scheduled||(window.setTimeout(function(){t.Validate_scheduled=!1,t.Validate()},0),this.Validate_scheduled=!0)},y.prototype.ShowAlgData=function(){this.ASC_action("algdata","")},y.prototype.ASC_action=function(t,e,i){void 0===e&&(e=""),this.jsc.ASC_action(t,e,i)},y.prototype.ZobrazKontrolu=function(t,e){var i=this;this.Validate(),this.ZrusKontrolu(),this.m_nKontrolaMode=n.KONTROLAMODE_KONTROLA,"listconstraints"==e&&(this.m_nKontrolaMode=n.KONTROLAMODE_PODMIENKY),"change"==e&&(this.m_nKontrolaMode=n.KONTROLAMODE_CHANGE);var o=[];this.m_ChybaItemsI={},t.forEach(function(t){var e=new s.CChybaItem(i.m_pRok,t);o.push(e)}),this.m_pRozView.ZobrazKontrolu(o,e),this.InvalidateTriedyView(),this.ribbonMenu.findButtonsByCmd("verification").forEach(function(t){t.selected(i.m_nKontrolaMode==n.KONTROLAMODE_KONTROLA)}),this.ribbonMenu.findButtonsByCmd("listconstraints").forEach(function(t){t.selected(i.m_nKontrolaMode==n.KONTROLAMODE_PODMIENKY)}),this.trackEvent("Verification",e)},y.prototype.JeKontrola=function(){return this.m_nKontrolaMode!=n.KONTROLAMODE_VYPNUTA},y.prototype.ZrusKontrolu=function(){this.JeKontrola()&&(this.m_nKontrolaMode=n.KONTROLAMODE_VYPNUTA,this.m_pRozView.ZrusKontrolu(),this.ribbonMenu.findButtonsByCmd("verification").forEach(function(t){t.selected(!1)}),this.ribbonMenu.findButtonsByCmd("listconstraints").forEach(function(t){t.selected(!1)}),this.m_ChybaItemsI={},this.m_pKontrolaItem=null,this.InvalidateTriedyView())},y.prototype.EnsureSynced=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return 0<this.m_pSync.CountChanges()?[4,this.SyncNow()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},y.prototype.ClickGenerate=function(t){return void 0===t&&(t={}),r.__awaiter(this,void 0,void 0,function(){var i,n;return r.__generator(this,function(o){switch(o.label){case 0:return i=void 0,t.sel&&(i=Array.isArray(t.sel)?t.sel:(n=this.m_pRadSelector).JeCelok()?void 0:n.m_Objects.map(function(t){return[n.m_Table,t.m_Id]})),[4,Promise.resolve().then(function(){return e("./gener")})];case 1:return o.sent().showStartGenerDlg(this.ttgpid,{sel:i}),[2]}})})},y.prototype.ClickTest=function(){return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return e("./test")})];case 1:return t.sent().showTestDlg(this),[2]}})})},y.prototype.ClickVerification=function(t,e){return void 0===e&&(e="all"),r.__awaiter(this,void 0,void 0,function(){var i,n;return r.__generator(this,function(o){switch(o.label){case 0:return this.JeKontrola()?(this.ZrusKontrolu(),[2]):this.JeKontrola()?(this.ZrusKontrolu(),[2]):[4,this.EnsureSynced()];case 1:return o.sent(),i=this.m_pRadSelector,[4,ASC.blockUI(d.runTTVerification(null,this.ttgpid,t,{sel:"sel"!=e||i.JeCelok()?void 0:i.m_Objects.map(function(t){return[i.m_Table,t.m_Id]})}),{simle:!0})];case 2:return n=o.sent(),this.ZobrazKontrolu(n.listNajdeneChyby,t),[2]}})})},y.prototype.ClickPrintPreview=function(t){void 0===t&&(t={}),this.m_bPrintPreview?this.ZrusPrintPreview():this.PrintPreview(t)},y.prototype.PrintPreview=function(t){if(void 0===t&&(t={}),this.ZrusKontrolu(),!this.m_bPrintPreview){this.m_bPrintPreview=!0;var e="printpreview";t.ttviewer&&(e="ttviewer"),this.$content_d.hide(),this.$printpreview_d.show().toggleClass("ttviewer","ttviewer"==e),this.ribbonMenu.findButtonsByCmd(e).forEach(function(t){t.selected(!0)}),this.ribbonMenu.select(e),this.ribbonMenu.$labels[e].show(),new c.CPrintPreview(this,t)}},y.prototype.ZrusPrintPreview=function(){if(this.m_bPrintPreview){this.$printpreview_d.hide(),this.$content_d.show(),this.m_bPrintPreview=!1;for(var t=0,e=["printpreview","ttviewer"];t<e.length;t++){var i=e[t];this.ribbonMenu.findButtonsByCmd(i).forEach(function(t){t.selected(!1)}),this.ribbonMenu.findButtonsByCmd(i).forEach(function(t){t.selected(!1)}),this.ribbonMenu.active==i&&this.ribbonMenu.select("main");var n=this.ribbonMenu.$labels[i];n&&n.hide()}this.m_pPrintPreview&&this.m_pPrintPreview.Destroy(),this.m_pPrintPreview=null,this.InvalidateTriedyView()}},y.prototype.UpdateWindowTitle=function(){if(!this.ttviewer){var t=ASC.ttls(1079);this.m_DocName&&(t=this.m_DocName+(this.m_ss_ver?" #"+this.m_ss_ver:"")+" - "+t),this.m_bModified&&(t="*"+t),$j("head title").text(t),$j("head link[rel='shortcut icon']").attr("href","/global/pics/ui/timetables_64.png")}},y.prototype.Fail=function(t){t=t||"Unknown error (9095935213)",ASC.ASC_messageBox(t)},y.prototype.ShowHelp=function(t){void 0===t&&(t="");var e="http://help.asctimetables.com/text.php?text="+t;ASC.windowOpenINP(e)},y.prototype.PrintSetFilter=function(t){this.m_pPrintPreview.SetFilter(t)},y.prototype.PrintSettingsChanged=function(){this.m_pPrintPreview.SettingsChanged()},y);function y(e){var i=this;this.ttviewer=!1,this.ttviewer_options=null,this.ttviewer_ribbon=null,this.$rg_pohlad_div=null,this.m_bModified=!1,this.m_DocName="",this.m_ss_ver="",this.Cursor_Canvas=null,this.Cursor_Hotspot=[0,0],this.m_nRozViewHeight=110,this.m_nKontrolaMode=n.KONTROLAMODE_VYPNUTA,this.m_bTahanaDajKontrolu=!1,this.m_pPrintPreview=null,this.Validate_scheduled=!1,this.formatLesson=null,this.CursorMove_Event=null,this.m_ChybaItemsI={},this.m_pKontrolaItem=null,this.m_bPrintPreview=!1,this.jsc=e,(this.jsc.app=this).ttgpid=e.ttgpid,t.farby=e.farby,e.ttviewer&&(this.ttviewer=!0,this.ttviewer_options=e.ttviewer_options),this.$dcvar=$j(this.jsc.dcvar),this.$dcvar.css("padding","0px");var o=$j("<div class='ttonline' style='min-height:80vh'><div id='ttonline_ribbon'/><div id='ttonline_content'/><div id='ttonline_printpreview' style='display:none'/></div></div>").appendTo(this.$dcvar);this.ttviewer?o.css("height","100%"):o.css("height","100vh"),"ie11"==ASC.browser&&o.css("display","block"),this.ribbonMenu=new ASC.ui.RibbonMenu(this.$dcvar.find("#ttonline_ribbon")),this.$content_d=this.$dcvar.find("#ttonline_content"),this.$printpreview_d=this.$dcvar.find("#ttonline_printpreview"),$j("<div class='asc-gadget-jsc' style='display:none'/>").appendTo(this.$dcvar)[0].ASC_gjsc={ASC_gpid:this.ttgpid},this.m_pRok=new m.CRok,(this.m_pRok.m_pRozApp=this).dbi=this.m_pRok.dbi,this.m_pSync=new g(this),this.m_pRadSelector=new s.CRadSelector(this),this.m_PodKurzoromMHodina=new l.CMHodina(this.m_pRok),this.m_TahanaMHodina=new l.CMHodina(this.m_pRok);var r=$j("<div style='flex: 1 1 0px;min-height:0px;display:flex;flex-direction:row;'>").appendTo(this.$content_d),a=$j("<div style=''>").appendTo(r),c=$j("<div style='flex: 1 1 0px; min-width: 0px'>").appendTo(r);this.m_pPohladSwitcher=new l.CPohladSwitcher(this,a),this.m_pTriedyView=new l.CTriedyView(this,c);var h=new ASC.ui.FlexSplitPane(this.$content_d,{vertical:!1});this.m_pRozView=new s.CRozView(this,$j("<div>").appendTo(this.$content_d)),h.$div.on("moved",function(t){i.m_nRozViewHeight=parseInt(i.m_pRozView.$div.get(0).style.height),i.Invalidate()}),this.InitRibbon(),this.m_pTriedyView.FillRibbonCombos();var _=this;this.m_OnMouseOverKarta=function(){var t=function(t){var e=t.ASC_karta;if(e)return(n=new l.CMHodina(i.m_pRok)).Add(e),n.FinishAdding(),n;if(t.ASC_dozor){var n,o=t.ASC_dozor;return(n=new l.CMHodina(i.m_pRok)).Add(o),n.FinishAdding(),n}return t.ASC_mh?t.ASC_mh:void 0}(this);t&&_.PodKurzorom(t)},this.m_OnMouseOutKarta=function(){_.PodKurzoromClear()},this.m_OnMouseClickKarta=function(t){var e=this.ASC_karta;if(_.m_TahanaMHodina.IsEmpty()){_.ZrusKontrolu();var i=_.m_pTriedyView.GetPolickoE(t);if(!i)return;this.parentNode.ASC_vriadok.m_pRokObject.UI_KartaVyberOdtialto(_,i,e,t),ASC.hideContextMenu(),_.m_OnMouse_StopEvent(t)}},this.m_OnMouseRightClickKarta=function(t){if(_.ZrusKontrolu(),!_.m_TahanaMHodina.IsEmpty())return _.OdhodKartu(),void _.m_OnMouse_StopEvent(t);var e=this.ASC_karta;e&&(_.m_pTriedyView.RightClickKarta($j.event.fix(t),e),_.m_OnMouse_StopEvent(t))},this.m_OnMouseRightClickDozor=function(t){if(_.ZrusKontrolu(),!_.m_TahanaMHodina.IsEmpty())return _.OdhodKartu(),void _.m_OnMouse_StopEvent(t);var e=this.ASC_dozor;e&&(_.m_pTriedyView.RightClickDozor($j.event.fix(t),e),_.m_OnMouse_StopEvent(t))},this.m_OnMouse_StopEvent=function(t){t.stopPropagation(),t.preventDefault()},this.ttviewer||($j(document).on("keyup keydown",function(t){return i.SetPreviewPodKurzorom(!!t.shiftKey),!0}),$j(document).on("keydown",function(t){if(!ASC.ui.getFocusedDialog())return!i.OnKeyDown(t)&&void 0}),$j(window).on("beforeunload",function(){if(!i.jsc.closing){var t=!1;return i.m_bModified&&(t=!0),0<i.m_pSync.CountChanges()&&(t=!0),t?ASC.ls(6122):void 0}})),this.InvalidatePending(),this.Invalidate(),this.ttviewer||this.m_pSync.StartUpdater(),this.trackEvent("App","initialized")}t.CRozApp=b;var g=(k.prototype.AddLocalChange=function(t){var e=t.m_Table;if(e in this.m_Local_Changes){this.m_Local_ModCount++,this.m_Local_Changes[e][t.m_Id]=!0;var i=this.m_pRozApp.ribbonMenu;i.findButton("undo").enabled(!0),i.findButton("redo").enabled(!1)}},k.prototype.SendSyncData=function(){var t=this.m_pRok,e={modCount:this.m_Remote_ModCount,localModCount:this.m_Local_ModCount,changes:{}};for(var i in this.m_Local_Changes)if(ASC.count(this.m_Local_Changes[i])){var n=k.change_cols[i];if(n)for(var o in e.changes[i]={},this.m_Local_Changes[i]){var r=t.m_ObjectsI[i][o];if(r){for(var a=r.m_Data,s={},l=0,c=n;l<c.length;l++){var m=c[l];m in a&&(s[m]=a[m])}e.changes[i][o]=s}}}return this.m_bVerbose&&0<ASC.count(e.changes)&&console.log("SendSyncData: "+JSON.stringify(e)),this.UpdateDebug(),e},k.prototype.ReceiveSyncData=function(t){var e=this.m_pRok,i=this.m_pRozApp,n=t.localModCount==this.m_Local_ModCount,o={};if(t.changes&&t.changes.forEach(function(t){var n=t.table,r=t.rows;0!=r.length&&(o[n]=!0,r.forEach(function(t){var o=t.id,r=e.m_ObjectsI[n][o];if(r){for(var a in i.InvalidateObject(r,!0),r.BeforeRemove(),t)r.m_Data[a]=t[a];r.InitFromData(),i.InvalidateObject(r,!0)}else{var s=ASC.clone(t);s.id=""+o,r=e.addRow(n,s),e.dbi.addOrUpdateRow(n,s),i.InvalidateTriedyView(),i.InvalidatePending(),i.InvalidateObject(r,!0)}}))}),t.deletes&&t.deletes.forEach(function(t){var n=t.table,r=t.ids;0!=r.length&&(o[n]=!0,r.forEach(function(t){e.m_ObjectsI[n][t]&&(e.deleteRow(n,t),i.InvalidateTriedyView(),i.InvalidatePending())}))}),t.orders&&t.orders.forEach(function(t){for(var n=t.table,o=t.ids,r=e.m_ObjectsO[n],a=r.slice(0,r.length),s={},l=r.length=0,c=o;l<c.length;l++){var m=c[l];if(!(u=e.m_ObjectsI[n][m]))return;r.push(u),s[m]=!0}for(var h=0,_=a;h<_.length;h++){var u;s[(u=_[h]).m_Id]||r.push(u)}i.m_pTriedyView.m_pAktPohlad&&i.m_pTriedyView.m_pAktPohlad.m_RowTable==n&&i.InvalidateTriedyView(),"groups"==n&&(e.m_ObjectsO.classes.forEach(function(t){t.m_Delenia.forEach(function(t){t.UpdatePoradieSkupin()})}),i.InvalidateTriedyView())}),(o.periods||o.daysdefs||o.weeksdefs||o.termsdefs||o.ttviews)&&(e.StructureFromData(),i.InvalidateTriedyView()),!i.ttviewer){var r=i.ribbonMenu;"undo_enabled"in t&&r.findButton("undo").enabled(t.undo_enabled),"redo_enabled"in t&&r.findButton("redo").enabled(t.redo_enabled)}if(n)for(var a in this.m_Local_Changes)this.m_Local_Changes[a]={};this.m_Remote_ModCount=t.modCount,this.m_bVerbose,t.apps&&JSON.stringify(t.apps)!=JSON.stringify(this.m_Apps)&&(this.m_Apps=t.apps,this.m_bInvalid_otherUsers=!0,this.m_pRozApp.m_pTriedyView.m_bInvalidFarbyRiadkov=!0,this.m_pRozApp.Invalidate(),this.m_bVerbose&&console.log("NewApps: "+JSON.stringify(this.m_Apps))),this.UpdateDebug()},k.prototype.CountChanges=function(){var t=0;for(var e in this.m_Local_Changes)t+=ASC.count(this.m_Local_Changes[e]);return t},k.prototype.UpdateDebug=function(){var t=this.$debug;t&&(t.css("white-space","pre"),t.text("remoteModCount="+this.m_Remote_ModCount+"\nlocalModCount="+this.m_Local_ModCount+"\nchanges="+this.CountChanges()+"\n"))},k.prototype.SyncIfNeeded=function(t){var e=this;if(void 0===t&&(t=0),!this.m_bSyncing&&this.m_bNeedsSync){var i=this.m_SyncCallbacks;this.m_SyncCallbacks=[],this.m_bNeedsSync=!1,this.m_bSyncing=!0;var n=this.SendSyncData();if(0<ASC.count(n.changes)){var o="";for(var r in n.changes)o+=(o?"_":"")+r;o&&this.m_pRozApp.trackEvent("SyncLocal",o)}this.m_pRozApp.ASC_action("sync","sync="+encodeURIComponent(JSON.stringify(n)),{modal:!1,timeout:6e4,success2:function(){e.m_bSyncing=!1;for(var n=0,o=i;n<o.length;n++)(0,o[n])();e.m_bNeedsSync&&t<3&&e.SyncIfNeeded(t+1)},failure:function(){e.m_bSyncing=!1}})}},k.prototype.SetNeedsSync=function(){this.m_bNeedsSync=!0},k.prototype.StartUpdater=function(){var t=this,e=!0,i=function(){var n=5e3;(e||1<t.m_Apps.length)&&(n=1e3),window.setTimeout(function(){0<t.CountChanges()&&(t.SetNeedsSync(),t.SyncIfNeeded()),e=!1,i()},n)};i()},k.prototype.UpdateOtherUsers=function(){var t=this;this.$other_users.empty();var e=[],i=[];if(this.m_Apps.forEach(function(n){if(n.my)i.push(n);else{var o=n.sh;if(!(0<=e.indexOf(o))){e.push(o);var r=$j("<span class='user'>").appendTo(t.$other_users);r.text(n.un),r.css("background-color",n.c)}}}),0<i.length&&1<i.length){var n=i[0],o=$j("<span class='user'>").appendTo(this.$other_users);o.text(ASC.ls(1751)+(1<i.length?" ("+i.length+")":"")),o.css("background-color",n.c)}this.m_bInvalid_otherUsers=!1},k.prototype.Validate=function(){this.m_bInvalid_otherUsers&&this.UpdateOtherUsers()},k.prototype.GetFarbyUserov=function(t){var e=t.m_Table,i=t.m_Id,n=null;return this.m_Apps.forEach(function(t){!t.my&&t.cr&&e in t.cr&&(ASC.indexOf(t.cr[e],i)<0||(n?n.push(t.c):n=[t.c]))}),n},k.change_cols={cards:["period","days","weeks","terms","classroomids","locked"],lessons:["terms"],classes:["timeoff"],teachers:["timeoff"],classrooms:["timeoff"],subjects:["timeoff"],studentsubjects:["locked","seminargroup"],classroomsupervisions:["teacherid","locked"]},k);function k(t){this.m_Local_ModCount=0,this.m_Local_Changes={cards:{},lessons:{},classes:{},teachers:{},classrooms:{},subjects:{},studentsubjects:{},classroomsupervisions:{}},this.m_Remote_ModCount=0,this.m_Apps=[],this.m_bVerbose=!0,this.m_bSyncing=!1,this.m_bNeedsSync=!1,this.m_SyncCallbacks=[],this.m_bInvalid_otherUsers=!1,this.m_pRozApp=t,this.m_pRok=t.m_pRok,this.$other_users=this.m_pRozApp.ribbonMenu.$right}var T,S=(T=m.CRokObject,r.__extends(C,T),C.prototype.GetNazov=function(){return this.m_Data.name},C.prototype.InitFromData=function(){var t=this.m_Data;this.m_Typ=t.typ,this.texttables=t.texttables,this.colortable=t.colortables.length?t.colortables[0]:"",this.m_RowTable=t.table,this.m_Icon=t.icon,this.m_Hidden=ASC.boolVal(t.hidden)},C.prototype.GetRiadkyObjects=function(){if("classroomsupervision"!=this.m_Typ)return"custom"==this.m_Typ?"classes"==this.m_RowTable?this.m_pRok.ids2ro("classes",this.m_Data.classids):"teachers"==this.m_RowTable?this.m_pRok.ids2ro("teachers",this.m_Data.teacherids):"classrooms"==this.m_RowTable?this.m_pRok.ids2ro("classrooms",this.m_Data.classroomids):[]:this.m_pRok.m_ObjectsO[this.m_RowTable];for(var t=[],e=0,i=this.m_pRok.TableObjects("classrooms");e<i.length;e++){var n=i[e];ASC.boolVal(n.m_Data.needssupervision)&&t.push(n)}return t},C.prototype.GetRiadkyTable=function(){return this.m_RowTable},C.prototype.UI_VhodnostTahanejMHodiny=function(t,e){if("classrooms"==this.m_RowTable){for(var i=0,n=t.Karty();i<n.length;i++)if(n[i].JeTu_Policko(e))return"1";return"0"}var o="1";t.Karty().forEach(function(t){if(!t.Obdobia_MozeSem_TWDH(e.m_nTerm,e.m_nWeek,e.m_nDay,-1))return"0";t.Obdobia_MozeSem_TWDH(e.m_nTerm,-1,-1,-1,!0)||(o="?")});var r=[];if(t.Ucitelia().forEach(function(t){r.push(t.timeoff())}),t.Predmety().forEach(function(t){r.push(t.timeoff())}),r.forEach(function(t){o=f.defaultVolnoJoiner(o,f.timeoff_get(t,e.m_nTerm,e.m_nWeek,e.m_nDay,e.period))}),"0"!=o){var a=[];"classes"!=this.m_RowTable&&"classrooms"!=this.m_RowTable||t.Ucitelia().forEach(function(t){t.AddKartyTu(a,e.m_nTerm,e.m_nWeek,e.m_nDay,e.period,0)}),0!=a.length&&(o="x")}return o},C);function C(t,e){var i=T.call(this,t,"ttviews",e)||this;return i.m_Typ="",i.texttables=[],i.colortable="",i.m_RowTable="classes",i.m_Hidden=!1,i.m_nVyskaRiadok=l.nDefaultVyskaRiadok,i.m_nScrollPos=0,i.m_pRozApp=t.m_pRozApp,i.m_pTriedyView=t.m_pRozApp.m_pTriedyView,i.InitFromData(),i}t.CPohlad=S;var A=(w.RovnakyList=function(t,e){if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!=e[i])return!1;return!0},w.GetImage=function(t){return console.log("ASC.tt.GetImage",ASC.tt.GetImage),ASC.tt.GetImage(t)},w.GetTableIcon=function(t){return ASC.tt.GetTableIcon(t)},w.GetTableName=function(t){switch(t){case"classes":return ASC.ls(1194);case"classrooms":return ASC.ls(1007);case"teachers":return ASC.ls(1005);case"subjects":return ASC.ls(1008);case"students":return ASC.ls(1006);case"lessons":return ASC.ls(1460)}return""},w.PaintFarbyToRect=function(t,e,i,n,o,r){var a=0<t.length?t[0]:"#ffffff";e.fillStyle=a,e.fillRect(i,n,o,r)},w.GetTextExtent=function(t,e){var i=t.measureText(e),n=t.measureText("M");return{cx:i.width,cy:n.width}},w.PaintTextToRect=function(t,e,i,n,o,r,a,s){if(void 0===a&&(a=0),void 0===s&&(s=0),0!=t.length){e.textBaseline="top",e.textAlign="left";var l=o,c=r;c+=1;var m=t,h=t.length,_=[],u=[],d=0,p=0,f=0,v=0;for(_[d=0]=v,u[0]=h;!(h<=v);){for(var b=v,y=b,g=!1;;){var k,T;if(g)for(var S=b;;){if(" "==m[S]){k=S+1,T=S;break}if(h<=(S+=1)){T=k=S;break}}else k=b+1," "==m[b]?(T=b,g=!0):T=k;if(v<b&&(I=w.GetTextExtent(e,t.substring(v,T))).cx>l)break;if(y=T,h<=(b=k))break}if((I=w.GetTextExtent(e,t.substring(v,y))).cx-=1,p+I.cy>c&&1<=d)break;if(f=Math.max(f,I.cx),p+=I.cy,u[d]=y-_[d],_[d+1]=b,u[d+1]=h-b,v=b,10<=++d)break}var C=i;0==a&&(C+=(l-f)/2),0<a&&(C+=l-f);var A=n;for(0==s&&(A+=(c-p)/2),0<s&&(A+=c-p),A-=2,S=0;;){var I,R=_[S];if(h=u[S],e.fillText(t.substr(R,h),C,A),d<=++S)break;(I=w.GetTextExtent(e,t.substr(R,h))).cy-=1,A+=I.cy}}},w.IsEventInside=function(t,e){var i=t.pageX-e.offset().top,n=t.pageY-e.offset().left;return 0<=i&&0<=n&&i<e.width()&&n<e.height()},w.FastRemove=function(t,e){var i=t.indexOf(e);0<=i&&(t[i]=t[t.length-1],t.length--)},w.IsEventRightButton=function(t){return 2==t.button},w.AddToSet=function(t,e){e.indexOf(t)<0&&e.push(t)},w.AddListToSet=function(t,e){for(var i=0;i<t.length;i++)w.AddToSet(t[i],e)},w.OpenDialog=function(t,e){void 0===e&&(e={}),e.modal=!0,t=t||ASC.ttls(1079),e.title=ASC.escapeHTML(t);var i=new ASC.ui.Dialog(e);return i.center(),i.show(),i},w.GetUINazov=function(t,e){return void 0===e&&(e="name"),w.GetUINazov2(t,null,e)},w.GetUINazov2=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i="short_name"),!t)return"";if(e)return"short_name"==i&&"classes"==t.m_Table&&"subjects"==e.m_Table?"("+t.GetSkratka()+":"+e.GetSkratka()+") "+t.GetNazov()+": "+e.GetNazov():w.GetUINazov(t,i)+" : "+w.GetUINazov(e,i);var n=t.m_pRok;switch(t.m_Table){case"cards":var o=t,r=w.GetUINazov(o.m_pHodina)+" - ";return o.JeUmiestnena()?r+=w.GetUINazov(n.GetDen_bits(o.days()),"short")+":"+w.GetUINazov(n.GetPeriod(o.GetHodina()),"short"):r+=ASC.ttls(1765),r;case"lessons":var a=t,s=new l.CMHodina(n);return s.Add(a),s.FinishAdding(),r=s.GetText("subjects"),0<s.m_nPoradieSeminaru&&(r+=" "+s.GetText("seminargroup")),r+=" (",0==s.m_Objects.classes.length?r+="Without class":r+=s.GetText("classes","short"),r+=")",0!=s.m_Skupiny.length&&(r+=" "+s.GetText("groups")),r;case"daysdefs":case"weeksdefs":case"termsdefs":case"periods":case"classes":case"teachers":case"subjects":case"classrooms":case"coursegroups":return"short_name"==i?"("+t.GetSkratka()+") "+t.GetNazov():t.GetNazov(i);case"students":return t.m_pTrieda.GetSkratka()+" - "+t.GetNazov();case"globals":return ASC.ttls(3756)}return"???"+t.m_Table},w.GetUINazvy=function(t,e){void 0===e&&(e="short");var i="";return t.forEach(function(t){""!=i&&(i+=", "),i+=w.GetUINazov(t,e)}),i},w.GetUINazovSTypom=function(t){return t?w.GetTableItemTypNazov(t.m_Table,1)+": "+this.GetUINazov(t):""},w.GetIconTimeOff=function(){return w.GetImage("timeoff_32")},w.GetIconConstraints=function(){return w.GetImage("constraints_32")},w.GetIconDivision=function(){return w.GetImage("division_32")},w.GetIconLessons=function(){return w.GetTableIcon("lessons")},w.GetIconNic=function(){return"/global/pics/ui/nic_32.png"},w.GetIconLocked=function(t,e){return void 0===e&&(e=!1),t?w.GetImage("lock_32"):e?"":w.GetImage("unlock_32")},w.GetIconOK=function(){return"/timetable/pics/app/ok_32.png"},w.GetIconVhodnost=function(t){switch(t){case"1":return w.GetImage("ok_32");case"?":return w.GetImage("question_32");case"0":return w.GetImage("no_32")}return""},w.AddMenuItemSmart=function(t,e,i){void 0===i&&(i={});var n=i.data,o={text:"",cmd:e};switch(void 0!==n&&(o.data=n),e){case"edit":o.text=ASC.ttls(1017);break;case"timeoff":o.text=ASC.ttls(1118),o.icon=w.GetIconTimeOff();break;case"timeoff:0":o.text=ASC.ttls(1122),o.icon=w.GetImage("no_32");break;case"timeoff:?":o.text=ASC.ttls(1121),o.icon=w.GetImage("question_32");break;case"timeoff:1":o.text=ASC.ttls(1120),o.icon=w.GetImage("ok_32");break;case"constraints":o.text=ASC.ttls(3071),o.icon=w.GetIconConstraints();break;case"lessons":o.text=ASC.ttls(1032),o.icon=w.GetIconLessons();break;case"divisions":o.text=ASC.ttls(1031),o.icon=w.GetIconDivision();break;case"deletecards":o.text=ASC.ttls(1712),o.icon=w.GetIconNic();break;case"unlockcard":o.icon=w.GetIconLocked(!1);break;case"lockcard":o.icon=w.GetIconLocked(!0);break;case"putcard":n instanceof m.CRokObject&&(o.text=w.GetUINazov(n));break;case"editlesson":o.text=ASC.ttls(1059),o.icon=w.GetImage("edit_32");break;case"test":o.text=ASC.ttls(2047),o.icon=w.GetImage("test_32");break;case"verification":o.text=ASC.ttls(1616),o.icon=w.GetImage("verification_32");break;case"listconstraints":o.text=ASC.ttls(3719),o.icon=w.GetImage("constraints_32");break;case"printpreview":o.text=ASC.ls(1837),o.icon=w.GetImage("print_preview_32")}n instanceof m.CRokObject&&(o.icon=w.GetTableIcon(n.m_Table),o.text||(o.text=w.GetUINazov(n))),"icon"in i&&(o.icon=i.icon),"text"in i&&(o.text=i.text),"disabled"in i&&(o.disabled=i.disabled),"submenu"in i&&(o.submenu=i.submenu),"checked"in i&&(o.checked=i.checked),"onclick"in i&&(o.onclick=i.onclick),o.icon||(o.icon=w.GetIconNic()),o.text||(o.text="???"+e),t.push(o)},w.GetTableItemTypNazov=function(t,e){switch(t){case"classrooms":return 1==e?ASC.ttls(1092):ASC.ttls(1085);case"teachers":return 1==e?ASC.ttls(1048):ASC.ttls(1038);case"subjects":return 1==e?ASC.ttls(1011):ASC.ttls(1021);case"classes":return 1==e?ASC.ttls(1035):ASC.ttls(1026);case"lessons":return 1==e?ASC.ttls(1063):ASC.ttls(2531);case"students":return 1==e?ASC.ttls(2956):ASC.ttls(2604);case"days":case"daysdefs":return 1==e?ASC.ls(1465):ASC.ls(1693);case"studentsubjects":return w.GetTableItemTypNazov("students",e)+"/"+w.GetTableItemTypNazov("subjects",e)}return w.GetTableName(t)},w.ZasedniColor=function(t){var e=w.ZasedniColor_cache[t];if(!e){var i=parseInt(t.substr(1,2),16)+parseInt(t.substr(1,2),16)+parseInt(t.substr(1,2),16),n=(Math.round(50*i/765)+200).toString(16);1==n.length&&(n="0"+n),e="#"+n+n+n,w.ZasedniColor_cache[t]=e}return e},w.ZasedniColors=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var o=n[i];e.push(w.ZasedniColor(o))}return e},w.StringHash=function(t){var e,i,n=0;if(0===t.length)return n;for(e=0,i=this.length;e<i;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return n},w.GetIconImportance=function(t){return"/timetable/pics/app/relations/importance_"+t+"_16.png"},w.AdvFilterPopis=function(t){var e="",i=t&w.VZTAH_ADV_OPTIONS_MASK_LENGTH;switch(0!=i&&(""!=e&&(e+=", "),e+=ASC.ttls(1640)+": "+i),t&w.VZTAH_ADV_OPTIONS_ENTIRECLASS&&(""!=e&&(e+=", "),e+=ASC.ttls(1643)),t&w.VZTAH_ADV_OPTIONS_DIVIDED&&(""!=e&&(e+=", "),e+=ASC.ttls(1178)),t&w.VZTAH_ADV_OPTIONS_SEMINAR&&(""!=e&&(e+=", "),e+=ASC.ttls(2609)),t&w.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT){case w.VZTAH_ADV_OPTIONS_NOCLASS:""!=e&&(e+=", "),e+=ASC.ttls(2825);break;case w.VZTAH_ADV_OPTIONS_ONECLASS:""!=e&&(e+=", "),e+=ASC.ttls(3844);break;case w.VZTAH_ADV_OPTIONS_JOINEDCLASSES:""!=e&&(e+=", "),e+=ASC.ttls(3845)}switch(t&w.VZTAH_ADV_OPTIONS_MASK_DAYS){case w.VZTAH_ADV_OPTIONS_EVERY_DAY:""!=e&&(e+=", "),e+=ASC.ttls(3549);break;case w.VZTAH_ADV_OPTIONS_NOT_EVERY_DAY:""!=e&&(e+=", "),e+="!"+ASC.ttls(3549)}switch(t&w.VZTAH_ADV_OPTIONS_MASK_WEEKS){case w.VZTAH_ADV_OPTIONS_EVERY_WEEK:""!=e&&(e+=", "),e+=ASC.ttls(1863);break;case w.VZTAH_ADV_OPTIONS_NOT_EVERY_WEEK:""!=e&&(e+=", "),e+="!"+ASC.ttls(1863)}switch(t&w.VZTAH_ADV_OPTIONS_MASK_TERMS){case w.VZTAH_ADV_OPTIONS_EVERY_TERM:""!=e&&(e+=", "),e+=ASC.ttls(3415);break;case w.VZTAH_ADV_OPTIONS_NOT_EVERY_TERM:""!=e&&(e+=", "),e+="!"+ASC.ttls(3415)}var n=(t&w.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT)>>11;return 0<n&&(""!=e&&(e+=", "),e+=ASC.ttls(3622)+": ",t&w.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT_ORLESS&&(e+="<="),e+=n),e},w.AdvFilterMenuBuild=function(t){var e,i,n,o=[],r="advfilter";o.push([]),e=[],i={text:ASC.ttls(1640),submenu:e};for(var a=1;a<=32;a++)n={text:""+a,cmd:r,data:2e3+a},(t&w.VZTAH_ADV_OPTIONS_MASK_LENGTH)==a&&(n.checked=!0,i.checked=!0),e.push(n);o.push(i),o.push([]),o.push({text:ASC.ttls(1643),cmd:r,data:1010,checked:0!=(t&w.VZTAH_ADV_OPTIONS_ENTIRECLASS)}),o.push({text:ASC.ttls(1178),cmd:r,data:1011,checked:0!=(t&w.VZTAH_ADV_OPTIONS_DIVIDED)}),o.push({text:ASC.ttls(2609),cmd:r,data:1012,checked:0!=(t&w.VZTAH_ADV_OPTIONS_SEMINAR)}),o.push([]),o.push({text:ASC.ttls(2825),cmd:r,data:1013,checked:(t&w.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT)==w.VZTAH_ADV_OPTIONS_NOCLASS}),o.push({text:ASC.ttls(3844),cmd:r,data:1014,checked:(t&w.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT)==w.VZTAH_ADV_OPTIONS_ONECLASS}),o.push({text:ASC.ttls(3845),cmd:r,data:1015,checked:(t&w.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT)==w.VZTAH_ADV_OPTIONS_JOINEDCLASSES}),o.push([]);var s=(t&w.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT)>>11;for(e=[],i={text:ASC.ttls(3622),submenu:e,checked:0<s},o.push(i),a=1;a<=7;a++)e.push({text:""+a,cmd:r,data:3e3+a,checked:a==s});return e.push([]),e.push({text:"<=",checked:0!=(t&w.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT_ORLESS),cmd:r,data:1016}),e=[],i={text:ASC.ttls(2532),submenu:e,checked:0!=(t&w.VZTAH_ADV_OPTIONS_MASK_DAYS)},o.push(i),e.push({text:ASC.ttls(3549),checked:(t&w.VZTAH_ADV_OPTIONS_MASK_DAYS)==w.VZTAH_ADV_OPTIONS_EVERY_DAY,cmd:r,data:4001}),e.push({text:ASC.ttls(2708),checked:(t&w.VZTAH_ADV_OPTIONS_MASK_DAYS)==w.VZTAH_ADV_OPTIONS_NOT_EVERY_DAY,cmd:r,data:4002}),e=[],i={text:ASC.ttls(3410),submenu:e,checked:0!=(t&w.VZTAH_ADV_OPTIONS_MASK_WEEKS)},o.push(i),e.push({text:ASC.ttls(1863),checked:(t&w.VZTAH_ADV_OPTIONS_MASK_WEEKS)==w.VZTAH_ADV_OPTIONS_EVERY_WEEK,cmd:r,data:5001}),e.push({text:ASC.ttls(2708),checked:(t&w.VZTAH_ADV_OPTIONS_MASK_WEEKS)==w.VZTAH_ADV_OPTIONS_NOT_EVERY_WEEK,cmd:r,data:5002}),e=[],i={text:ASC.ttls(3409),submenu:e,checked:0!=(t&w.VZTAH_ADV_OPTIONS_MASK_TERMS)},o.push(i),e.push({text:ASC.ttls(3415),checked:(t&w.VZTAH_ADV_OPTIONS_MASK_TERMS)==w.VZTAH_ADV_OPTIONS_EVERY_TERM,cmd:r,data:6001}),e.push({text:ASC.ttls(2708),checked:(t&w.VZTAH_ADV_OPTIONS_MASK_TERMS)==w.VZTAH_ADV_OPTIONS_NOT_EVERY_TERM,cmd:r,data:6002}),o.push([]),o.push({text:ASC.ttls(2823),cmd:r,data:1e3}),o},w.AdvFilterMenuHandle=function(t,e){var i=parseInt(t.data),n=0,o=0;switch(i){case 1e3:e=0;break;case 1010:n=w.VZTAH_ADV_OPTIONS_MASK_DIVIDED,o=w.VZTAH_ADV_OPTIONS_ENTIRECLASS;break;case 1011:n=w.VZTAH_ADV_OPTIONS_MASK_DIVIDED,o=w.VZTAH_ADV_OPTIONS_DIVIDED;break;case 1012:n=w.VZTAH_ADV_OPTIONS_MASK_DIVIDED,o=w.VZTAH_ADV_OPTIONS_SEMINAR;break;case 1013:n=w.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT,o=w.VZTAH_ADV_OPTIONS_NOCLASS;break;case 1014:n=w.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT,o=w.VZTAH_ADV_OPTIONS_ONECLASS;break;case 1015:n=w.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT,o=w.VZTAH_ADV_OPTIONS_JOINEDCLASSES;break;case 1016:o=n=w.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT_ORLESS;break;case 4001:n=w.VZTAH_ADV_OPTIONS_MASK_DAYS,o=w.VZTAH_ADV_OPTIONS_EVERY_DAY;break;case 4002:n=w.VZTAH_ADV_OPTIONS_MASK_DAYS,o=w.VZTAH_ADV_OPTIONS_NOT_EVERY_DAY;break;case 5001:n=w.VZTAH_ADV_OPTIONS_MASK_WEEKS,o=w.VZTAH_ADV_OPTIONS_EVERY_WEEK;break;case 5002:n=w.VZTAH_ADV_OPTIONS_MASK_WEEKS,o=w.VZTAH_ADV_OPTIONS_NOT_EVERY_WEEK;break;case 6001:n=w.VZTAH_ADV_OPTIONS_MASK_TERMS,o=w.VZTAH_ADV_OPTIONS_EVERY_TERM;break;case 6002:n=w.VZTAH_ADV_OPTIONS_MASK_TERMS,o=w.VZTAH_ADV_OPTIONS_NOT_EVERY_TERM}return 2001<=i&&i<2100&&(n=w.VZTAH_ADV_OPTIONS_MASK_LENGTH,o=i-2e3),3e3<=i&&i<3100&&(n=w.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT,o=i-3e3<<11),(e&n)==o?e&=~n:e=e&~n|o,e},w.AdvFilterPass=function(t,e,i){if(void 0===i&&(i=null),0!=t){if(t&w.VZTAH_ADV_OPTIONS_INVERT)return!w.AdvFilterPass(t&~w.VZTAH_ADV_OPTIONS_INVERT,e,i);var n=t&w.VZTAH_ADV_OPTIONS_MASK_LENGTH;if(0!=n&&e.GetDlzka()+1!=n)return!1;var o=t&w.VZTAH_ADV_OPTIONS_MASK_DIVIDED;if(o){var r=!1;if(o&w.VZTAH_ADV_OPTIONS_SEMINAR)if(i)for(var a=0,s=i;a<s.length;a++){var l=s[a];if(0<=e.m_KurzyPreTriedy.indexOf(l)){r=!0;break}}else 0<e.m_KurzyPreTriedy.length&&(r=!0);for(var c=0,m=e.m_Skupiny;c<m.length;c++){var h=m[c];if(!(i&&i.indexOf(h.m_pTrieda)<0)){if(o&w.VZTAH_ADV_OPTIONS_ENTIRECLASS&&h.m_bCelaTrieda){r=!0;break}if(o&w.VZTAH_ADV_OPTIONS_DIVIDED&&!h.m_bCelaTrieda&&!h.m_bKurz){r=!0;break}}}if(!r)return!1}var _=(t&w.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT)>>11;if(0<_){if(0==e.m_KurzyPreTriedy.length)return!1;var u=[];i?$j.merge(u,i):$j.merge(u,e.m_KurzyPreTriedy),r=!1;for(var d=0,p=u;d<p.length;d++)if(l=p[d],!(e.m_KurzyPreTriedy.indexOf(l)<0)){for(var f=[],b=0,y=e.m_pPredmet.m_Hodiny;b<y.length;b++){var g=y[b];if(!(g.m_KurzyPreTriedy.indexOf(l)<0)){var k=g.m_nPoradieSeminaru;v(0<k),f.indexOf(k)<0&&f.push(k)}}var T=f.length;if(v(0<T),0!=(t&w.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT_ORLESS)?T<=_&&(r=!0):T==_&&(r=!0),r)break}if(!r)return!1}var S=t&w.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT;if(0<S){switch(u=e.m_Triedy,S){case w.VZTAH_ADV_OPTIONS_NOCLASS:return 0==u.length;case w.VZTAH_ADV_OPTIONS_ONECLASS:return 1==u.length;case w.VZTAH_ADV_OPTIONS_JOINEDCLASSES:return 1<u.length}return v(!1),!1}var C=t&w.VZTAH_ADV_OPTIONS_MASK_DAYS;if(C==w.VZTAH_ADV_OPTIONS_EVERY_DAY&&"all"!=e.m_pObdobie.days.m_Typ)return!1;if(C==w.VZTAH_ADV_OPTIONS_NOT_EVERY_DAY&&"all"==e.m_pObdobie.days.m_Typ)return!1;var A=t&w.VZTAH_ADV_OPTIONS_MASK_WEEKS;if(A==w.VZTAH_ADV_OPTIONS_EVERY_WEEK&&"all"!=e.m_pObdobie.weeks.m_Typ)return!1;if(A==w.VZTAH_ADV_OPTIONS_NOT_EVERY_WEEK&&"all"==e.m_pObdobie.weeks.m_Typ)return!1;var I=t&w.VZTAH_ADV_OPTIONS_MASK_TERMS;if(I==w.VZTAH_ADV_OPTIONS_EVERY_TERM&&"all"!=e.m_pObdobie.terms.m_Typ)return!1;if(I==w.VZTAH_ADV_OPTIONS_NOT_EVERY_TERM&&"all"==e.m_pObdobie.terms.m_Typ)return!1}return!0},w.AdvFilterField=function(t,e,i,n){n=parseInt(n+"");var o=$j("<span>").appendTo(t),r=$j("<input>").appendTo(t).hide(),a=function(){var t=w.AdvFilterMenuBuild(n);ASC.ui.Menu.addHandler(t,function(t){n=w.AdvFilterMenuHandle(t,n),a()}),o.empty(),new ASC.ui.Button({container:o,label:e,menu:t}),$j(i).text(w.AdvFilterPopis(n)),r.val(n+"")};return a(),r[0]},w.bits2index=function(t){return t.indexOf("0")<0?-1:t.indexOf("1")},w.blank2minus=function(t){return ASC.strEmpty(t)?-1:parseInt(t)},w.minus2blank=function(t){return t<0?-1:t},w.StripStringTab=function(t){var e=t.indexOf("\t");return e<=0&&(e=t.indexOf("\\t")),0<=e&&(t=t.substr(0,e)),t.replace("&","")},w.minutes=function(t){var e=t.split(":");return 60*parseInt(e[0])+parseInt(e[1])},w.GetFarbaFazy=function(t,e){if(e<=1)return"";var i=Math.round(255*t/(e-1));return"rgb("+i+","+i+","+i+")"},w.GetFarbaIndex=function(t){return"#"+(this.colorPalette[t]||"FFFFFF")},w.ZasedniColor_cache={},w.VZTAH_ADV_OPTIONS_MASK_LENGTH=31,w.VZTAH_ADV_OPTIONS_ENTIRECLASS=256,w.VZTAH_ADV_OPTIONS_DIVIDED=512,w.VZTAH_ADV_OPTIONS_SEMINAR=1024,w.VZTAH_ADV_OPTIONS_MASK_DIVIDED=1792,w.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT=14336,w.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT_ORLESS=16384,w.VZTAH_ADV_OPTIONS_NOCLASS=32768,w.VZTAH_ADV_OPTIONS_ONECLASS=65536,w.VZTAH_ADV_OPTIONS_JOINEDCLASSES=98304,w.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT=98304,w.VZTAH_ADV_OPTIONS_EVERY_DAY=131072,w.VZTAH_ADV_OPTIONS_NOT_EVERY_DAY=262144,w.VZTAH_ADV_OPTIONS_MASK_DAYS=393216,w.VZTAH_ADV_OPTIONS_EVERY_WEEK=524288,w.VZTAH_ADV_OPTIONS_NOT_EVERY_WEEK=1048576,w.VZTAH_ADV_OPTIONS_MASK_WEEKS=1572864,w.VZTAH_ADV_OPTIONS_EVERY_TERM=2097152,w.VZTAH_ADV_OPTIONS_NOT_EVERY_TERM=4194304,w.VZTAH_ADV_OPTIONS_MASK_TERMS=6291456,w.VZTAH_ADV_OPTIONS_INVERT=2147483648,w.colorPalette=["FF0000","00FF00","0000FF","FF00CC","FFCCFF","FFFF66","FF6666","FFCC66","000080","66FFFF","009933","DDFF97","669900","66FF66","FFFFCC","6666FF"],w);function w(){ASC.assert(!1)}t.CUtils=A,t.formatDivision=function(t,e,i,n){var o=i.table._oRecordSet._records.indexOf(e),r=$j(t);r.empty();for(var a=$j("<div class='ttonline_delenie'>").appendTo(r).data("rec",e),s=0,l=n;s<l.length;s++){var c=l[s],m=$j("<div class='ttonline_skupina'>").appendTo(a).css({backgroundColor:o%2==0?"#b1febb":"#93fe93"}).text(c.name).data("grow",c);$j("<span class='students_count'>").text(c.students_count).appendTo(m)}e.getData("entireclass")||a.sortable({connectWith:".ttonline_delenie",update:function(t,e){if(!e.sender){var i=e.item,n=i.data("grow").id,o=i.parent().data("rec").getData("division"),r=i.index();i.parents(".ui-dialog").find(".asc-gadget-jsc").get(0).ASC_gjsc.ASC_action("move","groupid="+n+"&division="+o+"&index="+r)}}})},t.SortovacieSipocky=function(t,e,i,n){function o(){n.ASC_action("order","order="+t.GetAllIds().join(","),{modal:!1})}var r=[],a=!1,s=function(){a=0<t.sortedBy.length,r[0].attr("src",a?"/global/pics/ui/sipkaKluc.png":"/global/pics/ui/sipkaHore.png"),r[1].attr("src",a?"/global/pics/ui/sipkaReset.png":"/global/pics/ui/sipkaDole.png")};[0,1].forEach(function(i){r[i]=$j("<img>").appendTo(e).css({width:"19px",height:"20px",cursor:"pointer",display:"block",marginTop:"5px"}).click(function(){var e;e=i,a?0==e?(o(),t.setSortedBy([]),s()):(t.ASC_deleteAll(),t.setSortedBy([]),s(),n.ASC_action("refresh","")):(t.moveSelectedRow(0==e),o())})}),s(),t.subscribe("columnSortEvent",s)}},"/timetable/app/rozview.js":function(t,e,i){t.__esModule=!0;var n=e("tslib"),o=e("./online"),r=e("./rokobject"),a=e("./tview"),s=e("./ttdoc"),l=e("../../asc/edurequest"),c=(m.prototype.UpdateHeight=function(){this.$div.css("height",this.m_pRozApp.m_nRozViewHeight+"px")},m.prototype.Update=function(){this.UpdateHeight(),this.PaintRadKarticiek0(),this.UpdatePodKurzorom(),this.m_bInvalid=!1},m.prototype.Validate=function(){this.m_pRozApp.ttviewer||(this.m_bInvalid&&this.Update(),this.m_bInvalidPodKurzorom&&this.UpdatePodKurzorom())},m.prototype.PaintRadKarticiek0=function(){var t=this,e=this.m_pRozApp,i=this.$pending_d;i.empty();var n=e.m_pRadSelector,r="";n.JeCelok()||(""!=r&&(r+=", "),r+=n.GetSimplePopis(!0)),""!=r&&$j("<div style='padding:2px 0px 0px 3px;font-weight:bold;color:#404040'>").appendTo(i).text(ASC.ttls(3508)+": "+r);var a=this.$rad_icons_d;a.empty(),["globals","classes","teachers","subjects","classrooms"].forEach(function(i){var n="globals"==i?"/timetable/pics/app/settings_32.png":o.CUtils.GetTableIcon(i),r=$j("<span>").appendTo(a);"globals"!=i&&r.text(t.m_pRadSelector.GetRadStr(i)),$j("<img>").prependTo(r).attr("src",n),r.click(function(n){if("globals"==i)t.m_pRadSelector.SetCelok(),e.InvalidateSelector();else{var o=t.OblastMenu(i);0<o.length&&ASC.showContextMenu(o,n)}})}),this.PripravList0();for(var s=null,l=0,c=this.m_List;l<c.length;l++){var m=c[l],h=this.m_pRozApp.m_pTriedyView.BuildRVKarta(m);h.onclick=this.m_OnMouseClickKarta;var _=m.m_nRozView_Ciselko;if(1<_){_=Math.min(_,5);for(var u=h;1<_;)u=ASC.createDiv(u,"viac"),_--}i.append(h),s&&(m.m_bRozView_Zasednut==s.m_bRozView_Zasednut&&m.m_nRozView_TypKarty==s.m_nRozView_TypKarty||$j(h).css("margin-left","10px")),h.ASC_mh=m,h.onmouseover=e.m_OnMouseOverKarta,h.onmouseout=e.m_OnMouseOutKarta,h.onclick=this.m_OnMouseClickKarta,h.oncontextmenu=this.m_OnMouseRightClickKarta,s=m}},m.prototype.PripravList0=function(){var t=this,e=this.m_pRozApp,i=e.m_pTriedyView;if(i&&i.m_pAktPohlad){var n=this.m_pRadSelector.GetVybraneHodiny(e.m_pTriedyView.m_nROJTF|a.ROJTF_FILTER_AKT_TWD),o=this.PripravList0_Obycajne(n),r=this.PripravList0_Ucebne(n),s=[],l=[],c=[];switch(i.m_pAktPohlad.GetRiadkyTable()){case"students":$j.merge(l,s),$j.merge(c,o),$j.merge(c,r);break;case"classrooms":$j.merge(l,r),$j.merge(l,o),$j.merge(c,s);break;default:$j.merge(l,o),$j.merge(c,r),$j.merge(c,s)}this.m_List=[],l.forEach(function(e){e.m_bRozView_Zasednut||t.m_List.push(e)}),l.forEach(function(e){e.m_bRozView_Zasednut&&t.m_List.push(e)}),c.forEach(function(e){e.m_bRozView_Zasednut=!0,t.m_List.push(e)})}},m.prototype.PripravList0_Obycajne=function(t){for(var e=this.m_pRozApp.m_pTriedyView.m_pAktPohlad,i=[],n={},o=0;o<t.length;o++)for(var r=t[o],s=0;s<r.m_Karty.length;s++)(h=r.m_Karty[s]).JeUmiestnena()||(i.push(h),n[h.m_Id]=!0);for(var l=[],c={},m=0;m<i.length;m++){var h;if(!c[(h=i[m]).m_Id]){c[h.m_Id]=!0;var _=new a.CMHodina(this.m_pRok);(_.m_nRozView_TypKarty=0)<h.m_pHodina.m_Triedy.length&&_.SetPozicia(h.m_pHodina.m_Triedy[0]),_.Add(h),_.FinishAdding(),l.push(_);var u=null,d=_.m_Objects.classes;for(o=0;o<d.length;o++){var p=d[o];u=u||p}for(u&&"classes"==e.m_Table&&_.SetPozicia(u),_.m_nRozView_Ciselko=1;;){for(var f=!1,v=[],b=0;b<_.m_Objects.lessons.length;b++){r=_.m_Objects.lessons[b];for(var y=!1,g=0;g<r.m_Karty.length;g++)if(!c[(k=r.m_Karty[g]).m_Id]&&n[k.m_Id]){v.push(k),y=!0;break}if(!y){f=!0;break}}if(f)break;for(_.m_nRozView_Ciselko++,g=0;g<v.length;g++){var k;c[(k=v[g]).m_Id]=!0}}}}return l},m.prototype.PripravList0_Ucebne=function(t){var e=[],i=this.m_pRok;return t.forEach(function(t){var n=null;t.m_Karty.forEach(function(o){t.IsUvazujUcebne()&&o.JeUmiestnena()&&!o.VsetkyUcebneValid()&&(null==n&&((n=new a.CMHodina(i)).m_nRozView_TypKarty=1,e.push(n)),n.Add(o),n.m_nRozView_Ciselko++,n.FinishAdding())})}),e},m.prototype.UpdatePodKurzorom=function(){var t=this.m_pRok,e=this.$podkurzorom_d,i=this.$kontrola_podkurzorom_d,n=this.m_pRozApp.m_PodKurzoromMHodina;if(e.empty(),i.empty(),n.IsEmpty())e.css("visibility","hidden"),i.hide();else{if(e.css("visibility","visible"),i.show(),"classroomsupervisions"!=n.m_ModeTable){var a=this.m_pRozApp.m_pTriedyView.BuildRVKarta(n);e.append(a)}for(var s=0,l=["subjects","classes","teachers","classrooms"];s<l.length;s++){var c=l[s],m=ASC.createDiv(e.get(0),"detail");ASC.createChild(m,"img").src=o.CUtils.GetTableIcon(c),$j("<img>").appendTo(i).attr("src",o.CUtils.GetTableIcon(c));var h=r.CRokObject.ListIds(n.m_Objects[c]),_=t.dbi.rowNames(c,h,"short");"subjects"==c&&0<n.m_nPoradieSeminaru&&(_+=" ("+n.m_nPoradieSeminaru+")"),1==h.length&&"classes"!=c&&"classrooms"!=c&&(_=_+" - "+t.dbi.rowNames(c,h)),"classes"==c&&(0<n.m_Skupiny.length&&(_+=" "+n.m_Skupiny.join(", ")),n.m_bSeminar&&(_+=" "+ASC.ttls(2609))),"subjects"==c&&"classroomsupervisions"==n.m_ModeTable&&(_=ASC.ttls(3294)),ASC.createText(m,_),$j("<span style='margin-right:5px'>").appendTo(i).text(_)}var u=[],d=n.GetJedinaKarta(),p=n.GetJedinaHodina();d&&d.JeUmiestnena()?u=[t.GetObdobie_bits("terms",d.terms()),t.GetObdobie_bits("weeks",d.weeks())]:p&&(u=[p.m_pObdobie.terms,p.m_pObdobie.weeks]);for(var f=0,v=u;f<v.length;f++){var b=v[f];if("all"!=b.m_Typ&&1!=b.m_BitovePole[0].length){var y=ASC.createDiv(e.get(0),"detail");ASC.createChild(y,"img").src="/timetable/pics/app/term_week_day/"+("termsdefs"==b.m_Table?"b_2_A.png":"g_2_A.png"),ASC.createText(y,b.GetNazov())}}}this.m_bInvalidPodKurzorom=!1},m.prototype.ZobrazKontrolu=function(t,e){var i=this;this.m_pRozApp.m_nRozViewHeight<180&&(this.m_pRozApp.m_nRozViewHeight=180,this.UpdateHeight()),this.$kontrola_d.show(),this.$kontrola_chyby_d.empty();var n={width:"100%",height:"100%",cssClass:"base-dt",selectionMode:"single",idcol:"id",formatRow:function(t,e){$j(t).toggleClass("item-out",!!e.getData("locked"))}},r=[];t.forEach(function(t){r.push(t.GridRow())});for(var a={},s=0,l=["teachers","classes","classrooms","subjects","students","lessons","cards","classsubjects","globals"];s<l.length;s++){var c=l[s];a[c]=o.CUtils.GetTableIcon(c)}for(var m={},h=0,_=["default","low","normal","high","strict","optimize","disabled"];h<_.length;h++){var u=_[h];m[u]=o.CUtils.GetIconImportance(u)}var d=[{key:"zgrc",width:16,label:" ",formatter:function(t,e,n,o){var r=$j(t);r.empty().css({textAlign:"center"}).off();var a=i.m_pRozApp.m_ChybaItemsI[e.getData("id")],s="";if(a.IsZgrcnuta()){var l=n.table;r.css("cursor","pointer"),"+"==o?(s="/global/pics/ui/tree_plus.png",r.click(function(i){e.setData("zgrc","-"),n.formatter(t,e,n,e.getData("zgrc")),i.stopPropagation();for(var o=l.rows.indexOf(l.findDataRow(""+a.m_Id))+1,r=0,s=a.m_ZgrcnuteChyby;r<s.length;r++){var c=s[r];l.addRow(c.GridRow(),o++)}})):(s="/global/pics/ui/tree_minus.png",r.click(function(i){e.setData("zgrc","+"),n.formatter(t,e,n,e.getData("zgrc")),i.stopPropagation();for(var o=[],r=0,s=a.m_ZgrcnuteChyby;r<s.length;r++){var c=s[r];o.push(c.m_Id)}for(var m=0,h=o;m<h.length;m++){var _=h[m];l.ASC_deleteRow(_)}}))}else a.m_pZgrcParent&&(s="/global/pics/ui/tree_sub.png");s&&$j("<img>").appendTo(r).attr("src",s)}},{key:"importance",width:16,label:" ",icons:m},{key:"icon",width:16,label:" ",icons:a},{key:"object",width:170,label:ASC.ttls(3181)},{key:"icon2",width:16,label:" ",icons:{bad:"/timetable/pics/app/bug_small_16.png",ok:"/timetable/pics/app/ok_small_16.png",optimize:"/timetable/pics/app/importance_optimize_16.png",warning:"/timetable/pics/app/warning_32.png"}},{key:"description",width:500,label:ASC.ttls(1276),resizable:!0}],p=new ASC.ui.dt.DataTable($j("<div>").appendTo(this.$kontrola_chyby_d),d,new ASC.ui.dt.DataSource(r),n);p.fitWidth(),p.subscribe("select",function(){var t=i.m_pRozApp,e=p.ASC_getSelectedRowId();if(e){var n=t.m_ChybaItemsI[e];if(!e)throw"Error 9199507004";i.SetKontrolaItem(n)}});var f=ASC.ttls(1269),v="/timetable/pics/app/verification_128.png";"compare"==e&&(f=ASC.ttls(2819),v="/timetable/pics/app/office/compare_64.png"),this.$kontrola_detail_d.empty();var b=$j("<div style='text-align: center'>").appendTo(this.$kontrola_detail_d);b.text(f),b.append("<br>"),b.append("<img src='"+v+"' style='margin-top:20px'>"),this.$kontrola_podkurzorom_d.empty()},m.prototype.ZrusKontrolu=function(){this.$kontrola_d.hide()},m.prototype.SetKontrolaItem=function(t){var i=this,r=l.client_req,a=this.m_pRozApp,s=a.m_pTriedyView;if(a.m_pKontrolaItem!=t){var c=a.ttgpid;a.m_pKontrolaItem=t,a.InvalidateTriedyViewRiadky(),this.$kontrola_detail_d.empty(),$j("<div style='color:#0a539a;font-weight:bold;margin-bottom:5px'>").appendTo(this.$kontrola_detail_d).html(ASC.ttls(1034));var m=t.m_TextDetaily,h=ASC.escapeHTML(m);h=(h=h.split("&lt;imgchyba&gt;").join("<img src='/timetable/pics/app/bug_small_16.png'>")).split("&lt;imgok&gt;").join("<img src='/timetable/pics/app/ok_small_16.png'>"),$j("<div>").appendTo(this.$kontrola_detail_d).html(h);var _=$j("<div style='position:absolute;right:5px;bottom:0px'>").appendTo(this.$kontrola_detail_d);t.m_HelpID&&$j("<a style='cursor:pointer;margin-left:10px'>").prependTo(_).click(function(){i.m_pRozApp.ShowHelp(t.m_HelpID)}).text(ASC.ttls(3050)).prepend("<img src='/global/pics/ui/help_32.png' style='vertical-align:middle;margin-right:3px'>");var u=null,d=t.m_pNastavObject,p=function(t){return n.__awaiter(i,void 0,void 0,function(){return n.__generator(this,function(i){switch(i.label){case 0:return[4,ASC.blockUI(Promise.resolve().then(function(){return e("./dlg")}))];case 1:return i.sent().showItemDlg(c,t.m_Table,t.m_Id),[2]}})})};switch(t.m_Nastav){case"edit":case"timeoff":case"constraints":d&&(u=function(){d.UI_OnCommand(t.m_Nastav,s)});break;case"constraints-advanced":"classes"==d.m_Table&&d&&(u=function(){d.UI_OnCommand("constraints",s)});break;case"vztah":case"vztahadv":d&&(u=function(){i.m_pRozApp.click_func("edit","table="+d.m_Table+"&id="+d.m_Id)});break;case"constraints/global":break;case"ziak":case"coursegroup":u=function(){return p(d)};break;case"hodina":case"hodina/predmetconstraints/seminareadv":case"hodina/predmetconstraints":u=function(){return n.__awaiter(i,void 0,void 0,function(){var a,s,l,m,h;return n.__generator(this,function(_){switch(_.label){case 0:for(a=[],s=d,l=0,m=t.m_Nastav.split("/");l<m.length;l++)switch(h=m[l]){case"hodina":a.push({id:h,title:o.CUtils.GetUINazovSTypom(s),onClick:function(){return p(s)}});break;case"predmetconstraints":a.push({id:h,title:o.CUtils.GetUINazovSTypom(s.m_pPredmet),onClick:function(){return t=s.m_pPredmet,n.__awaiter(i,void 0,void 0,function(){return n.__generator(this,function(i){switch(i.label){case 0:return[4,ASC.blockUI(Promise.resolve().then(function(){return e("./constraints")}))];case 1:return i.sent().showTTDocConstraintsDlg(c,t.m_Table,t.m_Id),[2]}})});var t}});break;case"seminareadv":a.push({id:h,title:r.ttls(3756),onClick:function(){return ASC.blockUI(Promise.resolve().then(function(){return e("./students_dlg")})).then(function(t){return t.showSeminarParametersDlg(c)})}})}return 1!=a.length?[3,1]:(a[0].onClick(),[3,3]);case 1:return[4,ASC.blockUI(Promise.resolve().then(function(){return e("../../react/chooseoption_r")}))];case 2:_.sent().showChooseOption({title:r.ttls(1680),options:a}),_.label=3;case 3:return[2]}})})}}if(u&&$j("<a style='cursor:pointer'>").prependTo(_).click(function(){u()}).text(ASC.ttls(1680)).prepend("<img src='/global/pics/ui/settings_32.png' style='vertical-align:middle;margin-right:3px'>"),!t.ScrollTo()){var f=s.GetPohladForTable(t.GetIdealPohladTable());f&&(s.SetAktPohlad(f),t.ScrollTo())}}},m.prototype.RightClickPendingArea=function(t){var e=[],i=this.m_pRozApp,n=i.m_pRok,r=i.m_pRadSelector;o.CUtils.AddMenuItemSmart(e,"",{text:ASC.ttls(1607),checked:r.JeCelok(),onclick:function(){r.SetCelok(),i.InvalidateSelector()}}),e.push([]);for(var s=0,l=["classes","teachers","subjects","classrooms"];s<l.length;s++){var c=l[s];o.CUtils.AddMenuItemSmart(e,"",{text:o.CUtils.GetTableName(c),checked:r.m_Table==c,submenu:this.OblastMenu(c)})}e.push([]),o.CUtils.AddMenuItemSmart(e,"filter",{text:ASC.ttls(3508),submenu:o.CUtils.AdvFilterMenuBuild(r.m_nAdvFilterOptions),checked:0!=r.m_nAdvFilterOptions}),e.push([]),o.CUtils.AddMenuItemSmart(e,"test",{onclick:function(){if(r.m_nAdvFilterOptions){var t=[],e=i.m_pTriedyView.m_nROJTF,o=r.GetVybraneHodiny(e|a.ROJTF_FILTER_AKT_TWD);t=o.map(function(t){return["lessons",t.m_Id]});for(var s=0,l=n.TableObjects("studentsubjects");s<l.length;s++)for(var c=l[s],m=0,h=o;m<h.length;m++){var _=h[m];if(_.m_pPredmet==c.m_pPredmet&&_.m_KurzyPreTriedy.includes(c.m_pZiak.m_pTrieda)){t.push(["studentsubjects",c.m_Id]);break}}i.ClickGenerate({sel:t})}else i.ClickGenerate({sel:!0})}}),ASC.showContextMenu(e,t,{handler:function(t){"advfilter"==t.cmd&&(r.m_nAdvFilterOptions=o.CUtils.AdvFilterMenuHandle(t,r.m_nAdvFilterOptions),i.InvalidateSelector())}})},m.prototype.OblastMenu=function(t){var e=this,i=[],n=this.m_pRozApp.m_pRadSelector;return this.m_pRok.TableObjects(t).forEach(function(t){o.CUtils.AddMenuItemSmart(i,"",{text:o.CUtils.GetUINazov(t),data:t,checked:n.IsInRad(t),onclick:function(){n.SetCelok(),n.AddRadObject(t),e.m_pRozApp.InvalidateSelector()}})}),i},m.prototype.RightClickKarta=function(t,i){var r=this,a=[],s=this.m_pRozApp,l=i.GetJedinaKarta(),c=s.m_pTriedyView,m="";switch(m=l?o.CUtils.GetUINazov(l,"short"):o.CUtils.GetUINazvy(i.Predmety(),"short"),i.m_nRozView_TypKarty){case 0:m=ASC.ttls(3497)+" - "+m;break;case 1:m=ASC.ttls(3499)+" - "+m;break;case 2:m=ASC.ttls(3493)+" - "+m}var h=m;switch(1<i.m_nRozView_Ciselko&&(m+=" ("+i.m_nRozView_Ciselko+"x)"),i.m_nRozView_TypKarty){case 0:if(o.CUtils.AddMenuItemSmart(a,"",{text:ASC.ttls(4054),onclick:function(){s.Chyt(i)}}),1<i.Karty().length){a.push([]);var _=[];i.Karty().forEach(function(t){o.CUtils.AddMenuItemSmart(_,"",{text:o.CUtils.GetUINazov(t),data:t,onclick:function(){s.ChytKartu(t)}})}),o.CUtils.AddMenuItemSmart(a,"",{text:ASC.ttls(2958),submenu:_})}break;case 1:o.CUtils.AddMenuItemSmart(a,"",{text:ASC.ttls(1761),onclick:function(){s.Chyt(i)}})}a.push([]);var u=i.GetJedinaHodina();u&&(u.UI_HodinaPopup(a,c),a.push({text:ASC.ttls(4029),onclick:function(){return n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./quickchanges")})];case 1:return t.sent().showQuickChanges({ttgpid:s.ttgpid,lessonid:u.m_Id}),[2]}})})}})),ASC.showContextMenu(a,t,{header:ASC.escapeHTML(h)})},m);function m(t,e){var i=this;this.m_bInvalid=!1,this.m_bInvalidPodKurzorom=!1,this.m_List=[],this.m_pRozApp=t,this.$div=e,this.m_pRadSelector=this.m_pRozApp.m_pRadSelector,this.m_pRok=this.m_pRozApp.m_pRok,this.$div.addClass("rozview"),this.$pending_d=$j("<div class='pending-area'>").appendTo(this.$div),this.$podkurzorom_d=$j("<div class='podkurzorom'>").appendTo(this.$div),this.$rad_icons_d=$j("<div class='rad_icons'>").appendTo(this.$div),this.$kontrola_d=$j("<div class='kontrola'>").appendTo(this.$div).hide(),this.$kontrola_detail_d=$j("<div class='detail'>").appendTo(this.$kontrola_d),this.$kontrola_chyby_d=$j("<div class='chyby'>").appendTo(this.$kontrola_d),this.$kontrola_podkurzorom_d=$j("<div class='kontrola_podkurzorom'>").appendTo(this.$kontrola_d),this.$div.mousemove(function(t){i.m_pRozApp.CursorMove(t)}),this.$pending_d.click(function(t){i.m_pRozApp.OdhodKartu()}),this.$pending_d.on("contextmenu",function(e){ASC.hideContextMenu(),t.m_TahanaMHodina.IsEmpty()?i.RightClickPendingArea(e):t.OdhodKartu(),e.stopPropagation(),e.preventDefault()});var n=this;this.m_OnMouseClickKarta=function(e){if(ASC.hideContextMenu(),t.m_TahanaMHodina.IsEmpty()){var i=this.ASC_mh;i.m_bRozView_Zasednut?n.RightClickKarta(e,i):n.m_pRozApp.Chyt(i)}else t.OdhodKartu();e.stopPropagation()},this.m_OnMouseRightClickKarta=function(e){if(ASC.hideContextMenu(),t.m_TahanaMHodina.IsEmpty()){var i=this.ASC_mh;n.RightClickKarta(e,i)}else t.OdhodKartu();e.stopPropagation(),e.preventDefault()}}t.CRozView=c;var h,_,u,d=(p.prototype.SetCelok=function(){this.m_Table="globals",this.m_Objects.length=0,this.m_nAdvFilterOptions=0},p.prototype.JeCelok=function(){return"globals"==this.m_Table&&0==this.m_nAdvFilterOptions},p.prototype.AddRadObject=function(t){var e=t.m_Table;e!=this.m_Table&&(this.m_Table=e,this.m_Objects.length=0),this.m_Objects.indexOf(t)<0&&this.m_Objects.push(t)},p.prototype.RemoveRadObject=function(t){t.m_Table==this.m_Table&&(o.CUtils.FastRemove(this.m_Objects,t),0==this.m_Objects.length&&(this.m_Table="globals"))},p.prototype.IsInRad=function(t){return this.m_Table==t.m_Table&&0<=this.m_Objects.indexOf(t)},p.prototype.GetVybraneHodiny=function(t){var e=this,i=this.m_pRok,n=[],r=i.m_ObjectsO.lessons;switch(this.m_Table){case"classes":case"teachers":case"subjects":for(var l=0;l<this.m_Objects.length;l++)o.CUtils.AddListToSet(this.m_Objects[l].GetHodinyMozuSem(t),n);break;default:for(l=0;l<r.length;l++){var c=r[l];n.push(c)}}if(0!=(t&a.ROJTF_FILTER_AKT_TWD))for(var m=this.m_pRozApp.m_pTriedyView.m_pAktObdobie,h=function(t){var e=m[t].GetSumBitov();if(!e.includes("0"))return"continue";n=n.filter(function(i){var n=i.m_pObdobie[t].GetSumBitov();return s.bitfieldIsOverlap(e,n)})},_=0,u=["terms","weeks","days"];_<u.length;_++)h(u[_]);return n=n.filter(function(t){return o.CUtils.AdvFilterPass(e.m_nAdvFilterOptions,t,null)})},p.prototype.GetJediny=function(){return 1==this.m_Objects.length?this.m_Objects[0]:null},p.prototype.GetRadList=function(){return ASC.cloneArray(this.m_Objects)},p.prototype.GetRadStr=function(t){return t!=this.m_Table?"":o.CUtils.GetUINazvy(this.m_Objects,"short")},p.prototype.GetSimplePopis=function(t){void 0===t&&(t=!1);var e="";if("globals"==this.m_Table)t&&0!=this.m_nAdvFilterOptions||(e="All");else{var i=this.GetRadList();if(!i)return"???";e=i.length<=4?o.CUtils.GetUINazvy(i,i.length<=1?"short_name":"short"):i.length+" "+o.CUtils.GetTableItemTypNazov(this.m_Table,i.length)}return e=e.replace("\t"," "),t&&0!=this.m_nAdvFilterOptions&&(""!=e&&(e+=", "),e+=o.CUtils.AdvFilterPopis(this.m_nAdvFilterOptions)),e},p);function p(t){this.m_Table="globals",this.m_Objects=[],this.m_nAdvFilterOptions=0,this.m_pRozApp=t,this.m_pRok=this.m_pRozApp.m_pRok}t.CRadSelector=d,(_=h=t.CHYBAITEMIKONA||(t.CHYBAITEMIKONA={}))[_.CHYBAITEMIKONA_OK=0]="CHYBAITEMIKONA_OK",_[_.CHYBAITEMIKONA_CHYBA=1]="CHYBAITEMIKONA_CHYBA",_[_.CHYBAITEMIKONA_WARNING=2]="CHYBAITEMIKONA_WARNING",_[_.CHYBAITEMIKONA_OPTIMIZE=3]="CHYBAITEMIKONA_OPTIMIZE",(u=t.WARNINGTTYPE||(t.WARNINGTTYPE={}))[u.WT_NIC=0]="WT_NIC",u[u.WT_NESPLNITELNA=1]="WT_NESPLNITELNA",u[u.WT_NEIMPLEMENTOVANA_VIACDELENI=2]="WT_NEIMPLEMENTOVANA_VIACDELENI",u[u.WT_NEIMPLEMENTOVANA_CYKLUSVTRIEDE=3]="WT_NEIMPLEMENTOVANA_CYKLUSVTRIEDE",u[u.WT_VYPNUTA=4]="WT_VYPNUTA",u[u.WT_NEIMPLEMENTOVANA_CYKLUSHODINY=5]="WT_NEIMPLEMENTOVANA_CYKLUSHODINY",u[u.WT_CHYBNA=6]="WT_CHYBNA",u[u.WT_NEIMPLEMENTOVANA=7]="WT_NEIMPLEMENTOVANA",u[u.WT_VYPNUTA_VELA_KARIET=8]="WT_VYPNUTA_VELA_KARIET";var f=(v.prototype.FindRiadok=function(t){for(var e=0,i=this.m_Riadky;e<i.length;e++){var n=i[e];if(n.m_pRiadokObject==t)return n}return null},v.prototype.GridRow=function(){var t={id:this.m_Id,zgrc:"",importance:this.m_Importance,icon:this.m_pKde?this.m_pKde.m_Table:"",object:o.CUtils.GetUINazov2(this.m_pKde,this.m_pKde2,"short_name"),icon2:"",description:this.m_Text,locked:this.m_bLocked};switch(this.m_nIkona){case h.CHYBAITEMIKONA_CHYBA:t.icon2="bad";break;case h.CHYBAITEMIKONA_OK:t.icon2="ok";break;case h.CHYBAITEMIKONA_OPTIMIZE:t.icon2="optimize";break;case h.CHYBAITEMIKONA_WARNING:t.icon2="warning"}if(this.IsZgrcnuta()){t.object=this.m_ZgrcnuteChyby.length+"x",t.zgrc="+";var e=this.m_ZgrcnuteChyby[0];t.icon=e.m_pKde?e.m_pKde.m_Table:""}else this.m_pZgrcParent&&(t.zgrc=".");return this.m_bHeuristika&&(t.description=ASC.ttls(3635)+": "+t.description),""!=this.m_TextAppend&&(t.description+=": "+this.m_TextAppend),t},v.prototype.ScrollTo=function(){var t=this.m_pRok.m_pRozApp,e=t.m_pTriedyView;t.Validate();for(var i=[],n=0,o=e.m_Riadky;n<o.length;n++){var r=o[n];this.FindRiadok(r.m_pRokObject)&&i.push(r)}return 0!=i.length&&(e.ScrollToRiadky(i),!0)},v.prototype.GetIdealPohladTable=function(){for(var t=["teachers","classes","students","classrooms","subjects"],e=0,i=this.m_Riadky;e<i.length;e++){var n=i[e].m_pRiadokObject.m_Table;if(0<=t.indexOf(n))return n}return""},v.prototype.GetKdeTable=function(){return this.m_pKde?this.m_pKde2&&"classes"==this.m_pKde.m_Table&&"subjects"==this.m_pKde2.m_Table?"classsubjects":this.m_pKde.m_Table:""},v.prototype.IsZgrcnuta=function(){return 0<this.m_ZgrcnuteChyby.length},v.nextId=1,v);function v(t,e){var i,n;if(this.m_pKde=null,this.m_pKde2=null,this.m_PodmienkaNazov="",this.m_HelpID="",this.m_Text="",this.m_TextAppend="",this.m_TextDetaily="",this.m_Importance="",this.m_bLocked=!1,this.m_bHeuristika=!1,this.m_nIkona=-1,this.m_nWarningType=-1,this.m_Nastav="",this.m_pNastavObject=null,this.m_ZgrcnuteChyby=[],this.m_pZgrcParent=null,this.m_Riadky=[],this.m_pRok=t,this.m_Id=""+v.nextId++,t.m_pRozApp.m_ChybaItemsI[this.m_Id]=this,e){this.m_PodmienkaNazov=e.m_PodmienkaNazov,this.m_HelpID=e.m_HelpID,this.m_Text=e.m_Text,this.m_TextAppend=e.m_TextAppend,this.m_TextDetaily=e.m_TextDetaily,this.m_Importance=e.importance||((i={})[-1]="default",i[0]="low",i[1]="normal",i[2]="high",i[3]="strict",i[4]="optimize",i[5]="alternative",i[6]="disabled",i[7]="alternative2",i)[e.m_TextZoskupPriorita]||"",(""==this.m_TextAppend||0<(null===(n=e.m_ZgrcnuteChyby)||void 0===n?void 0:n.length))&&e.m_TextZoskupExtraText&&e.m_TextZoskupExtraText!=e.m_Text&&(this.m_TextAppend=e.m_TextZoskupExtraText),this.m_bLocked=e.m_bLocked,this.m_bHeuristika=e.m_bHeuristika,this.m_nIkona=e.m_nIkona,this.m_nWarningType=e.m_nWarningType,this.m_pKde=t.decodeRo(e.m_pKde),this.m_pKde2=t.decodeRo(e.m_pKde2),this.m_Nastav=e.m_Nastav,this.m_pNastavObject=t.decodeRo(e.m_pNastavObject);for(var o=0,r=e.m_Riadky;o<r.length;o++){var a=r[o];this.m_Riadky.push(new b(this,a))}if(e.m_ZgrcnuteChyby)for(var s=0,l=e.m_ZgrcnuteChyby;s<l.length;s++){var c=new v(t,l[s]);this.m_ZgrcnuteChyby.push(c),c.m_pZgrcParent=this}}}t.CChybaItem=f,t.blank_ChybaItem_JSON={m_Text:"",m_TextAppend:"",m_TextDetaily:"",m_TextZoskupPriorita:"",m_TextZoskupExtraText:"",m_Riadky:[]};var b=function(t,e){this.m_RelevantneHodiny={},this.m_ZleKarty={},this.m_pChybaItem=t,this.m_pRiadokObject=t.m_pRok.decodeRo(e.m_pRiadokObject);for(var i=0,n=e.m_RelevantneHodiny;i<n.length;i++){var o=n[i];this.m_RelevantneHodiny[o]=!0}for(var r=0,a=e.m_ZleKarty;r<a.length;r++)o=a[r],this.m_ZleKarty[o]=!0;this.m_pVysvietZle=e.m_pVysvietZle,this.m_pVysviet1=e.m_pVysviet1,this.m_pVysviet2=e.m_pVysviet2};t.CChybaItemRiadok=b},"/timetable/app/rokobject.js":function(t,e,i){t.__esModule=!0;var n=e("tslib");t.nMaxVyucHodin=32,t.nMaxDniVTyzdni=10,t.nMaxTyzdnov=20,t.nMaxTermov=12,t.nMaxDuration=8,t.ttapp_needed_part={globals:["name","settings","year","reg_name"],ttreports:["typ","name","page_tables","row_tables","column_tables","celltype","cellwidth","cellheight","fitwidth","fitheight","landscape","repeatpage","splitpage_w","splitpage_h","withclassroomtt","hideemptyrows","hideemptycolumns","headerwidth","headerheight","cardstyles","cardcolorenabled","cardcolortable1","cardcolortable2","cardcolorpos","classroomsupervisionstyle","gridheadertexts","pageheader","pageheaderprefixenabled","userheader","printlogo","extracolumns","extrarows","settings"],periods:["period","name","short","starttime","endtime","daydata","printinsummary","printinteacher","printinclass","printinclassroom","printonlyinbells"],breaks:["break","name","short","starttime","endtime","daydata","printinsummary","printinteacher","printinclass","printinclassroom","printonlyinbells","printtext"],bells:["bell","perioddata","breakdata"],daysdefs:["name","short","typ","vals","val"],weeksdefs:["name","short","typ","vals","val"],termsdefs:["name","short","typ","vals","val"],teachers:["firstname","lastname","nameprefix","namesuffix","short","bell","color","fontcolorprint","fontcolorprint2","fontcolorscreen","timeoff","gender"],classes:["name","short","teacherid","classroomids","bell","color","timeoff","printsubjectpictures"],groups:["name","classid","entireclass","ascttdivision","okgroup","students_count","color"],subjects:["name","short","color","picture_url","timeoff","contract_weight"],buildings:["name","short","color"],classrooms:["name","short","sharedroom","buildingid","needssupervision","color","nearbyclassroomids"],students:["firstname","lastname","classid","groupids","short"],lessons:["subjectid","teacherids","groupids","classids","count","durationperiods","classroomidss","termsdefid","weeksdefid","daysdefid","terms","seminargroup","bell"],cards:["lessonid","period","days","weeks","classroomids"],studentsubjects:["studentid","subjectid","seminargroup","importance","locked"],classroomsupervisions:["classroomid","teacherid","day","week","term","period","break","locked"],coursegroups:["name"]};var o=(r.prototype.timeoff=function(){return this.m_Data.timeoff||null},r.prototype.InitFromData=function(){},r.prototype.BeforeRemove=function(){},r.prototype.GetNazov=function(t){return void 0===t&&(t="name"),this.m_pRok.dbi.rowName(this.m_Table,this.m_Id,t)},r.prototype.GetSkratka=function(){return this.m_pRok.dbi.rowName(this.m_Table,this.m_Id,"short")},r.prototype.GetColor=function(){return""+this.m_Data.color},r.prototype.GetDBIndex=function(){return this.m_pRok.m_ObjectsO[this.m_Table].indexOf(this)},r.prototype.HodinaMozeSem=function(t,e){return!0},r.prototype.GetHodinyMozuSem=function(t){var e=this.m_pRok.m_ObjectsI.lessons,i=[];for(var n in e){var o=e[n];this.HodinaMozeSem(o,t)&&i.push(o)}return i},r.prototype.GetKartyMozuSem=function(t){var e=[];return this.GetHodinyMozuSem(t).forEach(function(t){$j.merge(e,t.m_Karty)}),e},r.prototype.GetKartyTu=function(t){var e=this.GetHodinyMozuSem(t),i=[];for(var n in e){var o=e[n];for(var r in o.m_Karty){var a=o.m_Karty[r];this.KartaJeTu(a,t)&&i.push(a)}}return i},r.prototype.GetKartyTuTWDH=function(t,e,i,n,o){for(var r=this.GetKartyTu(o),a=[],s=0;s<r.length;s++){var l=r[s];l.JeTu_TWDH(t,e,i,n)&&a.push(l)}return a},r.prototype.KartaJeTu=function(t,e){return!!t.JeUmiestnena()&&this.HodinaMozeSem(t.m_pHodina,e)},r.ListIds=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].m_Id);return e},r.prototype.UI_KartaVyberOdtialto=function(t,e,i,n){return!i.IsLocked()&&(t.InvalidateKarta(i),i.DeUmiestniKarta(),t.InvalidatePending(),t.ChytKartu(i,this),t.CursorMove(n),!0)},r.prototype.UI_ChooseObdobie=function(t,e,i){return n.__awaiter(this,void 0,void 0,function(){var o,r,a,s,l=this;return n.__generator(this,function(c){switch(c.label){case 0:return[4,(o=function(e,o){return n.__awaiter(l,void 0,void 0,function(){var r,a,s,l,c,m;return n.__generator(this,function(n){switch(n.label){case 0:if(r=t.m_pRok,a=t.m_pObdobie[e],0==(s=a.m_BitovePole.filter(function(t){return o<0||"1"==t[o]})).length)return[2,null];if(1==s.length)return[2,s[0]];if("terms"==e&&t.m_Data.terms)for(l=t.m_Data.terms,c=0,m=t.m_Karty;c<m.length;c++)if(m[c].JeUmiestnena()&&l.includes("1"))return[2,l];return[4,new Promise(function(t){ASC.showContextMenu(s.map(function(i){return{text:rt.obdobieName(r.dbi,e,i),onclick:function(){return t(i)}}}),i)})];case 1:return[2,n.sent()]}})})})("terms",e.m_nTerm)];case 1:return(r=c.sent())?[4,o("weeks",e.m_nWeek)]:[2,null];case 2:return(a=c.sent())?[4,o("days",e.m_nDay)]:[2,null];case 3:return(s=c.sent())?[2,{terms:r,weeks:a,days:s}]:[2,null]}})})},r.prototype.UI_KartaUmiestni=function(t,e,i,o){return n.__awaiter(this,void 0,void 0,function(){var r,a,s,l,c,m,h,_,u,d,p,f,v,b,y,g,k,T,S,C,A,w,I,R,P,O,D;return n.__generator(this,function(n){switch(n.label){case 0:for(r=t.m_pRok,a=e.m_Objects.cards,s=null,l=0,c=a;l<c.length;l++)if(!(O=c[l]).JeUmiestnena()){if(!this.HodinaMozeSem(O.m_pHodina,t.m_pTriedyView.m_nROJTF))return[2];s=s||O}return s&&s.Obdobia_MozeSem_TWDH(i.m_nTerm,i.m_nWeek,i.m_nDay,i.period)?[4,this.UI_ChooseObdobie(s.m_pHodina,i,o)]:[2];case 1:if(!(m=n.sent()))return[2];if(h=m.terms,_=m.weeks,u=m.days,d=i.period,1<s.m_pHodina.m_pObdobie.terms.m_BitovePole.length){for(p=[],f=0,v=a;f<v.length;f++)if((O=v[f]).m_pHodina.GetTerm()!=h)for(b=0,y=O.m_pHodina.m_Karty;b<y.length;b++)(g=y[b]).JeUmiestnena()&&p.push(g);if(0<p.length)return alert("Lesson is already in another term"),[2]}for(k=[],T=[],S=0,C=a;S<C.length;S++)O=C[S],r.ChangePosKarta_TWDH(O,h,_,u,d,!1),O.SimpleKolizie(k),O.SimpleKolizie(T,!0),O.DeUmiestniKarta();if(A=function(){a.forEach(function(e){r.ChangePosKarta_TWDH(e,h,_,u,d,!0),t.InvalidateKarta(e)}),t.InvalidatePending();var e=t.m_bTahanaDajKontrolu;t.OdhodKartu(),e&&(t.m_bTahanaDajKontrolu=!1,t.ClickVerification("verification","sel"))},w=function(){k.forEach(function(e){e.IsLocked()||(e.DeUmiestniKarta(),t.InvalidateKarta(e))}),A()},0==k.length)return A(),[2];for(I=!1,R=0,P=k;R<P.length;R++)(O=P[R]).IsLocked()&&(I=!0);return 1!=k.length||I||!this.KartaJeTu(k[0],t.m_pTriedyView.m_nROJTF)||o.shiftKey?(D=[],k.forEach(function(e){D.push({text:tt.CUtils.GetUINazov(e),icon:tt.CUtils.GetIconLocked(e.IsLocked(),!0)||tt.CUtils.GetIconNic(),disabled:I,onclick:function(){w(),t.ChytKartu(e)}})}),D.push([]),I||D.push({text:ASC.ttls(3448),icon:tt.CUtils.GetIconOK(),onclick:function(){w()}}),D.push({text:ASC.ttls(1007),icon:tt.CUtils.GetIconNic(),onclick:function(){}}),D.push([]),D.push({text:ASC.ttls(3449),icon:tt.CUtils.GetIconNic(),onclick:function(){A()}}),ASC.showContextMenu(D,o,{header:ASC.ttls(3447)+":"})):(w(),t.ChytKartu(k[0])),[2]}})})},r.prototype.UI_RiadokPopup=function(t,e){},r.prototype.UI_OnCommand=function(t,i,n){void 0===n&&(n=null);var o=i.m_pRozApp,r=o.ttgpid,a=this.m_Table,s=this.m_Id;switch(t){case"edit":return o.click_func(t,"table="+this.m_Table+"&id="+s),!0;case"timeoff":return void Promise.resolve().then(function(){return e("./timeoff")}).then(function(t){return t.showTTDocTimeoffDlg(r,a,s)});case"lessons":return void Promise.resolve().then(function(){return e("./lesson_dlg")}).then(function(t){var e;return t.showLessonsDlg(r,((e={})[nt.DBITools.removeEs(a)+"id"]=s,e))});case"constraints":return Promise.resolve().then(function(){return e("./constraints")}).then(function(t){return t.showTTDocConstraintsDlg(r,a,s)}),!0;case"deletecards":case"lockcards":case"unlockcards":return this.GetKartyTu(i.m_nROJTF).forEach(function(e){switch(t){case"deletecards":e.IsLocked()||(o.InvalidateKarta(e),e.DeUmiestniKarta());break;case"lockcards":e.IsLocked()||(o.InvalidateKarta(e),e.SetLocked(!0));break;case"unlockcards":e.IsLocked()&&(o.InvalidateKarta(e),e.SetLocked(!1))}}),!0;case"removecard":var l=n;o.InvalidateKarta(l),l.DeUmiestniKarta();break;case"lockcard":l=n,o.InvalidateKarta(l),l.SetLocked(!0);break;case"unlockcard":l=n,o.InvalidateKarta(l),l.SetLocked(!1)}return!1},r.prototype.AddKartyTuK=function(t,e,i){if(e.JeUmiestnena())for(var n=e.GetHodinaOd();n<=e.GetHodinaDo();n++)for(var o=0;o<=this.m_pRok.m_nTermov;o++)for(var r=0;r<this.m_pRok.m_nTyzdnov;r++)for(var a=0;a<this.m_pRok.m_nDni;a++)e.JeTu_TWDH(o,r,a,n)&&this.AddKartyTu(t,o,r,a,n,i)},r.prototype.AddKartyTu=function(t,e,i,n,o,r){for(var a=0,s=this.GetKartyTu(r);a<s.length;a++){var l=s[a];l.JeTu_TWDH(e,i,n,o)&&(t.includes(l)||t.push(l))}},r.prototype.GetObsadenieK=function(t){var e=[];return this.AddKartyTuK(e,t,0),e},r.prototype.UI_KartaMozeSem=function(t,e){for(var i=0,n=e.m_Objects.cards;i<n.length;i++){var o=n[i];if(!o.JeUmiestnena()&&this.HodinaMozeSem(o.m_pHodina,t.m_pTriedyView.m_nROJTF))return!0}return!1},r.prototype.UI_GetKartyNaPolicko=function(t,e){var i=this,n=[];return this.GetKartyMozuSem(t.m_nROJTF).forEach(function(t){if(!t.JeUmiestnena()&&t.Obdobia_MozeSem_TWDH(e.m_nTerm,e.m_nWeek,e.m_nDay,e.period,!0)){var o=t.m_pHodina.GetTermPrvyDobry(e.m_nTerm),r=t.m_pHodina.GetWeekPrvyDobry(e.m_nWeek),a=t.m_pHodina.GetDenPrvyDobry(e.m_nDay),s=e.period,l=[];i.m_pRok.ChangePosKarta_TWDH(t,o,r,a,s,!1);var c=i.m_pRok.VhodnostKarty_PUT(t);t.SimpleKolizie(l),t.DeUmiestniKarta(),"0"!=c&&(0<l.length||n.push(t))}}),n},r.prototype.GetSaveID=function(){return this.m_pRok.m_ObjectsO[this.m_Table].indexOf(this)},r.prototype.updateData=function(t){var e=!1;for(var i in t){var n=t[i];void 0!==n&&n!==this.m_Data[i]&&(this.m_Data[i]=n,e=!0)}e&&this.m_pRok.m_pRozApp.InvalidateObject(this)},r);function r(t,e,i){this.m_pRok=t,this.m_Table=e,this.m_Id=""+i.id,this.m_Data=i}t.CRokObject=o;var a,s=(a=o,n.__extends(l,a),l.prototype.StructureFromData=function(){this.m_nHodinyOd=32;for(var e=this.m_nHodinyDo=0;e<t.nMaxVyucHodin;e++)this.GetPeriod(e)&&(this.m_nHodinyOd=Math.min(this.m_nHodinyOd,e),this.m_nHodinyDo=Math.max(this.m_nHodinyDo,e));var i={terms:"",weeks:"",days:""};for(var n in i)for(;this.GetObdobie_One(n,i[n].length);)i[n]+="1";this.m_nDni=i.days.length,this.m_nTyzdnov=i.weeks.length,this.m_nTermov=i.terms.length,this.m_DaysAll=i.days,this.m_WeeksAll=i.weeks,this.m_TermsAll=i.terms},l.prototype.addRow=function(t,e){var i;switch(t){case"cards":i=new U(this,e);break;case"lessons":i=new G(this,e);break;case"classes":i=new m(this,e);break;case"teachers":i=new y(this,e);break;case"subjects":i=new T(this,e);break;case"students":i=new A(this,e);break;case"studentsubjects":i=new R(this,e);break;case"classrooms":i=new D(this,e);break;case"groups":i=new u(this,e);break;case"termsdefs":case"weeksdefs":case"daysdefs":i=new E(this,t,e);break;case"periods":i=new L(this,e);break;case"breaks":i=new W(this,e);break;case"ttreports":i=new it.CTlacZostava(this,e);break;case"ttviews":i=new tt.CPohlad(this,e);break;case"classroomsupervisions":i=new q(this,e);break;default:i=new o(this,t,e)}return this.m_ObjectsO[t].push(i),this.m_ObjectsI[t][e.id]=i},l.prototype.deleteRow=function(t,e){var i=this.m_ObjectsI[t][e];if(i){i.BeforeRemove(),delete this.m_ObjectsI[t][e];var n=this.m_ObjectsO[t],o=n.indexOf(i);n.splice(o,1)}},l.prototype.ids2ro=function(t,e){for(var i=[],n=0;n<e.length;n++)i.push(this.m_ObjectsI[t][e[n]]);return i},l.prototype.ChangePosKarta_TWDH=function(t,e,i,n,o,r){void 0===r&&(r=!1);var a=t.m_pHodina;ASC.assert(a.m_pObdobie.terms.IsCompatible(e)),ASC.assert(a.m_pObdobie.weeks.IsCompatible(i)),ASC.assert(a.m_pObdobie.days.IsCompatible(n)),t.SetPosition(n,o,e,i),r&&t.DajUcebnu()},l.prototype.GetObdobie_bits=function(t,e){for(var i=this.m_ObjectsO[t+"defs"],n=0;n<i.length;n++){var o=i[n];if(1==o.m_BitovePole.length&&o.m_BitovePole[0]==e)return o}return null},l.prototype.GetDen_bits=function(t){return this.GetObdobie_bits("days",t)},l.prototype.GetObdobieCount=function(t){switch(t){case"terms":return this.m_nTermov;case"weeks":return this.m_nTyzdnov;case"days":return this.m_nDni}throw"Error 2260283089"},l.prototype.GetObdobie_One=function(t,e){for(var i=this.m_ObjectsO[t+"defs"],n=0;n<i.length;n++){var o=i[n];if("one"==o.m_Typ&&o.m_Val==e)return o}return null},l.prototype.GetPeriod=function(t,e){return void 0===e&&(e=!1),e?this.m_ObjectsI.breaks[t]:this.m_ObjectsI.periods[t]},l.prototype.VhodnostKarty_PUT=function(t){for(var e=t.m_pHodina,i=t.GetVolno(e.m_pPredmet.timeoff()),n=0,o=e.m_Triedy;n<o.length;n++){var r=o[n];i=at.defaultVolnoJoiner(i,t.GetVolno(r.timeoff()))}for(var a=0,s=e.m_Ucitelia;a<s.length;a++){var l=s[a];i=at.defaultVolnoJoiner(i,t.GetVolno(l.timeoff()))}return i},l.prototype.TableObjects=function(t){switch(t){case"days":case"weeks":case"terms":for(var e=[],i=0,n=this.m_ObjectsO[t+"defs"];i<n.length;i++){var o=n[i];"one"==o.m_Typ&&e.push(o)}return e;default:return this.m_ObjectsO[t].slice()}},l.prototype.Obdobia=function(t){switch(t){case"termsdefs":case"weeksdefs":case"daysdefs":return this.TableObjects(t)}throw"Error 8110791570"},l.prototype.GetRegName=function(t){void 0===t&&(t=!1);var e="";this.m_pRozApp&&(e=this.m_pRozApp.jsc.reg_name);var i=this.dbi.rowData("globals","1");return i&&i.reg_name&&(e=i.reg_name),e||"Unregistered version"},l.prototype.decodeRo=function(t){if(!t)return null;var e=t[0],i=t[1];return"globals"==e?this:this.m_ObjectsI[e][i]},l.prototype.object2ro=function(t){return t?this.decodeRo([t.table,t.id]):null},l.prototype.FindTableTlacZostava=function(t){for(var e=0,i=this.m_ObjectsO.ttreports;e<i.length;e++){var n=i[e];if(n.m_PageTables.includes(t))return n}return null},l.prototype.GetDozoryTWDH=function(t,e,i,n,o,r){for(var a=[],s=0,l=this.m_ObjectsO.classroomsupervisions;s<l.length;s++){var c=l[s];c.m_pUcitel!=t&&c.m_pUcebna!=t||(n<0||c.m_Den<0||c.m_Den==n)&&c.m_Hodina==o&&c.m_Prestavka==r&&(i<0||c.m_Tyzden<0||i==c.m_Tyzden)&&(e<0||c.m_Term<0||e==c.m_Term)&&a.push(c)}return a},l.prototype.GetPeriodTime=function(t,e){for(var i=null,n=null,o=null,r=null,a=0,s=t;a<s.length;a++){var l=s[a];l instanceof m&&(i=l),l instanceof A&&(i=l.m_pTrieda),l instanceof y&&(n=l),l instanceof Z&&(o=l),"daysdefs"==l.m_Table&&(r=l)}return!i&&e&&0<e.m_Triedy.length&&(i=e.m_Triedy[0]),null==o?{starttime:"00:00",endtime:"00:00"}:o.GetTime(r?r.m_Val:-1,i,n,e)},l.prototype.GetHodinaNazov=function(t,e){void 0===e&&(e=!1);var i=this.GetPeriod(t,e);return i?i.GetSkratka():e?(0<t?this.GetHodinaNazov(t-1,!1):"")+"/"+this.GetHodinaNazov(t,!1):"???"+t},l.prototype.GlobalData=function(){return this.m_ObjectsI.globals[1].m_Data},l.prototype.GetJoinNames=function(t){try{return this.GlobalData().settings.name_format}catch(t){return"FSL"}},l.prototype.FormatTime=function(t){if(!t)return"";var e=t.split(":"),i=parseInt(e[0]),n=parseInt(e[1]),o=i<12?"AM":"PM",r=12<i?i-12:i;function a(t){return t<10?"0"+t:t}switch(parseInt(this.GlobalData().settings.m_nTimeFormat)){case 0:default:return i+":"+a(n);case 1:return a(i)+":"+a(n);case 2:return r+":"+a(n)+" "+o;case 3:return a(r)+":"+a(n)+o;case 4:return r+":"+a(n);case 5:return a(r)+":"+a(n)}},l.prototype.FormatTimeFromTo=function(t,e,i){void 0===i&&(i=" - ");for(var n=this.FormatTime(t),o=this.FormatTime(e),r=0,a=["AM","PM"];r<a.length;r++){var s=a[r];o.includes(s)&&(n=n.replace(s,""))}return n.trim()+i+o.trim()},l);function l(){var t=a.call(this,null,"globals",{})||this;for(var e in t.m_ObjectsO={globals:[],termsdefs:[],weeksdefs:[],daysdefs:[],periods:[],breaks:[],bells:[],teachers:[],classes:[],groups:[],buildings:[],classrooms:[],subjects:[],students:[],lessons:[],cards:[],ttviews:[],ttreports:[],studentsubjects:[],classroomsupervisions:[],cardrelationships:[],coursegroups:[]},t.m_ObjectsI={globals:{},termsdefs:{},weeksdefs:{},daysdefs:{},periods:{},breaks:{},bells:{},teachers:{},classes:{},groups:{},buildings:{},classrooms:{},subjects:{},students:{},lessons:{},cards:{},ttviews:{},ttreports:{},studentsubjects:{},classroomsupervisions:{},cardrelationships:{},coursegroups:{}},t.m_nHodin=10,t.m_nDni=5,t.m_DaysAll="11111",t.m_nTyzdnov=1,t.m_WeeksAll="1",t.m_nTermov=1,t.m_TermsAll="1",t.m_nHodinyOd=0,t.m_pRozApp=null,t.dbi=new nt.MutableDBI(ot.client_req),t.m_ObjectsO)new nt.DBITable(t.dbi,{id:e});return t.m_nHodinyDo=t.m_nHodin-1,t}t.CRok=s;var c,m=(c=o,n.__extends(h,c),h.prototype.InitFromData=function(){var t=this.m_Data;this.m_nZvonenieID=parseInt(t.bell),this.m_pUcitel=this.m_pRok.m_ObjectsI.teachers[t.teacherid]},h.prototype.HodinaMozeSem=function(t,e){return t.m_Triedy.includes(this)},h.prototype.FindDelenie=function(t,e){for(var i=0;i<this.m_Delenia.length;i++)if((n=this.m_Delenia[i]).divisiontag==t)return n;var n;return e?n=new f(this,t):null},h.prototype.UI_KartaVyberOdtialto=function(t,e,i,n){if(i.IsLocked())return!1;var o=n.ctrlKey,r=n.shiftKey;if(o||r){if(!o){ASC.assert(r);var a=i.m_pHodina.GetPrvaNeumiestnenaKarta();return t.ChytKartu(a,this),!0}for(var s=this.GetKartyTuTWDH(e.m_nTerm,e.m_nWeek,e.m_nDay,e.period,t.m_pTriedyView.m_nROJTF),l=[],m=0;m<s.length;m++)(a=s[m]).IsLocked()||a!=i&&!i.ChytCtrlPridaj_Moze(a)||l.push(a);if(0==l.length)return!1;if(r){var h=[];for(m=0;m<l.length;m++){var _=(a=l[m]).m_pHodina.GetPrvaNeumiestnenaKarta();_&&h.push(_)}return 0<h.length&&t.ChytKarty(h,this),!0}for(m=0;m<l.length;m++)a=l[m],t.InvalidateKarta(a),a.DeUmiestniKarta();return t.ChytKarty(l,this),t.Validate(),t.CursorMove(n),!0}return c.prototype.UI_KartaVyberOdtialto.call(this,t,e,i,n)},h.prototype.UI_RiadokPopup=function(t,e){tt.CUtils.AddMenuItemSmart(t,"edit",{icon:tt.CUtils.GetTableIcon(this.m_Table)}),tt.CUtils.AddMenuItemSmart(t,"timeoff"),tt.CUtils.AddMenuItemSmart(t,"constraints"),tt.CUtils.AddMenuItemSmart(t,"lessons"),tt.CUtils.AddMenuItemSmart(t,"divisions")},h.prototype.UI_OnCommand=function(t,i,n){var o=this;if(void 0===n&&(n=null),c.prototype.UI_OnCommand.call(this,t,i,n))return!0;switch(t){case"divisions":return Promise.resolve().then(function(){return e("./groups")}).then(function(t){return t.showClassDivisionsDlg(o.m_pRok.m_pRozApp.ttgpid,o.m_Id)}),!0}return!1},h.prototype.GetSkupinaCelaTrieda=function(){for(var t=0,e=this.m_Delenia;t<e.length;t++)for(var i=0,n=e[t].m_Skupiny;i<n.length;i++){var o=n[i];if(o.m_bCelaTrieda)return o}return null},h.prototype.GetUcebna=function(){var t=this.m_Data.classroomids[0];return t?this.m_pRok.m_ObjectsI.classrooms[t]:null},h.prototype.JeObed=function(t){var e=this.m_Data.constraints;return"d"!=e.lunch_periodfrom&&"d"!=e.lunch_periodto&&t>=parseInt(e.lunch_periodfrom)&&t<=parseInt(e.lunch_periodto)},h);function h(t,e){var i=c.call(this,t,"classes",e)||this;return i.m_Delenia=[],i.m_Skupiny=[],i.m_nZvonenieID=0,i.m_pUcitel=null,i.InitFromData(),i}t.CTrieda=m;var _,u=(_=o,n.__extends(d,_),d.prototype.GetNazov=function(){return this.m_bCelaTrieda?ASC.ttls(1643):this.m_Data.name},d.prototype.GetColor=function(){return this.m_Data.color||tt.farby[this.m_pTrieda.m_Skupiny.indexOf(this)%tt.farby.length]},d.prototype.InitFromData=function(){var t=this.m_Data;this.m_pTrieda=this.m_pRok.m_ObjectsI.classes[t.classid],this.m_pDelenie=this.m_pTrieda.FindDelenie(this.m_Data.ascttdivision,!0),this.m_pDelenie.m_Skupiny.includes(this)&&this.m_pRok.m_pRozApp.Fail("Error 0188464415"),this.m_nPoradieVDeleni=this.m_pDelenie.m_Skupiny.length,this.m_pDelenie.m_Skupiny.push(this),this.m_pTrieda.m_Skupiny.push(this),this.m_bCelaTrieda=ASC.boolVal(t.entireclass),this.m_bOkGroup=ASC.boolVal(t.okgroup)},d.prototype.BeforeRemove=function(){ASC.remove(this.m_pDelenie.m_Skupiny,this),ASC.remove(this.m_pTrieda.m_Skupiny,this)},d.prototype.HodinaMozeSem=function(t,e){for(var i=0;i<t.m_Skupiny.length;i++){var n=t.m_Skupiny[i];if(n.m_pTrieda==this.m_pTrieda){if(n==this)return!0;if(n.m_pDelenie!=this.m_pDelenie)return!0}}return!1},d);function d(t,e){var i=_.call(this,t,"groups",e)||this;return i.m_bCelaTrieda=!1,i.m_bOkGroup=!1,i.m_bKurz=!1,i.m_Ziaci=[],i.InitFromData(),i}t.CSkupina=u;var p,f=(p=o,n.__extends(v,p),v.prototype.UpdatePoradieSkupin=function(){if(1<this.m_Skupiny.length){this.m_Skupiny.sort(function(t,e){return t.GetDBIndex()-e.GetDBIndex()});var t=0;this.m_Skupiny.forEach(function(e){e.m_nPoradieVDeleni=t++})}},v);function v(t,e){var i=p.call(this,t.m_pRok,"divisions",{})||this;return i.m_Skupiny=[],i.m_pTrieda=t,i.divisiontag=e,i.m_pTrieda.m_Delenia.push(i),i}t.CDelenie=f;var b,y=(b=o,n.__extends(g,b),g.prototype.GetNazov=function(t){return void 0===t&&(t="name"),t&&"name"!=t||(t=this.m_pRok.GetJoinNames(this.m_Table)),b.prototype.GetNazov.call(this,t)},g.prototype.HodinaMozeSem=function(t,e){return t.m_Data.teacherids.includes(this.m_Id)},g.prototype.UI_RiadokPopup=function(t,e){tt.CUtils.AddMenuItemSmart(t,"edit",{icon:tt.CUtils.GetTableIcon(this.m_Table)}),tt.CUtils.AddMenuItemSmart(t,"timeoff"),tt.CUtils.AddMenuItemSmart(t,"constraints"),tt.CUtils.AddMenuItemSmart(t,"lessons")},g.prototype.GetDozory=function(){for(var t=[],e=0,i=this.m_pRok.TableObjects("classroomsupervisions");e<i.length;e++){var n=i[e];n.m_pUcitel==this&&t.push(n)}return t},g.prototype.GetPocetDozorov=function(){for(var t=0,e=0,i=0,n=this.GetDozory();i<n.length;i++)t++,e+=n[i].GetDlzkaVMinutach();return{count:t,minutes:e}},g);function g(t,e){return b.call(this,t,"teachers",e)||this}t.CUcitel=y;var k,T=(k=o,n.__extends(S,k),S.prototype.HodinaMozeSem=function(t,e){return ASC.strEquals(t.m_Data.subjectid,this.m_Id)},S.prototype.UI_RiadokPopup=function(t,e){tt.CUtils.AddMenuItemSmart(t,"edit",{icon:tt.CUtils.GetTableIcon(this.m_Table)}),tt.CUtils.AddMenuItemSmart(t,"timeoff"),tt.CUtils.AddMenuItemSmart(t,"constraints"),tt.CUtils.AddMenuItemSmart(t,"lessons")},S.prototype.GetDoUvazkuRatatAko=function(){var t;return parseFloat(null!==(t=this.m_Data.contract_weight)&&void 0!==t?t:1)},S);function S(t,e){var i=k.call(this,t,"subjects",e)||this;return i.m_Hodiny=[],i}t.CPredmet=T;var C,A=(C=o,n.__extends(w,C),w.prototype.GetNazov=function(t){return void 0===t&&(t="name"),t&&"name"!=t||(t=this.m_pRok.GetJoinNames(this.m_Table)),C.prototype.GetNazov.call(this,t)},w.prototype.LinkSkupina=function(t,e){void 0===e&&(e=!0),t&&(e?(this.m_Skupiny.includes(t)||this.m_Skupiny.push(t),t.m_Ziaci.includes(this)||t.m_Ziaci.push(this)):(ASC.remove(this.m_Skupiny,t),ASC.remove(t.m_Ziaci,this)))},w.prototype.InitFromData=function(){var t=this.m_Data;this.m_pTrieda=this.m_pRok.m_ObjectsI.classes[t.classid],this.LinkSkupina(this.m_pTrieda.GetSkupinaCelaTrieda());for(var e=0,i=t.groupids;e<i.length;e++){var n=i[e],o=this.m_pRok.m_ObjectsI.groups[n];this.LinkSkupina(o)}},w.prototype.HodinaMozeSem=function(t,e){if(!t.m_Triedy.includes(this.m_pTrieda))return!1;if(e&et.ROJTF_PRIBLIZNE)return this.m_pTrieda.HodinaMozeSem(t,e);if(this.GetZiakPredmet(t))return!0;for(var i=0,n=t.m_Skupiny;i<n.length;i++){var o=n[i];if(this.SkupinaStatus(o)>=(o.m_bOkGroup?1:0))return!0}return!1},w.prototype.GetZiakPredmet=function(t){if(!t.m_KurzyPreTriedy.includes(this.m_pTrieda))return null;if(t.m_nPoradieSeminaru<0)return null;for(var e=0,i=this.m_ZiakPredmety;e<i.length;e++){var n=i[e];if(n.m_pPredmet==t.m_pPredmet&&n.m_nPoradieSeminaru==t.m_nPoradieSeminaru)return n}return null},w.prototype.SkupinaStatus=function(t){if(t.m_pTrieda!=this.m_pTrieda)return-1;if(t.m_bCelaTrieda)return 1;for(var e=0,i=0,n=this.m_Skupiny;i<n.length;i++){var o=n[i];if(o==t)return 1;o.m_pDelenie==t.m_pDelenie&&(e=-1)}return e},w.prototype.UI_RiadokPopup=function(t,e){tt.CUtils.AddMenuItemSmart(t,"edit",{icon:tt.CUtils.GetTableIcon(this.m_Table)})},w.prototype.UI_KartaVyberOdtialto=function(t,e,i,n){var o=this.GetZiakPredmet(i.m_pHodina);return o?!o.m_bLocked&&!!o.SetPoradieSeminaru(-1)&&(t.InvalidateObject(o),t.ChytSeminar(i.m_pHodina.m_pPredmet,this.m_pTrieda),!0):(ASC.showContextMenu([],n,{header:ASC.escapeHTML(tt.CUtils.GetUINazov(i.m_pHodina,"short"))}),!1)},w.prototype.UI_OnCommand=function(t,i,n){var o=this;void 0===n&&(n=null);var r=i.m_pRozApp;switch(t){case"edit":return Promise.resolve().then(function(){return e("./dlg")}).then(function(t){return t.showItemDlg(r.ttgpid,"students",o.m_Id)}),!0;case"lockcard":case"unlockcard":var a=n;return(s=this.GetZiakPredmet(a.m_pHodina))&&(s.SetLocked("lockcard"==t),r.InvalidateObject(s)),!0;case"removecard":var s;return a=n,(s=this.GetZiakPredmet(a.m_pHodina))&&(s.SetPoradieSeminaru(-1),r.InvalidateObject(s)),!0;case"deletecards":case"lockcards":case"unlockcards":return this.GetKartyTu(i.m_nROJTF).forEach(function(e){var i=o.GetZiakPredmet(e.m_pHodina);if(i){switch(t){case"deletecards":i.m_bLocked||i.SetPoradieSeminaru(-1);break;case"lockcards":0<i.m_nPoradieSeminaru&&i.SetLocked(!0);break;case"unlockcards":i.SetLocked(!1)}r.InvalidateObject(i)}}),!0}return!1},w);function w(t,e){var i=C.call(this,t,"students",e)||this;return i.m_pTrieda=null,i.m_ZiakPredmety=[],i.m_Skupiny=[],i.InitFromData(),i}t.CZiak=A;var I,R=(I=o,n.__extends(P,I),P.prototype.InitFromData=function(){var t=this.m_Data;this.m_pZiak=this.m_pRok.m_ObjectsI.students[t.studentid],this.m_pPredmet=this.m_pRok.m_ObjectsI.subjects[t.subjectid];var e=t.seminargroup;this.m_nPoradieSeminaru=e?parseInt(e):-1,this.m_bLocked=!!t.locked,this.m_pZiak.m_ZiakPredmety.push(this)},P.prototype.BeforeRemove=function(){ASC.remove(this.m_pZiak.m_ZiakPredmety,this)},P.prototype.SetPoradieSeminaru=function(t){return this.m_nPoradieSeminaru=t,this.m_Data.seminargroup=this.m_nPoradieSeminaru<0?"":this.m_nPoradieSeminaru,!0},P.prototype.SetLocked=function(t){this.m_bLocked=t,this.m_Data.locked=this.m_bLocked?1:0},P);function P(t,e){var i=I.call(this,t,"studentsubjects",e)||this;return i.m_nPoradieSeminaru=-1,i.m_bLocked=!1,i.InitFromData(),i}t.CZiakPredmet=R;var O,D=(O=o,n.__extends(x,O),x.prototype.InitFromData=function(){this.m_pBudova=this.m_pRok.m_ObjectsI.buildings[this.m_Data.buildingid]},x.prototype.HodinaMozeSem=function(t,e){var i=t.m_Data.classroomidss;if(!i)return console.log("missing classroomidsss for lesson "+t.m_Id),!1;for(var n=0;n<i.length;n++)if(i[n].includes(this.m_Id))return!0;return!1},x.prototype.JeKmenovaPre=function(t){return t.m_Data.classroomids.includes(this.m_Id)},x.prototype.KartaJeTu=function(t){return t.m_Data.classroomids.includes(this.m_Id)},x.prototype.UI_RiadokPopup=function(t,e){tt.CUtils.AddMenuItemSmart(t,"edit",{icon:tt.CUtils.GetTableIcon(this.m_Table)}),tt.CUtils.AddMenuItemSmart(t,"timeoff"),tt.CUtils.AddMenuItemSmart(t,"constraints"),tt.CUtils.AddMenuItemSmart(t,"lessons")},x.prototype.IsVolno=function(t){for(var e=0,i=this.GetObsadenieK(t);e<i.length;e++){var n=i[e];if(!t.MozeKolidovat(n))return!1}return!0},x.prototype.UI_KartaVyberOdtialto=function(t,e,i,n){return!!i.JeUmiestnena()&&!i.IsLocked()&&(t.InvalidateKarta(i),i.FreeUcebnaU(this),t.ChytKartu(i),!0)},x.prototype.UI_KartaMozeSem=function(t,e){for(var i=0,n=e.Karty();i<n.length;i++){var o=n[i],r=o.m_pHodina;if(o.JeUmiestnena()){for(var a=0;a<r.m_nPotrebujeUcebni;a++)if(!o.Ucebna(a)&&r.GetUcebneV(a).includes(this))return!0}else if(this.HodinaMozeSem(o.m_pHodina,t.m_pTriedyView.m_nROJTF))return!0}return!1},x.prototype.UI_KartaUmiestni=function(t,e,i,o){return n.__awaiter(this,void 0,void 0,function(){var r,a,s,l,c,m,h,_,u,d,p;return n.__generator(this,function(n){switch(n.label){case 0:return(r=e.Karty().find(function(t){return!t.JeUmiestnena()||t.JeTu_Policko(i)}))?r.JeUmiestnena()?[3,2]:[4,this.UI_ChooseObdobie(r.m_pHodina,i,o)]:[2];case 1:if(!(a=n.sent()))return[2];if(s=a.terms,l=a.weeks,c=a.days,m=i.period,this.m_pRok.ChangePosKarta_TWDH(r,s,l,c,m,!1),h=[],r.SimpleKolizie(h),h.length)return r.DeUmiestniKarta(),[2];n.label=2;case 2:for(_=-1,u=r.m_pHodina,d=0;d<u.m_nPotrebujeUcebni;d++)if(!r.Ucebna(d)&&u.GetUcebneV(d).includes(this)){_=d;break}return _<0||r.JeTu_Policko(i)&&(p=[],this.AddKartyTuK(p,r,t.m_pTriedyView.m_nROJTF),1<this.m_nHodinNaraz&&(p=[]),r.RemoveMozuKolidovat(p),r.SetUcebna(this,_),t.InvalidateKarta(r),t.OdhodKartu()),[2]}})})},x.prototype.UI_OnCommand=function(t,e,i){var n=this;void 0===i&&(i=null);var o=e.m_pRozApp;switch(t){case"deletecards":return this.GetKartyTu(e.m_nROJTF).forEach(function(t){t.IsLocked()||(o.InvalidateKarta(t),t.FreeUcebnaU(n))}),!0}return!!O.prototype.UI_OnCommand.call(this,t,e,i)},x.prototype.JeBlizkaUcebna=function(t){if(t)return this.m_Data.nearbyclassroomids.includes(t.m_Id)},x.prototype.JeMulityCard=function(){return 1<parseInt(this.m_Data.constraints.maxcardspos)},x.prototype.GetDozory=function(){for(var t=[],e=0,i=this.m_pRok.TableObjects("classroomsupervisions");e<i.length;e++){var n=i[e];n.m_pUcebna==this&&t.push(n)}return t},x);function x(t,e){var i=O.call(this,t,"classrooms",e)||this;return i.m_nHodinNaraz=1,i.m_pBudova=null,i.InitFromData(),i}t.CUcebna=D;var z,G=(z=o,n.__extends(V,z),V.prototype.InitFromData=function(){var t=this,e=this.m_Data,i=this.m_pRok;this.m_Skupiny=[],this.m_Triedy=[],this.m_KurzyPreTriedy=[],this.m_nPoradieSeminaru=-1;for(var n=0;n<e.groupids.length;n++){var o=this.m_pRok.m_ObjectsI.groups[e.groupids[n]];this.m_Skupiny.push(o),this.m_Triedy.includes(o.m_pTrieda)||this.m_Triedy.push(o.m_pTrieda)}e.seminargroup&&(this.m_nPoradieSeminaru=parseInt(e.seminargroup),i.ids2ro("classes",e.classids).forEach(function(e){t.m_Triedy.includes(e)||(t.m_Triedy.push(e),t.m_KurzyPreTriedy.push(e))})),this.m_Ucitelia=i.ids2ro("teachers",e.teacherids),this.m_pPredmet=i.m_ObjectsI.subjects[e.subjectid],this.m_pPredmet&&this.m_pPredmet.m_Hodiny.push(this);for(var r=0,a=["terms","weeks","days"];r<a.length;r++){var s=a[r],l=i.m_ObjectsI[s+"defs"][e[s+"defid"]];ASC.assert(!!l),this.m_pObdobie[s]=l}e.classroomidss?this.m_nPotrebujeUcebni=e.classroomidss.length:console.log("missing classroomidss in lesson "+this.m_Id)},V.prototype.BeforeRemove=function(){this.m_pPredmet&&ASC.remove(this.m_pPredmet.m_Hodiny,this)},V.prototype.JeSeminar=function(){return 0<this.m_KurzyPreTriedy.length},V.prototype.IsBezTriedy=function(){return!(0<this.m_KurzyPreTriedy.length||0<this.m_Skupiny.length)},V.prototype.IsBezUcitela=function(){return 0==this.m_Ucitelia.length},V.prototype.GetDelenie=function(t){for(var e=0,i=this.m_Skupiny;e<i.length;e++){var n=i[e];if(n.m_pTrieda==t)return n.m_pDelenie}return null},V.prototype.GetDelenieSkupinyBity=function(t){for(var e=0,i=0;i<this.m_Skupiny.length;i++){var n=this.m_Skupiny[i];n.m_pTrieda==t&&(e|=1<<n.m_nPoradieVDeleni)}return e},V.prototype.GetDlzka=function(){return this.m_Data.durationperiods-1},V.prototype.GetPocet=function(){return this.m_Karty.length},V.prototype.GetPrvaNeumiestnenaKarta=function(){for(var t=0;t<this.m_Karty.length;t++){var e=this.m_Karty[t];if(!e.JeUmiestnena())return e}return null},V.prototype.GetPrvaUmiestnenaKarta=function(){for(var t=0;t<this.m_Karty.length;t++){var e=this.m_Karty[t];if(e.JeUmiestnena())return e}return null},V.prototype.ChytCtrlPridaj_Moze=function(t){var e=this,i=t;if(e==i)return!1;for(var n=0,o=["terms","weeks","days"];n<o.length;n++){var r=o[n];if(e.m_pObdobie[r]!=i.m_pObdobie[r])return!1}if(e.GetDlzka()!=i.GetDlzka())return!1;for(var a=0;a<e.m_Ucitelia.length;a++)if(i.m_Ucitelia.includes(e.m_Ucitelia[a]))return!1;for(var s=!1,l=0,c=e.m_Skupiny;l<c.length;l++)for(var m=c[l],h=0,_=i.m_Skupiny;h<_.length;h++){var u=_[h];if(m.m_pTrieda==u.m_pTrieda){if(s=!0,m.m_pDelenie!=u.m_pDelenie)return!1;if(m==u)return!1}}for(var d=0,p=e.m_KurzyPreTriedy;d<p.length;d++){var f=p[d];i.m_KurzyPreTriedy.includes(f)&&(s=!0)}return!!s},V.prototype.GetTermPrvyDobry=function(t){return-1==t&&this.m_pObdobie.terms.IsCompatible(this.GetTerm())?this.GetTerm():this.GetPrvaUmiestnenaKarta()?this.GetTerm():this.m_pObdobie.terms.GetPrveDobrePole(t)},V.prototype.GetWeekPrvyDobry=function(t){return this.m_pObdobie.weeks.GetPrveDobrePole(t)},V.prototype.GetDenPrvyDobry=function(t){return this.m_pObdobie.days.GetPrveDobrePole(t)},V.prototype.GetTerm=function(){return this.m_Data.terms},V.prototype.SetTerm=function(t){ASC.assert(this.m_pObdobie.terms.IsCompatible(t)),this.m_Data.terms=t},V.prototype.GetUcebneV=function(t){return t<0||t>=this.m_nPotrebujeUcebni?[]:this.m_pRok.ids2ro("classrooms",this.m_Data.classroomidss[t])},V.prototype.IsUvazujUcebne=function(){return 0<this.m_nPotrebujeUcebni},V.prototype.UI_HodinaPopup=function(t,i){var o=this;tt.CUtils.AddMenuItemSmart(t,"editlesson",{onclick:function(){return n.__awaiter(o,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./dlg")})];case 1:return[2,t.sent().showItemDlg(this.m_pRok.m_pRozApp.ttgpid,"lessons",this.m_Id)]}})})}})},V.prototype.GetZiaci=function(){for(var t=[],e=0,i=this.m_KurzyPreTriedy;e<i.length;e++){var n=i[e].GetSkupinaCelaTrieda();if(n)for(var o=0,r=n.m_Ziaci;o<r.length;o++)for(var a=r[o],s=0,l=a.m_ZiakPredmety;s<l.length;s++){var c=l[s];if(c.m_pPredmet==this.m_pPredmet&&c.m_nPoradieSeminaru==this.m_nPoradieSeminaru){t.push(a);break}}}return t},V.prototype.GetPocetZiakov=function(){return this.GetZiaci().length},V);function V(t,e){var i=z.call(this,t,"lessons",e)||this;return i.m_Karty=[],i.m_Skupiny=[],i.m_Triedy=[],i.m_KurzyPreTriedy=[],i.m_nPoradieSeminaru=-1,i.m_nPotrebujeUcebni=0,i.m_Ucitelia=[],i.m_pPredmet=null,i.m_pObdobie={terms:null,weeks:null,days:null},i.InitFromData(),i}t.CHodina=G;var M,U=(M=o,n.__extends(H,M),H.prototype.InitFromData=function(){var t=this.m_Data;this.m_pHodina=this.m_pRok.m_ObjectsI.lessons[t.lessonid],this.m_pHodina.m_Karty.push(this)},H.prototype.BeforeRemove=function(){ASC.remove(this.m_pHodina.m_Karty,this)},H.prototype.Ucebne=function(){var t=this,e=this.m_Data.classroomids,i=[];return e.forEach(function(e){e&&i.push(t.m_pRok.m_ObjectsI.classrooms[e])}),i},H.prototype.GetHodina=function(){return 0|this.m_Data.period},H.prototype.GetDlzka=function(){return this.m_pHodina.GetDlzka()},H.prototype.durationperiods=function(){return this.m_pHodina.m_Data.durationperiods},H.prototype.days=function(){return this.JeUmiestnena()?this.m_Data.days:""},H.prototype.weeks=function(){return this.JeUmiestnena()?this.m_Data.weeks:""},H.prototype.terms=function(){return this.JeUmiestnena()?this.m_pHodina.m_Data.terms:""},H.prototype.GetVolno=function(t){return at.timeoff_getByBits(t,this.terms(),this.weeks(),this.days(),this.GetHodina(),this.durationperiods())},H.prototype.JeTu_Policko=function(t){return this.JeTu_TWDH(t.m_nTerm,t.m_nWeek,t.m_nDay,t.period)},H.prototype.JeTu_TWDH=function(t,e,i,n){if(!this.JeUmiestnena())return!1;if(0<=t&&"1"!=this.m_pHodina.m_Data.terms[t])return!1;if(0<=e&&"1"!=this.m_Data.weeks[e])return!1;if(0<=i&&"1"!=this.m_Data.days[i])return!1;if(0<=n){var o=this.GetHodina(),r=o+this.GetDlzka();if(n<o||r<n)return!1}return!0},H.prototype.GetTableIds=function(t){switch(t){case"subjects":return[this.m_pHodina.m_Data.subjectid];case"classes":return this.m_pHodina.m_Data.classids;case"teachers":return this.m_pHodina.m_Data.teacherids;case"classrooms":return this.m_Data.classroomids;case"buildings":for(var e=[],i=0;i<this.m_pHodina.m_nPotrebujeUcebni;i++){var n=this.Ucebna(i);n&&n.m_pBudova&&e.push(n.m_pBudova.m_Id)}return e;case"groups":return this.m_pHodina.m_Data.groupids}return[]},H.prototype.GetFarby=function(t){var e=[];if("seminargroup"==t){var i=this.m_pHodina.m_nPoradieSeminaru;0<i&&e.push(tt.CUtils.GetFarbaIndex(i-1))}else for(var n=this.GetTableIds(t),o=0;o<n.length;o++){var r=this.m_pRok.m_ObjectsI[t][n[o]];r&&e.push(r.GetColor())}return e},H.prototype.GetFarbyChyby=function(){var t=[];return"0"==this.m_pRok.VhodnostKarty_PUT(this)&&t.push("#ff0000"),this.VsetkyUcebneValid()||t.push("#ffffff"),t},H.prototype.GetFarbyFazy=function(){return this.JeUmiestnena()&&rt.fazyColors([this.terms(),this.weeks()])||[]},H.prototype.GetTexty=function(t,e,i){void 0===e&&(e="short");for(var n="",o=this.m_pHodina,r=0;r<t.length;r++){0<r&&(n+="\n");var a=t[r];switch(a){case"groupnames":for(var s=[],l=0,c=o.m_Skupiny;l<c.length;l++){var h=c[l];if(!(h.m_bCelaTrieda||i instanceof m&&i!=h.m_pTrieda)){var _=h.GetNazov();s.includes(_)||s.push(_)}}n+=s.join(" ");break;case"seminargroup":0<o.m_nPoradieSeminaru&&(n+=o.m_nPoradieSeminaru);break;case"subjects":if(n+=this.m_pRok.dbi.rowName(a,o.m_pPredmet.m_Id,e),0<o.m_nPoradieSeminaru){for(var u=!1,d=0,p=o.m_pPredmet.m_Hodiny;d<p.length;d++)if(1<p[d].m_nPoradieSeminaru){u=!0;break}u&&(n+=o.m_nPoradieSeminaru)}break;case"students_count":n+="("+o.GetPocetZiakov()+")";break;default:n+=this.m_pRok.dbi.rowNames(a,this.GetTableIds(a),e)}}return n},H.prototype.GetDelenieSkupin=function(t){var e=this.m_pHodina.GetDelenie(t);return e?e.m_Skupiny.length:-1},H.prototype.GetDelenieSkupinyBity=function(t){return this.m_pHodina.GetDelenieSkupinyBity(t)},H.prototype.JeUmiestnena=function(){return!!this.m_Data.days},H.prototype.CyklovaniePo=function(){var t=0;return this.m_Data.days!=this.m_pRok.m_DaysAll&&(t|=1),this.m_Data.weeks!=this.m_pRok.m_WeeksAll&&(t|=2),this.m_pHodina.m_Data.terms!=this.m_pRok.m_TermsAll&&(t|=4),t},H.prototype.DeUmiestniKarta=function(){this.m_Data.days="",this.m_Data.weeks="",this.m_Data.period=-1,this.m_Data.classroomids.length=0},H.prototype.IsLocked=function(){return ASC.boolVal(this.m_Data.locked)},H.prototype.SetLocked=function(t){this.m_Data.locked=t?1:0},H.prototype.ChytCtrlPridaj_Moze=function(t){return t!=this&&t.m_pHodina!=this.m_pHodina&&t.JeUmiestnena()==this.JeUmiestnena()&&this.m_pHodina.ChytCtrlPridaj_Moze(t.m_pHodina)},H.prototype.Obdobia_MozeSem_TWDH=function(t,e,i,n,o){if(void 0===o&&(o=!1),this.JeTu_TWDH(t,e,i,n))return!0;if(0<=t){if(o&&this.m_pHodina.GetPrvaUmiestnenaKarta()&&"1"!=this.m_pHodina.GetTerm()[t])return!1;if(!this.m_pHodina.m_pObdobie.terms.JeMoznyBit(t))return!1}if(0<=e&&!this.m_pHodina.m_pObdobie.weeks.JeMoznyBit(e))return!1;if(0<=i&&!this.m_pHodina.m_pObdobie.days.JeMoznyBit(i))return!1;if(0<=n){if(n<this.m_pRok.m_nHodinyOd)return!1;if(n+this.m_pHodina.GetDlzka()>this.m_pRok.m_nHodinyDo)return!1}return!0},H.prototype.SetPosition=function(t,e,i,n){t&&i&&n||ASC.assert(!1),this.m_Data.days=t,this.m_Data.period=e,this.m_pHodina.SetTerm(i),this.m_Data.weeks=n},H.prototype.SimpleKolizie=function(t,e){void 0===e&&(e=!1);for(var i=0,n=this.m_pHodina.m_Ucitelia;i<n.length;i++)n[i].AddKartyTuK(t,this,0);for(var o=0,r=this.m_pHodina.m_Skupiny;o<r.length;o++)r[o].AddKartyTuK(t,this,0);tt.CUtils.FastRemove(t,this)},H.prototype.GetHodinaOd=function(){return parseInt(this.m_Data.period)},H.prototype.GetHodinaDo=function(){return this.GetHodinaOd()+this.m_pHodina.GetDlzka()},H.prototype.VsetkyUcebneValid=function(){for(var t=0;t<this.m_pHodina.m_nPotrebujeUcebni;t++)if(!this.Ucebna(t))return!1;return!0},H.prototype.Ucebna=function(t){if(void 0===t&&(t=0),t<0||t>=this.m_pHodina.m_nPotrebujeUcebni)return null;var e=this.m_Data.classroomids[t];return e?this.m_pRok.m_ObjectsI.classrooms[e]:null},H.prototype.MozeKolidovat=function(t){return t==this||(this.m_pHodina,t.m_pHodina,!1)},H.prototype.RemoveMozuKolidovat=function(t){for(var e=t.length-1;0<=e;e--)this.MozeKolidovat(t[e])&&t.splice(e,1)},H.prototype.SetUcebna=function(t,e){void 0===e&&(e=0),e<0||e>=this.m_pHodina.m_nPotrebujeUcebni||(this.m_Data.classroomids[e]=t?t.m_Id:"")},H.prototype.FreeUcebna=function(t){if(void 0===t&&(t=-1),-1!=t)t<0||t>=this.m_pHodina.m_nPotrebujeUcebni||this.Ucebna(t)&&(this.m_Data.classroomids[t]="");else for(t=0;t<this.m_pHodina.m_nPotrebujeUcebni;t++)this.FreeUcebna(t)},H.prototype.FreeUcebnaU=function(t){for(var e=0;e<this.m_pHodina.m_nPotrebujeUcebni;e++)this.Ucebna(e)==t&&this.FreeUcebna(e)},H.prototype.DajUcebnu=function(){if(!this.JeUmiestnena())return!0;for(var t=!0,e=0;e<this.m_pHodina.m_nPotrebujeUcebni;e++)if(!this.Ucebna(e)){var i=this.m_pHodina.GetUcebneV(e);if(0!=i.length){for(var n=null,o=0,r=i;o<r.length;o++){var a=r[o];if("0"!=this.GetVolno(a.timeoff())&&(1<a.m_nHodinNaraz||a.IsVolno(this))){n=a;break}}n?this.SetUcebna(a,e):t=!1}}return t},H);function H(t,e){var i=M.call(this,t,"cards",e)||this;return i.InitFromData(),i}t.CKarta=U;var K,E=(K=o,n.__extends(N,K),N.prototype.InitFromData=function(){var t=this.m_Data;this.m_BitovePole=t.vals},N.prototype.JeMoznyBit=function(t){for(var e=0;e<this.m_BitovePole.length;e++)if("1"==this.m_BitovePole[e][t])return!0;return!1},N.prototype.GetSumBitov=function(){for(var t=this.m_BitovePole,e=t[0],i=1;i<t.length;i++)e=rt.bitfieldOr(e,t[i]);return e},N.prototype.IsCompatible=function(t){for(var e=0;e<this.m_BitovePole.length;e++)if(this.m_BitovePole[e]==t)return!0;return!1},N.prototype.GetPrveDobrePole=function(t){if(t<0)return this.m_BitovePole[0];for(var e=0;e<this.m_BitovePole.length;e++)if("1"==this.m_BitovePole[e][t])return this.m_BitovePole[e];this.m_BitovePole[0]},N.prototype.GetNazov=function(t){if(void 0===t&&(t="name"),"number"==t){if("one"==this.m_Typ)return tt.CUtils.GetTableItemTypNazov(this.m_Table,1)+" "+(this.m_Val+1);t="short"}return K.prototype.GetNazov.call(this,t)},N.prototype.KartaJeTu=function(t,e){if(!t.JeUmiestnena())return!1;switch(this.m_Typ){case"all":case"any":return!0;case"one":var i=this.m_Val;switch(this.m_Table){case"daysdefs":return"1"==t.days()[i];case"weeksdefs":return"1"==t.weeks()[i]}}return!1},N.prototype.GetDlzka=function(){switch(this.m_Typ){case"one":case"any":return 1;case"all":return this.m_pRok.GetObdobieCount(this.m_ItemTable)}for(var t=0,e=this.m_BitovePole[0],i=0;i<e.length;i++)"1"==e[i]&&t++;return t},N.prototype.AvgPokrytieBitov=function(){return this.GetDlzka()/this.m_pRok.GetObdobieCount(this.m_ItemTable)},N);function N(t,e,i){var n=K.call(this,t,e,i)||this;return n.m_Val=null,n.m_BitovePole=[],n.m_ItemTable=e.substring(0,e.length-4),n.m_Typ=i.typ,"one"==n.m_Typ&&(n.m_Val=parseInt(i.val)),n.InitFromData(),n}t.CObdobie=E;var j,Z=(j=o,n.__extends($,j),$.prototype.InitFromData=function(){this.m_nHodina=parseInt(this.m_Id)},$.prototype.GetTime=function(t,e,i,n){void 0===t&&(t=-1);var o=this.m_Data,r={starttime:o.starttime,endtime:o.endtime},a=null,s=0;if(e?s=e.m_nZvonenieID:i&&(s=parseInt(i.m_Data.bell)),n&&""!=ASC.strVal(n.m_Data.bell)&&(s=parseInt(n.m_Data.bell)),0<s){var l=this.m_pRok.m_ObjectsI.bells[s];l&&(a=l.m_Data["periods"==this.m_Table?"perioddata":"breakdata"][this.m_nHodina])}if(a&&(a.starttime&&(r.starttime=a.starttime),a.endtime&&(r.endtime=a.endtime)),0<=t){var c=o.daydata[t];a&&a.daydata&&(c=a.daydata[t]),c&&(c.starttime&&(r.starttime=c.starttime),c.endtime&&(r.endtime=c.endtime))}return r},$.prototype.GetDlzkaVMinutach=function(t){void 0===t&&(t=-1);var e=this.GetTime(t);return tt.CUtils.minutes(e.endtime)-tt.CUtils.minutes(e.starttime)},$.prototype.JeValidPreTriedu=function(t){var e=this.m_Data.printonlyinbells;if(Array.isArray(e))return 0==e.length||0<=ASC.indexOf2(e,t.m_nZvonenieID);var i=this.m_Data.printonlyinbell;return!!ASC.strEmpty(i)||parseInt(i)==t.m_nZvonenieID},$);function $(t,e,i){var n=j.call(this,t,e,i)||this;return n.InitFromData(),n}t.CPeriodOrBreak=Z;var F,L=(F=Z,n.__extends(B,F),B.prototype.KartaJeTu=function(t,e){if(!t.JeUmiestnena())return!1;var i=this.m_nHodina,n=t.GetHodinaOd(),o=t.GetHodinaDo();return n<=i&&i<=o},B.GetMedzera=function(t,e,i){var n=e.GetTime(t),o=i.GetTime(t);return tt.CUtils.minutes(o.starttime)-tt.CUtils.minutes(n.endtime)},B);function B(t,e){return F.call(this,t,"periods",e)||this}t.CPeriod=L;var J,W=(J=Z,n.__extends(Y,J),Y.prototype.KartaJeTu=function(t,e){return!1},Y);function Y(t,e){return J.call(this,t,"breaks",e)||this}t.CBreak=W;var X,q=(X=o,n.__extends(Q,X),Q.prototype.InitFromData=function(){var t=this.m_Data,e=this.m_pRok;this.m_pUcebna=e.m_ObjectsI.classrooms[t.classroomid],this.m_pUcitel=e.m_ObjectsI.teachers[t.teacherid],this.m_Den=tt.CUtils.blank2minus(t.day),this.m_Tyzden=tt.CUtils.blank2minus(t.week),this.m_Term=tt.CUtils.blank2minus(t.term),""!=ASC.strVal(t.break)?(this.m_Hodina=parseInt(t.break),this.m_Prestavka=!0):(this.m_Hodina=parseInt(t.period),this.m_Prestavka=!1),this.m_bLocked=ASC.boolVal(t.locked)},Q.prototype.SetLocked=function(t){this.m_Data.locked=t?1:0,this.m_bLocked=ASC.boolVal(this.m_Data.locked)},Q.prototype.SetUcitel=function(t){this.m_Data.teacherid=t?t.m_Id:"",this.m_pUcitel=t},Q.prototype.GetHodinaText=function(){return this.m_pRok.GetHodinaNazov(this.m_Hodina,this.m_Prestavka)},Q.prototype.GetDlzkaVMinutach=function(){if(this.m_Prestavka){var t=this.m_pRok.GetPeriod(this.m_Hodina,!0);if(t)return t.GetDlzkaVMinutach(this.m_Den);var e=this.m_pRok.GetPeriod(this.m_Hodina,!1),i=this.m_pRok.GetPeriod(this.m_Hodina-1,!1);return e&&i?L.GetMedzera(this.m_Den,i,e):10}return(e=this.m_pRok.GetPeriod(this.m_Hodina,!1))?e.GetDlzkaVMinutach(this.m_Den):10},Q);function Q(t,e){var i=X.call(this,t,"classroomsupervisions",e)||this;return i.m_pUcitel=null,i.m_pUcebna=null,i.m_Den=-1,i.m_Tyzden=-1,i.m_Term=-1,i.m_Hodina=0,i.m_Prestavka=!1,i.m_bLocked=!1,i.m_bTemp=!1,i.InitFromData(),i}t.CDozor=q;var tt=e("./online"),et=e("./tview"),it=e("./print"),nt=e("../../rpr/dbi"),ot=e("../../asc/edurequest"),rt=e("./ttdoc"),at=e("../timeoff_r")},"/timetable/app/tview.js":function(t,e,i){t.__esModule=!0;var n=e("tslib"),o=e("react"),r=e("react-dom"),a=e("./online"),s=e("./rokobject"),l=e("./ttrowrenderer"),c=e("../../asc/asc_react"),m=e("../timeoff_r"),h=e("./ttdoc"),_=e("./server/dozory"),u=o.lazy(function(){return Promise.resolve().then(function(){return e("./lessongrid")})});t.ROJTF_PRIBLIZNE=1,t.ROJTF_SEMINARE_BEZ_ZIAKOV=2,t.ROJTF_SEMINARE_NESLIZUJ=4,t.ROJTF_FILTER_AKT_TWD=8,t.ROJTF_TERM=16,t.ROJTF_TERM_SHIFT=5,t.ROJTF_TERM_MASK=2032,t.nDefaultVyskaRiadok=25;var d=(p.prototype.RenderLessonGrid=function(){r.render(o.createElement(o.Suspense,{fallback:o.createElement(c.Loading,null)},o.createElement(u,{ttgpid:this.m_pRozApp.ttgpid,rowheight:this.m_nVyskaRiadok,pTView:this})),this.$div.get(0))},p.prototype.UpdateStruct=function(){var t=this;if(this.lastPohlad==this.m_pAktPohlad&&this.JePohladLessonGrid())this.RenderLessonGrid();else{if(this.m_Riadky.length=0,this.m_Policka.length=0,r.unmountComponentAtNode(this.$div.get(0)),this.$div.empty(),this.$div.off(),this.$content_d=null,this.$header_d=null,this.$toolbar_d=null,!this.m_pAktPohlad){for(var e=0,i=this.m_pRok.TableObjects("ttviews");e<i.length;e++){var n=i[e];if(!n.m_Hidden){this.m_pAktPohlad=n,this.m_pRozApp.InvalidatePohladSwitcher();break}}if(!this.m_pAktPohlad)return}if(this.lastPohlad=this.m_pAktPohlad,this.FillRibbonCombos(),this.JePohladLessonGrid())return this.RenderLessonGrid(),void this.$div.keydown(function(e){if([107,109].indexOf(e.keyCode)<0)return!0;t.OnKeyDown(e)});this.$toolbar_d=$j("<div class='toolbar'>").appendTo(this.$div),this.$header_d=$j("<div class='header'>").appendTo(this.$div),this.$content_d=$j("<div class='content'>").appendTo(this.$div),this.$header_d.css("height",this.m_nVyskaMenoDna-1+"px"),this.$content_d.mousemove(function(e){t.OnMouseMove(e),t.m_pRozApp.CursorMove(e)}),this.$content_d.on("scroll",function(){var e=t.m_pAktPohlad;e&&(e.m_nScrollPos=t.$content_d[0].scrollTop),t.m_pRozApp.Invalidate()}),this.$div.keydown(function(e){if(t.JePohladLessonGrid()&&[107,109].indexOf(e.keyCode)<0)return!0;t.OnKeyDown(e)}),this.$div.mousedown(function(e){ASC.hidePopups(),t.$div.focus(),e.preventDefault()}),this.$div.mouseup(function(t){t.preventDefault()}),this.$div.click(function(e){return!!t.JePohladLessonGrid()||(ASC.hideContextMenu(),t.OnLButtonClick(e),!1)}),this.$div.on("contextmenu",function(e){return!!t.JePohladLessonGrid()||(t.OnRButtonClick(e),!1)});var o=this.m_pAktPohlad.GetRiadkyObjects();for(var a in o){var s=o[a];this.m_Riadky.push(new f(this,s))}this.$content_d[0].scrollTop=this.m_pAktPohlad.m_nScrollPos;for(var l=this.m_pRok,c={terms:-1,weeks:-1,days:-1},m={terms:-1,weeks:-1,days:-1},h=0,_=["terms","weeks","days"];h<_.length;h++){var u=_[h],d=this.m_pAktObdobie[u];d&&("one"==d.m_Typ&&(c[u]=m[u]=d.m_Val),"any"==d.m_Typ&&(c[u]=0,m[u]=this.m_pRok.GetObdobieCount(u)-1))}for(var p=c.terms;p<=m.terms;p++)for(var v=c.weeks;v<=m.weeks;v++)for(var y=c.days;y<=m.days;y++)for(var g=l.m_nHodinyOd;g<=l.m_nHodinyDo;g++)this.m_Policka.push(new b(this,p,v,y,g,this.m_Policka.length));for(var a in this.m_Policka)this.m_Policka[a].UpdateX();this.m_nSirkaPolicko=(this.$content_d.width()-this.m_nSirkaStlpecMenoTriedy)/Math.max(1,this.m_Policka.length),this.m_nSirkaPolicko||(this.m_nSirkaPolicko=20),this.m_Policka[this.m_Policka.length-1].$div.addClass("last"),this.m_nOldContentWidth=this.$content_d.get(0).clientWidth}},p.prototype.Zoom=function(e){switch(e){case"+":this.m_nVyskaRiadok*=2;break;case"-":this.m_nVyskaRiadok/=2;break;case"0":this.m_nVyskaRiadok=t.nDefaultVyskaRiadok;break;case"/":0<this.m_Riadky.length&&(this.m_nVyskaRiadok=Math.floor(this.$content_d.height()/this.m_Riadky.length)-1);break;default:"%"==e.charAt(e.length-1)&&(this.m_nVyskaRiadok=parseInt(e.substr(0,e.length-1))*t.nDefaultVyskaRiadok/100)}this.m_nVyskaRiadok=Math.min(2e3,Math.max(2,Math.round(this.m_nVyskaRiadok))),this.m_pAktPohlad.m_nVyskaRiadok=this.m_nVyskaRiadok,this.m_pRozApp.InvalidateTriedyView(),this.m_pRozApp.InvalidatePending()},p.prototype.Scroll=function(t){var e=0,i=this.m_nVyskaRiadok+1,n=Math.max(1,Math.floor(this.$content_d.height()/i))*i;switch(t){case"up":e=-i;break;case"down":e=+i;break;case"pgup":e=-n;break;case"pgdown":e=+n}this.$content_d.get(0).scrollTop+=e},p.prototype.SetCursor=function(t,e){void 0!==t&&(this.m_pCursorRiadok&&this.m_pCursorRiadok.$div.removeClass("cursor"),this.m_pCursorRiadok=t||null,this.m_pCursorRiadok&&this.m_pCursorRiadok.$div.addClass("cursor")),void 0!==e&&(this.m_pCursorPolicko&&this.m_pCursorPolicko.$div.removeClass("cursor"),this.m_pCursorPolicko=e||null,this.m_pCursorPolicko&&this.m_pCursorPolicko.$div.addClass("cursor"))},p.prototype.OnMouseMove=function(t){this.SetCursor(this.GetRiadokE(t),this.GetPolickoE(t))},p.prototype.OnKeyDown=function(t){switch(t.keyCode){case 107:this.Zoom("+");break;case 109:this.Zoom("-");break;case 111:this.Zoom("/");break;case 38:this.Scroll("up");break;case 40:this.Scroll("down");break;case 33:this.Scroll("pgup");break;case 34:this.Scroll("pgdown");break;case 68:t.ctrlKey&&t.shiftKey;break;default:return}t.stopPropagation()},p.prototype.OnLButtonClick=function(t){this.$div.focus(),this.m_pRozApp.ZrusKontrolu(),this.ClickRiadok(t)||this.ClickRozvrh(t)||(t.stopPropagation(),t.preventDefault())},p.prototype.OnRButtonClick=function(t){this.RightClickRiadok(t)||this.RightClickDenHodina(t)||(this.m_pRozApp.m_TahanaMHodina.IsEmpty()?this.RightClickRozvrhVolno(t):this.m_pRozApp.OdhodKartu())},p.prototype.ClickRiadok=function(t){var e=this.Event2XY(t);if(e.x<0||e.x>=this.m_nSirkaStlpecMenoTriedy||e.y<this.m_nVyskaMenoDna)return!1;var i=this.GetRiadokE(t).m_pRokObject,n=this.m_pRozApp.m_pRadSelector;if(t.shiftKey){n.m_Table!=i.m_Table&&n.AddRadObject(i);var o,r,a=[];r=o=!1;for(var s=this.m_Riadky.length-1;0<=s;s--)if((l=this.m_Riadky[s].m_pRokObject)==i&&(o=!0),o&&(a.indexOf(l)<0&&a.push(l),n.IsInRad(l))){r=!0;break}if(!r)for(r=o=!1,s=a.length=0;s<this.m_Riadky.length;s++)if((l=this.m_Riadky[s].m_pRokObject)==i&&(o=!0),o&&(a.indexOf(l)<0&&a.push(l),n.IsInRad(l))){r=!0;break}if(r)for(s=0;s<a.length;s++){var l=a[s];n.AddRadObject(l)}return this.m_pRozApp.InvalidateSelector(),!0}return t.ctrlKey?n.IsInRad(i)?n.RemoveRadObject(i):n.AddRadObject(i):(n.SetCelok(),n.AddRadObject(i)),this.m_pRozApp.InvalidatePending(),this.m_bInvalidFarbyRiadkov=!0},p.prototype.JePohladDozory=function(){return this.m_pAktPohlad&&"classroomsupervision"==this.m_pAktPohlad.m_Typ},p.prototype.JePohladLessonGrid=function(){return this.m_pAktPohlad&&"lessongrid"==this.m_pAktPohlad.m_Typ},p.prototype.RightClickRiadok=function(t){var i=this,o=this.Event2XY(t);if(o.x<0||o.x>=this.m_nSirkaStlpecMenoTriedy||o.y<this.m_nVyskaMenoDna)return!1;var r=this.GetRiadokE(t);if(!r)return!1;var s=r.m_pRokObject,l=this.m_pRozApp,c=l.m_pRadSelector;if(!c.IsInRad(s)&&!this.ClickRiadok(t))return!1;l.ZrusKontrolu();var m=c.GetJediny(),h=c.GetRadList(),u=null;h.length&&(u=h[0]);var d=[];if(a.CUtils.AddMenuItemSmart(d,"test"),d.push([]),(m||u)&&m&&m.UI_RiadokPopup(d,this),d.push([]),a.CUtils.AddMenuItemSmart(d,"printpreview"),this.JePohladDozory()){if(m){var p=m.m_Id,f=this.m_Policka.map(function(t){return t.toDozorPolicko()});d.push([]);for(var v=function(t,e){d.push({text:t,onclick:function(){return ASC.blockUI(_.dozoryAddMulti(null,l.ttgpid,{classroomid:p,type:e,policka:f}))}})},b=0,y=[[ASC.ttls(3122)+" ("+ASC.ttls(1063)+")","period"],[ASC.ttls(3122)+" ("+ASC.ttls(2707)+")","break"]];b<y.length;b++){var g=y[b];v(g[0],g[1])}if(0<u.GetDozory().length){d.push([]);for(var k=function(t,e){d.push({text:t,onclick:function(){return _.dozoryRemoveMulti(null,l.ttgpid,{classroomid:p,policka:f,clear_teacher:e})}})},T=0,S=[[ASC.ttls(3123),!1],[ASC.ttls(3123)+" - "+a.CUtils.GetTableName("teachers"),!0]];T<S.length;T++){var C=S[T];k(C[0],C[1])}}}}else{d.push([]),a.CUtils.AddMenuItemSmart(d,"verification"),a.CUtils.AddMenuItemSmart(d,"listconstraints"),d.push([]),a.CUtils.AddMenuItemSmart(d,"deletecards"),a.CUtils.AddMenuItemSmart(d,"lockcards",{text:ASC.ttls(1713),icon:a.CUtils.GetIconLocked(!0)}),a.CUtils.AddMenuItemSmart(d,"unlockcards",{text:ASC.ttls(1729),icon:a.CUtils.GetIconLocked(!1)});var A=c.GetVybraneHodiny(l.m_pTriedyView.m_nROJTF).map(function(t){return t.m_Id});if(0<A.length){d.push([]);var w=[];a.CUtils.AddMenuItemSmart(w,"",{text:ASC.ttls(4344),onclick:function(){return n.__awaiter(i,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./server/refactor")})];case 1:return t.sent().refactorSinglesToDoubles(null,l.ttgpid,A),[2]}})})}}),d.push({text:ASC.ttls(4029),submenu:w})}}return ASC.showContextMenu(d,t,{header:ASC.escapeHTML(c.GetSimplePopis()),handler:function(t){var e=t.cmd;if(!m||!m.UI_OnCommand(e,i))switch(e){case"deletecards":case"lockcards":case"unlockcards":return void h.forEach(function(t){t.UI_OnCommand(e,i)});case"test":return void l.ClickGenerate({sel:!0});case"verification":return void l.ClickVerification("verification","sel");case"listconstraints":return void l.ClickVerification("listconstraints","sel");case"printpreview":for(var n={},o=0,r=h;o<r.length;o++){var a=r[o];n[a.m_Table]||(n[a.m_Table]=[]),n[a.m_Table].push(a.m_Id)}return l.PrintPreview(),l.m_pPrintPreview.SetZostava(u.m_Table),void l.PrintSetFilter(n)}}}),!0},p.prototype.RightClickRozvrhVolno=function(t){var e=this,i=this.GetRiadokE(t),n=this.GetPolickoE(t);if(!i||!n)return!1;var o=i.m_pRokObject,r=this.m_pRok;if(!this.JePohladDozory()){var l,c=[],h=o.UI_GetKartyNaPolicko(this,n),_=[],u=[];h.forEach(function(t){t.JeUmiestnena()?u.push(t):_.indexOf(t.m_pHodina)<0&&(_.push(t.m_pHodina),u.push(t))}),0==u.length?a.CUtils.AddMenuItemSmart(c,"",{text:ASC.ttls(1711),disabled:!0}):u.forEach(function(t){a.CUtils.AddMenuItemSmart(c,"putcard",{data:t})}),c.push([]),a.CUtils.AddMenuItemSmart(c,"deletecards");var d=o.timeoff();if(d){var p=m.timeoff_get(d,n.m_nTerm,n.m_nWeek,n.m_nDay,n.period);l=[],["0","?","1"].forEach(function(t){a.CUtils.AddMenuItemSmart(l,"timeoff:"+t,{checked:t==p})}),c.push([]),a.CUtils.AddMenuItemSmart(c,"timeoff",{submenu:l})}return ASC.showContextMenu(c,t,{header:ASC.escapeHTML(a.CUtils.GetUINazov(o,"short_name")),handler:function(i){var a=i.cmd;switch(a){case"putcard":var s=i.data,l=new T(e.m_pRok);return l.Add(s),l.FinishAdding(),void o.UI_KartaUmiestni(e.m_pRozApp,l,n,t);case"deletecards":return void o.UI_OnCommand(a,e);case"timeoff:0":case"timeoff:?":case"timeoff:1":return void o.updateData({timeoff:m.timeoff_set(d,r.dbi,n.m_nTerm,n.m_nWeek,n.m_nDay,n.period,a.substr(8))})}}}),!0}for(var f=[],v=this.Event2XY(t).x>(n.x1+n.x2)/2,b=0,y=[!0,!1];b<y.length;b++){var g=y[b],k=new s.CDozor(this.m_pRok,{classroomid:o.m_Id,teacherid:"",term:a.CUtils.minus2blank(n.m_nTerm),week:a.CUtils.minus2blank(n.m_nWeek),day:a.CUtils.minus2blank(n.m_nDay),period:g?"":n.period,break:g?n.period+(v?1:0):""});k.m_Hodina<r.m_nHodinyOd||k.m_Hodina>r.m_nHodinyDo||(k.m_bTemp=!0,f.push(k))}this.RightClickDozor(t,f[0],{adddozory:f})},p.prototype.ClickRozvrh=function(t){var e=this.GetRiadokE(t),i=this.GetPolickoE(t);if(!e||!i)return!1;var n=e.m_pRokObject;if(!this.m_pRozApp.m_TahanaMHodina.IsEmpty())return n.UI_KartaUmiestni(this.m_pRozApp,this.m_pRozApp.m_TahanaMHodina,i,t),!0;var o=this.GetKartaOnPositionE(t);return!!o&&(n.UI_KartaVyberOdtialto(this.m_pRozApp,i,o,t),!0)},p.prototype.RightClickKarta=function(t,i){var o=this,r=i.m_pHodina,s=this.GetRiadokE(t);if(!s)return!1;if(!this.GetPolickoE(t))return!1;var l=this.m_pRozApp,c=l.m_pRok,m=s.m_pRokObject,h=new T(c);h.SetPozicia(m),h.Add(i),h.FinishAdding();var _,u=h.IsLocked(!0),d=n.__spreadArrays([r.m_pPredmet],r.m_Triedy,r.m_Ucitelia),p=[];u?a.CUtils.AddMenuItemSmart(p,"unlockcard",{text:ASC.ttls(1619)}):(a.CUtils.AddMenuItemSmart(p,"removecard",{text:ASC.ttls(1025)}),a.CUtils.AddMenuItemSmart(p,"lockcard",{text:ASC.ttls(1618)})),p.push([]),a.CUtils.AddMenuItemSmart(p,"deletecards"),p.push([]),_=[];for(var f=0;f<r.m_nPotrebujeUcebni;f++)!function(t){var e=i.Ucebna(t);r.GetUcebneV(t).forEach(function(n){var o=n.JeMulityCard(),r={};r.text=a.CUtils.GetUINazov(n),r.checked=n==e;var s=i.GetVolno(n.timeoff());"1"!=s&&(r.icon=a.CUtils.GetIconVhodnost(s));var c=[];if(n.AddKartyTuK(c,i,0),c.length){var m=!1,h=!0;c.forEach(function(t){t.IsLocked()&&(m=!0),i.MozeKolidovat(t)||(h=!1)}),h?"1"==s&&n!=e&&(r.icon=a.CUtils.GetIconVhodnost("1")):(r.icon=a.CUtils.GetIconVhodnost(o?"?":"0"),o&&(r.icon="/timetable/pics/app/office/no_green_32.png"),m&&(r.disabled=!0))}r.onclick=function(){l.InvalidateKarta(i),i.FreeUcebna(t),o||c.forEach(function(t){i.MozeKolidovat(t)||(l.InvalidateKarta(t),t.FreeUcebnaU(n))}),i.SetUcebna(n,t),l.InvalidateKarta(i)},a.CUtils.AddMenuItemSmart(_,"",r)}),_.push([])}(f);if(a.CUtils.AddMenuItemSmart(_,"",{text:ASC.ttls(1723),onclick:function(){l.InvalidateKarta(i),i.FreeUcebna()}}),a.CUtils.AddMenuItemSmart(p,"",{submenu:_,text:ASC.ttls(1092)}),p.push([]),r.UI_HodinaPopup(p,this),0<r.m_KurzyPreTriedy.length){var v=ASC.ttls(2604),b=r.GetZiaci();v+=" ("+b.length+")",p.push([]),_=[];for(var y=0,g=b;y<g.length;y++){var k=g[y];a.CUtils.AddMenuItemSmart(_,"",{data:k})}a.CUtils.AddMenuItemSmart(p,"",{submenu:_,text:v})}p.push([]),_=[],d.forEach(function(t){a.CUtils.AddMenuItemSmart(_,"",{text:a.CUtils.GetUINazov(t),data:t,onclick:function(){l.click_func("zadanie","table="+t.m_Table+"&id="+t.m_Id)}})}),a.CUtils.AddMenuItemSmart(p,"",{submenu:_,text:ASC.ttls(3621)}),p.push([]),_=[],d.forEach(function(t){var e=t.timeoff();if(e){var n=i.GetVolno(e);a.CUtils.AddMenuItemSmart(_,"timeoff:"+n,{text:a.CUtils.GetUINazov(t),onclick:function(){l.click_func("timeoff","table="+t.m_Table+"&id="+t.m_Id)}})}}),a.CUtils.AddMenuItemSmart(p,"timeoff",{submenu:_}),p.push({text:ASC.ttls(4029),onclick:function(){return n.__awaiter(o,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./quickchanges")})];case 1:return t.sent().showQuickChanges({ttgpid:l.ttgpid,cardid:i.m_Id}),[2]}})})}}),ASC.showContextMenu(p,t,{header:ASC.escapeHTML(a.CUtils.GetUINazov(i,"short")),handler:function(t){var e=t.cmd;m.UI_OnCommand(e,o,i)}})},p.prototype.RightClickDenHodina=function(t){var e=this;if(this.Event2XY(t).y>=this.m_nVyskaMenoDna)return!1;var i=this.GetPolickoE(t);if(!i)return!1;for(var n=[],o=0,r=[["terms",i.m_nTerm],["weeks",i.m_nWeek],["days",i.m_nDay]];o<r.length;o++){var s=r[o],l=s[0],c=s[1];c<0||n.push(this.m_pRok.GetObdobie_One(l,c).GetNazov())}for(var m=[],h=function(t,n){m.push({text:n,icon:a.CUtils.GetIconLocked(t),onclick:function(){for(var n=[],o=0,r=e.m_Riadky;o<r.length;o++)for(var a=0,s=r[o].m_pRokObject.GetKartyMozuSem(e.m_nROJTF);a<s.length;a++)(m=s[a]).JeTu_TWDH(i.m_nTerm,i.m_nWeek,i.m_nDay)&&(n.includes(m)||n.push(m));for(var l=0,c=n;l<c.length;l++){var m;(m=c[l]).IsLocked()!=t&&(e.m_pRozApp.InvalidateKarta(m),m.SetLocked(t))}}})},_=0,u=[[!0,ASC.ttls(1618)],[!1,ASC.ttls(1619)]];_<u.length;_++){var d=u[_];h(d[0],d[1])}return 0<m.length&&ASC.showContextMenu(m,t,{header:n.join(", ")}),!0},p.prototype.d2p=function(t,e){var i="";return i=t.m_Prestavka?"break="+t.m_Hodina:"period="+t.m_Hodina,t.m_bTemp||(i+="&id="+t.m_Id),0<=e.m_nDay&&(i+="&day="+e.m_nDay),0<=e.m_nWeek&&(i+="&week="+e.m_nWeek),0<=e.m_nTerm&&(i+="&term="+e.m_nTerm),i},p.prototype.RightClickDozor=function(t,i,o){var r=this;void 0===o&&(o={});var l=this.GetRiadokE(t);if(!l)return!1;var c=this.GetPolickoE(t);if(!c)return!1;var m=l.m_pRokObject,h=null;m instanceof s.CRokObject&&(h=m);var u,d=this.m_pRozApp,p=d.m_pRok,f=[],v=this.d2p(i,c);if(m instanceof s.CUcitel&&(v+="&teacherid="+m.m_Id),m instanceof s.CUcebna&&(v+="&classroomid="+m.m_Id),i.m_bTemp)for(var b=o.adddozory||[i],y=function(t){if(0<p.GetDozoryTWDH(h,c.m_nTerm,c.m_nWeek,c.m_nDay,t.m_Hodina,t.m_Prestavka).length)return"continue";if(c.m_nDay<0)return"continue";var e=g.d2p(t,c);f.push({text:ASC.ttls(3122)+" ("+t.GetHodinaText()+")",icon:a.CUtils.GetIconNic(),onclick:function(){d.click_func("dozor",e+"&cmd=add&classroomid="+m.m_Id)}})},g=this,k=0,T=b;k<T.length;k++)y(T[k]);else"teachers"==m.m_Table&&f.push({text:ASC.ttls(3123),onclick:function(){d.InvalidateDozor(i),i.SetUcitel(null)},icon:a.CUtils.GetIconNic()}),"classrooms"==m.m_Table&&f.push({text:ASC.ttls(3123),onclick:function(){return ASC.blockUI(_.dozoryRemoveMulti(null,d.ttgpid,{ids:[i.m_Id]}))},icon:a.CUtils.GetIconNic()});if(!i.m_bTemp){if(i.m_bLocked?f.push({text:ASC.ttls(1619),icon:a.CUtils.GetIconLocked(!1),onclick:function(){i.SetLocked(!1),d.InvalidateDozor(i)}}):f.push({text:ASC.ttls(1618),icon:a.CUtils.GetIconLocked(!0),onclick:function(){i.SetLocked(!0),d.InvalidateDozor(i)}}),!i.m_bLocked&&h){b=p.GetDozoryTWDH(h,c.m_nTerm,c.m_nWeek,c.m_nDay,i.m_Hodina,i.m_Prestavka),u=[];for(var S=function(t){u.push({text:""+t,checked:t==b.length,onclick:function(){d.click_func("dozor",v+"&cmd=setcount&count="+t)}})},C=1;C<=10;C++)S(C);f.push({text:ASC.ttls(1266),submenu:u,icon:a.CUtils.GetIconNic()})}if(!i.m_bLocked){f.push([]),f.push({text:ASC.ttls(1090),icon:a.CUtils.GetIconNic(),onclick:function(){return n.__awaiter(r,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./dozory")})];case 1:return t.sent().showStartGenerDozory(d.ttgpid),[2]}})})}}),f.push({text:ASC.ttls(4267),icon:a.CUtils.GetIconNic(),onclick:function(){d.click_func("dozor",v+"&cmd=removeallteachers")}}),f.push([]),f.push({text:ASC.ttls(3118),icon:a.CUtils.GetIconNic(),onclick:function(){r.m_pRozApp.InvalidateDozor(i),i.SetUcitel(null)},selected:!i.m_pUcitel});for(var A=[],I=0,R=p.TableObjects("teachers");I<R.length;I++){var P=R[I];A.push(new w(i,P))}A.sort(function(t,e){return e.poradie-t.poradie});for(var O=0,D=A;O<D.length;O++){var x=D[O];f.push(x.MenuItem())}}}ASC.showContextMenu(f,t,{header:ASC.escapeHTML(i.GetHodinaText()+" ("+i.GetDlzkaVMinutach()+")"),handler:function(t){var e=t.cmd;m.UI_OnCommand(e,r,i)}})},p.prototype.GetKartaOnPositionE=function(t){var e=this.GetRiadokE(t);return e?e.GetKartaOnPositionE(t):null},p.prototype.Event2XY=function(t){var e=this.$div.offset();return{x:ertl(!0,!1)?t.pageX-e.left:e.left+this.$div.width()-t.pageX,y:t.pageY-e.top}},p.prototype.OnClick=function(t){var e=t.x-this.$content_d.offset().left,i=t.y-this.$content_d.offset().top+this.$content_d.get(0).scrollTop,n=this.GetRiadok(i),o=this.GetPolicko(e);n&&o&&(this.m_pRozApp.m_TahanaMHodina.IsEmpty()||n.m_pRokObject.UI_KartaUmiestni(this.m_pRozApp,this.m_pRozApp.m_TahanaMHodina,o,t))},p.prototype.FindRiadok=function(t){for(var e=0;e<this.m_Riadky.length;e++){var i=this.m_Riadky[e];if(i.m_pRokObject==t)return i}return null},p.prototype.GetRiadok=function(t){if(t<this.m_nVyskaMenoDna)return null;var e=Math.floor((t-this.m_nVyskaMenoDna+this.$content_d.get(0).scrollTop)/(this.m_nVyskaRiadok+1));return 0<=e&&e<this.m_Riadky.length?this.m_Riadky[e]:null},p.prototype.GetRiadokE=function(t){return this.GetRiadok(this.Event2XY(t).y)},p.prototype.GetPolicko=function(t){for(var e=0;e<this.m_Policka.length;e++){var i=this.m_Policka[e];if(t>=i.x1&&t<=i.x2+1)return i}return null},p.prototype.GetPolickoE=function(t){return this.GetPolicko(this.Event2XY(t).x)},p.prototype.FillRibbonCombos=function(){var t=this;if(!this.m_pRozApp.ttviewer){var i=this.m_pRozApp.$rg_pohlad_div,o="width:150px; display:block; margin-bottom: 2px";this.m_pComboPohlad||(this.m_pComboPohlad=new ASC.ui.ComboBox(i,this.m_pAktPohlad?this.m_pAktPohlad.m_Id:"",[],{style:o,fn:function(){return n.__awaiter(t,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:switch(this.m_pComboPohlad.value){case"view_manage":return[3,1];case"view_edit":return[3,3]}return[3,5];case 1:return this.m_pComboPohlad.ASC_set(this.m_pAktPohlad.m_Id),[4,Promise.resolve().then(function(){return e("./zadanie")})];case 2:return t.sent().showZadanieDlg(this.m_pRozApp.ttgpid,{table:"ttviews"}),[3,6];case 3:return this.m_pComboPohlad.ASC_set(this.m_pAktPohlad.m_Id),[4,Promise.resolve().then(function(){return e("./dlg")})];case 4:return t.sent().showItemDlg(this.m_pRozApp.ttgpid,"ttviews",this.m_pAktPohlad.m_Id),[3,6];case 5:this.SetAktPohlad(this.m_pComboPohlad.value),t.label=6;case 6:return[2]}})})}})),["terms","weeks","days"].forEach(function(e){t.m_ComboObdobia[e]||(t.m_ComboObdobia[e]=new ASC.ui.ComboBox(i,"",[],{style:o,fn:function(){t.SetAktObdobie(e,t.m_ComboObdobia[e].value)}}))});for(var r=[],a=0,s=this.m_pRok.TableObjects("ttviews");a<s.length;a++){var l=s[a];l.m_Hidden||r.push({value:l.m_Id,name:l.GetNazov(),icon:l.m_Icon})}r.push([]),r.push({name:ASC.ttls(1161),value:"view_manage"}),r.push({name:ASC.ttls(3303),value:"view_edit"}),this.m_pComboPohlad.setItems(r),this.m_pAktPohlad&&this.m_pComboPohlad.ASC_set(this.m_pAktPohlad.m_Id,!1);for(var c=0,m=["terms","weeks","days"];c<m.length;c++){var h=m[c],_=this.m_ComboObdobia[h],u=!1;"days"==h&&(u=!0),1==this.m_pRok.GetObdobieCount(h)&&(u=!0),u?_.$div.hide():_.$div.show();var d=h+"defs",p=!(r=[]),f=null,v=null,b=this.m_pRok.GetObdobieCount(h),y=b;y<2&&(y=2),4<y&&(y=4);for(var g=0,k=this.m_pRok.Obdobia(d);g<k.length;g++){var T=k[g];switch(T==this.m_pAktObdobie[h]&&(p=!0),T.m_Typ){case"one":var S="";2<=b&&b<=4&&("terms"==h&&(S="b_"+y+"_"+(T.m_Val+1)),"weeks"==h&&(S="g_"+y+"_"+(T.m_Val+1))),r.push({value:T.m_Id,name:T.GetNazov(),icon:S?"/timetable/pics/app/term_week_day/"+S+".png":null});break;case"all":var C=(f=T).GetNazov();S="","terms"==h&&(C=ASC.ttls(3552),S="b_"+y+"_A"),"weeks"==h&&(C=ASC.ttls(3444),S="g_"+y+"_A"),r.push({value:T.m_Id,name:C,icon:S?"/timetable/pics/app/term_week_day/"+S+".png":null});break;case"any":C=(v=T).GetNazov(),"terms"==h&&(C=ASC.ttls(3553),S="b_x"),"weeks"==h&&(C=ASC.ttls(3443),S="g_x"),r.push({value:T.m_Id,name:C,icon:S?"/timetable/pics/app/term_week_day/"+S+".png":null})}}p||(this.m_pAktObdobie[h]="days"==h?v:f),_.setItems(r),this.m_pAktObdobie[h]&&_.ASC_set(this.m_pAktObdobie[h].m_Id,!1)}}},p.prototype.SetAktPohlad=function(t){if(ASC.isString(t))for(var e=0,i=this.m_pRok.TableObjects("ttviews");e<i.length;e++){var n=i[e];if(n.m_Id==t){t=n;break}}var o=t;0<(this.m_pAktPohlad=o).m_nVyskaRiadok&&(this.m_nVyskaRiadok=o.m_nVyskaRiadok),this.m_pComboPohlad&&this.m_pComboPohlad.ASC_set(o.m_Id,!1),this.m_pRozApp.InvalidateTriedyView(),this.m_pRozApp.InvalidatePending(),this.m_pRozApp.InvalidatePohladSwitcher()},p.prototype.SetAktObdobie=function(t,e){var i;i=ASC.isString(e)?this.m_pRok.m_ObjectsI[t+"defs"][e]:e,console.log([t,e,i,this.m_pAktObdobie]),i&&(this.m_pAktObdobie[t]=i,this.m_pRozApp.InvalidateTriedyView(),this.m_pRozApp.InvalidatePending())},p.prototype.GetPohladForTable=function(t){for(var e=0,i=this.m_pRok.TableObjects("ttviews");e<i.length;e++){var n=i[e];if(n.m_Data.table==t)return n}return null},p.prototype.InvalidateMHodina=function(t){for(var e=0;e<this.m_Riadky.length;e++){var i=this.m_Riadky[e],n=i.m_pRokObject;t.m_ObjectsI[n.m_Table][n.m_Id]&&(i.m_bInvalid=!0)}},p.prototype.InvalidateObject=function(t){var e=this;this.m_Riadky.forEach(function(i){if(!i.m_bInvalid){var n=i.m_pRokObject,o=!1;if(n==t)o=!0;else for(var r=n.GetHodinyMozuSem(e.m_nROJTF),a=0;a<r.length;a++){var s=r[a];switch(t.m_Table){case"classes":o=0<=s.m_Triedy.indexOf(t);break;case"teachers":o=0<=s.m_Ucitelia.indexOf(t);break;case"subjects":o=s.m_pPredmet==t}if(o)break}o&&(i.m_bInvalid=!0)}})},p.prototype.Validate=function(){if((this.m_bInvalidAll||this.$content_d&&this.$content_d.get(0).clientWidth!=this.m_nOldContentWidth)&&(this.UpdateStruct(),this.m_bInvalidAll=!1),!this.m_pRozApp.ttviewer){for(var t=this.m_nDefaultSirkaStlpecMenoTriedy,e=0,i=this.m_Riadky;e<i.length;e++){var n=i[e];n.m_bInvalid&&n.DrawMeno0()}for(var o=0,r=this.m_Riadky;o<r.length;o++){var a=r[o];a.$name_s&&(t=Math.max(t,a.$name_s.width()+4))}(t=Math.min(t,150))!=this.m_nSirkaStlpecMenoTriedy&&(this.m_nSirkaStlpecMenoTriedy=t,this.UpdateStruct());var s=[];if(50<=this.m_Riadky.length)for(var l=this.$content_d.scrollTop(),c=this.$content_d.height(),m=l-.3*c,h=l+1.3*c,_=0,u=this.m_Riadky;_<u.length;_++){var d=u[_];d.m_bInvalid&&!d.isOutOfView(m,h)&&s.push(d)}else $j.merge(s,this.m_Riadky);for(var p=0,f=s;p<f.length;p++){var v=f[p];v.m_bInvalid&&v.Draw()}this.m_bInvalidFarbyRiadkov&&this.UpdateFarbyRiadkov(),this.m_bInvalidFarbyStlpcov&&this.UpdateFarbyStlpcov()}},p.prototype.UpdateFarbyRiadkov=function(){this.m_Riadky.forEach(function(t){t.UpdateFarbaRiadku()}),this.m_bInvalidFarbyRiadkov=!1},p.prototype.UpdateFarbyStlpcov=function(){this.m_Policka.forEach(function(t){t.UpdateFarbaStlpca()}),this.m_bInvalidFarbyStlpcov=!1},p.prototype.BuildRVKarta=function(t){var e=this.m_pAktPohlad,i=document.createElement("div");i.className="rvcard";var n=this.m_nVyskaRiadok;50<n&&(n=50);var o=this.m_nSirkaPolicko;50<o&&(o=50),o*=t.GetMaxDlzka()+1,i.style.width=o+"px",i.style.height=n+"px";var r=this.m_pTTRowRenderer;r.Clear(),r.m_bIgnoreFilters=!0,r.m_bVsetkoNaJednuPoziciu=!0,r.m_SuggestedKarty=t.m_Objects.cards,r.m_pHorizontalRokObject=t.m_Pozicia.classes,0<t.m_nRozView_TypKarty&&1<r.m_SuggestedKarty.length&&(r.m_SuggestedKarty=[r.m_SuggestedKarty[0]]),r.Compute(),ASC.assert(0<r.m_Cells.length);for(var s=0;s<r.m_Cells.length;s++){var l=r.m_Cells[s],c=document.createElement("div");c.className="card",i.appendChild(c),c.innerHTML=ASC.escapeHTML(l.m_pKarta.GetTexty(e.texttables)),c.ASC_karta=l.m_pKarta,c.style.left="0px",c.style.right="0px",c.style.top=100*l.y1+"%",c.style.bottom=100-100*l.y2+"%";var m=l.m_pKarta.GetFarby(e.colortable);if(m&&0!=m.length||(m=["#ffffff"]),"teachers"==e.colortable){var h=l.m_pKarta.m_pHodina.m_Ucitelia[0];h&&h.m_Data.fontcolorscreen&&(c.style.color=h.m_Data.fontcolorscreen)}t.m_bRozView_Zasednut&&(m=a.CUtils.ZasedniColors(m)),ASC.strippedBackground(c,m)}return i},p.prototype.PaintMH=function(t,e,i,n,o,r){var s=this.m_pAktPohlad,l=this.m_pTTRowRenderer;l.Clear(),l.m_bIgnoreFilters=!0,l.m_bVsetkoNaJednuPoziciu=!0,l.m_SuggestedKarty=r.m_Objects.cards,l.m_pHorizontalRokObject=r.m_Pozicia.classes,l.Compute(),ASC.assert(0<l.m_Cells.length);for(var c=0;c<l.m_Cells.length;c++){var m=l.m_Cells[c],h=m.m_pKarta.GetTexty(s.texttables),_=m.m_pKarta.GetFarby(s.colortable),u=Math.round(i+o*m.y1),d=Math.round(i+o*m.y2);if(a.CUtils.PaintFarbyToRect(_,t,e,u,n,d-u),t.font="Arial 11px",t.fillStyle="#000000","teachers"==s.colortable){var p=m.m_pKarta.m_pHodina.m_Ucitelia[0];p&&p.m_Data.fontcolorscreen&&(t.fillStyle=p.m_Data.fontcolorscreen)}a.CUtils.PaintTextToRect(h,t,e,u,n,d-u)}},p.prototype.GetPreviewMHodina=function(){return this.m_bPreviewPodKurzorom?this.m_pRozApp.m_PodKurzoromMHodina:this.m_pRozApp.m_TahanaMHodina},p.prototype.ScrollToRiadky=function(t){if(0!=t.length){for(var e=this.m_pRozApp.m_pTriedyView.$content_d[0],i=1e6,n=0,o=0,r=t;o<r.length;o++){var a=r[o].$div[0],s=a.offsetTop,l=s+a.offsetHeight;i=Math.min(i,s),n=Math.max(n,l)}var c=e.scrollTop;c=Math.max(c,n-e.clientHeight),c=Math.min(c,i),e.scrollTop=c}},p);function p(e,i){this.m_Riadky=[],this.m_Policka=[],this.m_nVyskaMenoDna=22,this.m_nVyskaRiadok=t.nDefaultVyskaRiadok,this.m_nDefaultSirkaStlpecMenoTriedy=28,this.m_pAktObdobie={},this.m_bPreviewPodKurzorom=!1,this.m_pCursorRiadok=null,this.m_pCursorPolicko=null,this.m_pComboPohlad=null,this.m_ComboObdobia={},this.m_nOldContentWidth=-1,this.m_bInvalidAll=!1,this.m_bInvalidFarbyRiadkov=!1,this.m_bInvalidFarbyStlpcov=!1,this.m_nROJTF=0,this.lastPohlad=null,this.m_pRozApp=e,this.m_pRok=this.m_pRozApp.m_pRok,this.$div=i,this.$div.addClass("triedyview"),this.m_pAktPohlad=null,this.m_nVyskaRiadok=t.nDefaultVyskaRiadok,this.m_nSirkaStlpecMenoTriedy=this.m_nDefaultSirkaStlpecMenoTriedy,this.m_nSirkaPolicko=20,this.m_pTTRowRenderer=new l.CTTRowRenderer(this.m_pRok),this.$div.attr("tabindex","0")}t.CTriedyView=d;var f=(v.prototype.isOutOfView=function(t,e){var i=this.$div[0].offsetTop;return i<t||e<i},v.prototype.DrawMeno0=function(){this.$name_d&&this.$name_d.remove(),this.$name_d=$j("<div class='name'>").prependTo(this.$div).css("width",this.m_pTriedyView.m_nSirkaStlpecMenoTriedy+1+"px"),this.$name_s=$j("<span>").text(this.m_pRokObject.GetSkratka()).appendTo(this.$name_d)},v.prototype.Draw=function(){var t=this.$div,e=this.m_pTriedyView,i=e.m_pRozApp,n=e.m_Policka,o=e.m_pAktPohlad,r=i.m_pKontrolaItem,l=null;r&&(l=r.FindRiadok(this.m_pRokObject));var c,_=this.m_pRokObject instanceof s.CTrieda?this.m_pRokObject:null;if(t.empty(),this.DrawMeno0(),16<=e.m_nVyskaRiadok){for(var u=0,d=0,p=this.m_pRokObject.GetHodinyMozuSem(e.m_nROJTF);d<p.length;d++)for(var f=0,v=p[d].m_Karty;f<v.length;f++)v[f].JeUmiestnena()||u++;0<u&&$j("<span class='neumiestnenych'>").text(""+u).appendTo(this.$name_d)}for(var b=0;b<n.length;b++){var y=n[b];0!=b&&((L=document.createElement("div")).className="vline",t.append(L),L.style[ertl("left","right")]=y.x1-1+"px",y.m_pGroup!=c.m_pGroup&&ASC.setClass(L,"first")),c=y}var g=this.m_pRokObject.GetKartyTu(e.m_nROJTF);t.get(0).ASC_karty=g;var k=e.m_pTTRowRenderer;k.Clear();for(var T=!0,S=0;S<n.length;S++){var C=n[S];T&&(k.Clear(),k.m_pHorizontalRokObject=this.m_pRokObject,k.m_horizontalTimeoff=this.m_pRokObject.timeoff(),k.m_nDay=C.m_nDay,k.m_nWeek=C.m_nWeek,k.m_nTerm=C.m_nTerm,k.m_nVerticalHodinyOd=C.period,k.m_SuggestedKarty=g,T=!1),k.m_Policka.push(C);var A=!0,w=n[S+1];if(w&&w.JeRovnakyDen(C)&&(A=!1),A){if(k.m_nVerticalHodinyDo=C.period,k.Compute(),k.m_horizontalTimeoff)for(var I=0;I<k.m_nXCount;I++)for(var R=k.m_nVerticalHodinyOd+I,P=k.m_nXFaz[I],O=0;O<P;O++){var D=0;if("0"==k.GetVolno(O,I)?D=1:_&&_.JeObed(R)&&(D=2),0<D){var x=k.m_Policka[I].x1,z=k.m_Policka[I].x2;switch((L=document.createElement("div")).style[ertl("left","right")]=x+"px",L.style.width=z-x+"px",L.style.top="0%",L.style.bottom="0%",D){case 1:L.className="krizik";break;case 2:L.className="obed"}t.append(L)}}for(b=0;b<k.m_Cells.length;b++){var G=k.m_Cells[b],V=G.m_pKarta;(L=document.createElement("div")).className="card",t.append(L);var M=V.GetTexty(o.texttables);ASC.createText(L,M),L.ASC_karta=V,x=k.m_Policka[G.x1].x1,z=k.m_Policka[G.x2].x2,L.style.boxSizing="border-box",L.style[ertl("left","right")]=x+"px",L.style.width=z-x+"px",L.style.top=100*G.y1+"%",L.style.bottom=100-100*G.y2+"%";var U=V.GetFarby(o.colortable);if(U&&0!=U.length||(U=["#ffffff"]),"teachers"==o.colortable){var H=V.m_pHodina.m_Ucitelia[0];H&&H.m_Data.fontcolorscreen&&(L.style.color=H.m_Data.fontcolorscreen)}var K=!1,E=!1;r&&(K=!0,l&&(l.m_RelevantneHodiny[V.m_pHodina.m_Id]&&(K=!1),l.m_ZleKarty[V.m_Id]&&(K=!(E=!0)))),K&&(U=a.CUtils.ZasedniColors(U));var N=(G.y2-G.y1)*e.m_nVyskaRiadok;ASC.strippedBackground(L,U,z-x,N,!0),E&&(L.style.border="2px solid red");var j=G.m_pKarta.GetFarbyChyby();0<j.length&&(ASC.createDiv(L,"pruzok").style.background=h.strippedBackground(j,0));var Z=G.m_pKarta.GetFarbyFazy();0<Z.length&&(ASC.createDiv(L,"pruzok_l").style.background=h.strippedBackground(Z,0));var $=!1;if("students"==this.m_pRokObject.m_Table){var F=this.m_pRokObject.GetZiakPredmet(V.m_pHodina);F&&F.m_bLocked&&($=!0)}else $=G.m_pKarta.IsLocked();$&&ASC.createDiv(L,"locked"),L.onmouseover=i.m_OnMouseOverKarta,L.onmouseout=i.m_OnMouseOutKarta,e.JePohladDozory()||(L.onclick=i.m_OnMouseClickKarta,L.oncontextmenu=i.m_OnMouseRightClickKarta),L.onmouseup=i.m_OnMouse_StopEvent}if(1<k.m_nMaxFaz)for(I=0;I<k.m_nXCount;I++)if(!((P=k.m_nXFaz[I])<=1))for(y=k.m_Policka[I],O=1;O<P;O++){var L;(L=document.createElement("div")).className="cyklus",L.style[ertl("left","right")]=y.x1+"px",L.style.width=y.x2-y.x1+"px",L.style.top=100*O/P+"%",t.append(L)}if(l){var B=function(e,i){if(e)for(var n=null,o=0,r=0,a=0;a<k.m_nXCount;a++){var s=k.m_Policka[a];"1"==m.timeoff_get(e,s.m_nTerm,s.m_nWeek,s.m_nDay,s.period)?n?n.style.width=s.x2-o+"px":((n=document.createElement("div")).className="vysvietpos",n.style.borderColor=i,o=s.x1,r=s.x2,n.style.left=o+"px",n.style.width=r-o+"px",t.append(n)):n=null}};B(l.m_pVysviet2,"#fce872"),B(l.m_pVysviet1,"#ff8040"),B(l.m_pVysvietZle,"#ff0000")}T=!0}}this.m_bInvalid=!1,this.UpdateFarbaRiadku(),this.DrawDozory()},v.prototype.DrawDozory=function(){var t=this.m_pRokObject,e=t.m_pRok;if(0!=e.m_ObjectsO.classroomsupervisions.length)for(var i=this.m_pRozApp.m_pTriedyView,n=i.m_pRozApp,o=i.m_nVyskaRiadok-1,r=null,a=0,l=[!1,!0];a<l.length;a++)for(var c=l[a],m=0,_=this.m_pTriedyView.m_Policka;m<_.length;m++){var u=_[m],d=e.GetDozoryTWDH(t,u.m_nTerm,u.m_nWeek,u.m_nDay,u.period,c);if(d.length)for(var p=0;p<d.length;p++){var f=d[p],v=document.createElement("span");v.className="dozor";var b=.25+.5*p/d.length,y=.25+.5*(p+1)/d.length;v.style.top=o*b+"px",v.style.bottom=o*(1-y)-1+"px";var g=u.x1,k=(u.x2-g)/2;g--,c?r&&u.JeRovnakyDen(r)?g-=k/2:k/=2:g+=k/2,v.style.left=g+"px",v.style.width=k+"px",f.m_bLocked&&ASC.createDiv(v,"locked");var T="#c0c0c0";t instanceof s.CUcebna&&(f.m_pUcitel?T=f.m_pUcitel.GetColor():ASC.setClass(v,"otaznik")),v.style.backgroundColor=T,0<=f.m_Tyzden&&(ASC.createDiv(v,"pruzok_l").style.backgroundColor=h.getFarbaFazy(f.m_Tyzden,e.m_nTyzdnov)),v.ASC_dozor=f,v.oncontextmenu=n.m_OnMouseRightClickDozor,v.onmouseover=n.m_OnMouseOverKarta,v.onmouseout=n.m_OnMouseOutKarta,i.JePohladDozory()&&(v.onclick=n.m_OnMouseRightClickDozor),this.$div.append(v)}r=u}},v.prototype.MozeSemIst=function(t){return!t.IsEmpty()&&this.m_pRokObject.UI_KartaMozeSem(this.m_pRozApp,t)},v.prototype.UpdateFarbaRiadku=function(){var t=!1,e=!1;if(this.$name_d){var i=this.m_pRozApp.m_TahanaMHodina;i.IsEmpty()||this.MozeSemIst(i)&&(t=!0),this.m_pRozApp.m_pRadSelector.IsInRad(this.m_pRokObject)&&(e=!0),this.$name_d.toggleClass("mozesem",t),this.$div.toggleClass("selrad",e);var n=this.m_pRozApp.m_pSync.GetFarbyUserov(this.m_pRokObject);if(n){var o=this.$name_d.find(".users");o.length||(o=$j("<div class='users'>").appendTo(this.$name_d)),o.css("background-color",n[0]),this.$name_d.addClass("users")}else this.$name_d.find(".users").remove(),this.$name_d.removeClass("users")}},v.prototype.GetKartaOnPositionE=function(t){return this.$div.children().each(function(e,i){var n=i.ASC_karta;if(n&&a.CUtils.IsEventInside(t,$j(i)))return a.CUtils.IsEventInside(t,$j(i)),n}),null},v);function v(t,e){this.$name_d=null,this.$name_s=null,this.m_bInvalid=!0,this.m_pRozApp=t.m_pRozApp,this.m_pTriedyView=t,this.m_pRokObject=e,this.$div=$j("<div class='vriadok'>").appendTo(this.m_pTriedyView.$content_d).css("height",t.m_nVyskaRiadok+"px"),this.$div.get(0).ASC_vriadok=this}t.CVRiadok=f;var b=(y.prototype.UpdateX=function(){var t=this.m_pTriedyView.$content_d.get(0).clientWidth,e=this.m_pTriedyView.m_nSirkaStlpecMenoTriedy;t-=e,this.x1=Math.round(e+t*this.index/this.m_pTriedyView.m_Policka.length+1),this.x2=Math.round(e+t*(this.index+1)/this.m_pTriedyView.m_Policka.length),this.$div.css(ertl("left","right"),this.x1-1+"px"),this.$div.css("width",this.x2-this.x1+"px"),this.m_pGroup.UpdateX()},y.prototype.JeRovnakyDen=function(t){return this.m_nTerm==t.m_nTerm&&this.m_nWeek==t.m_nWeek&&this.m_nDay==t.m_nDay},y.prototype.UpdateFarbaStlpca=function(){var t="",e=this.m_pTriedyView.GetPreviewMHodina();e.IsEmpty()||(t=this.m_pTriedyView.m_pAktPohlad.UI_VhodnostTahanejMHodiny(e,this)),this.$div.toggleClass("obsadene","x"==t),this.$div.toggleClass("volne","1"==t),this.$div.toggleClass("otaznikove","?"==t)},y.prototype.toDozorPolicko=function(){return{w:this.m_nWeek,d:this.m_nDay,h:this.period}},y);function y(t,e,i,n,o,r){if(this.m_pGroup=null,this.m_pRozApp=t.m_pRozApp,this.m_pTriedyView=t,this.m_nTerm=e,this.m_nWeek=i,this.m_nDay=n,this.period=o,this.index=r,this.x1=0,this.x2=20,this.$div=$j("<div class='vpolicko'>").appendTo(this.m_pTriedyView.$header_d),ASC.createSpanText(this.$div.get(0),this.m_pRozApp.dbi.rowName("periods",""+this.period,"short"),"","display:block;margin-top:-0px"),this.m_pRozApp.m_pRok.m_ObjectsI.breaks[o]&&this.$div.addClass("break"),0<t.m_Policka.length){var a=t.m_Policka[t.m_Policka.length-1];a.m_nDay==this.m_nDay&&a.m_nWeek==this.m_nWeek&&a.m_nTerm==this.m_nTerm&&(this.m_pGroup=a.m_pGroup,this.m_pGroup.m_pLast=this)}this.m_pGroup||(this.m_pGroup=new g(this),this.$div.addClass("first"))}t.CVPolicko=b;var g=(k.prototype.UpdateX=function(){var t=this.m_pFirst.x1,e=this.m_pLast.x2;this.$div.css(ertl("left","right"),t-1+"px"),this.$div.css("width",e-t+"px")},k);function k(t){var e=t.m_pTriedyView;this.m_pRozApp=e.m_pRozApp,this.m_pTriedyView=e,this.m_pFirst=t,this.m_pLast=t,this.$div=$j("<div class='vpolickogroup'>").appendTo(this.m_pTriedyView.$header_d);var i=this.m_pRozApp.m_pRok,n="";0<=this.m_pFirst.m_nTerm&&(n&&(n+="-"),n+=i.GetObdobie_One("terms",this.m_pFirst.m_nTerm).GetNazov()),0<=this.m_pFirst.m_nWeek&&(n&&(n+="-"),n+=i.GetObdobie_One("weeks",this.m_pFirst.m_nWeek).GetNazov()),0<=this.m_pFirst.m_nDay&&(n&&(n+="-"),n+=i.GetObdobie_One("days",this.m_pFirst.m_nDay).GetNazov()),ASC.createSpanText(this.$div.get(0),n,"","display:block;margin-top:-0px")}t.CVPolickoGroup=g;var T=(S.prototype.Clear=function(){for(var t in this.m_ModeTable="",this.m_Pozicia={},this.m_Skupiny=[],this.m_Objects)this.m_Objects[t]=[],this.m_ObjectsI[t]={};this.m_pDelenie=null,this.m_bSeminar=!1,this.m_nPoradieSeminaru=-1,this.m_dHodin=0,this.m_bRoznePoctyHodin=!1},S.prototype.SetPozicia=function(t){this.m_Pozicia[t.m_Table]=t},S.prototype.Add0=function(t){var e=t.m_Table,i=t.m_Id;this.m_ObjectsI[e][i]||(this.m_Objects[e].push(t),this.m_ObjectsI[e][i]=t)},S.prototype.Add0_array=function(t){for(var e=0;e<t.length;e++)this.Add0(t[e])},S.prototype.Add0_id=function(t,e){this.Add0_array(this.m_pRok.ids2ro(t,[e]))},S.prototype.Add0_ids=function(t,e){this.Add0_array(this.m_pRok.ids2ro(t,e))},S.prototype.Add=function(t){var e=t.m_Table;ASC.assert(""==this.m_ModeTable||this.m_ModeTable==e),this.m_ModeTable=e,this.Add0(t)},S.prototype.Add_array=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];this.Add(n)}},S.prototype.FinishAdding=function(){var t=this,e=this.m_Pozicia.classes;switch(this.m_ModeTable){case"cards":for(var i=0;i<this.m_Objects.cards.length;i++){var n=this.m_Objects.cards[i],o=n.m_pHodina;this.Add0(o),this.Add0_array(n.Ucebne())}break;case"lessons":for(i=0;i<this.m_Objects.lessons.length;i++)o=this.m_Objects.lessons[i],this.Add0(o);break;case"classroomsupervisions":for(var r=0,a=this.m_Objects.classroomsupervisions;r<a.length;r++){var s=a[r];this.Add0(s.m_pUcebna),s.m_pUcitel&&this.Add0(s.m_pUcitel)}}if("lessons"==this.m_ModeTable||"cards"==this.m_ModeTable){var l=!1;e=this.m_Pozicia.classes,this.m_Objects.lessons.forEach(function(i){t.Add0_array(i.m_Ucitelia),t.Add0(i.m_pPredmet),t.Add0_array(i.m_Triedy),i.m_Skupiny.forEach(function(i){var n=i.m_pTrieda;e&&n!=e||(t.m_pDelenie?t.m_pDelenie!=i.m_pDelenie&&(l=!0):t.m_pDelenie=i.m_pDelenie,i.m_bCelaTrieda||i.m_bKurz||t.m_Skupiny.indexOf(i.GetNazov())<0&&t.m_Skupiny.push(i.GetNazov()))}),0<i.m_KurzyPreTriedy.length&&(t.m_nPoradieSeminaru!=i.m_nPoradieSeminaru&&(-1==t.m_nPoradieSeminaru?t.m_nPoradieSeminaru=i.m_nPoradieSeminaru:t.m_nPoradieSeminaru=-2),e?0<=i.m_KurzyPreTriedy.indexOf(e)&&(t.m_bSeminar=!0):t.m_bSeminar=!0)}),l&&(this.m_pDelenie=null)}this.m_dHodin=0,this.m_bRoznePoctyHodin=!1;var c=this.m_Objects.lessons;if(e){for(var m=0,h=e.m_Delenia;m<h.length;m++){for(var _=-1,u=0,d=h[m].m_Skupiny;u<d.length;u++){for(var p=d[u],f=0,v=0,b=c;v<b.length;v++)(o=b[v]).m_Skupiny.indexOf(p)<0||(f+=this.DHodin(o));_=_<0?f:(.001<Math.abs(_-f)&&(this.m_bRoznePoctyHodin=!0),Math.max(_,f))}0<_&&(this.m_dHodin+=_)}this.m_bSeminar}else{var y=0;c.forEach(function(e){y+=t.DHodin(e)}),this.m_dHodin=y}},S.prototype.GetMaxDlzka=function(){for(var t=0,e=0;e<this.m_Objects.lessons.length;e++)t=Math.max(t,this.m_Objects.lessons[e].GetDlzka());return t},S.prototype.DHodin=function(t){var e=1;return this.m_bUvazujDlzkuPreUvazokUcitela&&(e=t.m_pPredmet.GetDoUvazkuRatatAko()),t.m_pObdobie.terms.AvgPokrytieBitov()*t.m_pObdobie.weeks.AvgPokrytieBitov()*t.m_pObdobie.days.GetDlzka()*(t.GetDlzka()+1)*e*this.PocetKarietDoSuctuHodin(t)},S.prototype.PocetKarietDoSuctuHodin=function(t){var e=this;if("cards"!=this.m_ModeTable)return t.GetPocet();var i=0;return t.m_Karty.forEach(function(t){t.JeUmiestnena()&&(e.m_Objects.cards.indexOf(t)<0||i++)}),i},S.prototype.IsEmpty=function(){switch(this.m_ModeTable){case"lessons":case"cards":return 0==this.m_Objects[this.m_ModeTable].length;default:return!(0<this.m_Objects.lessons.length||0<this.m_Objects.cards.length||0<this.m_Objects.teachers.length||0<this.m_Objects.classes.length||0<this.m_Objects.classrooms.length||0<this.m_Objects.subjects.length)}},S.prototype.Set=function(t){for(var e in this.Clear(),t.m_Pozicia)this.m_Pozicia[e]=t.m_Pozicia[e];switch(t.m_ModeTable){case"cards":case"lessons":case"classroomsupervisions":this.m_ModeTable=t.m_ModeTable,this.Add0_array(t.m_Objects[t.m_ModeTable]);break;default:for(var e in this.m_Objects)this.Add0_array(t.m_Objects[e])}this.FinishAdding()},S.prototype.Equals=function(t){for(var e in this.m_Objects)if(!a.CUtils.RovnakyList(this.m_Objects[e],t.m_Objects[e]))return!1;return!0},S.prototype.GetText=function(t,e){switch(t){case"classes":return a.CUtils.GetUINazvy(this.m_Objects.classes,e);case"subjects":return a.CUtils.GetUINazvy(this.m_Objects.subjects,e);case"teachers":return a.CUtils.GetUINazvy(this.m_Objects.teachers,e);case"classrooms":return a.CUtils.GetUINazvy(this.m_Objects.classrooms,e);case"groupnames":case"groups":return this.m_Skupiny.join(", ")}return"HU"+t},S.prototype.GetFarby=function(t){var e=[],i=this.m_Objects[t];return i&&i.forEach(function(t){e.push(t.GetColor())}),e},S.prototype.GetTexty=function(t){var e=this,i="";return t.forEach(function(t){""!=i&&(i+="\n"),i+=e.GetText(t)}),i},S.prototype.IsLocked=function(t){void 0===t&&(t=!1);var e=this.m_Pozicia.students;if(e){for(var i=!1,n=0,o=this.Hodiny();n<o.length;n++){var r=o[n],a=e.GetZiakPredmet(r);if(a)if(i=!0,a.m_bLocked){if(!t)return!0}else if(t)return!1}return!!i&&t}var s=this.m_Objects.cards;if(0==s.length)return!1;for(var l=0;l<s.length;l++){var c=s[l];if(c.JeUmiestnena()&&c.IsLocked()){if(!t)return!0}else if(t)return!1}return t},S.prototype.Karty=function(){return this.m_Objects.cards},S.prototype.Hodiny=function(){return this.m_Objects.lessons},S.prototype.Ucitelia=function(){return this.m_Objects.teachers},S.prototype.Predmety=function(){return this.m_Objects.subjects},S.prototype.Triedy=function(){return this.m_Objects.classes},S.prototype.GetJedinaKarta=function(){return 1==this.m_Objects.cards.length?this.m_Objects.cards[0]:null},S.prototype.GetJedinaHodina=function(){return 1==this.m_Objects.lessons.length?this.m_Objects.lessons[0]:null},S);function S(t){this.m_Objects={classes:[],teachers:[],subjects:[],students:[],classrooms:[],lessons:[],cards:[],classroomsupervisions:[]},this.m_ObjectsI={classes:{},teachers:{},subjects:{},students:{},classrooms:{},lessons:{},cards:{},classroomsupervisions:{}},this.m_Skupiny=[],this.m_pDelenie=null,this.m_bSeminar=!1,this.m_nPoradieSeminaru=-1,this.m_dHodin=0,this.m_bRoznePoctyHodin=!1,this.m_bUvazujDlzkuPreUvazokUcitela=!1,this.m_nRozView_Ciselko=0,this.m_nRozView_TypKarty=0,this.m_bRozView_Zasednut=!1,this.m_pRok=t,this.Clear()}t.CMHodina=T;var C=(A.prototype.SetEnabled=function(t){(t=ASC.boolVal(t))!=this.m_bEnabled&&(this.m_bEnabled=t,this.m_pRozApp.InvalidatePohladSwitcher())},A.prototype.Validate=function(){var t=this;if(this.m_bInvalid)if(this.m_bEnabled){this.$div.show(),this.$div.empty();for(var e=function(e){if(e.m_Hidden)return"continue";var n=$j("<div class='tab'>").appendTo(i.$div),o=$j("<span>").text(e.GetNazov()).appendTo(n).outerWidth();n.css("height",o+"px"),i.m_pRozApp.m_pTriedyView.m_pAktPohlad==e&&n.addClass("selected"),n.click(function(){t.m_pRozApp.m_pTriedyView.SetAktPohlad(e)})},i=this,n=0,o=this.m_pRok.TableObjects("ttviews");n<o.length;n++)e(o[n]);this.m_bInvalid=!1}else this.$div.hide()},A);function A(t,e){this.m_bEnabled=!0,this.m_bInvalid=!0,this.m_pRozApp=t,this.m_pRok=this.m_pRozApp.m_pRok,this.$div=e,this.$div.addClass("pohladswitcher")}t.CPohladSwitcher=C;var w=(I.prototype.MenuItem=function(){var t=this,e="";e=this.m_pUcitel?a.CUtils.GetUINazov(this.m_pUcitel,"short_name"):ASC.ttls(3118);var i=a.CUtils.GetIconNic(),n="/timetable/pics/app/supervision/";i=this.obsadeny?n+"uh0.png":n+"uh"+this.p1+this.p2+".png";var o=this.m_pUcitel.m_Data.constraints,r=this.m_pUcitel.GetPocetDozorov(),s=!ASC.strEmpty(o.m_nMaxDozorovPocet)||!ASC.strEmpty(o.m_nMaxDozorovMinut);return(r.count||s)&&(e+=" ("+r.minutes+"/"+r.count+")"),s&&(e+=" (",e+=ASC.strEmpty(o.m_nMaxDozorovMinut)?"-":o.m_nMaxDozorovMinut,e+="/",e+=ASC.strEmpty(o.m_nMaxDozorovPocet)?"-":o.m_nMaxDozorovPocet,e+=" "+ASC.ttls(3001)+")"),{text:e,icon:i,selected:this.m_pUcitel==this.m_pDozor.m_pUcitel,onclick:function(){t.m_pRozApp.InvalidateDozor(t.m_pDozor),t.m_pDozor.SetUcitel(t.m_pUcitel),t.m_pRozApp.InvalidateDozor(t.m_pDozor)}}},I);function I(t,e){this.p1=0,this.p2=0,this.obsadeny=!1,this.poradie=0,this.m_pRozApp=t.m_pRok.m_pRozApp,this.m_pDozor=t,this.m_pUcitel=e;var i=t.m_pRok,n=t.m_Hodina,o=t.m_Prestavka,r=!1,a=i.GetDozoryTWDH(e,t.m_Term,t.m_Tyzden,t.m_Den,n,o);(1<a.length||1==a.length&&a[0]!=t)&&(r=!0),o||e.GetKartyTuTWDH(t.m_Term,t.m_Tyzden,t.m_Den,n,0).length&&(r=!0);var s=!1,l=0,c=0,h=!0;if(o){var _=p="0"!=m.timeoff_get(e.timeoff(),t.m_Term,t.m_Tyzden,t.m_Den,n);if(n>i.m_nHodinyOd&&(_="0"!=m.timeoff_get(e.timeoff(),t.m_Term,t.m_Tyzden,t.m_Den,n-1)),p||_||(h=!1),0<n)if(0<(v=e.GetKartyTuTWDH(t.m_Term,t.m_Tyzden,t.m_Den,n-1,0)).length)l=1,t.m_pUcebna.JeBlizkaUcebna(v[0].Ucebna(0))&&(l=2),v[0].GetHodina()+v[0].GetDlzka()>=n&&(s=!0);else{var u=n-1,d=!1;(f=i.GetDozoryTWDH(e,t.m_Term,t.m_Tyzden,t.m_Den,u,d)).length&&(l=1,t.m_pUcebna.JeBlizkaUcebna(f[0].m_pUcebna)&&(l=2))}0<(v=e.GetKartyTuTWDH(t.m_Term,t.m_Tyzden,t.m_Den,n,0)).length?(c=1,t.m_pUcebna.JeBlizkaUcebna(v[0].Ucebna(0))&&(c=2)):(u=n,d=!1,(f=i.GetDozoryTWDH(e,t.m_Term,t.m_Tyzden,t.m_Den,u,d)).length&&(c=1,t.m_pUcebna.JeBlizkaUcebna(f[0].m_pUcebna)&&(c=2)))}else{var p,f,v;(p="0"!=m.timeoff_get(e.timeoff(),t.m_Term,t.m_Tyzden,t.m_Den,n))||(h=!1),u=n,d=!0,(f=i.GetDozoryTWDH(e,t.m_Term,t.m_Tyzden,t.m_Den,u,d)).length?(l=1,t.m_pUcebna.JeBlizkaUcebna(f[0].m_pUcebna)&&(l=2)):0<(v=e.GetKartyTuTWDH(t.m_Term,t.m_Tyzden,t.m_Den,n-1,0)).length&&(l=1,t.m_pUcebna.JeBlizkaUcebna(v[0].Ucebna(0))&&(l=2)),u=n+1,d=!0,(f=i.GetDozoryTWDH(e,t.m_Term,t.m_Tyzden,t.m_Den,u,d)).length?(c=1,t.m_pUcebna.JeBlizkaUcebna(f[0].m_pUcebna)&&(c=2)):0<(v=e.GetKartyTuTWDH(t.m_Term,t.m_Tyzden,t.m_Den,n+1,0)).length&&(c=1,t.m_pUcebna.JeBlizkaUcebna(v[0].Ucebna(0))&&(c=2))}h||(r=!0);var b=0;r||!h?b=-1e3:(b=100+100*Math.max(l,c)+12*l+10*c,s&&(b-=1)),this.p1=l,this.p2=c,this.obsadeny=r,this.poradie=b+(1e3-this.m_pUcitel.GetSaveID())/1e3}},"/timetable/app/ttrowrenderer.js":function(t,e,i){t.__esModule=!0;var n=e("./online"),o=e("../timeoff_r"),r=(a.prototype.Clear=function(){this.m_pHorizontalRokObject=null,this.m_nROJTF=0,this.m_horizontalTimeoff=null,this.m_bVsetkoNaJednuPoziciu=!1,this.m_bSpojNaViacHodinovku=!1,this.m_bIgnoreFilters=!1,this.m_nVerticalHodinyOd=this.m_pRok.m_nHodinyOd,this.m_nVerticalHodinyDo=this.m_pRok.m_nHodinyDo,this.m_nDay=-1,this.m_nWeek=-1,this.m_nTerm=-1,this.m_Cells.length=0,this.m_Policka.length=0},a.prototype.Compute=function(){this.m_nXCount=this.m_nVerticalHodinyDo-this.m_nVerticalHodinyOd+1,this.m_bVsetkoNaJednuPoziciu&&(this.m_nXCount=1),0<this.m_Policka.length&&ASC.assert(this.m_nXCount==this.m_Policka.length);for(var t=this.m_SuggestedKarty,e=[0,0],i=0,n=t=t||this.m_pHorizontalRokObject.GetKartyTu(this.m_nROJTF);i<n.length;i++){var o=n[i];if(this.HorizontalCheck(o)&&this.OtherCheck(o)&&this.VerticalCheck(o,e)){var r=e[0],a=e[1],s=this.NewCell();if(s.x1=r,s.x2=a,s.m_pKarta=o,s.m_nFaza=0,this.m_bRozdelNaJednohodinovky&&r<a)for(var l=(s.x2=r)+1;l<=a;l++){var c=this.SplitCell(s);c.x1=c.x2=l}}}if(this.m_bSpojNaViacHodinovku){this.m_Cells.sort(function(t,e){return t.x1-e.x1});for(var m=0;m<this.m_Cells.length;m++)for(var h=this.m_Cells[m],_=m+1;_<this.m_Cells.length;_++)h.SpojNaViacHodinovku(this.m_Cells[_])&&(this.m_Cells.splice(_,1),_--)}for(this.m_nMaxFaz=1,this.m_nXFaz.length=0,this.m_nXCyklovaniePo.length=0,G=this.m_bXJeSeminar.length=0;G<this.m_nXCount;G++)this.m_nXFaz[G]=1,this.m_nXCyklovaniePo[G]=0,this.m_bXJeSeminar[G]=!1;if(!this.m_bVsetkoNaJednuPoziciu){var u=!1,d=!1;switch(this.m_pHorizontalRokObject.m_Table){case"classes":u=!0;break;case"globals":d=!0}var p=0;for(this.m_nDay<0&&(p|=1),this.m_nWeek<0&&(p|=2),this.m_nTerm<0&&(p|=4),G=0;G<this.m_Cells.length;G++){var f=this.m_Cells[G];this.m_nXCyklovaniePo[f.x1]|=f.CyklovaniePo()&p,f.JeSeminar()&&(this.m_bXJeSeminar[f.x1]=!0)}var v=[];for(G=0;G<this.m_nXCount;G++)v[G]=!1;for(G=0;G<this.m_Cells.length;G++)for(var b=(f=this.m_Cells[G]).x1;b<f.x2;b++)v[b]=!0;for(G=0;G<this.m_nXCount-1;G++)v[G]&&(this.m_nXCyklovaniePo[G+1]|=this.m_nXCyklovaniePo[G],u&&this.m_bXJeSeminar[G]&&(this.m_bXJeSeminar[G+1]=!0));for(G=this.m_nXCount-2;0<=G;G--)v[G]&&(this.m_nXCyklovaniePo[G]|=this.m_nXCyklovaniePo[G+1],u&&this.m_bXJeSeminar[G+1]&&(this.m_bXJeSeminar[G]=!0));for(this.m_nMaxFaz=1,G=0;G<this.m_nXCount;G++)d||u&&this.m_bXJeSeminar[G]?(this.m_nXFaz[G]=1,this.m_nXCyklovaniePo[G]=0):this.m_nXFaz[G]=this.FazyFaz(this.m_nXCyklovaniePo[G]),this.m_nMaxFaz=Math.max(this.m_nMaxFaz,this.m_nXFaz[G]);var y=this.m_Cells.length;for(G=0;G<y;G++){f=this.m_Cells[G];var g=this.m_nXCyklovaniePo[f.x1];if(0!=g){var k=0;4&g&&(k=this.m_pRok.m_nTermov-1);var T=0;2&g&&(T=this.m_pRok.m_nTyzdnov-1);var S=0;1&g&&(S=this.m_pRok.m_nDni-1);for(var C=!1,A=0,w=0;w<=k;w++)for(var I=0;I<=T;I++)for(var R=0;R<=S;R++){var P=!0;0==k||f.m_pKarta.JeTu_TWDH(w)||(P=!1),0==T||f.m_pKarta.JeTu_TWDH(-1,I)||(P=!1),0==S||f.m_pKarta.JeTu_TWDH(-1,-1,R)||(P=!1),P&&(C?this.SplitCell(f).m_nFaza=A:(f.m_nFaza=A,C=!0)),A++}}}}var O=this.m_pHorizontalRokObject&&"classes"==this.m_pHorizontalRokObject.m_Table,D=[],x=[],z=[];for(A=0;A<this.m_nMaxFaz;A++){for(var G=0;G<this.m_nXCount;G++)D[G]=O;if(O){var V=[],M=[];for(G=0;G<this.m_nXCount;G++)V[G]=-1,M[G]=0;for(G=0;G<this.m_Cells.length;G++)if((f=this.m_Cells[G]).m_nFaza==A)for(b=f.x1;b<=f.x2;b++)if(D[b]){var U=f.m_pKarta.GetDelenieSkupin(this.m_pHorizontalRokObject);if(U<0){D[b]=!1;break}if(30<U){D[b]=!1;break}if(V[b]!=U){if(0<=V[b]){D[b]=!1;break}V[b]=U}var H=f.m_pKarta.GetDelenieSkupinyBity(this.m_pHorizontalRokObject);if(0!=(M[b]&H)){D[b]=!1;break}M[b]|=H}for(v=[],G=0;G<this.m_nXCount;G++)v[G]=!1;for(G=0;G<this.m_Cells.length;G++)if((f=this.m_Cells[G]).m_nFaza==A)for(b=f.x1;b<f.x2;b++)v[b]=!0;var K=0,E=!1;for(G=0;G<this.m_nXCount;G++)if(0==D[G]&&(E=!0),!v[G]){if(E)for(var N=K;N<=G;N++)D[N]=!1;E=!1,K=G+1}for(y=this.m_Cells.length,G=0;G<y;G++)if((f=this.m_Cells[G]).m_nFaza==A&&D[f.x1]){var j=f.m_pKarta.GetDelenieSkupin(this.m_pHorizontalRokObject);if(j<1)ASC.assert(!1);else for(var Z=f.m_pKarta.GetDelenieSkupinyBity(this.m_pHorizontalRokObject),$=(C=!1,null),F=0;F<j;F++)0!=(Z&1<<F)?($||(C?$=this.SplitCell(f):($=f,C=!0),$.y1=F/j),$.y2=(F+1)/j):$=null}}for(G=0;G<this.m_nXCount;G++)x[G]=0,z[G]=!1;for(G=0;G<this.m_Cells.length;G++)if((f=this.m_Cells[G]).m_nFaza==A&&!D[f.x1]){var L=0;for(b=f.x1;b<=f.x2;b++)L=Math.max(L,x[b]);for(f.m_nTempOrder=L,b=f.x1;b<=f.x2;b++)x[b]=L+1,b<f.x2&&(z[b]=!0)}var B=K=0;for(b=0;b<this.m_nXCount;b++)if(B=Math.max(B,x[b]),!z[b]){for(var J=K;J<=b;J++)x[J]=B;K=b+1,B=0}for(G=0;G<this.m_Cells.length;G++)if((f=this.m_Cells[G]).m_nFaza==A){if(!D[f.x1]){var W=x[f.x1];L=f.m_nTempOrder,f.y1=L/W,f.y2=(L+1)/W}var Y=this.m_nXFaz[f.x1];1<Y&&(f.y1=(f.y1+f.m_nFaza)/Y,f.y2=(f.y2+f.m_nFaza)/Y)}}},a.prototype.HorizontalCheck=function(t){return!!this.m_bIgnoreFilters||this.m_pHorizontalRokObject.KartaJeTu(t,this.m_nROJTF)},a.prototype.OtherCheck=function(t){return!!this.m_bIgnoreFilters||!!t.JeTu_TWDH(this.m_nTerm,this.m_nWeek,this.m_nDay)},a.prototype.VerticalCheck=function(t,e){if(this.m_bIgnoreFilters&&this.m_bVsetkoNaJednuPoziciu)return o=r=0,!0;if(!t.JeUmiestnena())return!1;var i=t.GetHodina(),n=i+t.GetDlzka(),o=i-this.m_nVerticalHodinyOd,r=n-this.m_nVerticalHodinyOd;return o=Math.max(o,0),!((r=Math.min(r,this.m_nXCount-1))<o||(e[0]=o,e[1]=r,0))},a.prototype.NewCell=function(){var t=new s(this);return this.m_Cells.push(t),t},a.prototype.SplitCell=function(t){var e=this.NewCell();return e.Set(t),e},a.prototype.FazyFaz=function(t){var e=1;return 1&t&&(e*=this.m_pRok.m_nDni),2&t&&(e*=this.m_pRok.m_nTyzdnov),4&t&&(e*=this.m_pRok.m_nTermov),e},a.prototype.GetVolno=function(t,e){return this.m_horizontalTimeoff?o.timeoff_get(this.m_horizontalTimeoff,this.m_nTerm,this.m_nWeek,this.m_nDay,this.m_nVerticalHodinyOd+e):""},a.prototype.GetPeriodX=function(t){return this.m_pRok.GetPeriod(this.m_nVerticalHodinyOd+t)},a);function a(t){this.m_pHorizontalRokObject=null,this.m_nROJTF=0,this.m_horizontalTimeoff=null,this.m_nDay=-1,this.m_nWeek=-1,this.m_nTerm=-1,this.m_nVerticalHodinyOd=0,this.m_nVerticalHodinyDo=5,this.m_SuggestedKarty=null,this.m_bVsetkoNaJednuPoziciu=!1,this.m_bSpojNaViacHodinovku=!1,this.m_bRozdelNaJednohodinovky=!1,this.m_bIgnoreFilters=!1,this.m_Cells=[],this.m_nXCount=5,this.m_Policka=[],this.m_nXFaz=[],this.m_nXCyklovaniePo=[],this.m_bXJeSeminar=[],this.m_pRok=t}t.CTTRowRenderer=r;var s=(l.prototype.Set=function(t){this.m_pKarta=t.m_pKarta,this.m_MHodina=t.m_MHodina,this.x1=t.x1,this.x2=t.x2,this.y1=t.y1,this.y2=t.y2,this.m_nTempOrder=t.m_nTempOrder,this.m_nFaza=t.m_nFaza},l.prototype.CyklovaniePo=function(){return this.m_pKarta?this.m_pKarta.CyklovaniePo():0},l.prototype.JeSeminar=function(){return!!this.m_pKarta&&this.m_pKarta.m_pHodina.JeSeminar()},l.prototype.SpojNaViacHodinovku=function(t){if(t.x2+1!=this.x1&&this.x2+1!=t.x1)return!1;if(!this.m_pKarta)return!1;var e=this.m_pKarta,i=t.m_pKarta,o=e.m_pHodina,r=i.m_pHodina;if(o!=r){if(o.m_pPredmet!=r.m_pPredmet)return!1;if(!n.CUtils.RovnakyList(o.m_Ucitelia,r.m_Ucitelia))return!1;if(!n.CUtils.RovnakyList(o.m_Triedy,r.m_Triedy))return!1;if(!n.CUtils.RovnakyList(o.m_Skupiny,r.m_Skupiny))return!1;if(!n.CUtils.RovnakyList(o.m_KurzyPreTriedy,r.m_KurzyPreTriedy))return!1;if(o.m_nPoradieSeminaru!=r.m_nPoradieSeminaru)return!1;if(o.GetTerm()!=r.GetTerm())return!1}return!!n.CUtils.RovnakyList(e.Ucebne(),i.Ucebne())&&e.days()==i.days()&&e.weeks()==i.weeks()&&(this.x1=Math.min(this.x1,t.x1),this.x2=Math.max(this.x2,t.x2),!0)},l);function l(t){this.x1=0,this.x2=0,this.y1=0,this.y2=1,this.m_nTempOrder=0,this.m_nFaza=0,this.m_pKarta=null,this.m_MHodina=null,this.m_pTTRowRenderer=t}t.CTTRowCell=s},"/timetable/app/server/dozory.js":function(t,e,i){i.implementRpc(["dozoryAddMulti","dozoryRemoveMulti"])},"/timetable/app/print.js":function(t,e,i){t.__esModule=!0;var n=e("tslib"),o=e("./rokobject"),r=e("./online"),a=e("./ttrowrenderer"),s=e("./tview"),l=e("../../asc/edurequest"),c=e("./ttdoc"),m=e("./server/designs"),h=e("../../asc/lib_date"),_=(u.prototype.width=function(){return this.x2-this.x1},u.prototype.height=function(){return this.y2-this.y1},u.prototype.pad=function(t,e){void 0===e&&(e=t);var i=this.width()*t,n=this.height()*e;return new u(this.x1+i,this.y1+n,this.x2-i,this.y2-n)},u);function u(t,e,i,n){this.x1=t,this.y1=e,this.x2=i,this.y2=n}var d,p=function(t,e){this.m_pTlacZostava=t,this.data=e,this.size=.1,this.size=e.size/100,0<this.size||(this.size=.1)},f=(d=o.CRokObject,n.__extends(v,d),v.prototype.InitFromData=function(){this.m_PageTables=this.m_Data.page_tables,this.m_RowTables=this.m_Data.row_tables,this.m_ColumnTables=this.m_Data.column_tables,this.m_nTypStredu=this.m_Data.celltype,this.m_PrintKartaStyles=this.m_Data.cardstyles,this.m_ExtraColumns=this.m_Data.extracolumns,this.m_ExtraRows=this.m_Data.extrarows},v.prototype.GetIcon=function(){return this.m_Data.icon},v.prototype.Render=function(t){var e=this,i=this.m_Data,n=[],o=t.filter,r=o;t.m_bTTViewer&&(r=this.m_pRok.m_pRozApp.ttviewer_options.filter);var a=this.Roznasob(this.m_pRok,this.m_PageTables,r,{withclassroomtt:i.withclassroomtt}),s=this.Roznasob(this.m_pRok,this.m_RowTables,o),l=this.Roznasob(this.m_pRok,this.m_ColumnTables,o),c=(i.extrarows||[]).map(function(t){return new p(e,t)}),m=(i.extracolumns||[]).map(function(t){return new p(e,t)}),h={6:"teachers_summary",5:"classes_summary",7:"classrooms_summary"}[i.typ];h&&h in r&&(r[h].length||(a=[]));for(var _=0,u=a;_<u.length;_++){var d=u[_],f=new V(this,d,this.PurgeSliziky(d,s,ASC.boolVal(i.hideemptyrows)),this.PurgeSliziky(d,l,ASC.boolVal(i.hideemptycolumns)));t.fixTTColors&&(f.fixTTColors=!0),t.designData&&(f.designData=t.designData),f.m_ExtraColumns=m,f.m_ExtraRows=c,n.push(f)}if(1<this.m_Data.repeatpage){var v=n;n=[];for(var b=0,y=v;b<y.length;b++){f=y[b];for(var g=0;g<this.m_Data.repeatpage;g++)n.push(f)}}if(!this.m_Data.fitwidth){for(var k=Math.max(1,Math.floor(1/i.cellwidth)),T=[],S=0,C=n;S<C.length;S++)if((O=C[S])instanceof A){f=O;var w=null;for(g=0;g<f.m_Columns.length;g+=k)(x=new V(this,f.m_Page,f.m_Rows,f.m_Columns.slice(g,g+k))).m_ExtraRows=f.m_ExtraRows,T.push(x),w=x;w&&(w.m_ExtraColumns=f.m_ExtraColumns)}n=T}if(!this.m_Data.fitheight){for(var I=Math.max(1,Math.floor(1/i.cellheight)),R=(T=[],0),P=n;R<P.length;R++){var O;if((O=P[R])instanceof A){for(f=O,w=null,g=0;g<f.m_Rows.length;g+=I){var x;(x=new V(this,f.m_Page,f.m_Rows.slice(g,g+I),f.m_Columns)).m_ExtraColumns=f.m_ExtraColumns,T.push(x),w=x}w&&(w.m_ExtraRows=f.m_ExtraRows)}}n=T}var z=this.Dimensions(!0);if(1<z.splitpage_w||1<z.splitpage_h){v=n,n=[];for(var G=null,M=0,U=v;M<U.length;M++)f=U[M],null==G&&(G=new D(this),n.push(G)),G.subpages.push(f),G.subpages.length>=z.splitpage_w*z.splitpage_h&&(G=null)}return n},v.prototype.PurgeSliziky=function(t,e,i){for(var n=null,r=z(t),a=0,s=t;a<s.length;a++)(T=s[a])instanceof o.CTrieda&&(n=T),T instanceof o.CZiak&&(n=T.m_pTrieda);var l=this.m_pRok.m_ObjectsO.cards;i&&r&&(l=r.GetKartyTu(0));for(var c=[],m=0,h=e;m<h.length;m++){for(var _=h[m],u=!1,d=0,p=_;d<p.length;d++)(T=p[d])instanceof o.CPeriodOrBreak&&n&&!T.JeValidPreTriedu(n)&&(u=!0);if(i&&!u){u=!0;for(var f=0,v=l;f<v.length;f++){var b=v[f];if(b.JeUmiestnena()){for(var y=!0,g=0,k=_;g<k.length;g++){var T;if(!(T=k[g]).KartaJeTu(b,0)){y=!1;break}}if(y){u=!1;break}}}}u||c.push(_)}return c},v.prototype.Dimensions=function(t){var e=6*b,i=5*b,n={page_width:297*b,page_height:210*b,pad_w:e,pad_h:e,tt_basex:e,tt_basey:25*b,tt_space_bottom:15*b,tt_width:0,tt_height:0,splitpage_w:t?this.m_Data.splitpage_w:1,splitpage_h:t?this.m_Data.splitpage_h:1};if(!this.m_Data.landscape){var o=n.page_width;n.page_width=n.page_height,n.page_height=o}(1<n.splitpage_w||1<n.splitpage_h)&&(n.tt_basex-=n.pad_w,n.page_width-=2*n.pad_w,n.pad_w=0,n.tt_basey-=n.pad_h,n.tt_space_bottom-=n.pad_h,n.page_height-=2*n.pad_h,n.pad_h=0);var r=0;1<n.splitpage_w&&(n.page_width=(n.page_width+i)/n.splitpage_w,n.tt_basex/=n.splitpage_w,r=i);var a=0;return 1<n.splitpage_h&&(n.page_height=(n.page_height+i)/n.splitpage_h,n.tt_basey/=n.splitpage_h,n.tt_space_bottom/=n.splitpage_h,a=i),n.tt_width=n.page_width-2*n.tt_basex-r,n.tt_height=n.page_height-n.tt_basey-n.tt_space_bottom-a,n},v.prototype.IsSuhrn=function(){for(var t=0,e=["teachers","classes","classrooms","subjects","students"];t<e.length;t++){var i=e[t];if(this.m_RowTables.includes(i))return!0;if(this.m_ColumnTables.includes(i))return!0}return!1},v.prototype.Roznasob=function(t,e,i,o){void 0===o&&(o={});for(var r=[[]],a=0,s=e;a<s.length;a++){var l=s[a],c=r;r=[];for(var m=0,h=c;m<h.length;m++){var _=h[m],u=t.TableObjects(l);if("periods"==l){for(var d=[],p=0,f=u;p<f.length;p++){var v=f[p],b=t.m_ObjectsI.breaks[v.m_Id];b&&d.push(b),d.push(v)}u=[];for(var y=0,g=d;y<g.length;y++){var k=g[y];this.TlacPeriodu(k)&&u.push(k)}}for(var T=0,S=u;T<S.length;T++){var C=S[T];if(i[l]){var A=C.m_Id;if("days"!=l&&"weeks"!=l&&"terms"!=l||(A=""+C.m_Val),ASC.indexOf2(i[l],A)<0)continue}if(!("students"==C.m_Table&&i.classes&&ASC.indexOf2(i.classes,C.m_pTrieda.m_Id)<0)){var w=_.slice();if(w.push(C),r.push(w),"classes"==l&&o.withclassroomtt){var I=C.GetUcebna();if(I){var R=n.__spreadArrays(w);R.pop(),R.push(I),r.push(R)}}}}}}return r},v.prototype.TlacPeriodu=function(t){var e=t.m_Data;return this.IsSuhrn()?ASC.boolVal(e.printinsummary):this.m_PageTables.includes("teachers")?ASC.boolVal(e.printinteacher):this.m_PageTables.includes("classes")||this.m_PageTables.includes("students")?ASC.boolVal(e.printinclass):!this.m_PageTables.includes("classrooms")||ASC.boolVal(e.printinclassroom)},v.prototype.GetPrintKartaStyle=function(t,e,i){for(var n=0,o=this.m_PrintKartaStyles;n<o.length;n++)if((s=o[n]).m_nDlzka==t&&s.m_nPocetRiadkov==e&&s.m_nBezTriedyAleboUcitela==i)return s;for(var r=0,a=this.m_PrintKartaStyles;r<a.length;r++){var s;if((s=a[r]).m_nDlzka==t&&0==s.m_nPocetRiadkov&&s.m_nBezTriedyAleboUcitela==i)return s}return this.m_PrintKartaStyles[0]},v.prototype.UpdateSetting=function(t,e){this.m_pRok.m_pRozApp.click_func("print_setting","tzid="+this.m_Id+"&s="+t+"&v="+e)},v);function v(t,e){var i=d.call(this,t,"ttreports",e)||this;return i.m_PageTables=[],i.m_RowTables=[],i.m_ColumnTables=[],i.m_nTypStredu=0,i.m_PrintKartaStyles=[],i.m_bTTViewerDisableCardColor=!1,i.m_ExtraColumns=[],i.m_ExtraRows=[],i.InitFromData(),i}t.CTlacZostava=f;var b=10,y=["il","rb"].includes(ASC.lang),g=(k.prototype.SetScale=function(t,e){var i=this.m_Scale;this.m_Scale=t;var n=this.m_Pages[this.m_nPage];if(n&&(n.UpdateSheetScale(this.m_Scale),e)){var o=e.offsetX/i,r=e.offsetY/i,a=n.$svg.offset().left+o*t,s=n.$svg.offset().top+r*t,l=this.$sheet.parent();l[0].scrollLeft+=a-e.pageX,l[0].scrollTop+=s-e.pageY}},k.prototype.Zoom=function(t,e){var i=this.m_Scales[0];if(e)i=this.m_Scale*e,i=Math.max(i,this.m_Scales[0]),i=Math.min(i,this.m_Scales[this.m_Scales.length-1]);else for(var n=1;n<this.m_Scales.length;n++){var o=this.m_Scales[n];if(o>=1.05*this.m_Scale){i=o;break}}this.SetScale(i,t)},k.prototype.ZoomFit=function(){this.ZoomFit0(),this.m_Scales=ASC.clone(k.default_scales),this.m_Scales.push(this.m_Scale),this.m_Scales.sort(function(t,e){return t-e})},k.prototype.ZoomFit0=function(){var t=this.m_Pages[0];if(t){var e=(this.$div.innerHeight()-13)/t.height;e=Math.min(e,(this.$div.innerWidth()-13)/t.width),e*=b,10<(e=Math.max(e,1.5))||this.SetScale(e)}},k.prototype.Render=function(){if(this.m_Pages=this.m_pTlacZostava.Render(this),0==this.m_Pages.length){var t=new R(this.m_pTlacZostava);this.m_Pages.push(t)}},k.prototype.IsNoPage=function(){return 0==this.m_Pages.length||this.m_Pages[0]instanceof R},k.prototype.Update=function(){this.Render(),this.m_nPage>=this.m_Pages.length&&(this.m_nPage=0),this.UpdatePage()},k.prototype.UpdatePage=function(){var t=this.m_Pages[this.m_nPage];this.$sheet.empty(),this.UpdateRibbon(),t.RenderSheet(this.$sheet,this.m_Scale,!this.m_bTTViewer)},k.prototype.UpdateRibbon=function(){var t=this;this.$pagenum_d.text(ASC.ttls(1750)+" "+(this.m_nPage+1)+"/"+this.m_Pages.length);var e=this.m_pRozApp,i=this.m_pRok;if(e.ribbonMenu.findButtonsByCmd("printpreview_prev").forEach(function(e){e.enabled(0<t.m_nPage)}),e.ribbonMenu.findButtonsByCmd("printpreview_next").forEach(function(e){e.enabled(t.m_nPage+1<t.m_Pages.length)}),this.m_bTTViewer){for(var n=e.ttviewer_options.filter,o=this.TTViewer_CurrentObject(),r=function(r){e.ribbonMenu.findButtonsByCmd("ttviewer_"+r).forEach(function(e){var a=[];if("students"==r){for(var s={},l=function(e){if(ASC.indexOf2(n[r],e.m_Id)<0)return"continue";var i=e.m_pTrieda.m_Id;s[i]||(s[i]=[]),s[i].push({text:ASC.escapeHTML(e.GetNazov()),checked:e==o,onclick:function(){t.TTViewer_SetCurrentObject(e)}})},c=0,m=i.TableObjects(r);c<m.length;c++)l(m[c]);for(var h=0,_=i.TableObjects("classes");h<_.length;h++){var u=_[h],d=u.m_Id;s[d]&&a.push({text:ASC.escapeHTML(u.GetNazov()),submenu:s[d]})}}else for(var p=function(e){if(ASC.indexOf2(n[r],e.m_Id)<0)return"continue";a.push({text:ASC.escapeHTML(e.GetNazov()),checked:e==o,onclick:function(){t.TTViewer_SetCurrentObject(e)}})},f=0,v=i.TableObjects(r);f<v.length;f++)p(v[f]);e.enabled(0<a.length),e.selected(o&&o.m_Table==r),e.menu=a})},a=0,s=["subjects","classes","teachers","classrooms","students"];a<s.length;a++)r(s[a]);e.ribbonMenu.findButtonsByCmd("ttviewer_summary").forEach(function(i){for(var o=[],r=!1,a=function(e){var i=e.t+"_summary";if(0==n[i].length)return"continue";var a=t.m_pTlacZostava.m_Data.typ==e.pt;r=r||a,o.push({text:ASC.escapeHTML(e.l),checked:a,onclick:function(){t.TTViewer_SetTable(i)}})},s=0,l=[{t:"teachers",l:ASC.ls(1656),pt:6},{t:"classes",l:ASC.ls(1657),pt:5},{t:"classrooms",l:ASC.ls(1658),pt:7}];s<l.length;s++)a(l[s]);o.length&&!e.ttviewer_options.kiosk&&(0<o.length&&o.push([]),o.push({text:ASC.ls(2838),onclick:function(){var t="/timetable/view.php";document.location.href.indexOf("fullscreen=1")<0&&(t+="?fullscreen=1"),document.location.href=t}})),i.enabled(0<o.length),i.selected(r),i.menu=o})}},k.prototype.TTViewer_Select=function(t){if(!t)return!1;var e=t.split(":");return this.TTViewer_Sel(e[0],e[1])},k.prototype.TTViewer_Sel=function(t,e){var i=this.m_pRok;if(i.m_ObjectsI[t]){var n=i.m_ObjectsI[t][e];if(n)return this.TTViewer_SetCurrentObject(n),!0}return this.TTViewer_SetTable(t)},k.prototype.TTViewer_AutoSelect=function(){for(var t=0,e=["classes","classes_summary","teachers","teachers_summary","subjects"];t<e.length;t++){var i=e[t];if(this.TTViewer_SetTable(i),!this.IsNoPage())break}},k.prototype.TTViewer_SetTable=function(t){var e={teachers_summary:6,classes_summary:5,classrooms_summary:7}[t];if(e){for(var i=0,n=this.m_pRok.TableObjects("ttreports");i<n.length;i++)if((a=n[i]).m_Data.typ==e)return this.SetZostava(a),!0;return!1}if(this.m_pTlacZostava.m_PageTables.includes(t))return 0==this.m_Pages.length&&this.Update(),!0;for(var o=0,r=this.m_pRok.TableObjects("ttreports");o<r.length;o++){var a;if((a=r[o]).m_PageTables.includes(t))return this.SetZostava(a),!0}return!1},k.prototype.TTViewer_SetCurrentObject=function(t){if(t&&this.TTViewer_SetTable(t.m_Table))for(var e=0;e<this.m_Pages.length;e++){var i=this.m_Pages[e];if(!(i instanceof V))return;if(i.m_Page.includes(t)){this.m_nPage=e,this.UpdatePage();break}}},k.prototype.TTViewer_CurrentObject=function(){var t=this.m_Pages[this.m_nPage];if(!t)return null;if(t instanceof V){for(var e=0,i=t.m_Page;e<i.length;e++){var n=i[e];if(["subjects","classes","teachers","classrooms","students"].includes(n.m_Table))return n}return null}},k.prototype.TTViewer_GetSelected=function(){var t=this.TTViewer_CurrentObject();return t?t.m_Table+":"+t.m_Id:null},k.prototype.PrevPage=function(){this.m_nPage<=0||(this.m_nPage--,this.UpdatePage())},k.prototype.NextPage=function(){this.m_nPage+1>=this.m_Pages.length||(this.m_nPage++,this.UpdatePage())},k.prototype.SetZostava=function(t){var e,i,n=this,o="";if("string"==typeof t){var r=t.split("."),a=r[0];o=(o=r[1]||"")||"",t=(t=this.m_pRok.m_ObjectsI.ttreports[a])||this.m_pRok.FindTableTlacZostava(a)}if(this.m_pTlacZostava!=t||(null!==(i=null===(e=this.designData)||void 0===e?void 0:e.id)&&void 0!==i?i:"")!==o){t||this.m_pRozApp.Fail("Error 6995307472"),this.m_pTlacZostava=t,this.designData=null;var s=this.m_pTlacZostava.m_Id+(o?"."+o:"");this.m_pZostavaCombo.value!=s&&this.m_pZostavaCombo.ASC_set(s),this.m_nPage=0,this.Update(),o&&ASC.blockUI(m.getDesignData(null,this.m_pRozApp.ttgpid,o)).then(function(t){n.designData=t,n.Update()})}},k.prototype.Print=function(t){void 0===t&&(t={}),H(t.selected_page?[this.m_Pages[this.m_nPage]]:this.m_Pages)},k.prototype.ClickFilter=function(){Promise.resolve().then(function(){return e("./print_filter")}).then(function(t){return t.showPrintFilterDlg()})},k.prototype.SetFilter=function(t){JSON.stringify(t)!=JSON.stringify(this.filter)&&(this.filter=t,this.Update())},k.prototype.SettingsChanged=function(){var t=this;this.m_pRozApp.SyncNow().then(function(){t.Update()})},k.prototype.Validate=function(){this.m_bInvalid&&(this.m_bInvalid=!1,this.Update())},k.prototype.Destroy=function(){},k.default_scales=[2,3,4,6,10],k);function k(t,e){var i=this;void 0===e&&(e={}),this.m_pTlacZostava=null,this.designData=null,this.m_pZostavaCombo=null,this.m_Pages=[],this.m_nPage=0,this.m_Scale=4,this.m_Scales=ASC.clone(k.default_scales),this.filter={},this.m_bInvalid=!1,this.m_bTTViewer=!1;var n=l.client_req;this.m_pRozApp=t,this.m_pRok=t.m_pRok,this.m_pRozApp.m_pPrintPreview=this,e.ttviewer&&(this.m_bTTViewer=!0);var o=t.$rg_printpreview_div;o.css("margin-top","4px"),o.empty();for(var r=[],a=0,s=($j("<div style='margin-bottom:4px'>").appendTo(o).text(ASC.ttls(3341)).get(0).ASC_printpreview=this).m_pRok.m_ObjectsO.ttreports;a<s.length;a++){var m=s[a];this.m_pTlacZostava||(this.m_pTlacZostava=m);var _=[{}],u="ascpalo"==n.edupage,d="de"==n.school_country||u;switch(parseInt(m.m_Data.typ)){case c.PRINTAREA.INSPEKCIA:_=[{designid:"internal_table"}],"sk"==n.school_country?_=[{designid:"internal_table_sk"}]:u&&_.push({designid:"internal_table_sk",name:"SK tlacivo"}),d&&_.push({name:"Vorlage Schulamt",designid:"internal_table_de_1"});break;case c.PRINTAREA.INSPEKCIA_UCITEL:_=[{designid:"internal_table_teacher"}],d&&(u||(_=[]),_.push({name:"Stundenplan fÃ¼r jeden Lehrer - mit Tabelle",designid:"internal_table_teacher_de_3"}),_.push({name:"Vorlage Schulamt erweitert LehrerIn",designid:"internal_table_teacher_de_1"}),_.push({name:"Neu Schulamt Tab Unterschrift Klassen",designid:"internal_table_teacher_de_2"}))}for(var p=0,f=_;p<f.length;p++){var v=f[p],b=v.name||m.GetNazov();r.push({value:m.m_Id+(v.designid?"."+v.designid:""),name:b,icon:m.GetIcon(),html:"<img src='"+m.GetIcon()+"' style='height:24px;vertical-align:middle;padding-right:10px'>"+ASC.escapeHTML(b)})}}if(this.m_pZostavaCombo=new ASC.ui.ComboBox(o,this.m_pTlacZostava.m_Id,r,{style:"width:100%",fn:function(t){i.SetZostava(t)}}),this.$pagenum_d=$j("<div style='margin-top:4px'>").appendTo(o),this.$div=t.$printpreview_d,this.$div.empty(),this.$sheet=$j("<div class='print-sheet' style='cursor:zoom-in'>").appendTo(this.$div),this.$sheet.on("mousedown",function(t){0==t.button&&(t.shiftKey?i.ZoomFit():i.Zoom(t),t.preventDefault(),ASC.hideContextMenu())}),this.$sheet.on("contextmenu",function(t){var e=[];e.push({text:ASC.ttls(2551)+": "+ASC.ttls(2829),onclick:function(){i.ZoomFit()}});var n=i.m_pTlacZostava;n.m_Data.cardcolorenabled&&(e.push([]),e.push({text:ASC.ttls(1438),checked:!n.m_bTTViewerDisableCardColor,onclick:function(){n.m_bTTViewerDisableCardColor=!n.m_bTTViewerDisableCardColor,i.Update()}})),i.m_bTTViewer&&(e.push([]),e.push({text:ASC.ls(1248),onclick:function(){var t="https://"+ASC.edupage+".edupage.org/timetable/view.php",e=[],n=""+i.m_pRozApp.ttviewer_options.num;n&&(""+parseInt(n)==n?e.push("num="+i.m_pRozApp.ttviewer_options.num):"week:"==n.substr(0,5)&&n!="week:"+h.date_week(l.client_req,l.client_req.timezone_date())&&e.push("week="+n.substr(5)));var o=i.m_Pages[i.m_nPage];if(o instanceof V){for(var r="",a=0,s=o.m_Page;a<s.length;a++){var c=s[a];if(["classes","teachers","classrooms","subjects","students"].includes(c.m_Table)){r=ASC.tt.removeEs(c.m_Table)+"="+c.m_Id;break}}if(!r)for(var m=0,_=i.m_pTlacZostava.m_RowTables;m<_.length;m++){var u=_[m];if(["classes","teachers","classrooms"].includes(u)){r="summary="+u;break}}r&&e.push(r)}prompt(ASC.ls(1248)+":",t+"?"+e.join("&"))}})),ASC.showContextMenu(e,t),t.preventDefault()}),this.m_bTTViewer&&ASC.edupage,this.$sheet.on("mousedown mouseup",function(t){t.preventDefault()}),this.m_bTTViewer){var y=null;t.ttviewer_options.browser_jsc&&(t.ttviewer_options.browser_jsc.app&&(y=t.ttviewer_options.browser_jsc.app.m_pPrintPreview.TTViewer_GetSelected()),t.ttviewer_options.browser_jsc.app=t),!y&&t.ttviewer_options.select&&(y=t.ttviewer_options.select),y&&this.TTViewer_Select(y),this.IsNoPage()&&this.TTViewer_AutoSelect()}this.IsNoPage()&&this.Render(),"interactive"==document.readyState?$j(window).load(function(){i.ZoomFit0(),i.Update()}):(this.ZoomFit0(),this.Update())}function T(t,e){return void 0===e&&(e=null),$j(function(t,e){return void 0===e&&(e=null),(e=e||document).createElementNS("http://www.w3.org/2000/svg",t)}(t,e))}function S(t){return t.get(0).getBBox()}t.CPrintPreview=g;var C=1,A=(w.prototype.RenderSheet=function(t,e,i){this.$sheet=t,this.preview=i,t.css({minHeight:"0px",padding:"0px"}),this.page_document=t[0].ownerDocument,this.$svg=$j("<svg style='position:absolute;left:0px;top:0px;direction:ltr'>").attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("stroke","#000000").attr("stroke-width","0").attr("fill","#000000").appendTo(t),this.$defs=T("defs",this.page_document).appendTo(this.$svg),this.$page=T("g",this.page_document).appendTo(this.$svg),this.UpdateSheetScale(e),this.Render()},w.prototype.UpdateSheetScale=function(t){if(this.$sheet){var e=t/b,i=e*this.width,n=e*this.height;this.$sheet.css({width:i+"px",height:.995*n+"px",minHeight:"0px",padding:"0px"}),this.$svg.attr({width:i,height:n}),y?this.$page.attr({"transform-origin":"0 0",transform:"scale("+-e+","+e+") translate("+-this.width+")"}):this.$page.attr({transform:"scale("+e+")"})}},w.prototype.Render=function(){},w);function w(t){this.width=100,this.height=100,this.preview=!1,this.fixTTColors=!1,this.designData=null,this.m_pTlacZostava=t,this.dimensions=t.Dimensions(this instanceof V),this.width=this.dimensions.page_width,this.height=this.dimensions.page_height}t.CPrintPage=A;var I,R=(I=A,n.__extends(P,I),P);function P(){return null!==I&&I.apply(this,arguments)||this}t.CDummyPage=R;var O,D=(O=A,n.__extends(x,O),x.prototype.Render=function(){for(var t=this.m_pTlacZostava.Dimensions(!1),e=this.m_pTlacZostava.Dimensions(!0),i=0,n=0,o=t.pad_w,r=t.pad_h,a=0,s=this.subpages;a<s.length;a++){var l=s[a];l.page_document=this.page_document;var c=T("g",this.page_document).appendTo(this.$page).attr("transform","translate("+o+","+r+")");l.$page=c,l.$defs=this.$defs,l.preview=this.preview,l.Render(),this.m_pTlacZostava.m_Data.splitpageorder?(n++,r+=l.height,n>=e.splitpage_h&&(n=0,r=t.pad_h,i++,o+=l.width)):(i++,o+=l.width,i>=e.splitpage_w&&(i=0,o=t.pad_w,n++,r+=l.height))}},x);function x(t){var e=O.call(this,t)||this;return e.subpages=[],e}function z(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];switch(n.m_Table){case"classes":case"teachers":case"subjects":case"classrooms":case"students":return n}}return null}t.CPrintPageSplit=D,t.HorizontalRO=z;var G,V=(G=A,n.__extends(M,G),M.prototype.Render=function(){var t=this;if(this.designData)this.RenderDesign();else{var i=this.dimensions,n=this.m_pTlacZostava_objekt.m_Data.userheader,o=this.m_pTlacZostava_objekt.m_Data.pageheader,r=i.pad_w,a=i.tt_basey,s=this.m_pTlacZostava.m_pRok.m_ObjectsI.globals[1].m_Data.settings.m_strPrintHeaderText;if(""!=s){var l=(a-r)/4;this.TextBox(new _(i.tt_basex,r,i.tt_basex+i.tt_width,r+l),i.tt_height*n.size,s,0,1,n,n),r+=l/2}var c=this.m_pTlacZostava.m_Data.printlogo_url;c&&this.Image(new _(i.tt_basex,i.pad_h,i.tt_basex+i.tt_width,i.tt_basey-2),c,-1,0).css("pointer-events","none");var m=i.tt_basex,h=r,u=i.tt_basex+i.tt_width,d=new _(m,h,u,a);this.TextBox(d,i.tt_height*o.size,this.m_Title,0,0,o,o),this.preview&&this.Rect(d,"transparent",0).on("contextmenu",function(i){var n=t.m_pTlacZostava_objekt;Promise.resolve().then(function(){return e("./print_settings")}).then(function(t){return t.showPrintPageHeaderDlg(n.m_pRok.m_pRozApp.ttgpid,n.m_Id)}),i.preventDefault(),i.stopPropagation()}),this.RenderTT(i.tt_basex,i.tt_basey,i.tt_width,i.tt_height)}},M.prototype.RenderDesign=function(){for(var t=this,e=this.m_pTlacZostava.m_pRok,i=this.designData,n=this.dimensions,a=new _(100,100,n.page_width-100,n.page_height-100),l=this.m_Page[0],c=a.width()/1e6,m=a.height()/1e6,h=.005*a.width(),u=function(n){var u=n.m_text,p=new _(a.x1+n.m_rect.left*c,a.y1+n.m_rect.top*m,a.x1+n.m_rect.right*c,a.y1+n.m_rect.bottom*m);switch(n.m_nTyp){case 0:d.RenderTT(p.x1,p.y1,p.width(),p.height(),!0);break;case 1:if(u){u=(u=u.replace(/\{!#([0-9]{4})\}/g,function(t,e){return ASC.ttls(parseInt(e))})).replace(/\{([^}]+)\}/g,function(n,a){var c,m,h=a.split(":");if(1==h.length)a.startsWith("!#")?n=ASC.ttls(parseInt(n.substr(2))):"#1635"==a&&(n=l.GetNazov());else if(2==h.length){var _=h[0],u=h[1];if("#1035"==_&&l instanceof o.CTrieda){var d,p=i.class_data[l.m_Id]||{};"#1635"==u&&(n=l.GetNazov()),"#1067"==u&&(n=null===(c=l.GetUcebna())||void 0===c?void 0:c.GetNazov()),"#1532"==u&&(n=null===(m=l.m_pUcitel)||void 0===m?void 0:m.GetNazov()),"#3956"==u&&(n=p.sk_vyucovaci_jazyk||""),"TlaÄivo - typ"==u&&(n=p.sk_tlacivo_typ||""),"TlaÄivo - nÃ¡zov"==u&&(n=p.sk_tlacivo_nazov||""),"#1159"==u&&((d=new s.CMHodina(e)).SetPozicia(l),d.Add0_array(l.GetHodinyMozuSem(0)),d.FinishAdding(),n=t.GetMHText(d,"count"))}"#1048"==_&&l instanceof o.CUcitel&&("#1052"==u&&(n=r.CUtils.GetUINazvy(e.m_ObjectsO.classes.filter(function(t){return t.m_pUcitel==l}))),"#1635"==u&&(n=l.GetNazov()),"#3314"==u&&((d=new s.CMHodina(e)).m_bUvazujDlzkuPreUvazokUcitela=!0,d.Add0_array(l.GetHodinyMozuSem(0)),d.FinishAdding(),n=t.GetMHText(d,"count"))),"#3148"==_&&("#1166"!=u&&"#3205"!=u||(n=i.school_name),"#2975"!=u&&"#3975"!=u||(n=i.headmaster_name),"#1167"==u&&(n=i.year_name))}return n||""});var f=U(n.m_align),v=f.ax,b=f.ay;d.TextBox(p,n.font.ratio*a.height()*.87,u,v,b,{},{shrink:!0})}var y=function(e,i,n,o,r){if(r){var a=.1*((r-1)%3+1),s=Math.floor((r-1)/3),l=t.Line(e,i,n,o,a);2==s&&l.attr("stroke-dasharray","3 6")}};y(p.x1,p.y1,p.x2,p.y1,n.m_lineTop),y(p.x1,p.y2,p.x2,p.y2,n.m_lineBottom),y(p.x1,(p.y1+p.y2)/2,p.x2,(p.y1+p.y2)/2,n.m_lineMiddle),y(p.x1,p.y1,p.x1,p.y2,n.m_lineLeft),y(p.x2,p.y1,p.x2,p.y2,n.m_lineRight);break;case 3:var g=n.Reportdata;d.Rect(p,"#fff",.2);var k=p.y1+p.height()*g.m_nHeaderHeight/100,T=p.y2-p.height()*g.m_nFooterHeight/100;d.HLine(p.x1,k,p.width(),.2),d.HLine(p.x1,T,p.width(),.2);var S=p.x1,C=d.m_Page[0],A=new s.CMHodina(e),w=[];A.SetPozicia(C);var I=C.GetHodinyMozuSem(0);A.Add_array(I);for(var R=function(t){var i=w.find(function(e){return!!g.m_bGroupBySubject&&e.m_Pozicia.subjects==t.m_pPredmet});i||((i=new s.CMHodina(e)).SetPozicia(C),i.SetPozicia(t.m_pPredmet),w.push(i)),i.Add(t)},P=0,O=I;P<O.length;P++)R(O[P]);A.FinishAdding();for(var D=0,x=w;D<x.length;D++)(X=x[D]).FinishAdding();w.sort(function(t,e){return t.m_Pozicia.subjects.GetDBIndex()-e.m_Pozicia.subjects.GetDBIndex()});for(var z=n.font.ratio*a.height()*1.3,G=0;G<g.columns.length;G++){var V=g.columns[G],M=S+p.width()*V.nWidth/100,H=S+h,K=M-h,E=V.nID;0<G&&d.VLine(S,p.y1,p.height(),.1);for(var N=0,j=[[V.strUserHeaderName,n.fontheader,p.y1,k],[V.strUserFooterName,n.fontfooter,T,p.y2]];N<j.length;N++){var Z=j[N],$=Z[0],F=Z[1],L=Z[2],B=Z[3];"#"==$[0]&&($=ASC.ttls(parseInt($.substr(1)))),"{sum}"==$&&($=d.GetMHText(A,"count")),"{}"==$&&28001==E&&($=ASC.ttls(1035)),d.TextBox(new _(H,L,K,B),F.ratio*a.height(),$,-1,0,{},{shrink:!0})}for(var J=k,W=0,Y=w;W<Y.length;W++){var X=Y[W],q=J+z;0==G&&d.HLine(p.x1,q,p.width(),.1);var Q=""+E;0==E&&(Q=""),28e3==E&&(Q=X.GetText("subjects","name")),28001==E&&(Q=X.GetText("classes","name")),28004==E&&(Q=d.GetMHText(X,"count")),28018==E&&(Q=""+(null===(f=X.m_Objects.subjects[0])||void 0===f?void 0:f.GetDoUvazkuRatatAko())),d.TextBox(new _(H,J,K,q),n.font.ratio*a.height(),Q,-1,0,{},{clip:!0}),J=q}S=M}}},d=this,p=0,f=i.objects;p<f.length;p++)u(f[p])},M.prototype.RenderTT=function(t,i,r,m,u){var d,p=this;void 0===u&&(u=!1);var f=this.m_pTTRowRenderer,v=this.m_pTlacZostava.m_pRok,y=this.m_pTlacZostava.m_Data,g=y.gridheadertexts,k=this.m_Columns,T=this.m_Rows,S=this.m_pTlacZostava.m_ColumnTables,C=this.m_pTlacZostava.m_RowTables,A=k.length,w=T.length,I=r*y.headerwidth,R=m*y.headerheight,P=0;this.m_ExtraColumns.forEach(function(t){return P+=t.size*r});var O=0;this.m_ExtraRows.forEach(function(t){return O+=t.size*m});var D=y.cellwidth*(r-I-P),x=y.cellheight*(m-R-O);function G(t,e,i,n){var o=0,r=0;if(i&&i.pos)switch(i.pos){case 1:o=r=-1;break;case 2:r=-1,o=1;break;case 3:o=-(r=1);break;case 4:o=r=1;break;case 5:r=1,o=0;break;case 6:r=-1,o=0;break;case 7:r=0,o=-1;break;case 8:r=0,o=1}var a=i?i.size:0;return a=a||.4,p.TextBox(t.pad(.05),e*a,n,o,r,i,{shrink:!0})}function V(t,i,o,r,a,s){var l=o;g[l]||(l="objects");var c=g[l];if(G(t,i,c,c&&c.column?r.GetNazov(c.column):"periods"==o?r.GetNazov():r.GetSkratka()),"periods"==o&&g.time&&g.time.enabled){var m=n.__spreadArrays(p.m_Page);0<=a&&m.push.apply(m,k[a]),0<=s&&m.push.apply(m,T[s]);var h=v.GetPeriodTime(m);0<=a&&(E[a]=h),0<=s&&(j[s]=h);var _=v.FormatTimeFromTo(h.starttime,h.endtime,"2lines"==g.time.column?"\n":void 0);G(t,i,g.time,_)}p.CustomizeRect(t,function(){var t=p.m_pTlacZostava;Promise.resolve().then(function(){return e("./print_settings")}).then(function(e){return e.showPrintGridHeaderTextDlg(v.m_pRozApp.ttgpid,t.m_Id,l)})})}y.fitwidth&&0<A&&(D=(r-I-P)/A),y.fitheight&&0<w&&(x=(m-R-O)/w);var M=t+I+A*D,U=i+R+w*x,H=M+P,K=U+O,E=[],j=[];function Z(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];if(n instanceof o.CBreak)return n}return null}var $=[],F=[],L=g.days.size;L?(S.includes("days")&&(L*=S.length),C.includes("days")&&(L*=C.length)):L=.5;for(var B=0;B<A;B++){var J=Z(k[B]);if(J){var W=new _(it=t+I+B*D,rt=i+R+x/3,ot=t+I+(B+1)*D,tt=U-x/3);this.Rect(W,"#fff",0),J.m_Data.printtext&&this.TextBoxRotated(W,L*D,J.m_Data.printtext,0,0,{},{shrink:!0}),$[B]=J}}for(B=0;B<w;B++){var Y=Z(T[B]);Y&&(W=new _(it=t+I,rt=i+R+B*x,ot=M,tt=i+R+(1+B)*x),this.Rect(W,"#fff",0),Y.m_Data.printtext&&this.TextBox(W,L*x,Y.m_Data.printtext),F[B]=Y)}for(var X=function(t,e,i,n,o,r,a){for(var s=0;s<o;s++)if(!r[s]){for(var l=s+1;l<o&&!r[l];)l++;p.Line(t+s*i,e+s*n,t+l*i,e+l*n,a),s=l}},q=[],Q=0;Q<S.length;Q++){var tt=(rt=i+Q*R/S.length)+R/S.length;0<Q&&this.HLine(t+I,rt,A*D,.1);var et=null,it=0;for(B=0;B<A;B++)(at=k[B][Q])!=et&&(it=t+I+B*D,et&&(Q+1<S.length&&(q[B]=!0),this.VLine(it,rt,tt-rt,q[B]?.2:.1))),(A<=B+1||k[B+1][Q]!=at)&&V(new _(it,rt,ot=t+I+(B+1)*D,tt),R,S[Q],at,B,-1),et=at}for(B=1;B<A;B++)X(t+I+B*D,i+R,0,x,w,F,q[B]?.2:.1);var nt=[];for(Q=0;Q<C.length;Q++){var ot=(it=t+Q*I/C.length)+I/C.length;0<Q&&this.VLine(it,i+R,w*x,.1),et=null;var rt=0;for(B=0;B<w;B++){var at;(at=T[B][Q])!=et&&(rt=i+R+B*x,et&&(Q+1<C.length&&(nt[B]=!0),this.HLine(it,rt,ot-it,nt[B]?.2:.1))),(w<=B+1||T[B+1][Q]!=at)&&V(new _(it,rt,ot,tt=i+R+(B+1)*x),x,C[Q],at,-1,B),et=at}}for(B=1;B<w;B++)X(t+I,i+R+B*x,D,0,A,$,nt[B]?.2:.1);function st(t){for(var e=0,i=t;e<i.length;e++)if(i[e]instanceof o.CPeriod)return!0;return!1}function lt(t,e){for(var i=0,n=e;i<n.length;i++){var o=n[i];switch(o.m_Table){case"termsdefs":t[0]=o.m_Val;break;case"weeksdefs":t[1]=o.m_Val;break;case"daysdefs":t[2]=o.m_Val;break;case"periods":case"breaks":t[3]=o.m_nHodina}}}function ct(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];if(n instanceof o.CUcitel)return n;if(n instanceof o.CUcebna)return n}return null}function mt(t,i,r,a){for(var s=i==T,l=s?1:0,c=1-l,m=s?nt:q,h=s?F:$,u=!0,d=0,b=[0,0],g=[0,0],k=[b,g],S=0;S<i.length;S++)if(st(N=i[S])){u&&(p.TTR_Init(p.m_Page.concat(t,N)),u=!1,d=S);var C=S+1>=i.length;if(C||st(i[S+1])||(C=!0),C||p.TTR_TryContinue(i[S+1])||(C=!0),C){f.Compute();for(var A=n.__spreadArrays(p.m_Page,t),w=0,I=f.m_Cells;w<I.length;w++){var R=I[w],P=n.__spreadArrays(A,i[d+R.x1]),O=n.__spreadArrays(A,i[d+R.x2]);b[l]=ht[l]+_t[l]+(d+R.x1)*ut[l],g[l]=b[l]+(R.x2-R.x1+1)*ut[l],b[c]=ht[c]+_t[c]+(a+R.y1)*ut[c],g[c]=ht[c]+_t[c]+(a+R.y2)*ut[c];var z=b[0],G=b[1],V=g[0],M=g[1];p.RenderCell(new _(z,G,V,M),D,x,R,!1,P,O,r[d+R.x1],r[d+R.x2]);var U=void 0;U=p.Line(k[0][0],k[0][1],k[c][0],k[l][1],.1),0<R.y1&&U.attr("stroke-dasharray","0.7,0.7"),U=p.Line(k[l][0],k[c][1],k[1][0],k[1][1],.1),R.y2<1&&U.attr("stroke-dasharray","0.7,0.7"),U=p.Line(k[0][0],k[0][1],k[l][0],k[c][1],m[d+R.x1]?.2:.1),U=p.Line(k[c][0],k[l][1],k[1][0],k[1][1],m[d+R.x1+1]?.2:.1)}u=!0}}var H=v.GlobalData().settings;if(p.m_pTlacZostava.IsSuhrn()?H.m_bPrintDozoryVSuhrnnych:H.m_bPrintDozory){var K=[-1,-1,-1,-1];lt(K,p.m_Page),lt(K,t);var E=ct(p.m_Page)||ct(t);for(S=0;S<i.length;S++){var N=i[S];lt(K,N);var j=ct(N);if(j&&(E=j),E)for(var Z=0,L=[!0,!1];Z<L.length;Z++){var B=L[Z],J=null;if(h[S]){if(B)continue;J=v.GetDozoryTWDH(E,K[0],K[1],K[2],K[3],!0)}else{if(B){var W=h[S-1];if(W&&W.m_nHodina==K[3])continue}J=v.GetDozoryTWDH(E,K[0],K[1],K[2],K[3],B)}if(J&&J.length){B?(b[l]=ht[l]+_t[l]+Math.max(0,S-.1)*ut[l],g[l]=ht[l]+_t[l]+(S+.1)*ut[l]):(b[l]=ht[l]+_t[l]+(S+.3)*ut[l],g[l]=ht[l]+_t[l]+(S+.7)*ut[l]);for(var Y=J.length,X=0;X<Y;X++){var Q=J[X];b[c]=ht[c]+_t[c]+(a+.2+.6*X/Y)*ut[c],g[c]=ht[c]+_t[c]+(a+.2+.6*(X+1)/Y)*ut[c];var tt="",et="",it=null;E instanceof o.CUcebna?Q.m_pUcitel&&(it=Q.m_pUcitel):it=Q.m_pUcebna,it&&(tt=it.GetSkratka(),et=it.GetNazov());var ot=new _(b[0],b[1],g[0],g[1]),rt=p.Rect(ot,H.m_bPrintDozoryColor&&it&&!p.m_pTlacZostava.m_bTTViewerDisableCardColor?it.GetColor():"#fff",.1);""!=et&&p.Tootlip(rt,et);var at=y.classroomsupervisionstyle,mt={shrink:!0},dt=ut[l]*at.size;0==l?p.TextBoxRotated(ot,dt,tt,0,0,at,mt):p.TextBox(ot,dt,tt,0,0,at,mt),Q.m_Data.substed&&p.SubstBox(ot),p.preview&&rt.on("contextmenu",function(t){Promise.resolve().then(function(){return e("./print_settings")}).then(function(t){return t.showPrintDozorStyleDlg(v.m_pRozApp.ttgpid,p.m_pTlacZostava.m_Id)}),t.preventDefault(),t.stopPropagation()})}}}}}}var ht=[t,i],_t=[I,R],ut=[D,x];if(this.m_pTlacZostava.m_nTypStredu==c.TLACDEF_STRED.HODINA){if("periods"==S[S.length-1])for(Q=0;Q<w;Q++)mt(T[Q],k,E,Q);else if("periods"==C[C.length-1])for(Q=0;Q<A;Q++)mt(k[Q],T,j,Q)}else{var dt=function(t,e){for(var i=0;i<e.length;i++)if(!e[i].KartaJeTu(t,0))return!1;return!0},pt=n.__spreadArrays(v.TableObjects("cards")),ft=[];pt.forEach(function(t){dt(t,p.m_Page)&&ft.push(t)});var vt,bt=z(this.m_Page),yt=function(e){var n=i+R+e*x,o=n+x;vt=T[e];var r=[];ft.forEach(function(t){dt(t,vt)&&r.push(t)});for(var l=bt||z(vt),c=function(e){var i=t+I+e*D,c=i+D,m=k[e],h=new s.CMHodina(v);if(h.SetPozicia(l||z(m)),r.forEach(function(t){dt(t,m)&&h.Add(t)}),h.IsEmpty())return"continue";h.FinishAdding();var u=new a.CTTRowCell(f);u.m_MHodina=h;var d=new _(i,n,c,o);gt.RenderCell(d,D,x,u,!1,[],[],E[e],E[e]),gt.Rect(d,"none",.1)},m=0;m<A;m++)c(m)},gt=this;for(Q=0;Q<w;Q++)yt(Q)}for(var kt=function(o,a,l,c){for(var h=M,u=U,f=function(f){var b=o.indexOf(f),y=f.data,g=y.typ,k=y.cellstyle,T=y.headerstyle,S=f.size*(c?r:m);f!=o[0]&&(c?Tt.VLine(h,i,U-i,.1):Tt.HLine(t,u,M-t,.1));var C=c?new _(h,i,h+S,i+R):new _(t,u,t+I,u+S);Tt.TextBox(C.pad(.05),C.height()*(T.size||.4),f.data.name,0,0,T,{wrap:!0}),Tt.CustomizeRect(C,function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./extracolumns")})];case 1:return[2,t.sent().showExtraColumnStyleDlg(v.m_pRozApp.ttgpid,this.m_pTlacZostava.m_Id,l,b,"headerstyle")]}})})});for(var A=function(o){var r=c?new _(C.x1,i+R+x*o,C.x2,i+R+x*(o+1)):new _(t+I+D*o,C.y1,t+I+D*(o+1),C.y2),m=1==a[o].length?a[o][0]:null,h="";switch(g){case"empty":break;case"classrooms":case"teachers":case"subjects":case"count":var u=new s.CMHodina(v),f=n.__spreadArrays(Tt.m_Page,a[o]),T=z(f);T&&u.SetPozicia(T);var S=T?T.GetKartyTu(0):v.m_ObjectsO.cards;S=S.filter(function(t){return!f.find(function(e){return!e.KartaJeTu(t,0)})}),u.Add_array(S),u.FinishAdding(),"count"==g?(h=u.m_bRoznePoctyHodin?"*":"",h+=Math.round(100*u.m_dHodin)/100):h=u.GetText(g);break;case"name":case"short":h=null==m?void 0:m.GetNazov(g);break;default:var A=g.split(".");if(2==A.length&&m&&A[0]==m.m_Table)switch(g){case"classes.teacherid":h=null===(y=m.m_pUcitel)||void 0===y?void 0:y.GetNazov();break;case"classes.classroomid":h=null===(d=m.GetUcebna())||void 0===d?void 0:d.GetNazov()}}h&&(Tt.TextBox(r.pad(.05),r.height()*(k.size||.4),h,0,0,k,{wrap:!0}),Tt.CustomizeRect(r,function(){return n.__awaiter(p,void 0,void 0,function(){return n.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return e("./extracolumns")})];case 1:return[2,t.sent().showExtraColumnStyleDlg(v.m_pRozApp.ttgpid,this.m_pTlacZostava.m_Id,l,b,"cellstyle")]}})})})),0<o&&(c?Tt.HLine(r.x1,r.y1,r.width(),.1):Tt.VLine(r.x1,r.y1,r.height(),.1))},w=0;w<a.length;w++)A(w);c?h+=S:u+=S},b=0,y=o;b<y.length;b++)f(y[b])},Tt=this,St=0,Ct=[[this.m_ExtraColumns,T,"extracolumns",!0],[this.m_ExtraRows,k,"extrarows",!1]];St<Ct.length;St++){var At=Ct[St];kt(At[0],At[1],At[2],At[3])}this.Box(t,i,H,K,.3),this.VLine(t+I,i,K-i,.3),this.HLine(t,i+R,H-t,.3),0<P&&this.VLine(H-P,i,K-i,.3),0<O&&this.HLine(t,K-O,H-t,.3),this.preview&&(new N(this.$page,!0,y.headerwidth,t,i,t+r,K,function(t){p.m_pTlacZostava.UpdateSetting("headerwidth",t)}),new N(this.$page,!1,y.headerheight,t,i,H,i+m,function(t){p.m_pTlacZostava.UpdateSetting("headerheight",t)}),y.fitwidth||new N(this.$page,!0,y.cellwidth,t+I,i,t+r-P,i+R,function(t){p.m_pTlacZostava.UpdateSetting("cellwidth",t)}),y.fitheight||new N(this.$page,!1,y.cellheight,t,i+R,t+I,i+m-O,function(t){p.m_pTlacZostava.UpdateSetting("cellheight",t)}));var wt=.02*m,It=.2*wt;if(this.TextBox(new _(t,0,H,i-It),wt,this.m_pTlacZostava.m_pRok.GetRegName(!0),y.printlogo_url?0:-1,1),!u){var Rt=null,Pt=z(this.m_Page);if(Pt instanceof o.CTrieda&&(Rt=Pt),Rt){var Ot=[];Rt.GetUcebna()&&Ot.push(Rt.GetUcebna().GetSkratka()),Rt.m_pUcitel&&Ot.push(("F"==Rt.m_pUcitel.m_Data.gender?ASC.ls(1209):ASC.ls(1199))+": "+Rt.m_pUcitel.GetNazov());for(var Dt=i-It,xt=0,zt=Ot;xt<zt.length;xt++){var Gt=zt[xt];this.TextBox(new _(t,0,H,Dt),wt,Gt,1,1),Dt-=wt+It}}}var Vt=v.GlobalData().settings.m_strDateBellowTimeTable||"";if(""==Vt){var Mt=l.client_req;Vt=Mt.ttls(1854)+": "+h.date_format_date(Mt,Mt.timezone_date())}this.TextBox(new _(t,K+It,H,K+30*b),wt,Vt,-1,-1),this.TextBox(new _(t,K+It,H,K+30*b),wt,"aSc "+ASC.ls(1687),1,-1),v.m_pRozApp&&v.m_pRozApp.jsc.unregistered&&(W=new _(H-.35*r,K-.35*m,H,K),this.Rect(W,"rgba(255,255,255,0.8)",0),this.TextBox(W,.05*m,ASC.ttls(2061),0,0,{},{shrink:!0}))},M.prototype.RenderCell=function(t,i,n,r,a,s,l,m,h){var u,d=this,p=this.m_pTlacZostava.m_pRok,f=this.m_pTlacZostava.m_Data,v=r.m_pKarta,b=r.m_MHodina,y=this.m_pTlacZostava_objekt.m_Data,g=z(s),k=t.x1,S=null;if(y.cardcolorenabled&&!this.m_pTlacZostava.m_bTTViewerDisableCardColor){var C=y.cardcolortable1;C=C||(this.m_pTlacZostava.m_PageTables.includes("teachers")?"classes":"teachers");var A=v?this.GetKartaFarby(v,C):b.GetFarby(C),w=v?this.GetKartaFarby(v,y.cardcolortable2):[];"teachers"==C&&(S=v?v.m_pHodina.m_Ucitelia[0]:b.m_Objects.teachers[0]),this.fixTTColors&&(A=A.map(function(t){return c.fixTTColor(t)}),w=w.map(function(t){return c.fixTTColor(t)}),S=null);var I=null,R=null,P=null,O=null;"left"==y.cardcolorpos?R=A:"topleft"==y.cardcolorpos?O=A:(I=A,P=w);var D="#fff";if(I&&0<I.length&&(D=this.FillFarby(I,t.width(),t.height())),u=this.Rect(t,D,0),R&&0<R.length){var x=t.x1+t.width()/5;this.Rect(new _(t.x1,t.y1,x,t.y2),this.FillFarby(R,0,t.width()),0),k=x}if(P&&0<P.length&&this.Rect(new _(t.x1,t.y1+3*t.height()/4,t.x2,t.y2),this.FillFarby(P,t.x2-t.x1,0),0),O&&0<O.length){var G=Math.max(i,n)/5,V=(x=t.x1+G,t.y1+G);T("polygon",this.page_document).appendTo(this.$page).attr({points:[t.x1,t.y1,x,t.y1,t.x1,V].join(","),stroke:"none",style:"fill:"+this.FillFarby(O,G,G,!0)})}}else u=this.Rect(t,"#fff",0);if(0==f.typ&&v){for(var M=null,H=0,K=this.m_Page;H<K.length;H++){var E=K[H];E instanceof o.CTrieda&&(M=E)}var N=ASC.strVal(v.m_pHodina.m_pPredmet.m_Data.picture_url);""!=N&&M&&ASC.boolVal(M.m_Data.printsubjectpictures)&&this.Image(t.pad(.2),N).css("pointer-events","none")}var j=1;v&&v.m_pHodina&&(j=v.m_pHodina.IsBezTriedy()?0:v.m_pHodina.IsBezUcitela()?2:1);var Z=1/(r.y2-r.y1);(!(Z=Math.round(Z-.01)-1)||Z<0)&&(Z=0);for(var $=r.x2-r.x1,F=this.m_pTlacZostava_objekt.GetPrintKartaStyle($,Z,j),L="",B=0,J=["subjects","classes","groupnames","teachers","classrooms","time","count"];B<J.length;B++){var W=J[B],Y=F.texts[W];if(Y&&Y.enabled){var X=U(Y.pos),q=X.ax,Q=X.ay,tt="",et="";if("time"==W){var it=r.m_pKarta;if(it){var nt=p.GetPeriodTime(s,it.m_pHodina),ot=p.GetPeriodTime(l,it.m_pHodina);m&&h&&m.starttime==nt.starttime&&h.endtime==ot.endtime||(tt=p.FormatTimeFromTo(nt.starttime,ot.endtime)),et=tt}}else tt=v?this.GetKartaText(r.m_pKarta,W,Y.autohide,g,Y.name_col):this.GetMHText(b,W,Y.name_col||"short"),et=v?this.GetKartaText(r.m_pKarta,W,Y.autohide,g,"name"):b.GetText(W,"name");if(""!=tt){var rt=this.TextBox(new _(k,t.y1,t.x2,t.y2).pad(.05),n*Y.size,tt,q,Q,Y,{wrap:!0,clip:!0});if(this.preview&&rt.css("pointer-events","none"),S){var at=S.m_Data[0==q&&0==Q?"fontcolorprint":"fontcolorprint2"];at&&rt.attr("fill",at)}}""!=et&&(L&&(L+="\n"),L+=et)}}this.Tootlip(u,L),v&&v.m_Data.substed&&this.SubstBox(t),this.preview&&u.on("contextmenu",function(t){var i=d.m_pTlacZostava_objekt,n=i.m_PrintKartaStyles.indexOf(F);Promise.resolve().then(function(){return e("./print_settings")}).then(function(t){return t.showPrintCellStyleDlg(p.m_pRozApp.ttgpid,i.m_Id,{ksi:n,m_nDlzka:$,m_nPocetRiadkov:Z,m_nBezTriedyAleboUcitela:j})}),t.preventDefault(),t.stopPropagation()})},M.prototype.GetKartaText=function(t,e,i,n,r){var a;switch(void 0===r&&(r="short"),r=r||"short",e){case"subjects":var s=t.m_pHodina,l=s.m_pPredmet.GetNazov(r);return 1<=s.m_nPoradieSeminaru&&("short"==r?("0"<=l.substr(-1)&&l.substr(-1)<="9"&&(l+="-"),l+=s.m_nPoradieSeminaru):l+=" ("+s.m_nPoradieSeminaru+")"),l;case"groups":case"groupnames":a=[];for(var c=0,m=t.m_pHodina.m_Skupiny;c<m.length;c++){var h=m[c];h.m_bCelaTrieda&&i||n instanceof o.CTrieda&&n!=h.m_pTrieda||(l=h.GetNazov(),a.includes(l)||a.push(l))}return a.join("/");case"teachers":a=[];for(var _=0,u=t.m_pHodina.m_Ucitelia;_<u.length;_++){var d=u[_];a.push(d.GetNazov(r))}return a.join(" / ");case"classes":a=[];for(var p=0,f=t.m_pHodina.m_Triedy;p<f.length;p++){var v=f[p];a.push(v.GetNazov(r))}return a.join("/");case"classrooms":a=[];for(var b=0,y=t.Ucebne();b<y.length;b++){var g=y[b];if(g){if(i){for(var k=!1,T=0,S=t.m_pHodina.m_Triedy;T<S.length;T++)v=S[T],g.JeKmenovaPre(v)&&(k=!0);if(k)continue}a.push(g.GetNazov(r))}}return a.join(" / ");default:return t.GetTexty([e],r,n)}},M.prototype.GetKartaFarby=function(t,e){var i=[];switch(e){case"teachers":for(var n=0,o=t.m_pHodina.m_Ucitelia;n<o.length;n++){var r=o[n];i.push(r.GetColor())}break;case"subjects":i.push(t.m_pHodina.m_pPredmet.GetColor());break;case"classes":for(var a=0,s=t.m_pHodina.m_Triedy;a<s.length;a++)r=s[a],i.push(r.GetColor());break;case"groupnames":case"groups":for(var l=0,c=t.m_pHodina.m_Skupiny;l<c.length;l++)r=c[l],i.push(r.GetColor());break;case"classrooms":for(var m=0,h=t.Ucebne();m<h.length;m++)(r=h[m])&&i.push(r.GetColor());break;case"buildings":for(var _=0,u=t.Ucebne();_<u.length;_++)(r=u[_])&&r.m_pBudova&&i.push(r.m_pBudova.GetColor())}return i},M.prototype.GetMHText=function(t,e,i){switch(e){case"teachers":case"classes":case"subjects":case"classrooms":case"groups":case"groupnames":return t.GetText(e,i);case"count":return(t.m_bRoznePoctyHodin?"*":"")+Math.round(100*t.m_dHodin)/100}return e+"?"},M.prototype.Line=function(t,e,i,n,o){return T("line",this.page_document).attr({x1:t,y1:e,x2:i,y2:n,"stroke-width":o*b}).appendTo(this.$page)},M.prototype.VLine=function(t,e,i,n){return this.Line(t,e,t,e+i,n)},M.prototype.HLine=function(t,e,i,n){return this.Line(t,e,t+i,e,n)},M.prototype.Box=function(t,e,i,n,o){var r=this.Line(t,e,i,e,o);return(r=(r=r.add(this.Line(i,e,i,n,o))).add(this.Line(i,n,t,n,o))).add(this.Line(t,n,t,e,o))},M.prototype.Rect=function(t,e,i){var n=T("rect",this.page_document).attr({x:t.x1,y:t.y1,width:t.width(),height:t.height(),style:"fill:"+e}).appendTo(this.$page);return 0<i?n.attr("stroke-width",i*b):n.attr("stroke","none"),n},M.prototype.CustomizeRect=function(t,e){this.preview&&this.Rect(t,"transparent",0).on("contextmenu",function(t){t.preventDefault(),t.stopPropagation(),e()})},M.prototype.Tootlip=function(t,e){T("title",this.page_document).text(e).prependTo(t)},M.prototype.Image=function(t,e,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=T("image",this.page_document),r=document.createAttributeNS("http://www.w3.org/1999/xlink","href");r.nodeValue=e,o[0].attributes.setNamedItemNS(r),o.appendTo(this.$page).attr({x:t.x1,y:t.y1});var a=t.width(),s=t.height();if(i||n){var l=S(o),c=function(){var e=Math.min(a/l.width,s/l.height);a=l.width*e,s=l.height*e,0==i?o.attr("width",t.width()):0<i&&o.attr({x:t.x2-a,width:a}),0==n?o.attr("height",t.height()):0<i&&o.attr({y:t.y2-s,width:s})};l.width?c():o.load(function(){l=S(o),c()})}else o.attr({width:a,height:s});if(y){var m=S(o);o.attr({transform:"scale(-1 1) translate("+(-2*m.x-m.width)+")"})}return o},M.prototype.FillFarby=function(t,e,i,n){if(0==t.length)return"#fff";if(1==t.length)return t[0];for(var o="LG_"+C++,r=T("linearGradient",this.page_document).appendTo(this.$defs).attr({id:o,x1:0,y1:0,x2:0<e?1:0,y2:0<i?1:0}),a=(n?.5:1)/t.length,s=0;s<t.length;s++)T("stop",this.page_document).appendTo(r).attr({offset:s*a,"stop-color":t[s]}),T("stop",this.page_document).appendTo(r).attr({offset:(s+1)*a,"stop-color":t[s]});return"url(#"+o+")"},M.prototype.FixFont=function(t){return["arial","courier","times new roman"].includes(t.toLowerCase())?t:t+",Arial"},M.prototype.TextBox=function(t,e,i,o,r,a,s){var l=this;if(void 0===o&&(o=0),void 0===r&&(r=0),void 0===a&&(a={}),void 0===s&&(s={}),e=Math.min(e,t.height()),a.vertical)return delete(a=n.__assign({},a)).vertical,this.TextBoxRotated(t,e,i,o,r,a,s);var c=T("text",this.page_document).attr({"font-size":e,"text-rendering":"geometricPrecision","text-anchor":o<0?"start":0<o?"end":"middle","dominant-baseline":r<0?"text-before-edge":0<r?"text-after-edge":"central"}).appendTo(this.$page).css("pointer-events","none").css("white-space","pre").text(i);a.bold&&c.css("font-weight","bold"),a.italic&&c.css("font-style","italic"),a.underline&&c.css("text-decoration","underline"),a.font&&c.css("font-family",this.FixFont(a.font));var m=c[0];function h(t){c.empty();for(var i=0,n=t;i<n.length;i++){var o=n[i],r=T("tspan",l.page_document).appendTo(c).text(o);o!=t[0]&&r.attr({dy:e})}d=t.length}e>t.height()&&(e=t.height(),c.attr("font-size",e));var _=t.width(),u=t.height(),d=1;if(i.includes("\n"))h(i.split("\n"));else{var p=m.getComputedTextLength();if(_<p)if(s.wrap){for(var f=[],v=0;v<i.length;){for(var b=v,g=!1;b<i.length;){var k=b+1;if(g||(k=i.indexOf(" ",k))<0&&(k=i.length),m.getSubStringLength(v,k-v)>_){if(v<b)break;if(g){b=i.length;break}g=!0,b=v}else b=k}for(f.push(i.substring(v,b).trim()),v=b;" "==i.charAt(v);)v++}h(f)}else s.shrink&&(e=e*_/p,c.attr("font-size",e))}if((1<d?c.find("tspan"):c).attr("x",t.x1+(1+o)*_/2),c.attr("y",t.y1+(1+r)*(u-(d-1)*e)/2),!(["edge","ie11","ie10"].includes(ASC.browser)||"safari"==ASC.browser&&0<r)||(I=S(c)).height&&c.attr("y",parseFloat(c.attr("y"))+t.y1-I.y+(t.height()-I.height)*(1+r)/2),s&&s.clip&&((I=S(c)).width>_||I.height>u)){var A="CP_"+C++,w=T("clipPath",this.page_document).appendTo(this.$page).attr("id",A);T("rect",this.page_document).appendTo(w).attr({x:t.x1,y:t.y1,width:_,height:u}),c.attr("clip-path","url(#"+A+")")}if(y){var I=S(c);c.attr({transform:"scale(-1 1) translate("+(-2*I.x-I.width)+")"})}return c},M.prototype.TextBoxRotated=function(t,e,i,n,o,r,a){void 0===n&&(n=0),void 0===o&&(o=0);var s=t.width(),l=t.height(),c=this.TextBox(new _(t.x1-l,t.y1,t.x1,t.y1+s),e,i,n,o,r,a);return c.attr("transform","rotate(-90 "+t.x1+" "+t.y1+")"),c},M.prototype.SubstBox=function(t){var e=this.Rect(new _(t.x1+.35,t.y1+.35,t.x2-.35,t.y2-.35),"none",.7);return e.attr("stroke-dasharray","2,2"),e},M.prototype.TTR_Init=function(t){var e=this.m_pTTRowRenderer;e.Clear();for(var i=0,n=t;i<n.length;i++){var o=n[i];if("periods"==o.m_Table){var r=o;e.m_nVerticalHodinyOd=r.m_nHodina,e.m_nVerticalHodinyDo=r.m_nHodina}if("daysdefs"==o.m_Table){var a=o;e.m_nDay=a.m_Val}"weeksdefs"==o.m_Table&&(a=o,e.m_nWeek=a.m_Val),"termsdefs"==o.m_Table&&(a=o,e.m_nTerm=a.m_Val)}if(e.m_pHorizontalRokObject=z(t),e.m_bSpojNaViacHodinovku=ASC.boolVal(e.m_pRok.GlobalData().settings.m_bPrintSinglesSpolu),e.m_bRozdelNaJednohodinovky=ASC.boolVal(e.m_pRok.GlobalData().settings.m_bPrintDoublesAsSingles),!e.m_pHorizontalRokObject)throw"Error 7857072888"},M.prototype.TTR_TryContinue=function(t){for(var e=!1,i=this.m_pTTRowRenderer,n=0,o=t;n<o.length;n++){var r=o[n];if("periods"==r.m_Table){if(r.m_nHodina!=i.m_nVerticalHodinyDo+1)return!1;e=!0}}return!!e&&(i.m_nVerticalHodinyDo++,!0)},M);function M(t,e,i,n){var o=G.call(this,t)||this;o.m_Title="",o.m_Page=[],o.m_Rows=[],o.m_Columns=[],o.m_ExtraRows=[],o.m_ExtraColumns=[],o.m_pTlacZostava=t,o.m_pTlacZostava_objekt=t;for(var s=0,l=e;s<l.length;s++)if("classrooms"==l[s].m_Table&&!t.m_PageTables.includes("classrooms"))for(var c=0,m=t.m_pRok.m_ObjectsO.ttreports;c<m.length;c++){var h=m[c];if(3==h.m_Data.typ){o.m_pTlacZostava_objekt=h;break}}if(o.m_Page=e,o.m_Rows=i,o.m_Columns=n,0<e.length)for(var _=0,u=e;_<u.length;_++){var d=u[_];""!=o.m_Title&&(o.m_Title+=" - "),o.m_pTlacZostava_objekt.m_Data.pageheaderprefixenabled&&d.m_Data.printheaderprefix&&(o.m_Title+=d.m_Data.printheaderprefix+" "),o.m_Title+=r.CUtils.GetUINazov(d,"name")}else o.m_Title=o.m_pTlacZostava.GetNazov();return o.m_pTTRowRenderer=new a.CTTRowRenderer(o.m_pTlacZostava.m_pRok),o}function U(t){var e=0,i=0;switch(t){case 1:e=i=-1;break;case 2:i=-1,e=1;break;case 3:e=-(i=1);break;case 4:e=i=1;break;case 5:i=1,e=0;break;case 6:i=-1,e=0;break;case 7:i=0,e=-1;break;case 8:i=0,e=1}return{ax:e,ay:i}}function H(t){var e=window.open("","_blank"),i=e.document,n=$j(i.head).empty(),o=$j(i.body).empty();o.css({margin:"0px",padding:"0px"});try{$j("<base>").attr("href","https://"+document.location.host).appendTo(n),$j("link[type='text/css']").each(function(t,e){$j(e).clone().appendTo(n)})}catch(t){console.error(t)}$j("<style type='text/css'>@page {margin: 0px;margin-bottom: -5cm;}</style>").appendTo(n);for(var r=[],a=function(t){r.push(function(){var e=$j("<div class='print-sheet-manual'>").appendTo(o);e.css({width:5*t.width+"px",height:5*t.height-100+"px"}),t.RenderSheet(e,5,!1)})},s=0,l=t;s<l.length;s++)a(l[s]);r.push(function(){$j(i).ready(function(){setTimeout(function(){e.print()},100)})});var c=new ASC.ui.ProgressBar(r);c.safetyCounterMax=Math.max(c.safetyCounterMax,r.length+10)}t.CPrintPageGrid=V,t.printPagesPrint=H,t.phpPrintPosField=function(t,e,i,n,o){void 0===i&&(i={}),n[o]=new K(t,e,i).input};var K=(E.prototype.setValue=function(t){this.input.value=""+t,this.$div.find("div").removeClass("selected"),this.$pos[t].addClass("selected")},E);function E(t,e,i){var n=this;void 0===i&&(i={}),this.$pos=[],e=parseInt(e),this.$div=$j("<div class='ttonline-print-pos-field'>").appendTo(t),this.input=$j("<input type='hidden'>").appendTo(t).get(0),this.input.value=""+e,i.style&&(this.$div[0].style.cssText+=";"+i.style),[1,6,2,7,0,8,3,5,4].forEach(function(t,i){n.$pos[t]=$j("<div>").appendTo(n.$div).toggleClass("selected",t==e).click(function(){n.setValue(t)}),2!=i&&5!=i||$j("<br>").appendTo(n.$div)})}t.PrintPosField=K;var N=(j.prototype.updatePos=function(){if(this.vertical){var t=this.s_min+this.s_delta*this.v;this.$l.attr({x1:t,x2:t})}else{var e=this.s_min+this.s_delta*this.v;this.$l.attr({y1:e,y2:e})}},j);function j(t,e,i,n,o,r,a,s){var l=this;this.v_min=.01,this.v_max=.99,this.vertical=!1;var c=$j(t)[0].ownerDocument;this.$l=T("line",c).appendTo(t).attr({"stroke-width":2*b,cursor:e?"w-resize":"n-resize","stroke-opacity":0}),this.$f=T("line",c).appendTo(t).attr({x1:n,y1:o,x2:r,y2:a,"stroke-width":1*b,"stroke-opacity":0}),this.v=i,this.vertical=e,this.fn=s,e?(this.s_min=n,this.s_delta=r-n,this.$l.attr({y1:o,y2:a})):(this.s_min=o,this.s_delta=a-o,this.$l.attr({x1:n,x2:r})),this.updatePos(),this.$l.mousedown(function(t){function e(e){var n,o,r,a=l.v,s=l.$f[0].getBoundingClientRect();r=l.vertical?(n=e.pageX,o=s.left,s.width):(n=e.pageY,o=s.top,s.height),a=(n-o)/r,a=Math.max(l.v_min,Math.min(l.v_max,a)),(i||1<Math.abs(e.pageX-t.pageX)+Math.abs(e.pageY-t.pageY))&&(l.v=a,l.updatePos(),i=!0),e.stopPropagation(),e.preventDefault(),l.updatePos()}l.$l.attr("stroke-opacity",1);var i=!1,n=function(t){$j(document).off("mousemove",e).off("mouseup",n),l.$l.attr("stroke-opacity",0),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),i&&l.fn(l.v)};$j(document).mousemove(e).mouseup(n),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()})}t.Potahovatko=N},"/timetable/app/server/designs.js":function(t,e,i){i.implementRpc(["getDesignData"])},"/timetable/app/server/generator.js":function(t,e,i){i.implementRpc(["listTTGenerators_local","listTTGenerators_global","scTTGeneratorFind","runTTVerification","rozExportDownloadLink","ttdocDbForGen","generatorStart","generatorPing","generatorStop","testStart","testPing","testStop","getDraftOptions"])}});