"use strict";ASC.installBundle("ttonline_base",["subst","dbi"],{"/timetable/app/online.js":function(l,require,t){l.__esModule=!0;var c,e,h=require("tslib"),_=require("react"),m=require("./rozview"),u=require("./tview"),i=require("./print"),d=require("./rokobject"),p=require("../../asc/asc_react"),f=require("../../asc/edurequest"),v=require("../../asc/actions"),r=require("./server/generator"),n=require("../../asc/asc_react2"),s=require("../timeoff_r");function w(t){t||ASC.logProblem("9576331351",t)}(e=c=c||{})[e.KONTROLAMODE_VYPNUTA=0]="KONTROLAMODE_VYPNUTA",e[e.KONTROLAMODE_KONTROLA=1]="KONTROLAMODE_KONTROLA",e[e.KONTROLAMODE_PODMIENKY=2]="KONTROLAMODE_PODMIENKY",e[e.KONTROLAMODE_CHANGE=3]="KONTROLAMODE_CHANGE",e[e.KONTROLAMODE_RUCNEINFO=4]="KONTROLAMODE_RUCNEINFO",e[e.KONTROLAMODE_PO_RIES=5]="KONTROLAMODE_PO_RIES",e[e.KONTROLAMODE_ADVISOR=6]="KONTROLAMODE_ADVISOR",l.startTTOnline=function(e,i){return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,ASC.loadTTLang()];case 1:return t.sent(),new o(e).Sync(i),[2]}})})},l.farby=[];var o=(a.get=function(){return document.getElementsByClassName("ttonline")[0].previousSibling.ASC_gjsc.app},a.prototype.checkPurchased=function(){return h.__awaiter(this,void 0,void 0,function(){var e,i=this;return h.__generator(this,function(t){switch(t.label){case 0:return this.jsc.unregistered?(e=f.client_req,[4,p.RDialog.show(_.createElement(p.RDialog,{width:400,buttons:[{label:e.ttls(2797),type:"green",onClick:function(){return h.__awaiter(i,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../../asc/purchase")})];case 1:return[4,t.sent().showPurchaseEdupage()];case 2:return[2,t.sent()]}})})}},"cancel"]},_.createElement(n.DlgHeader,{title:e.ttls(2061),small:!0,icon:"/timetable/pics/app/office/purchase_32.png"}),_.createElement("div",null,e.ls(2016))))]):[2,!0];case 1:return t.sent(),[2,!1]}})})},a.prototype.trackEvent=function(t,e){if(!this.ttviewer){var i=window.ga;i&&("App"==t&&"initialized"==e?(i("ttonlineTracker.send","pageview"),i("ttonlineTracker.send","event",t,e,null,null,{nonInteraction:!0})):i("ttonlineTracker.send","event",t,e))}},a.prototype.InitRibbon_back=function(t){var e=this;new ASC.ui.RibbonButton(t,ASC.ls(1748),S.GetImage("back_32"),function(){e.ribbonMenu.select("main")})},a.prototype.InitRibbon_file=function(t,e){var i=this;new ASC.ui.RibbonButton(t,ASC.ls(6133),S.GetImage("file_new_32"),function(){i.ClickNew()}),new ASC.ui.RibbonButton(t,ASC.ls(6370),S.GetImage("open_32"),function(){p.openUrl("/timetable/admin.php")}),"file"==e&&this.InitRibbon_close(t),new ASC.ui.RibbonButton(t,ASC.ttls(2577),S.GetImage("save_32"),null,{menu:[{text:ASC.escapeHTML(ASC.ttls(2577)),onclick:function(){i.click_func("save")}},{text:ASC.escapeHTML(ASC.ttls(1589).replace("&","")),onclick:function(){i.click_func("save","saveas=1")}}]})},a.prototype.InitRibbon_demos=function(t){var e=this;new ASC.ui.RibbonButton(t,ASC.ttls(3045),S.GetImage("demofiles_32"),function(){return h.__awaiter(e,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../demofiles")})];case 1:return t.sent().showTTDemoFiles(),[2]}})})})},a.prototype.InitRibbon_feedback=function(t){var e=this,i=f.client_req;new ASC.ui.RibbonButton(t,ASC.ls(1593),S.GetImage("help_32"),function(){"tr"==i.school_country?p.openUrl("https://ascturkiye.com/Index.aspx?cpc=4"):e.click_func("feedback")})},a.prototype.InitRibbon_close=function(t){var e=this;new ASC.ui.RibbonButton(t,ASC.ls(1567),S.GetImage("close_32"),function(){e.click_func("close")})},a.prototype.InitRibbon=function(){var t,i,n=this,e=f.client_req,o=this.ttgpid;if(!this.ttviewer){var r=function(e){new ASC.ui.RibbonButton(i,S.GetTableName(e),S.GetTableIcon(e),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return require("./zadanie")})];case 1:return t.sent().showZadanieDlg(o,{table:e}),[2]}})})})};t=this.ribbonMenu.addRibbon("main",ASC.ttls(3222).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_file(i,"main"),this.jsc.ttfeedbackid&&new ASC.ui.RibbonButton(i,"FEEDBACK info",S.GetImage("print_preview_32"),function(){n.click_func("ttfeedback")},{}),new ASC.ui.RibbonButton(i,ASC.ttls(3351),S.GetImage("print_preview_32"),function(){n.ClickPrintPreview()},{cmd:"printpreview"}),i=new ASC.ui.RibbonGroup(t),this.$rg_pohlad_div=$j(i.addDiv()).css("margin-top","2px"),i=new ASC.ui.RibbonGroup(t),["subjects","classes","classrooms","teachers"].forEach(function(t){return r(t)}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3263),S.GetImage("seminar_32"),function(){return h.__awaiter(n,void 0,void 0,function(){var e=this;return h.__generator(this,function(t){switch(t.label){case 0:return 0!=this.m_pRok.TableObjects("students").length?[3,2]:[4,p.RDialog.showConfirm(_.createElement(_.Fragment,null,_.createElement("h1",null,ASC.ttls(2610)),_.createElement("span",{style:{whiteSpace:"pre-wrap"}},ASC.ttls(3258)+" "+ASC.ttls(3259),": ",_.createElement("a",{onClick:function(){return e.ShowHelp("seminarsdialog")},style:{cursor:"pointer"}},ASC.ttls(3263)))),{buttons:[{label:ASC.ttls(3260),action:"ok",type:"green"},"cancel"],width:400})];case 1:if(!t.sent())return[2];t.label=2;case 2:return[4,Promise.resolve().then(function(){return require("./students_dlg")})];case 3:return t.sent().showStudentsDlg(o),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(2614),S.GetImage("relation_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return require("./vztahy")})];case 1:return t.sent().showVztahyDlg(o),[2]}})})}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(2047),S.GetImage("test_32"),function(){n.ClickTest()}),new ASC.ui.RibbonButton(i,ASC.ttls(1090),S.GetImage("gener_32"),function(){n.ZrusKontrolu(),n.ClickGenerate()}),new ASC.ui.RibbonButton(i,e.ttls(4382),S.GetImage("gener_cloud_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./cloudgenerator")})];case 1:return t.sent().onClickCloudGenerator({ttgpid:o}),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(1616),S.GetImage("verification_32"),function(){n.ClickVerification("verification")},{cmd:"verification"}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3148),S.GetImage("school_32"),function(){n.ZrusKontrolu(),Promise.resolve().then(function(){return require("./school")}).then(function(t){return t.showSchoolDlg(o)})}),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_feedback(i),i=new ASC.ui.RibbonGroup(t),!ASC.ascdebug&&"ascpalo"!=ASC.edupage||(this.m_pSync.$debug=$j(i.addDiv())),i=new ASC.ui.RibbonGroup(t,{right:!0}),this.InitRibbon_close(i),t=this.ribbonMenu.addRibbon("files",ASC.ttls(1572).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_file(i,"file"),this.InitRibbon_demos(i),i=new ASC.ui.RibbonGroup(t);var a=[];a.push({text:"Edupage - "+e.ls(1394),onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./import")})];case 1:return[2,t.sent().showImportEdupage(o)]}})})}}),a.push({text:"Edupage - "+e.ls(1001)+" (beta)",onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./import")})];case 1:return[2,t.sent().showImportOtherTimetable(o)]}})})}}),a.push({text:e.ttls(2793),onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./import")})];case 1:return[2,t.sent().showImportClipboard(o)]}})})}}),a.push({text:e.ttls(1079)+" XML",onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./import")})];case 1:return[2,t.sent().showImportXML(o)]}})})}}),a.push([]),"de"!=e.school_country&&!e.props.ascdevelop||a.push({text:"Winprosa (beta)",onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./import")})];case 1:return[2,t.sent().showImportWinprosa(o)]}})})}}),new ASC.ui.RibbonButton(i,ASC.ls(1422),S.GetImage("import_32"),null,{menu:a});var s=[];s.push({text:e.ttls(1079)+" (*.roz)",onclick:function(){ASC.blockUI(function(){return h.__awaiter(n,void 0,void 0,function(){var e,i;return h.__generator(this,function(t){switch(t.label){case 0:return i=(e=window).open,[4,Promise.resolve().then(function(){return require("./server/generator")})];case 1:return[4,t.sent().rozExportDownloadLink(null,o)];case 2:return i.apply(e,[t.sent(),"_blank"]),[2]}})})})}}),s.push([]),s.push({text:"aSc Timetables XML",onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,this.checkPurchased()];case 1:return t.sent()?[4,Promise.resolve().then(function(){return require("./export ")})]:[3,3];case 2:t.sent().showExportAscTimetablesXML(o),t.label=3;case 3:return[2]}})})}}),s.push([]),s.push({text:e.ttls(1e3)+" - "+e.ttls(1008),onclick:function(){ASC.blockUI(function(){return h.__awaiter(n,void 0,void 0,function(){var e,i;return h.__generator(this,function(t){switch(t.label){case 0:return i=(e=window).open,[4,Promise.resolve().then(function(){return require("./server/export")})];case 1:return[4,t.sent().excelExportDownloadLink(null,o,"contracts")];case 2:return i.apply(e,[t.sent(),"_blank"]),[2]}})})})}}),s.push([]),s.push({text:"GP-Untis DIF ("+ASC.ls(1001)+")",onclick:function(){ASC.blockUI(function(){return h.__awaiter(n,void 0,void 0,function(){var e,i;return h.__generator(this,function(t){switch(t.label){case 0:return i=(e=window).open,[4,Promise.resolve().then(function(){return require("../../exports/de/server/untis_DIF")})];case 1:return[4,t.sent().untisDIFExportDownloadLink(null,o)];case 2:return i.apply(e,[t.sent(),"_self"]),[2]}})})})}}),s.push({text:"Atlantis (STDPLAN) - beta",onclick:function(){ASC.blockUI(function(){return h.__awaiter(n,void 0,void 0,function(){var e,i;return h.__generator(this,function(t){switch(t.label){case 0:return i=(e=window).open,[4,Promise.resolve().then(function(){return require("../../exports/de/server/atlantis_stdplan")})];case 1:return[4,t.sent().atlantisSTDPLANExportDownloadLink(null,o)];case 2:return i.apply(e,[t.sent(),"_self"]),[2]}})})})}}),s.push({text:"PowerSchool(Pearson) Excel Export",onclick:function(){ASC.blockUI(function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../../exports/powerschool")})];case 1:return t.sent().showPowerSchoolExport(o),[2]}})})})}}),s.push({text:"NYC Excel Export",onclick:function(){ASC.blockUI(function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../../exports/us/nyc_excel")})];case 1:return t.sent().showNYCExcelExport(o),[2]}})})})}}),"de"!=e.school_country&&!e.props.ascdevelop||(s.push({text:"Winprosa (beta)",onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./export ")})];case 1:return[2,t.sent().showExportWinprosa(o)]}})})}}),s.push({text:"KÃ¶ln UniterrichtsImport Schild (beta)",onclick:function(){return ASC.blockUI(function(){return h.__awaiter(n,void 0,void 0,function(){var e,i;return h.__generator(this,function(t){switch(t.label){case 0:return i=(e=window).open,[4,Promise.resolve().then(function(){return require("../../exports/de/server/kolin_schild")})];case 1:return[4,t.sent().kolinSchildExportDownloadLink(null,o)];case 2:return i.apply(e,[t.sent(),"_self"]),[2]}})})})}})),0<=["ascpalo","gsg-waldkirch-test","schillertest2"].indexOf(e.edupage)&&s.push({text:"ASV - Stundenplanprogramm->ASV",onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("../../exports/de_bw/asv_stdplan")})];case 1:return[2,t.sent().showExportStdplan(o)]}})})}}),["ascpalo","dasman","greenfieldsch"].includes(e.edupage)&&s.push({text:"Timetabler TTExport.TXT",onclick:function(){ASC.blockUI(function(){return h.__awaiter(n,void 0,void 0,function(){var e,i;return h.__generator(this,function(t){switch(t.label){case 0:return i=(e=window).open,[4,Promise.resolve().then(function(){return require("../../exports/server/timetabler")})];case 1:return[4,t.sent().timetableTTExportDownloadLink(null,o)];case 2:return i.apply(e,[t.sent(),"_self"]),[2]}})})})}}),new ASC.ui.RibbonButton(i,ASC.ls(1701),S.GetImage("export_32"),null,{menu:s}),new ASC.ui.RibbonButton(i,ASC.ttls(2819),S.GetImage("compare_32"),null,{menu:[{text:ASC.ttls(2820),onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./compare")})];case 1:return t.sent().showCompareDoc(this),[2]}})})}},{text:ASC.ttls(2821),onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./compare")})];case 1:return t.sent().showCompareDoc(this,!0),[2]}})})}}]}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3351),S.GetImage("print_preview_32"),function(){n.ClickPrintPreview()},{cmd:"printpreview"}),t=this.ribbonMenu.addRibbon("specification",ASC.ttls(1598).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(1599),S.GetImage("wizard_32"),function(){n.ZrusKontrolu(),Promise.resolve().then(function(){return require("./wizard")}).then(function(t){return t.showWizard(o)})}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3148),S.GetImage("school_32"),function(){n.ZrusKontrolu(),Promise.resolve().then(function(){return require("./school")}).then(function(t){return t.showSchoolDlg(o)})}),["subjects","classes","classrooms","teachers"].forEach(function(t){return r(t)}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(2614),S.GetImage("relation_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return require("./vztahy")})];case 1:return t.sent().showVztahyDlg(o),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(3719),S.GetImage("constraints_32"),function(){n.ClickVerification("listconstraints")},{cmd:"listconstraints"}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,S.GetTableName("lessons"),S.GetTableIcon("lessons"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return require("./lesson_dlg")})];case 1:return t.sent().showLessonsDlg(o),[2]}})})}),t=this.ribbonMenu.addRibbon("view",ASC.ttls(1149).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,S.StripStringTab(ASC.ttls(2629)),S.GetImage("undo_32"),function(){n.click_func("undo")},{mini:!1,id:"undo"}),new ASC.ui.RibbonButton(i,S.StripStringTab(ASC.ttls(2630)),S.GetImage("redo_32"),function(){n.click_func("undo","redo=1")},{mini:!1,id:"redo"}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,S.StripStringTab(ASC.ttls(3117)),S.GetImage("show_tabs_32"),function(){n.m_pPohladSwitcher.SetEnabled(!n.m_pPohladSwitcher.m_bEnabled)}),new ASC.ui.RibbonButton(i,ASC.ttls(2551),S.GetImage("zoom_32"),null,{menu:[{text:"50%",onclick:function(){n.Zoom("50%")}},{text:"100%",onclick:function(){n.Zoom("100%")}},{text:"200%",onclick:function(){n.Zoom("200%")}},[],{text:ASC.ttls(2551)+" +",onclick:function(){n.Zoom("+")}},{text:ASC.ttls(2551)+" -",onclick:function(){n.Zoom("-")}},[],{text:ASC.ttls(2829),onclick:function(){n.Zoom("/")}}]}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,S.StripStringTab(ASC.ttls(3303)),S.GetImage("view_define_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./dlg")})];case 1:return t.sent().showItemDlg(o,"ttviews",this.m_pTriedyView.m_pAktPohlad.m_Id),[2]}})})}),t=this.ribbonMenu.addRibbon("timetable",ASC.ttls(1502).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(2047),S.GetImage("test_32"),function(){n.ClickTest()}),new ASC.ui.RibbonButton(i,ASC.ttls(1090),S.GetImage("gener_32"),function(){n.ClickGenerate()}),new ASC.ui.RibbonButton(i,ASC.ttls(1613),S.GetImage("improve_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,this.checkPurchased()];case 1:return t.sent()?[4,Promise.resolve().then(function(){return require("./gener")})]:[3,3];case 2:t.sent().showImprove(o),t.label=3;case 3:return[2]}})})}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(1615),S.GetImage("parameters_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return require("./constraints")})];case 1:return t.sent().showTTDocConstraintsDlg(o,"globals","1"),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(3719),S.GetImage("constraints_32"),function(){n.ClickVerification("listconstraints")},{cmd:"listconstraints"}),new ASC.ui.RibbonButton(i,ASC.ttls(1616),S.GetImage("verification_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){return this.ClickVerification("verification"),[2]})})},{cmd:"verification"}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(1617),S.GetImage("assignclassrooms_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return require("./gener")})];case 1:return t.sent().showAssignClassrooms(o),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(1618),S.GetIconLocked(!0),function(){n.ZrusKontrolu(),n.click_func("cards","cmd=lock")}),new ASC.ui.RibbonButton(i,ASC.ttls(1619),S.GetIconLocked(!1),function(){n.ZrusKontrolu(),n.click_func("cards","cmd=unlock")}),new ASC.ui.RibbonButton(i,ASC.ttls(1201),S.GetImage("remove_32"),function(){n.ZrusKontrolu(),n.click_func("cards","cmd=delete")}),t=this.ribbonMenu.addRibbon("options",ASC.ttls(1578).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3148),S.GetImage("school_32"),function(){n.ZrusKontrolu(),Promise.resolve().then(function(){return require("./school")}).then(function(t){return t.showSchoolDlg(o)})}),new ASC.ui.RibbonButton(i,ASC.ttls(2968),"/global/pics/ui/classroom_32.png",function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return require("./zadanie")})];case 1:return t.sent().showZadanieDlg(o,{table:"buildings"}),[2]}})})}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,v.action_name("tools"),v.action_icon("tools"),null,{menu:[{text:ASC.ttls(3296),onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./tools")})];case 1:return[2,t.sent().showMoveLessonsDlg(o)]}})})}},{text:ASC.ls(1641),onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./zadanie")})];case 1:return[2,t.sent().showZadanieDlg(o,{table:"ttreports"})]}})})}}]}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3316),S.GetImage("settings_basic_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return require("./settings")})];case 1:return t.sent().showSettingsDlg(o),[2]}})})}),t=this.ribbonMenu.addRibbon("help",ASC.ttls(2634).replace("&","")),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_back(i),i=new ASC.ui.RibbonGroup(t),this.InitRibbon_demos(i),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3204),S.GetImage("onlinehelp_32"),function(){var t="https://help.asctimetables.com/";"tr"==e.school_country&&(t="https://help.ascturkiye.com/"),window.open(t,"_blank")}),this.InitRibbon_feedback(i),this.jsc.asc_menu&&(i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,"ASC tools","/agenda/pics/online/files_back_32.png",null,{menu:h.__spreadArrays(this.jsc.asc_menu,[[],{text:"New dbForGen",onclick:function(){return h.__awaiter(n,void 0,void 0,function(){var e,i;return h.__generator(this,function(t){switch(t.label){case 0:return i=(e=console).log,[4,Promise.resolve().then(function(){return require("./server/generator")})];case 1:return[4,t.sent().ttdocDbForGen(null,o)];case 2:return[2,i.apply(e,[t.sent()])]}})})}},{text:"Restore deleted snapshot",onclick:function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./tools")})];case 1:return[2,t.sent().showRestoreDeletedSnapshotDlg()]}})})}},{text:"Anonymize TT",onclick:function(){return Promise.resolve().then(function(){return require("./asctools")}).then(function(t){return t.showAnonymizeTT(o)})}}])})),i=new ASC.ui.RibbonGroup(t,{right:!0}),this.InitRibbon_close(i)}if(t=this.ribbonMenu.addRibbon("printpreview",ASC.ttls(3351)),this.ribbonMenu.$labels.printpreview.addClass("special"),this.ribbonMenu.$labels.printpreview.hide(),this.ttviewer||(i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3349).replace(" ","\n"),S.GetImage("preview_back_32"),function(){n.m_pPrintPreview.PrevPage()},{cmd:"printpreview_prev"}),new ASC.ui.RibbonButton(i,ASC.ttls(3350).replace(" ","\n"),S.GetImage("preview_forward_32"),function(){n.m_pPrintPreview.NextPage()},{cmd:"printpreview_next"})),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ls(1638).replace(" ","\n"),S.GetImage("printer_32"),function(){n.m_pPrintPreview.Print()}),this.$rg_printpreview_div=$j(i.addDiv()).css("width","250px"),this.ttviewer||(i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3508),S.GetImage("filter_32"),function(){n.m_pPrintPreview.ClickFilter()}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3343),S.GetImage("preview_global_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./print_settings")})];case 1:return t.sent().showPrintGlobalSettingsDlg(o,this.m_pPrintPreview.m_pTlacZostava.m_Id),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(3342),S.GetImage("preview_modify_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./print_settings")})];case 1:return t.sent().showPrintStructureDlg(o,this.m_pPrintPreview.m_pTlacZostava.m_Id),[2]}})})}),new ASC.ui.RibbonButton(i,ASC.ttls(3344),S.GetImage("preview_extracolumns_32"),function(){return h.__awaiter(n,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./extracolumns")})];case 1:return t.sent().showExtraColumnsDlg(o,this.m_pPrintPreview.m_pTlacZostava.m_Id),[2]}})})}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(1324),S.GetImage("preview_style_32"),function(){n.click_func("print_style")}),new ASC.ui.RibbonButton(i,ASC.ttls(3345),S.GetImage("preview_sizes_32"),function(){n.click_func("print_sizes","tzid="+n.m_pPrintPreview.m_pTlacZostava.m_Id)}),new ASC.ui.RibbonButton(i,ASC.ttls(3124),S.GetImage("preview_design_32"),function(){n.click_func("print_design","tzid="+n.m_pPrintPreview.m_pTlacZostava.m_Id)}),new ASC.ui.RibbonButton(i,ASC.ttls(3346),S.GetImage("preview_color_32"),function(){n.click_func("print_colors","tzid="+n.m_pPrintPreview.m_pTlacZostava.m_Id)}),i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ttls(3348),S.GetImage("turn_off_32"),function(){n.ZrusPrintPreview()})),this.ttviewer){t=this.ribbonMenu.addRibbon("ttviewer","Timetable viewer (aSc)"),this.ribbonMenu.$labels.ttviewer.addClass("special"),this.ribbonMenu.$labels.ttviewer.hide(),this.ttviewer_ribbon=t,i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ls(1170),S.GetImage("preview_back_32"),function(){n.m_pPrintPreview.PrevPage()},{mini:!0,cmd:"printpreview_prev"}),new ASC.ui.RibbonButton(i,ASC.ls(1171),S.GetImage("preview_forward_32"),function(){n.m_pPrintPreview.NextPage()},{mini:!0,cmd:"printpreview_next"}),this.ttviewer_options.kiosk||new ASC.ui.RibbonButton(i,ASC.ls(1638).replace(" ","\n"),S.GetImage("printer_32"),function(){n.m_pPrintPreview.Print({selected_page:!0})},{mini:!0}),i=new ASC.ui.RibbonGroup(t);for(var l=0,c=["subjects","classes","teachers","classrooms","students"];l<c.length;l++){var m=c[l];new ASC.ui.RibbonButton(i,S.GetTableName(m),S.GetTableIcon(m),null,{menu:[],cmd:"ttviewer_"+m})}i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,ASC.ls(1250),"/global/pics/ui/summarytt_32.png",null,{menu:[],cmd:"ttviewer_summary"}),this.ttviewer_options.version_menu&&(i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,this.ttviewer_options.version_menu_label,"/global/pics/ui/ttversion_32.png",null,{menu:this.ttviewer_options.version_menu})),0<=["ascpalo","democz","test-democz","gjj","gvmyto","skolabn","spschrudim","zsnezamyslice","zsbrankovice"].indexOf(f.client_req.edupage)||["de","cz","at","ch","sk"].indexOf(f.client_req.school_country),this.ttviewer_options&&!this.ttviewer_options.kiosk&&(i=new ASC.ui.RibbonGroup(t),new ASC.ui.RibbonButton(i,f.client_req.ls(3964),"/global/pics/ui/try_new_32.svg",function(){return h.__awaiter(n,void 0,void 0,function(){var e,i;return h.__generator(this,function(t){switch(t.label){case 0:switch(i="",f.client_req.lang){case"sk":e=_.createElement("div",null,"DovoÄ¾te, aby sme vÃ¡m predstavili novÃ© zobrazenie rozvrhu. Odteraz v Åˆom neuvidÃ­te len Å¡tandardnÃ½ rozvrh, ale aj udalosti, suplovanie a odpadnutÃ© hodiny. Dokonca aj krÃºÅ¾ky a Å¡kolskÃ½ klub detÃ­ si viete jednoducho zobraziÅ¥ v pohÄ¾ade uÄiteÄ¾, Å¾iak, trieda. Tento novÃ½ pohÄ¾ad postupne nahradÃ­ ten pÃ´vodnÃ½.",_.createElement("br",null),"TeÅ¡Ã­me sa na vaÅ¡e postrehy."),i="https://help.edupage.org/text.php?id=3161&lang=sk";break;case"cz":e=_.createElement("div",null,"Dovolte, abychom vÃ¡m pÅ™edstavili novÃ© zobrazenÃ­ rozvrhu. OdteÄ v nÄ›m neuvidÃ­te jen standardnÃ­ rozvrh, ale i udÃ¡losti, suplovÃ¡nÃ­ a odpadlÃ© hodiny. Dokonce i krouÅ¾ky a Å¡kolnÃ­ klub dÄ›tÃ­ si umÃ­te jednoduÅ¡e zobrazit v pohledu uÄitel, Å¾Ã¡k, tÅ™Ã­da. Tento novÃ½ pohled postupnÄ› nahradÃ­ ten pÅ¯vodnÃ­. ",_.createElement("br",null),"TÄ›Å¡Ã­me se na vaÅ¡e postÅ™ehy."),i="https://help.edupage.org/text.php?id=3161&lang=sk";break;case"de":e=_.createElement("div",null,"Es ist soweit! Wir freuen uns, Ihnen hier unsere neue Stundenplanansicht zu prÃ¤sentieren.",_.createElement("br",null),"Ab sofort sehen Sie nicht nur die Stunden aus dem Stundenplan, sondern auch Termine, Vertretungen und entfallene Stunden. Auch die Interessensgruppen/AGs sehen Sie in der Lehrer-, SchÃ¼ler und Klassenansicht auf einen Blick. In KÃ¼rze wird diese Ansicht die alte Ansicht ersetzen.",_.createElement("br",null),"Wir freuen uns auf Ihr Feedback. (asc@raabe.de)"),i="https://help.edupage.org/text.php?id=3161&lang=de";break;default:e=_.createElement("div",null,"Let us introduce you to the new timetable viewer. From now you will not only be be able to view the standard timetable lessons but also events, substitution or cancelled lessons. Even interest or after-schoool clubs are available in the teacher, student or class view. This new viewer will eventualy replace the original one."),i="https://h.edupage.org/?p=u1/u3/u338/e3161"}return[4,p.RDialog.showConfirm(e,{width:500,footer:i&&(f.client_req.isAdmin()||f.client_req.isUcitel())?_.createElement(p.RButton,{label:v.action_name("help"),onClick:function(){return window.open(i,"_blank")}}):void 0})];case 1:return t.sent()&&(document.location.href="/timetable/current.php"),[2]}})})}))}this.ttviewer&&this.ribbonMenu.$top.hide()},a.prototype.UpdateButtons=function(){},a.prototype.ClickNew=function(){window.open("/timetable/online.php?cmd=new","_blank")},a.prototype.click_func=function(t,e){if(void 0===e&&(e=""),e+="&sync="+JSON.stringify(this.m_pSync.SendSyncData()),!this.m_pRadSelector.JeCelok()){for(var i=[],n=0,o=this.m_pRadSelector.m_Objects;n<o.length;n++){var r=o[n];i.push(r.m_Table+":"+r.m_Id)}e+="&rad_sel="+i.join(",")}this.ASC_action(t,e)},a.prototype.Sync=function(t){var e=this;"modified"in t&&(this.m_bModified=t.modified),"name"in t&&(this.m_DocName=t.name),"ss_ver"in t&&(this.m_ss_ver=t.ss_ver),this.m_pSync.ReceiveSyncData(t),this.UpdateWindowTitle(),this.ttviewer||(t.ce_ttdoc_last&&ASC.changeEvents.on(this.$content_d,"ttdoc:"+this.ttgpid,function(){e.SyncNow()},t.ce_ttdoc_last),t.ce_ttnum_last&&t.ttnum&&ASC.changeEvents.on(this.$content_d,"ttnum:"+t.ttnum,function(){e.SyncNow()},t.ce_ttnum_last))},a.prototype.SyncNow=function(){var e=this;return new Promise(function(t){e.jsc.closing?console.log("can't sync, closing."):(e.m_pSync.SetNeedsSync(),e.m_pSync.m_SyncCallbacks.push(t),e.m_pSync.SyncIfNeeded())})},a.prototype.OnResize=function(){},a.prototype.OnKeyDown=function(t){switch(t.keyCode){case 32:ASC.isBlockedUI()||this.ClickVerification("verification");break;case 65:if(t.ctrlKey)break;return!1;case 83:case 83:if(t.ctrlKey){this.click_func("save");break}return!1;case 84:if(t.ctrlKey){this.m_pPohladSwitcher.SetEnabled(!this.m_pPohladSwitcher.m_bEnabled);break}return!1;case 89:if(t.ctrlKey){this.click_func("undo","redo=1");break}return!1;case 90:if(t.ctrlKey){this.click_func("undo");break}return!1;default:return!1}return t.preventDefault(),t.stopPropagation(),!0},a.prototype.Zoom=function(t){this.m_pTriedyView.Zoom(t)},a.prototype.PodKurzorom=function(t){this.m_PodKurzoromMHodina.Equals(t)||(this.m_PodKurzoromMHodina.Set(t),this.m_pRozView.m_bInvalidPodKurzorom=!0,this.m_pTriedyView.m_bPreviewPodKurzorom&&(this.m_pTriedyView.m_bInvalidFarbyStlpcov=!0),this.Invalidate())},a.prototype.PodKurzoromClear=function(){var t=new u.CMHodina(this.m_pRok);this.PodKurzorom(t)},a.prototype.SetPreviewPodKurzorom=function(t){t!=this.m_pTriedyView.m_bPreviewPodKurzorom&&(this.m_pTriedyView.m_bPreviewPodKurzorom=t,this.m_pTriedyView.m_bInvalidFarbyStlpcov=!0,this.Invalidate())},a.prototype.OdhodKartu=function(){var t=new u.CMHodina(this.m_pRok);this.Chyt(t)},a.prototype.Chyt=function(t){this.PodKurzoromClear(),t.Equals(this.m_TahanaMHodina)||(this.m_TahanaMHodina.Set(t),this.InvalidateTahanaMHodina(),this.m_bTahanaDajKontrolu=!1)},a.prototype.ChytKartu=function(t,e){if(t){var i=new u.CMHodina(this.m_pRok);null!=e&&i.SetPozicia(e),i.Add(t),i.FinishAdding(),this.Chyt(i)}else this.OdhodKartu()},a.prototype.ChytKarty=function(t,e){if(0!=t.length){var i=new u.CMHodina(this.m_pRok);null!=e&&i.SetPozicia(e),i.Add_array(t),i.FinishAdding(),this.Chyt(i)}else this.OdhodKartu()},a.prototype.ChytSeminar=function(t,e){},a.prototype.SelectRiadok=function(t){this.m_pRadSelector.SetCelok(),t&&this.m_pRadSelector.AddRadObject(t)},a.prototype.ScrollToRiadok=function(e){if(e){var t=this.m_pTriedyView,i=t.GetPohladForTable(e.m_Table);i&&i!=t.m_pAktPohlad&&t.SetAktPohlad(i);var n=t.m_Riadky.find(function(t){return t.m_pRokObject==e});n&&t.ScrollToRiadky([n])}},a.prototype.InvalidateTahanaMHodina=function(){this.UpdateCursor(),this.m_pTriedyView.m_bInvalidFarbyRiadkov=!0,this.m_pTriedyView.m_bInvalidFarbyStlpcov=!0,this.Invalidate()},a.prototype.UpdateCursor=function(){var t=this.m_TahanaMHodina;if(!this.Cursor_Canvas){var e=ASC.createChild(document.body,"canvas","","display:none;position:absolute; pointer-events:none; z-index:1");this.Cursor_Canvas=e,this.Cursor_Canvas.width=32,this.Cursor_Canvas.height=32}if(t.IsEmpty())this.Cursor_Canvas.style.display="none",this.$content_d.css("cursor","default");else{var i=this.Cursor_Canvas.getContext("2d"),n=Math.min(this.m_pTriedyView.m_nSirkaPolicko,this.Cursor_Canvas.width-2),o=Math.min(this.m_pTriedyView.m_nVyskaRiadok,this.Cursor_Canvas.height-2);this.Cursor_Hotspot[0]=1+n/2,this.Cursor_Hotspot[1]=1+o/2,i.globalCompositeOperation="destination-out",i.fillRect(0,0,this.Cursor_Canvas.width,this.Cursor_Canvas.height),i.globalCompositeOperation="source-over",i.fillStyle="#808080",i.fillRect(0,0,n+2,o+2),i.globalCompositeOperation="destination-out",i.fillRect(1,1,n,o),i.globalCompositeOperation="source-over",this.m_pTriedyView.PaintMH(i,1,1,n,o,t);var r=this.$content_d.get(0),a="url("+this.Cursor_Canvas.toDataURL()+") "+this.Cursor_Hotspot[0]+" "+this.Cursor_Hotspot[1]+", crosshair";r.style.cursor=a}document.body.style.cursor="default"},a.prototype.CursorMove=function(t){this.CursorMove_Event=t,this.CursorMove_Validate()},a.prototype.CursorMove_Validate=function(){if(null!=this.CursorMove_Event){var t=this.CursorMove_Event;t.clientX,t.clientY,this.Cursor_Canvas&&(this.$content_d.css("cursor"),this.Cursor_Canvas.style.display="none"),this.CursorMove_Event=null}},a.prototype.InvalidateKarta=function(t,e){var i=new u.CMHodina(this.m_pRok);i.Add(t),i.FinishAdding(),this.InvalidateMHodina(i,e)},a.prototype.InvalidateDozor=function(t,e){this.m_pTriedyView.InvalidateObject(t.m_pUcebna),t.m_pUcitel&&this.m_pTriedyView.InvalidateObject(t.m_pUcitel),this.Invalidate(),e||this.m_pSync.AddLocalChange(t)},a.prototype.InvalidateHodina=function(t){var e=this;t.m_Karty.forEach(function(t){e.InvalidateKarta(t)})},a.prototype.InvalidateObject=function(t,e){t&&(t instanceof d.CKarta?this.InvalidateKarta(t,e):t instanceof d.CDozor?this.InvalidateDozor(t,e):t instanceof d.CHodina?this.InvalidateHodina(t):t instanceof d.CZiakPredmet?this.InvalidateObject(t.m_pZiak,e):(t instanceof k&&this.InvalidatePohladSwitcher(),this.m_pTriedyView.InvalidateObject(t)),0<=["ttreports","periods","breaks","cards","subjects"].indexOf(t.m_Table)&&this.InvalidatePrintPreview(),"globals"==t.m_Table&&this.InvalidatePrintPreview(),"classrooms"==t.m_Table&&this.m_pTriedyView.JePohladDozory()&&this.InvalidateTriedyView(),this.Invalidate(),e||this.m_pSync.AddLocalChange(t))},a.prototype.InvalidatePending=function(){this.m_pRozView.m_bInvalid=!0,this.Invalidate()},a.prototype.InvalidateTriedyView=function(){this.m_pTriedyView.m_bInvalidAll=!0,this.Invalidate()},a.prototype.InvalidateTriedyViewRiadky=function(){for(var t=0,e=this.m_pTriedyView.m_Riadky;t<e.length;t++)e[t].m_bInvalid=!0;this.Invalidate()},a.prototype.InvalidatePohladSwitcher=function(){this.m_pPohladSwitcher.m_bInvalid=!0,this.Invalidate()},a.prototype.InvalidatePrintPreview=function(){this.m_pPrintPreview&&(this.m_pPrintPreview.m_bInvalid=!0,this.Invalidate())},a.prototype.InvalidateSelector=function(){this.m_pTriedyView.m_bInvalidFarbyRiadkov=!0,this.InvalidatePending()},a.prototype.InvalidateMHodina=function(t,e){if(this.m_pTriedyView.InvalidateMHodina(t),this.m_pRozView.m_bInvalid=!0,this.Invalidate(),!e){for(var i=0,n=t.Karty();i<n.length;i++){var o=n[i];this.m_pSync.AddLocalChange(o)}for(var r=0,a=t.Hodiny();r<a.length;r++){var s=a[r];1<s.m_pObdobie.terms.m_BitovePole.length&&this.m_pSync.AddLocalChange(s)}}},a.prototype.Validate=function(){this.CursorMove_Validate(),this.m_pPohladSwitcher.Validate(),this.m_pTriedyView.Validate(),this.m_pRozView.Validate(),this.m_pSync.Validate(),this.m_pSync.UpdateDebug(),this.m_pPrintPreview&&this.m_pPrintPreview.Validate(),this.UpdateButtons()},a.prototype.Invalidate=function(){var t=this;this.Validate_scheduled||(window.setTimeout(function(){t.Validate_scheduled=!1,t.Validate()},0),this.Validate_scheduled=!0)},a.prototype.ShowAlgData=function(){this.ASC_action("algdata","")},a.prototype.ASC_action=function(t,e,i){void 0===e&&(e=""),this.jsc.ASC_action(t,e,i)},a.prototype.ZobrazKontrolu=function(t,e){var i=this;this.Validate(),this.ZrusKontrolu(),this.m_nKontrolaMode=c.KONTROLAMODE_KONTROLA,"listconstraints"==e&&(this.m_nKontrolaMode=c.KONTROLAMODE_PODMIENKY),"change"==e&&(this.m_nKontrolaMode=c.KONTROLAMODE_CHANGE);var n=[];this.m_ChybaItemsI={},t.forEach(function(t){var e=new m.CChybaItem(i.m_pRok,t);n.push(e)}),this.m_pRozView.ZobrazKontrolu(n,e),this.InvalidateTriedyView(),this.ribbonMenu.findButtonsByCmd("verification").forEach(function(t){t.selected(i.m_nKontrolaMode==c.KONTROLAMODE_KONTROLA)}),this.ribbonMenu.findButtonsByCmd("listconstraints").forEach(function(t){t.selected(i.m_nKontrolaMode==c.KONTROLAMODE_PODMIENKY)}),this.trackEvent("Verification",e)},a.prototype.JeKontrola=function(){return this.m_nKontrolaMode!=c.KONTROLAMODE_VYPNUTA},a.prototype.ZrusKontrolu=function(){this.JeKontrola()&&(this.m_nKontrolaMode=c.KONTROLAMODE_VYPNUTA,this.m_pRozView.ZrusKontrolu(),this.ribbonMenu.findButtonsByCmd("verification").forEach(function(t){t.selected(!1)}),this.ribbonMenu.findButtonsByCmd("listconstraints").forEach(function(t){t.selected(!1)}),this.m_ChybaItemsI={},this.m_pKontrolaItem=null,this.InvalidateTriedyView())},a.prototype.EnsureSynced=function(){return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return 0<this.m_pSync.CountChanges()?[4,this.SyncNow()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},a.prototype.ClickGenerate=function(n){return void 0===n&&(n={}),h.__awaiter(this,void 0,void 0,function(){var e,i;return h.__generator(this,function(t){switch(t.label){case 0:return e=void 0,n.sel&&(e=Array.isArray(n.sel)?n.sel:(i=this.m_pRadSelector).JeCelok()?void 0:i.m_Objects.map(function(t){return[i.m_Table,t.m_Id]})),[4,Promise.resolve().then(function(){return require("./gener")})];case 1:return t.sent().showStartGenerDlg(this.ttgpid,{sel:e}),[2]}})})},a.prototype.ClickTest=function(){return h.__awaiter(this,void 0,void 0,function(){return h.__generator(this,function(t){switch(t.label){case 0:return this.ZrusKontrolu(),[4,Promise.resolve().then(function(){return require("./test")})];case 1:return t.sent().showTestDlg(this),[2]}})})},a.prototype.ClickVerification=function(n,o){return void 0===o&&(o="all"),h.__awaiter(this,void 0,void 0,function(){var e,i;return h.__generator(this,function(t){switch(t.label){case 0:return this.JeKontrola()?(this.ZrusKontrolu(),[2]):this.JeKontrola()?(this.ZrusKontrolu(),[2]):[4,this.EnsureSynced()];case 1:return t.sent(),e=this.m_pRadSelector,[4,ASC.blockUI(r.runTTVerification(null,this.ttgpid,n,{sel:"sel"!=o||e.JeCelok()?void 0:e.m_Objects.map(function(t){return[e.m_Table,t.m_Id]})}),{simle:!0})];case 2:return i=t.sent(),this.ZobrazKontrolu(i.listNajdeneChyby,n),[2]}})})},a.prototype.ClickPrintPreview=function(t){void 0===t&&(t={}),this.m_bPrintPreview?this.ZrusPrintPreview():this.PrintPreview(t)},a.prototype.PrintPreview=function(t){if(void 0===t&&(t={}),this.ZrusKontrolu(),!this.m_bPrintPreview){this.m_bPrintPreview=!0;var e="printpreview";t.ttviewer&&(e="ttviewer"),this.$content_d.hide(),this.$printpreview_d.show().toggleClass("ttviewer","ttviewer"==e),this.ribbonMenu.findButtonsByCmd(e).forEach(function(t){t.selected(!0)}),this.ribbonMenu.select(e),this.ribbonMenu.$labels[e].show(),new i.CPrintPreview(this,t)}},a.prototype.ZrusPrintPreview=function(){if(this.m_bPrintPreview){this.$printpreview_d.hide(),this.$content_d.show(),this.m_bPrintPreview=!1;for(var t=0,e=["printpreview","ttviewer"];t<e.length;t++){var i=e[t];this.ribbonMenu.findButtonsByCmd(i).forEach(function(t){t.selected(!1)}),this.ribbonMenu.findButtonsByCmd(i).forEach(function(t){t.selected(!1)}),this.ribbonMenu.active==i&&this.ribbonMenu.select("main");var n=this.ribbonMenu.$labels[i];n&&n.hide()}this.m_pPrintPreview&&this.m_pPrintPreview.Destroy(),this.m_pPrintPreview=null,this.InvalidateTriedyView()}},a.prototype.UpdateWindowTitle=function(){if(!this.ttviewer){var t=ASC.ttls(1079);this.m_DocName&&(t=this.m_DocName+(this.m_ss_ver?" #"+this.m_ss_ver:"")+" - "+t),this.m_bModified&&(t="*"+t),$j("head title").text(t),$j("head link[rel='shortcut icon']").attr("href","/global/pics/ui/timetables_64.png")}},a.prototype.Fail=function(t){t=t||"Unknown error (9095935213)",ASC.ASC_messageBox(t)},a.prototype.ShowHelp=function(t){void 0===t&&(t="");var e="http://help.asctimetables.com/text.php?text="+t;ASC.windowOpenINP(e)},a.prototype.PrintSetFilter=function(t){this.m_pPrintPreview.SetFilter(t)},a.prototype.PrintSettingsChanged=function(){this.m_pPrintPreview.SettingsChanged()},a);function a(t){var o=this;this.ttviewer=!1,this.ttviewer_options=null,this.ttviewer_ribbon=null,this.$rg_pohlad_div=null,this.m_bModified=!1,this.m_DocName="",this.m_ss_ver="",this.Cursor_Canvas=null,this.Cursor_Hotspot=[0,0],this.m_nRozViewHeight=110,this.m_nKontrolaMode=c.KONTROLAMODE_VYPNUTA,this.m_bTahanaDajKontrolu=!1,this.m_pPrintPreview=null,this.Validate_scheduled=!1,this.formatLesson=null,this.CursorMove_Event=null,this.m_ChybaItemsI={},this.m_pKontrolaItem=null,this.m_bPrintPreview=!1,this.jsc=t,(this.jsc.app=this).ttgpid=t.ttgpid,l.farby=t.farby,t.ttviewer&&(this.ttviewer=!0,this.ttviewer_options=t.ttviewer_options),this.$dcvar=$j(this.jsc.dcvar),this.$dcvar.css("padding","0px");var e=$j("<div class='ttonline' style='min-height:80vh'><div id='ttonline_ribbon'/><div id='ttonline_content'/><div id='ttonline_printpreview' style='display:none'/></div></div>").appendTo(this.$dcvar);this.ttviewer?e.css("height","100%"):e.css("height","100vh"),"ie11"==ASC.browser&&e.css("display","block"),this.ribbonMenu=new ASC.ui.RibbonMenu(this.$dcvar.find("#ttonline_ribbon")),this.$content_d=this.$dcvar.find("#ttonline_content"),this.$printpreview_d=this.$dcvar.find("#ttonline_printpreview"),$j("<div class='asc-gadget-jsc' style='display:none'/>").appendTo(this.$dcvar)[0].ASC_gjsc={ASC_gpid:this.ttgpid},this.m_pRok=new d.CRok,(this.m_pRok.m_pRozApp=this).dbi=this.m_pRok.dbi,this.m_pSync=new b(this),this.m_pRadSelector=new m.CRadSelector(this),this.m_PodKurzoromMHodina=new u.CMHodina(this.m_pRok),this.m_TahanaMHodina=new u.CMHodina(this.m_pRok);var i=$j("<div style='flex: 1 1 0px;min-height:0px;display:flex;flex-direction:row;'>").appendTo(this.$content_d),n=$j("<div style=''>").appendTo(i),r=$j("<div style='flex: 1 1 0px; min-width: 0px'>").appendTo(i);this.m_pPohladSwitcher=new u.CPohladSwitcher(this,n),this.m_pTriedyView=new u.CTriedyView(this,r);var a=new ASC.ui.FlexSplitPane(this.$content_d,{vertical:!1});this.m_pRozView=new m.CRozView(this,$j("<div>").appendTo(this.$content_d)),a.$div.on("moved",function(t){o.m_nRozViewHeight=parseInt(o.m_pRozView.$div.get(0).style.height),o.Invalidate()}),this.InitRibbon(),this.m_pTriedyView.FillRibbonCombos();var s=this;this.m_OnMouseOverKarta=function(){var t=function(t){var e=t.ASC_karta;if(e)return(i=new u.CMHodina(o.m_pRok)).Add(e),i.FinishAdding(),i;if(t.ASC_dozor){var i,n=t.ASC_dozor;return(i=new u.CMHodina(o.m_pRok)).Add(n),i.FinishAdding(),i}return t.ASC_mh?t.ASC_mh:void 0}(this);t&&s.PodKurzorom(t)},this.m_OnMouseOutKarta=function(){s.PodKurzoromClear()},this.m_OnMouseClickKarta=function(t){var e=this.ASC_karta;if(s.m_TahanaMHodina.IsEmpty()){s.ZrusKontrolu();var i=s.m_pTriedyView.GetPolickoE(t);if(!i)return;this.parentNode.ASC_vriadok.m_pRokObject.UI_KartaVyberOdtialto(s,i,e,t),ASC.hideContextMenu(),s.m_OnMouse_StopEvent(t)}},this.m_OnMouseRightClickKarta=function(t){if(s.ZrusKontrolu(),!s.m_TahanaMHodina.IsEmpty())return s.OdhodKartu(),void s.m_OnMouse_StopEvent(t);var e=this.ASC_karta;e&&(s.m_pTriedyView.RightClickKarta($j.event.fix(t),e),s.m_OnMouse_StopEvent(t))},this.m_OnMouseRightClickDozor=function(t){if(s.ZrusKontrolu(),!s.m_TahanaMHodina.IsEmpty())return s.OdhodKartu(),void s.m_OnMouse_StopEvent(t);var e=this.ASC_dozor;e&&(s.m_pTriedyView.RightClickDozor($j.event.fix(t),e),s.m_OnMouse_StopEvent(t))},this.m_OnMouse_StopEvent=function(t){t.stopPropagation(),t.preventDefault()},this.ttviewer||($j(document).on("keyup keydown",function(t){return o.SetPreviewPodKurzorom(!!t.shiftKey),!0}),$j(document).on("keydown",function(t){if(!ASC.ui.getFocusedDialog())return!o.OnKeyDown(t)&&void 0}),$j(window).on("beforeunload",function(){if(!o.jsc.closing){var t=!1;return o.m_bModified&&(t=!0),0<o.m_pSync.CountChanges()&&(t=!0),t?ASC.ls(6122):void 0}})),this.InvalidatePending(),this.Invalidate(),this.ttviewer||this.m_pSync.StartUpdater(),this.trackEvent("App","initialized")}l.CRozApp=o;var b=(y.prototype.AddLocalChange=function(t){var e=t.m_Table;if(e in this.m_Local_Changes){this.m_Local_ModCount++,this.m_Local_Changes[e][t.m_Id]=!0;var i=this.m_pRozApp.ribbonMenu;i.findButton("undo").enabled(!0),i.findButton("redo").enabled(!1)}},y.prototype.SendSyncData=function(){var t=this.m_pRok,e={modCount:this.m_Remote_ModCount,localModCount:this.m_Local_ModCount,changes:{}};for(var i in this.m_Local_Changes)if(ASC.count(this.m_Local_Changes[i])){var n=y.change_cols[i];if(n)for(var o in e.changes[i]={},this.m_Local_Changes[i]){var r=t.m_ObjectsI[i][o];if(r){for(var a=r.m_Data,s={},l=0,c=n;l<c.length;l++){var m=c[l];m in a&&(s[m]=a[m])}e.changes[i][o]=s}}}return this.m_bVerbose&&0<ASC.count(e.changes)&&console.log("SendSyncData: "+JSON.stringify(e)),this.UpdateDebug(),e},y.prototype.ReceiveSyncData=function(t){var _=this.m_pRok,u=this.m_pRozApp,e=t.localModCount==this.m_Local_ModCount,n={};if(t.changes&&t.changes.forEach(function(t){var r=t.table,e=t.rows;0!=e.length&&(n[r]=!0,e.forEach(function(t){var e=t.id,i=_.m_ObjectsI[r][e];if(i){for(var n in u.InvalidateObject(i,!0),i.BeforeRemove(),t)i.m_Data[n]=t[n];i.InitFromData(),u.InvalidateObject(i,!0)}else{var o=ASC.clone(t);o.id=""+e,i=_.addRow(r,o),_.dbi.addOrUpdateRow(r,o),u.InvalidateTriedyView(),u.InvalidatePending(),u.InvalidateObject(i,!0)}}))}),t.deletes&&t.deletes.forEach(function(t){var e=t.table,i=t.ids;0!=i.length&&(n[e]=!0,i.forEach(function(t){_.m_ObjectsI[e][t]&&(_.deleteRow(e,t),u.InvalidateTriedyView(),u.InvalidatePending())}))}),t.orders&&t.orders.forEach(function(t){for(var e=t.table,i=t.ids,n=_.m_ObjectsO[e],o=n.slice(0,n.length),r={},a=n.length=0,s=i;a<s.length;a++){var l=s[a];if(!(h=_.m_ObjectsI[e][l]))return;n.push(h),r[l]=!0}for(var c=0,m=o;c<m.length;c++){var h;r[(h=m[c]).m_Id]||n.push(h)}u.m_pTriedyView.m_pAktPohlad&&u.m_pTriedyView.m_pAktPohlad.m_RowTable==e&&u.InvalidateTriedyView(),"groups"==e&&(_.m_ObjectsO.classes.forEach(function(t){t.m_Delenia.forEach(function(t){t.UpdatePoradieSkupin()})}),u.InvalidateTriedyView())}),(n.periods||n.daysdefs||n.weeksdefs||n.termsdefs||n.ttviews)&&(_.StructureFromData(),u.InvalidateTriedyView()),!u.ttviewer){var i=u.ribbonMenu;"undo_enabled"in t&&i.findButton("undo").enabled(t.undo_enabled),"redo_enabled"in t&&i.findButton("redo").enabled(t.redo_enabled)}if(e)for(var o in this.m_Local_Changes)this.m_Local_Changes[o]={};this.m_Remote_ModCount=t.modCount,this.m_bVerbose,t.apps&&JSON.stringify(t.apps)!=JSON.stringify(this.m_Apps)&&(this.m_Apps=t.apps,this.m_bInvalid_otherUsers=!0,this.m_pRozApp.m_pTriedyView.m_bInvalidFarbyRiadkov=!0,this.m_pRozApp.Invalidate(),this.m_bVerbose&&console.log("NewApps: "+JSON.stringify(this.m_Apps))),this.UpdateDebug()},y.prototype.CountChanges=function(){var t=0;for(var e in this.m_Local_Changes)t+=ASC.count(this.m_Local_Changes[e]);return t},y.prototype.UpdateDebug=function(){var t=this.$debug;t&&(t.css("white-space","pre"),t.text("remoteModCount="+this.m_Remote_ModCount+"\nlocalModCount="+this.m_Local_ModCount+"\nchanges="+this.CountChanges()+"\n"))},y.prototype.SyncIfNeeded=function(i){var n=this;if(void 0===i&&(i=0),!this.m_bSyncing&&this.m_bNeedsSync){var o=this.m_SyncCallbacks;this.m_SyncCallbacks=[],this.m_bNeedsSync=!1,this.m_bSyncing=!0;var t=this.SendSyncData();if(0<ASC.count(t.changes)){var e="";for(var r in t.changes)e+=(e?"_":"")+r;e&&this.m_pRozApp.trackEvent("SyncLocal",e)}this.m_pRozApp.ASC_action("sync","sync="+encodeURIComponent(JSON.stringify(t)),{modal:!1,timeout:6e4,success2:function(){n.m_bSyncing=!1;for(var t=0,e=o;t<e.length;t++)(0,e[t])();n.m_bNeedsSync&&i<3&&n.SyncIfNeeded(i+1)},failure:function(){n.m_bSyncing=!1}})}},y.prototype.SetNeedsSync=function(){this.m_bNeedsSync=!0},y.prototype.StartUpdater=function(){var e=this,i=!0,n=function(){var t=5e3;(i||1<e.m_Apps.length)&&(t=1e3),window.setTimeout(function(){0<e.CountChanges()&&(e.SetNeedsSync(),e.SyncIfNeeded()),i=!1,n()},t)};n()},y.prototype.UpdateOtherUsers=function(){var n=this;this.$other_users.empty();var o=[],r=[];if(this.m_Apps.forEach(function(t){if(t.my)r.push(t);else{var e=t.sh;if(!(0<=o.indexOf(e))){o.push(e);var i=$j("<span class='user'>").appendTo(n.$other_users);i.text(t.un),i.css("background-color",t.c)}}}),0<r.length&&1<r.length){var t=r[0],e=$j("<span class='user'>").appendTo(this.$other_users);e.text(ASC.ls(1751)+(1<r.length?" ("+r.length+")":"")),e.css("background-color",t.c)}this.m_bInvalid_otherUsers=!1},y.prototype.Validate=function(){this.m_bInvalid_otherUsers&&this.UpdateOtherUsers()},y.prototype.GetFarbyUserov=function(t){var e=t.m_Table,i=t.m_Id,n=null;return this.m_Apps.forEach(function(t){!t.my&&t.cr&&e in t.cr&&(ASC.indexOf(t.cr[e],i)<0||(n?n.push(t.c):n=[t.c]))}),n},y.change_cols={cards:["period","days","weeks","terms","classroomids","locked"],lessons:["terms"],classes:["timeoff"],teachers:["timeoff"],classrooms:["timeoff"],subjects:["timeoff"],studentsubjects:["locked","seminargroup"],classroomsupervisions:["teacherid","locked"]},y);function y(t){this.m_Local_ModCount=0,this.m_Local_Changes={cards:{},lessons:{},classes:{},teachers:{},classrooms:{},subjects:{},studentsubjects:{},classroomsupervisions:{}},this.m_Remote_ModCount=0,this.m_Apps=[],this.m_bVerbose=!0,this.m_bSyncing=!1,this.m_bNeedsSync=!1,this.m_SyncCallbacks=[],this.m_bInvalid_otherUsers=!1,this.m_pRozApp=t,this.m_pRok=t.m_pRok,this.$other_users=this.m_pRozApp.ribbonMenu.$right}var g,k=(g=d.CRokObject,h.__extends(T,g),T.prototype.GetNazov=function(){return this.m_Data.name},T.prototype.InitFromData=function(){var t=this.m_Data;this.m_Typ=t.typ,this.texttables=t.texttables,this.colortable=t.colortables.length?t.colortables[0]:"",this.m_RowTable=t.table,this.m_Icon=t.icon,this.m_Hidden=ASC.boolVal(t.hidden)},T.prototype.GetRiadkyObjects=function(){if("classroomsupervision"!=this.m_Typ)return"custom"==this.m_Typ?"classes"==this.m_RowTable?this.m_pRok.ids2ro("classes",this.m_Data.classids):"teachers"==this.m_RowTable?this.m_pRok.ids2ro("teachers",this.m_Data.teacherids):"classrooms"==this.m_RowTable?this.m_pRok.ids2ro("classrooms",this.m_Data.classroomids):[]:this.m_pRok.m_ObjectsO[this.m_RowTable];for(var t=[],e=0,i=this.m_pRok.TableObjects("classrooms");e<i.length;e++){var n=i[e];ASC.boolVal(n.m_Data.needssupervision)&&t.push(n)}return t},T.prototype.GetRiadkyTable=function(){return this.m_RowTable},T.prototype.UI_VhodnostTahanejMHodiny=function(t,e){if("classrooms"==this.m_RowTable){for(var i=0,n=t.Karty();i<n.length;i++)if(n[i].JeTu_Policko(e))return"1";return"0"}var o="1";t.Karty().forEach(function(t){if(!t.Obdobia_MozeSem_TWDH(e.m_nTerm,e.m_nWeek,e.m_nDay,-1))return"0";t.Obdobia_MozeSem_TWDH(e.m_nTerm,-1,-1,-1,!0)||(o="?")});var r=[];if(t.Ucitelia().forEach(function(t){r.push(t.timeoff())}),t.Predmety().forEach(function(t){r.push(t.timeoff())}),r.forEach(function(t){o=s.defaultVolnoJoiner(o,s.timeoff_get(t,e.m_nTerm,e.m_nWeek,e.m_nDay,e.period))}),"0"!=o){var a=[];"classes"!=this.m_RowTable&&"classrooms"!=this.m_RowTable||t.Ucitelia().forEach(function(t){t.AddKartyTu(a,e.m_nTerm,e.m_nWeek,e.m_nDay,e.period,0)}),0!=a.length&&(o="x")}return o},T);function T(t,e){var i=g.call(this,t,"ttviews",e)||this;return i.m_Typ="",i.texttables=[],i.colortable="",i.m_RowTable="classes",i.m_Hidden=!1,i.m_nVyskaRiadok=u.nDefaultVyskaRiadok,i.m_nScrollPos=0,i.m_pRozApp=t.m_pRozApp,i.m_pTriedyView=t.m_pRozApp.m_pTriedyView,i.InitFromData(),i}l.CPohlad=k;var S=(R.RovnakyList=function(t,e){if(t.length!=e.length)return!1;for(var i=0;i<t.length;i++)if(t[i]!=e[i])return!1;return!0},R.GetImage=function(t){return ASC.tt.GetImage(t)},R.GetTableIcon=function(t){return ASC.tt.GetTableIcon(t)},R.GetTableName=function(t){switch(t){case"classes":return ASC.ls(1194);case"classrooms":return ASC.ls(1007);case"teachers":return ASC.ls(1005);case"subjects":return ASC.ls(1008);case"students":return ASC.ls(1006);case"lessons":return ASC.ls(1460)}return""},R.PaintFarbyToRect=function(t,e,i,n,o,r){var a=0<t.length?t[0]:"#ffffff";e.fillStyle=a,e.fillRect(i,n,o,r)},R.GetTextExtent=function(t,e){var i=t.measureText(e),n=t.measureText("M");return{cx:i.width,cy:n.width}},R.PaintTextToRect=function(t,e,i,n,o,r,a,s){if(void 0===a&&(a=0),void 0===s&&(s=0),0!=t.length){e.textBaseline="top",e.textAlign="left";var l=o,c=r;c+=1;var m=t,h=t.length,_=[],u=[],d=0,p=0,f=0,v=0;for(_[d=0]=v,u[0]=h;!(h<=v);){for(var b=v,y=b,g=!1;;){var k,T;if(g)for(var S=b;;){if(" "==m[S]){k=S+1,T=S;break}if(h<=(S+=1)){T=k=S;break}}else k=b+1," "==m[b]?(T=b,g=!0):T=k;if(v<b&&(w=R.GetTextExtent(e,t.substring(v,T))).cx>l)break;if(y=T,h<=(b=k))break}if((w=R.GetTextExtent(e,t.substring(v,y))).cx-=1,p+w.cy>c&&1<=d)break;if(f=Math.max(f,w.cx),p+=w.cy,u[d]=y-_[d],_[d+1]=b,u[d+1]=h-b,v=b,10<=++d)break}var C=i;0==a&&(C+=(l-f)/2),0<a&&(C+=l-f);var A=n;for(0==s&&(A+=(c-p)/2),0<s&&(A+=c-p),A-=2,S=0;;){var w,I=_[S];if(h=u[S],e.fillText(t.substr(I,h),C,A),d<=++S)break;(w=R.GetTextExtent(e,t.substr(I,h))).cy-=1,A+=w.cy}}},R.IsEventInside=function(t,e){var i=t.pageX-e.offset().top,n=t.pageY-e.offset().left;return 0<=i&&0<=n&&i<e.width()&&n<e.height()},R.FastRemove=function(t,e){var i=t.indexOf(e);0<=i&&(t[i]=t[t.length-1],t.length--)},R.IsEventRightButton=function(t){return 2==t.button},R.AddToSet=function(t,e){e.indexOf(t)<0&&e.push(t)},R.AddListToSet=function(t,e){for(var i=0;i<t.length;i++)R.AddToSet(t[i],e)},R.OpenDialog=function(t,e){void 0===e&&(e={}),e.modal=!0,t=t||ASC.ttls(1079),e.title=ASC.escapeHTML(t);var i=new ASC.ui.Dialog(e);return i.center(),i.show(),i},R.GetUINazov=function(t,e){return void 0===e&&(e="name"),R.GetUINazov2(t,null,e)},R.GetUINazov2=function(t,e,i){if(void 0===e&&(e=null),void 0===i&&(i="short_name"),!t)return"";if(e)return"short_name"==i&&"classes"==t.m_Table&&"subjects"==e.m_Table?"("+t.GetSkratka()+":"+e.GetSkratka()+") "+t.GetNazov()+": "+e.GetNazov():R.GetUINazov(t,i)+" : "+R.GetUINazov(e,i);var n=t.m_pRok;switch(t.m_Table){case"cards":var o=t,r=R.GetUINazov(o.m_pHodina)+" - ";return o.JeUmiestnena()?r+=R.GetUINazov(n.GetDen_bits(o.days()),"short")+":"+R.GetUINazov(n.GetPeriod(o.GetHodina()),"short"):r+=ASC.ttls(1765),r;case"lessons":var a=t,s=new u.CMHodina(n);return s.Add(a),s.FinishAdding(),r=s.GetText("subjects"),0<s.m_nPoradieSeminaru&&(r+=" "+s.GetText("seminargroup")),r+=" (",0==s.m_Objects.classes.length?r+="Without class":r+=s.GetText("classes","short"),r+=")",0!=s.m_Skupiny.length&&(r+=" "+s.GetText("groups")),r;case"daysdefs":case"weeksdefs":case"termsdefs":case"periods":case"classes":case"teachers":case"subjects":case"classrooms":case"coursegroups":return"short_name"==i?"("+t.GetSkratka()+") "+t.GetNazov():t.GetNazov(i);case"students":return t.m_pTrieda.GetSkratka()+" - "+t.GetNazov();case"globals":return ASC.ttls(3756)}return"???"+t.m_Table},R.GetUINazvy=function(t,e){void 0===e&&(e="short");var i="";return t.forEach(function(t){""!=i&&(i+=", "),i+=R.GetUINazov(t,e)}),i},R.GetUINazovSTypom=function(t){return t?R.GetTableItemTypNazov(t.m_Table,1)+": "+this.GetUINazov(t):""},R.GetIconTimeOff=function(){return R.GetImage("timeoff_32")},R.GetIconConstraints=function(){return R.GetImage("constraints_32")},R.GetIconDivision=function(){return R.GetImage("division_32")},R.GetIconLessons=function(){return R.GetTableIcon("lessons")},R.GetIconNic=function(){return"/global/pics/ui/nic_32.png"},R.GetIconLocked=function(t,e){return void 0===e&&(e=!1),t?R.GetImage("lock_32"):e?"":R.GetImage("unlock_32")},R.GetIconOK=function(){return"/timetable/pics/app/ok_32.png"},R.GetIconVhodnost=function(t){switch(t){case"1":return R.GetImage("ok_32");case"?":return R.GetImage("question_32");case"0":return R.GetImage("no_32")}return""},R.AddMenuItemSmart=function(t,e,i){void 0===i&&(i={});var n=i.data,o={text:"",cmd:e};switch(void 0!==n&&(o.data=n),e){case"edit":o.text=ASC.ttls(1017);break;case"timeoff":o.text=ASC.ttls(1118),o.icon=R.GetIconTimeOff();break;case"timeoff:0":o.text=ASC.ttls(1122),o.icon=R.GetImage("no_32");break;case"timeoff:?":o.text=ASC.ttls(1121),o.icon=R.GetImage("question_32");break;case"timeoff:1":o.text=ASC.ttls(1120),o.icon=R.GetImage("ok_32");break;case"constraints":o.text=ASC.ttls(3071),o.icon=R.GetIconConstraints();break;case"lessons":o.text=ASC.ttls(1032),o.icon=R.GetIconLessons();break;case"divisions":o.text=ASC.ttls(1031),o.icon=R.GetIconDivision();break;case"deletecards":o.text=ASC.ttls(1712),o.icon=R.GetIconNic();break;case"unlockcard":o.icon=R.GetIconLocked(!1);break;case"lockcard":o.icon=R.GetIconLocked(!0);break;case"putcard":n instanceof d.CRokObject&&(o.text=R.GetUINazov(n));break;case"editlesson":o.text=ASC.ttls(1059),o.icon=R.GetImage("edit_32");break;case"test":o.text=ASC.ttls(2047),o.icon=R.GetImage("test_32");break;case"verification":o.text=ASC.ttls(1616),o.icon=R.GetImage("verification_32");break;case"listconstraints":o.text=ASC.ttls(3719),o.icon=R.GetImage("constraints_32");break;case"printpreview":o.text=ASC.ls(1837),o.icon=R.GetImage("print_preview_32")}n instanceof d.CRokObject&&(o.icon=R.GetTableIcon(n.m_Table),o.text||(o.text=R.GetUINazov(n))),"icon"in i&&(o.icon=i.icon),"text"in i&&(o.text=i.text),"disabled"in i&&(o.disabled=i.disabled),"submenu"in i&&(o.submenu=i.submenu),"checked"in i&&(o.checked=i.checked),"onclick"in i&&(o.onclick=i.onclick),o.icon||(o.icon=R.GetIconNic()),o.text||(o.text="???"+e),t.push(o)},R.GetTableItemTypNazov=function(t,e){switch(t){case"classrooms":return 1==e?ASC.ttls(1092):ASC.ttls(1085);case"teachers":return 1==e?ASC.ttls(1048):ASC.ttls(1038);case"subjects":return 1==e?ASC.ttls(1011):ASC.ttls(1021);case"classes":return 1==e?ASC.ttls(1035):ASC.ttls(1026);case"lessons":return 1==e?ASC.ttls(1063):ASC.ttls(2531);case"students":return 1==e?ASC.ttls(2956):ASC.ttls(2604);case"days":case"daysdefs":return 1==e?ASC.ls(1465):ASC.ls(1693);case"studentsubjects":return R.GetTableItemTypNazov("students",e)+"/"+R.GetTableItemTypNazov("subjects",e)}return R.GetTableName(t)},R.ZasedniColor=function(t){var e=R.ZasedniColor_cache[t];if(!e){var i=parseInt(t.substr(1,2),16)+parseInt(t.substr(1,2),16)+parseInt(t.substr(1,2),16),n=(Math.round(50*i/765)+200).toString(16);1==n.length&&(n="0"+n),e="#"+n+n+n,R.ZasedniColor_cache[t]=e}return e},R.ZasedniColors=function(t){for(var e=[],i=0,n=t;i<n.length;i++){var o=n[i];e.push(R.ZasedniColor(o))}return e},R.StringHash=function(t){var e,i,n=0;if(0===t.length)return n;for(e=0,i=this.length;e<i;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return n},R.GetIconImportance=function(t){return"/timetable/pics/app/relations/importance_"+t+"_16.png"},R.AdvFilterPopis=function(t){var e="",i=t&R.VZTAH_ADV_OPTIONS_MASK_LENGTH;switch(0!=i&&(""!=e&&(e+=", "),e+=ASC.ttls(1640)+": "+i),t&R.VZTAH_ADV_OPTIONS_ENTIRECLASS&&(""!=e&&(e+=", "),e+=ASC.ttls(1643)),t&R.VZTAH_ADV_OPTIONS_DIVIDED&&(""!=e&&(e+=", "),e+=ASC.ttls(1178)),t&R.VZTAH_ADV_OPTIONS_SEMINAR&&(""!=e&&(e+=", "),e+=ASC.ttls(2609)),t&R.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT){case R.VZTAH_ADV_OPTIONS_NOCLASS:""!=e&&(e+=", "),e+=ASC.ttls(2825);break;case R.VZTAH_ADV_OPTIONS_ONECLASS:""!=e&&(e+=", "),e+=ASC.ttls(3844);break;case R.VZTAH_ADV_OPTIONS_JOINEDCLASSES:""!=e&&(e+=", "),e+=ASC.ttls(3845)}switch(t&R.VZTAH_ADV_OPTIONS_MASK_DAYS){case R.VZTAH_ADV_OPTIONS_EVERY_DAY:""!=e&&(e+=", "),e+=ASC.ttls(3549);break;case R.VZTAH_ADV_OPTIONS_NOT_EVERY_DAY:""!=e&&(e+=", "),e+="!"+ASC.ttls(3549)}switch(t&R.VZTAH_ADV_OPTIONS_MASK_WEEKS){case R.VZTAH_ADV_OPTIONS_EVERY_WEEK:""!=e&&(e+=", "),e+=ASC.ttls(1863);break;case R.VZTAH_ADV_OPTIONS_NOT_EVERY_WEEK:""!=e&&(e+=", "),e+="!"+ASC.ttls(1863)}switch(t&R.VZTAH_ADV_OPTIONS_MASK_TERMS){case R.VZTAH_ADV_OPTIONS_EVERY_TERM:""!=e&&(e+=", "),e+=ASC.ttls(3415);break;case R.VZTAH_ADV_OPTIONS_NOT_EVERY_TERM:""!=e&&(e+=", "),e+="!"+ASC.ttls(3415)}var n=(t&R.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT)>>11;return 0<n&&(""!=e&&(e+=", "),e+=ASC.ttls(3622)+": ",t&R.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT_ORLESS&&(e+="<="),e+=n),e},R.AdvFilterMenuBuild=function(t){var e,i,n,o=[],r="advfilter";o.push([]),e=[],i={text:ASC.ttls(1640),submenu:e};for(var a=1;a<=32;a++)n={text:""+a,cmd:r,data:2e3+a},(t&R.VZTAH_ADV_OPTIONS_MASK_LENGTH)==a&&(n.checked=!0,i.checked=!0),e.push(n);o.push(i),o.push([]),o.push({text:ASC.ttls(1643),cmd:r,data:1010,checked:0!=(t&R.VZTAH_ADV_OPTIONS_ENTIRECLASS)}),o.push({text:ASC.ttls(1178),cmd:r,data:1011,checked:0!=(t&R.VZTAH_ADV_OPTIONS_DIVIDED)}),o.push({text:ASC.ttls(2609),cmd:r,data:1012,checked:0!=(t&R.VZTAH_ADV_OPTIONS_SEMINAR)}),o.push([]),o.push({text:ASC.ttls(2825),cmd:r,data:1013,checked:(t&R.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT)==R.VZTAH_ADV_OPTIONS_NOCLASS}),o.push({text:ASC.ttls(3844),cmd:r,data:1014,checked:(t&R.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT)==R.VZTAH_ADV_OPTIONS_ONECLASS}),o.push({text:ASC.ttls(3845),cmd:r,data:1015,checked:(t&R.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT)==R.VZTAH_ADV_OPTIONS_JOINEDCLASSES}),o.push([]);var s=(t&R.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT)>>11;for(e=[],i={text:ASC.ttls(3622),submenu:e,checked:0<s},o.push(i),a=1;a<=7;a++)e.push({text:""+a,cmd:r,data:3e3+a,checked:a==s});return e.push([]),e.push({text:"<=",checked:0!=(t&R.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT_ORLESS),cmd:r,data:1016}),e=[],i={text:ASC.ttls(2532),submenu:e,checked:0!=(t&R.VZTAH_ADV_OPTIONS_MASK_DAYS)},o.push(i),e.push({text:ASC.ttls(3549),checked:(t&R.VZTAH_ADV_OPTIONS_MASK_DAYS)==R.VZTAH_ADV_OPTIONS_EVERY_DAY,cmd:r,data:4001}),e.push({text:ASC.ttls(2708),checked:(t&R.VZTAH_ADV_OPTIONS_MASK_DAYS)==R.VZTAH_ADV_OPTIONS_NOT_EVERY_DAY,cmd:r,data:4002}),e=[],i={text:ASC.ttls(3410),submenu:e,checked:0!=(t&R.VZTAH_ADV_OPTIONS_MASK_WEEKS)},o.push(i),e.push({text:ASC.ttls(1863),checked:(t&R.VZTAH_ADV_OPTIONS_MASK_WEEKS)==R.VZTAH_ADV_OPTIONS_EVERY_WEEK,cmd:r,data:5001}),e.push({text:ASC.ttls(2708),checked:(t&R.VZTAH_ADV_OPTIONS_MASK_WEEKS)==R.VZTAH_ADV_OPTIONS_NOT_EVERY_WEEK,cmd:r,data:5002}),e=[],i={text:ASC.ttls(3409),submenu:e,checked:0!=(t&R.VZTAH_ADV_OPTIONS_MASK_TERMS)},o.push(i),e.push({text:ASC.ttls(3415),checked:(t&R.VZTAH_ADV_OPTIONS_MASK_TERMS)==R.VZTAH_ADV_OPTIONS_EVERY_TERM,cmd:r,data:6001}),e.push({text:ASC.ttls(2708),checked:(t&R.VZTAH_ADV_OPTIONS_MASK_TERMS)==R.VZTAH_ADV_OPTIONS_NOT_EVERY_TERM,cmd:r,data:6002}),o.push([]),o.push({text:ASC.ttls(2823),cmd:r,data:1e3}),o},R.AdvFilterMenuHandle=function(t,e){var i=parseInt(t.data),n=0,o=0;switch(i){case 1e3:e=0;break;case 1010:n=R.VZTAH_ADV_OPTIONS_MASK_DIVIDED,o=R.VZTAH_ADV_OPTIONS_ENTIRECLASS;break;case 1011:n=R.VZTAH_ADV_OPTIONS_MASK_DIVIDED,o=R.VZTAH_ADV_OPTIONS_DIVIDED;break;case 1012:n=R.VZTAH_ADV_OPTIONS_MASK_DIVIDED,o=R.VZTAH_ADV_OPTIONS_SEMINAR;break;case 1013:n=R.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT,o=R.VZTAH_ADV_OPTIONS_NOCLASS;break;case 1014:n=R.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT,o=R.VZTAH_ADV_OPTIONS_ONECLASS;break;case 1015:n=R.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT,o=R.VZTAH_ADV_OPTIONS_JOINEDCLASSES;break;case 1016:o=n=R.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT_ORLESS;break;case 4001:n=R.VZTAH_ADV_OPTIONS_MASK_DAYS,o=R.VZTAH_ADV_OPTIONS_EVERY_DAY;break;case 4002:n=R.VZTAH_ADV_OPTIONS_MASK_DAYS,o=R.VZTAH_ADV_OPTIONS_NOT_EVERY_DAY;break;case 5001:n=R.VZTAH_ADV_OPTIONS_MASK_WEEKS,o=R.VZTAH_ADV_OPTIONS_EVERY_WEEK;break;case 5002:n=R.VZTAH_ADV_OPTIONS_MASK_WEEKS,o=R.VZTAH_ADV_OPTIONS_NOT_EVERY_WEEK;break;case 6001:n=R.VZTAH_ADV_OPTIONS_MASK_TERMS,o=R.VZTAH_ADV_OPTIONS_EVERY_TERM;break;case 6002:n=R.VZTAH_ADV_OPTIONS_MASK_TERMS,o=R.VZTAH_ADV_OPTIONS_NOT_EVERY_TERM}return 2001<=i&&i<2100&&(n=R.VZTAH_ADV_OPTIONS_MASK_LENGTH,o=i-2e3),3e3<=i&&i<3100&&(n=R.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT,o=i-3e3<<11),(e&n)==o?e&=~n:e=e&~n|o,e},R.AdvFilterPass=function(t,e,i){if(void 0===i&&(i=null),0!=t){if(t&R.VZTAH_ADV_OPTIONS_INVERT)return!R.AdvFilterPass(t&~R.VZTAH_ADV_OPTIONS_INVERT,e,i);var n=t&R.VZTAH_ADV_OPTIONS_MASK_LENGTH;if(0!=n&&e.GetDlzka()+1!=n)return!1;var o=t&R.VZTAH_ADV_OPTIONS_MASK_DIVIDED;if(o){var r=!1;if(o&R.VZTAH_ADV_OPTIONS_SEMINAR)if(i)for(var a=0,s=i;a<s.length;a++){var l=s[a];if(0<=e.m_KurzyPreTriedy.indexOf(l)){r=!0;break}}else 0<e.m_KurzyPreTriedy.length&&(r=!0);for(var c=0,m=e.m_Skupiny;c<m.length;c++){var h=m[c];if(!(i&&i.indexOf(h.m_pTrieda)<0)){if(o&R.VZTAH_ADV_OPTIONS_ENTIRECLASS&&h.m_bCelaTrieda){r=!0;break}if(o&R.VZTAH_ADV_OPTIONS_DIVIDED&&!h.m_bCelaTrieda&&!h.m_bKurz){r=!0;break}}}if(!r)return!1}var _=(t&R.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT)>>11;if(0<_){if(0==e.m_KurzyPreTriedy.length)return!1;var u=[];i?$j.merge(u,i):$j.merge(u,e.m_KurzyPreTriedy),r=!1;for(var d=0,p=u;d<p.length;d++)if(l=p[d],!(e.m_KurzyPreTriedy.indexOf(l)<0)){for(var f=[],v=0,b=e.m_pPredmet.m_Hodiny;v<b.length;v++){var y=b[v];if(!(y.m_KurzyPreTriedy.indexOf(l)<0)){var g=y.m_nPoradieSeminaru;w(0<g),f.indexOf(g)<0&&f.push(g)}}var k=f.length;if(w(0<k),0!=(t&R.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT_ORLESS)?k<=_&&(r=!0):k==_&&(r=!0),r)break}if(!r)return!1}var T=t&R.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT;if(0<T){switch(u=e.m_Triedy,T){case R.VZTAH_ADV_OPTIONS_NOCLASS:return 0==u.length;case R.VZTAH_ADV_OPTIONS_ONECLASS:return 1==u.length;case R.VZTAH_ADV_OPTIONS_JOINEDCLASSES:return 1<u.length}return w(!1),!1}var S=t&R.VZTAH_ADV_OPTIONS_MASK_DAYS;if(S==R.VZTAH_ADV_OPTIONS_EVERY_DAY&&"all"!=e.m_pObdobie.days.m_Typ)return!1;if(S==R.VZTAH_ADV_OPTIONS_NOT_EVERY_DAY&&"all"==e.m_pObdobie.days.m_Typ)return!1;var C=t&R.VZTAH_ADV_OPTIONS_MASK_WEEKS;if(C==R.VZTAH_ADV_OPTIONS_EVERY_WEEK&&"all"!=e.m_pObdobie.weeks.m_Typ)return!1;if(C==R.VZTAH_ADV_OPTIONS_NOT_EVERY_WEEK&&"all"==e.m_pObdobie.weeks.m_Typ)return!1;var A=t&R.VZTAH_ADV_OPTIONS_MASK_TERMS;if(A==R.VZTAH_ADV_OPTIONS_EVERY_TERM&&"all"!=e.m_pObdobie.terms.m_Typ)return!1;if(A==R.VZTAH_ADV_OPTIONS_NOT_EVERY_TERM&&"all"==e.m_pObdobie.terms.m_Typ)return!1}return!0},R.AdvFilterField=function(t,e,i,n){n=parseInt(n+"");var o=$j("<span>").appendTo(t),r=$j("<input>").appendTo(t).hide(),a=function(){var t=R.AdvFilterMenuBuild(n);ASC.ui.Menu.addHandler(t,function(t){n=R.AdvFilterMenuHandle(t,n),a()}),o.empty(),new ASC.ui.Button({container:o,label:e,menu:t}),$j(i).text(R.AdvFilterPopis(n)),r.val(n+"")};return a(),r[0]},R.bits2index=function(t){return t.indexOf("0")<0?-1:t.indexOf("1")},R.blank2minus=function(t){return ASC.strEmpty(t)?-1:parseInt(t)},R.minus2blank=function(t){return t<0?-1:t},R.StripStringTab=function(t){var e=t.indexOf("\t");return e<=0&&(e=t.indexOf("\\t")),0<=e&&(t=t.substr(0,e)),t=t.replace("&","")},R.minutes=function(t){var e=t.split(":");return 60*parseInt(e[0])+parseInt(e[1])},R.GetFarbaFazy=function(t,e){if(e<=1)return"";var i=Math.round(255*t/(e-1));return"rgb("+i+","+i+","+i+")"},R.GetFarbaIndex=function(t){return"#"+(this.colorPalette[t]||"FFFFFF")},R.ZasedniColor_cache={},R.VZTAH_ADV_OPTIONS_MASK_LENGTH=31,R.VZTAH_ADV_OPTIONS_ENTIRECLASS=256,R.VZTAH_ADV_OPTIONS_DIVIDED=512,R.VZTAH_ADV_OPTIONS_SEMINAR=1024,R.VZTAH_ADV_OPTIONS_MASK_DIVIDED=1792,R.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT=14336,R.VZTAH_ADV_OPTIONS_MASK_SEMINARGROUPSCOUNT_ORLESS=16384,R.VZTAH_ADV_OPTIONS_NOCLASS=32768,R.VZTAH_ADV_OPTIONS_ONECLASS=65536,R.VZTAH_ADV_OPTIONS_JOINEDCLASSES=98304,R.VZTAH_ADV_OPTIONS_MASK_CLASSCOUNT=98304,R.VZTAH_ADV_OPTIONS_EVERY_DAY=131072,R.VZTAH_ADV_OPTIONS_NOT_EVERY_DAY=262144,R.VZTAH_ADV_OPTIONS_MASK_DAYS=393216,R.VZTAH_ADV_OPTIONS_EVERY_WEEK=524288,R.VZTAH_ADV_OPTIONS_NOT_EVERY_WEEK=1048576,R.VZTAH_ADV_OPTIONS_MASK_WEEKS=1572864,R.VZTAH_ADV_OPTIONS_EVERY_TERM=2097152,R.VZTAH_ADV_OPTIONS_NOT_EVERY_TERM=4194304,R.VZTAH_ADV_OPTIONS_MASK_TERMS=6291456,R.VZTAH_ADV_OPTIONS_INVERT=2147483648,R.colorPalette=["FF0000","00FF00","0000FF","FF00CC","FFCCFF","FFFF66","FF6666","FFCC66","000080","66FFFF","009933","DDFF97","669900","66FF66","FFFFCC","6666FF"],R);function R(){ASC.assert(!1)}l.CUtils=S,l.formatDivision=function(t,e,i,n){var o=i.table._oRecordSet._records.indexOf(e),r=$j(t);r.empty();for(var a=$j("<div class='ttonline_delenie'>").appendTo(r).data("rec",e),s=0,l=n;s<l.length;s++){var c=l[s],m=$j("<div class='ttonline_skupina'>").appendTo(a).css({backgroundColor:o%2==0?"#b1febb":"#93fe93"}).text(c.name).data("grow",c);$j("<span class='students_count'>").text(c.students_count).appendTo(m)}e.getData("entireclass")||a.sortable({connectWith:".ttonline_delenie",update:function(t,e){if(!e.sender){var i=e.item,n=i.data("grow").id,o=i.parent().data("rec").getData("division"),r=i.index();i.parents(".ui-dialog").find(".asc-gadget-jsc").get(0).ASC_gjsc.ASC_action("move","groupid="+n+"&division="+o+"&index="+r)}}})},l.SortovacieSipocky=function(e,i,t,n){function o(){n.ASC_action("order","order="+e.GetAllIds().join(","),{modal:!1})}var r=[],a=!1,s=function(){a=0<e.sortedBy.length,r[0].attr("src",a?"/global/pics/ui/sipkaKluc.png":"/global/pics/ui/sipkaHore.png"),r[1].attr("src",a?"/global/pics/ui/sipkaReset.png":"/global/pics/ui/sipkaDole.png")};[0,1].forEach(function(t){r[t]=$j("<img>").appendTo(i).css({width:"19px",height:"20px",cursor:"pointer",display:"block",marginTop:"5px"}).click(function(){!function(t){a?0==t?(o(),e.setSortedBy([]),s()):(e.ASC_deleteAll(),e.setSortedBy([]),s(),n.ASC_action("refresh","")):(e.moveSelectedRow(0==t),o())}(t)})}),s(),e.subscribe("columnSortEvent",s)}},"/timetable/app/rozview.js":function(t,require,e){t.__esModule=!0;var u=require("tslib"),b=require("./online"),y=require("./rokobject"),k=require("./tview"),h=require("./ttdoc"),d=require("../../asc/edurequest"),i=(n.prototype.UpdateHeight=function(){this.$div.css("height",this.m_pRozApp.m_nRozViewHeight+"px")},n.prototype.Update=function(){this.UpdateHeight(),this.PaintRadKarticiek0(),this.UpdatePodKurzorom(),this.m_bInvalid=!1},n.prototype.Validate=function(){this.m_pRozApp.ttviewer||(this.m_bInvalid&&this.Update(),this.m_bInvalidPodKurzorom&&this.UpdatePodKurzorom())},n.prototype.PaintRadKarticiek0=function(){var n=this,o=this.m_pRozApp,t=this.$pending_d;t.empty();var e=o.m_pRadSelector,i="";e.JeCelok()||(""!=i&&(i+=", "),i+=e.GetSimplePopis(!0)),""!=i&&$j("<div style='padding:2px 0px 0px 3px;font-weight:bold;color:#404040'>").appendTo(t).text(ASC.ttls(3508)+": "+i);var r=this.$rad_icons_d;r.empty(),["globals","classes","teachers","subjects","classrooms"].forEach(function(i){var t="globals"==i?"/timetable/pics/app/settings_32.png":b.CUtils.GetTableIcon(i),e=$j("<span>").appendTo(r);"globals"!=i&&e.text(n.m_pRadSelector.GetRadStr(i)),$j("<img>").prependTo(e).attr("src",t),e.click(function(t){if("globals"==i)n.m_pRadSelector.SetCelok(),o.InvalidateSelector();else{var e=n.OblastMenu(i);0<e.length&&ASC.showContextMenu(e,t)}})}),this.PripravList0();for(var a=null,s=0,l=this.m_List;s<l.length;s++){var c=l[s],m=this.m_pRozApp.m_pTriedyView.BuildRVKarta(c);m.onclick=this.m_OnMouseClickKarta;var h=c.m_nRozView_Ciselko;if(1<h){h=Math.min(h,5);for(var _=m;1<h;)_=ASC.createDiv(_,"viac"),h--}t.append(m),a&&(c.m_bRozView_Zasednut==a.m_bRozView_Zasednut&&c.m_nRozView_TypKarty==a.m_nRozView_TypKarty||$j(m).css("margin-left","10px")),m.ASC_mh=c,m.onmouseover=o.m_OnMouseOverKarta,m.onmouseout=o.m_OnMouseOutKarta,m.onclick=this.m_OnMouseClickKarta,m.oncontextmenu=this.m_OnMouseRightClickKarta,a=c}},n.prototype.PripravList0=function(){var e=this,t=this.m_pRozApp,i=t.m_pTriedyView;if(i&&i.m_pAktPohlad){var n=this.m_pRadSelector.GetVybraneHodiny(t.m_pTriedyView.m_nROJTF|k.ROJTF_FILTER_AKT_TWD),o=this.PripravList0_Obycajne(n),r=this.PripravList0_Ucebne(n),a=[],s=[],l=[];switch(i.m_pAktPohlad.GetRiadkyTable()){case"students":$j.merge(s,a),$j.merge(l,o),$j.merge(l,r);break;case"classrooms":$j.merge(s,r),$j.merge(s,o),$j.merge(l,a);break;default:$j.merge(s,o),$j.merge(l,r),$j.merge(l,a)}this.m_List=[],s.forEach(function(t){t.m_bRozView_Zasednut||e.m_List.push(t)}),s.forEach(function(t){t.m_bRozView_Zasednut&&e.m_List.push(t)}),l.forEach(function(t){t.m_bRozView_Zasednut=!0,e.m_List.push(t)})}},n.prototype.PripravList0_Obycajne=function(t){for(var e=this.m_pRozApp.m_pTriedyView.m_pAktPohlad,i=[],n={},o=0;o<t.length;o++)for(var r=t[o],a=0;a<r.m_Karty.length;a++)(m=r.m_Karty[a]).JeUmiestnena()||(i.push(m),n[m.m_Id]=!0);for(var s=[],l={},c=0;c<i.length;c++){var m;if(!l[(m=i[c]).m_Id]){l[m.m_Id]=!0;var h=new k.CMHodina(this.m_pRok);(h.m_nRozView_TypKarty=0)<m.m_pHodina.m_Triedy.length&&h.SetPozicia(m.m_pHodina.m_Triedy[0]),h.Add(m),h.FinishAdding(),s.push(h);var _=null,u=h.m_Objects.classes;for(o=0;o<u.length;o++){var d=u[o];_=_||d}for(_&&"classes"==e.m_Table&&h.SetPozicia(_),h.m_nRozView_Ciselko=1;;){for(var p=!1,f=[],v=0;v<h.m_Objects.lessons.length;v++){r=h.m_Objects.lessons[v];for(var b=!1,y=0;y<r.m_Karty.length;y++)if(!l[(g=r.m_Karty[y]).m_Id]&&n[g.m_Id]){f.push(g),b=!0;break}if(!b){p=!0;break}}if(p)break;for(h.m_nRozView_Ciselko++,y=0;y<f.length;y++){var g;l[(g=f[y]).m_Id]=!0}}}}return s},n.prototype.PripravList0_Ucebne=function(t){var n=[],o=this.m_pRok;return t.forEach(function(e){var i=null;e.m_Karty.forEach(function(t){e.IsUvazujUcebne()&&t.JeUmiestnena()&&!t.VsetkyUcebneValid()&&(null==i&&((i=new k.CMHodina(o)).m_nRozView_TypKarty=1,n.push(i)),i.Add(t),i.m_nRozView_Ciselko++,i.FinishAdding())})}),n},n.prototype.UpdatePodKurzorom=function(){var t=this.m_pRok,e=this.$podkurzorom_d,i=this.$kontrola_podkurzorom_d,n=this.m_pRozApp.m_PodKurzoromMHodina;if(e.empty(),i.empty(),n.IsEmpty())e.css("visibility","hidden"),i.hide();else{if(e.css("visibility","visible"),i.show(),"classroomsupervisions"!=n.m_ModeTable){var o=this.m_pRozApp.m_pTriedyView.BuildRVKarta(n);e.append(o)}for(var r=0,a=["subjects","classes","teachers","classrooms"];r<a.length;r++){var s=a[r],l=ASC.createDiv(e.get(0),"detail");ASC.createChild(l,"img").src=b.CUtils.GetTableIcon(s),$j("<img>").appendTo(i).attr("src",b.CUtils.GetTableIcon(s));var c=y.CRokObject.ListIds(n.m_Objects[s]),m=t.dbi.rowNames(s,c,"short");"subjects"==s&&0<n.m_nPoradieSeminaru&&(m+=" ("+n.m_nPoradieSeminaru+")"),1==c.length&&"classes"!=s&&"classrooms"!=s&&(m=m+" - "+t.dbi.rowNames(s,c)),"classes"==s&&(0<n.m_Skupiny.length&&(m+=" "+n.m_Skupiny.join(", ")),n.m_bSeminar&&(m+=" "+ASC.ttls(2609))),"subjects"==s&&"classroomsupervisions"==n.m_ModeTable&&(m=ASC.ttls(3294)),ASC.createText(l,m),$j("<span style='margin-right:5px'>").appendTo(i).text(m)}var h=[],_=n.GetJedinaKarta(),u=n.GetJedinaHodina();_&&_.JeUmiestnena()?h=[t.GetObdobie_bits("terms",_.terms()),t.GetObdobie_bits("weeks",_.weeks())]:u&&(h=[u.m_pObdobie.terms,u.m_pObdobie.weeks]);for(var d=0,p=h;d<p.length;d++){var f=p[d];if("all"!=f.m_Typ&&1!=f.m_BitovePole[0].length){var v=ASC.createDiv(e.get(0),"detail");ASC.createChild(v,"img").src="/timetable/pics/app/term_week_day/"+("termsdefs"==f.m_Table?"b_2_A.png":"g_2_A.png"),ASC.createText(v,f.GetNazov())}}}this.m_bInvalidPodKurzorom=!1},n.prototype.ZobrazKontrolu=function(t,e){var n=this;this.m_pRozApp.m_nRozViewHeight<180&&(this.m_pRozApp.m_nRozViewHeight=180,this.UpdateHeight()),this.$kontrola_d.show(),this.$kontrola_chyby_d.empty();var i={width:"100%",height:"100%",cssClass:"base-dt",selectionMode:"single",idcol:"id",formatRow:function(t,e){$j(t).toggleClass("item-out",!!e.getData("locked"))}},o=[];t.forEach(function(t){o.push(t.GridRow())});for(var r={},a=0,s=["teachers","classes","classrooms","subjects","students","lessons","cards","classsubjects","globals"];a<s.length;a++){var l=s[a];r[l]=b.CUtils.GetTableIcon(l)}for(var c={},m=0,h=["default","low","normal","high","strict","optimize","disabled"];m<h.length;m++){var _=h[m];c[_]=b.CUtils.GetIconImportance(_)}var u=[{key:"zgrc",width:16,label:" ",formatter:function(l,c,m,t){var e=$j(l);e.empty().css({textAlign:"center"}).off();var h=n.m_pRozApp.m_ChybaItemsI[c.getData("id")],i="";if(h.IsZgrcnuta()){var _=m.table;e.css("cursor","pointer"),"+"==t?(i="/global/pics/ui/tree_plus.png",e.click(function(t){c.setData("zgrc","-"),m.formatter(l,c,m,c.getData("zgrc")),t.stopPropagation();for(var e=_.rows.indexOf(_.findDataRow(""+h.m_Id))+1,i=0,n=h.m_ZgrcnuteChyby;i<n.length;i++){var o=n[i];_.addRow(o.GridRow(),e++)}})):(i="/global/pics/ui/tree_minus.png",e.click(function(t){c.setData("zgrc","+"),m.formatter(l,c,m,c.getData("zgrc")),t.stopPropagation();for(var e=[],i=0,n=h.m_ZgrcnuteChyby;i<n.length;i++){var o=n[i];e.push(o.m_Id)}for(var r=0,a=e;r<a.length;r++){var s=a[r];_.ASC_deleteRow(s)}}))}else h.m_pZgrcParent&&(i="/global/pics/ui/tree_sub.png");i&&$j("<img>").appendTo(e).attr("src",i)}},{key:"importance",width:16,label:" ",icons:c},{key:"icon",width:16,label:" ",icons:r},{key:"object",width:170,label:ASC.ttls(3181)},{key:"icon2",width:16,label:" ",icons:{bad:"/timetable/pics/app/bug_small_16.png",ok:"/timetable/pics/app/ok_small_16.png",optimize:"/timetable/pics/app/importance_optimize_16.png",warning:"/timetable/pics/app/warning_32.png"}},{key:"description",width:500,label:ASC.ttls(1276),resizable:!0}],d=new ASC.ui.dt.DataTable($j("<div>").appendTo(this.$kontrola_chyby_d),u,new ASC.ui.dt.DataSource(o),i);d.fitWidth(),d.subscribe("select",function(){var t=n.m_pRozApp,e=d.ASC_getSelectedRowId();if(e){var i=t.m_ChybaItemsI[e];if(!e)throw"Error 9199507004";n.SetKontrolaItem(i)}});var p=ASC.ttls(1269),f="/timetable/pics/app/verification_128.png";"compare"==e&&(p=ASC.ttls(2819),f="/timetable/pics/app/office/compare_64.png"),this.$kontrola_detail_d.empty();var v=$j("<div style='text-align: center'>").appendTo(this.$kontrola_detail_d);v.text(p),v.append("<br>"),v.append("<img src='"+f+"' style='margin-top:20px'>"),this.$kontrola_podkurzorom_d.empty()},n.prototype.ZrusKontrolu=function(){this.$kontrola_d.hide()},n.prototype.SetKontrolaItem=function(a){var s=this,l=d.client_req,t=this.m_pRozApp,e=t.m_pTriedyView;if(t.m_pKontrolaItem!=a){var c=t.ttgpid;t.m_pKontrolaItem=a,t.InvalidateTriedyViewRiadky(),this.$kontrola_detail_d.empty(),$j("<div style='color:#0a539a;font-weight:bold;margin-bottom:5px'>").appendTo(this.$kontrola_detail_d).html(ASC.ttls(1034));var i=a.m_TextDetaily,n=ASC.escapeHTML(i);n=(n=n.split("&lt;imgchyba&gt;").join("<img src='/timetable/pics/app/bug_small_16.png'>")).split("&lt;imgok&gt;").join("<img src='/timetable/pics/app/ok_small_16.png'>"),$j("<div>").appendTo(this.$kontrola_detail_d).html(n);var o=$j("<div style='position:absolute;right:5px;bottom:0px'>").appendTo(this.$kontrola_detail_d);a.m_HelpID&&$j("<a style='cursor:pointer;margin-left:10px'>").prependTo(o).click(function(){s.m_pRozApp.ShowHelp(a.m_HelpID)}).text(ASC.ttls(3050)).prepend("<img src='/global/pics/ui/help_32.png' style='vertical-align:middle;margin-right:3px'>");var r=null,m=a.m_pNastavObject,h=function(e){return u.__awaiter(s,void 0,void 0,function(){return u.__generator(this,function(t){switch(t.label){case 0:return[4,ASC.blockUI(Promise.resolve().then(function(){return require("./dlg")}))];case 1:return t.sent().showItemDlg(c,e.m_Table,e.m_Id),[2]}})})};switch(a.m_Nastav){case"edit":case"timeoff":case"constraints":m&&(r=function(){m.UI_OnCommand(a.m_Nastav,e)});break;case"constraints-advanced":"classes"==m.m_Table&&m&&(r=function(){m.UI_OnCommand("constraints",e)});break;case"vztah":case"vztahadv":m&&(r=function(){s.m_pRozApp.click_func("edit","table="+m.m_Table+"&id="+m.m_Id)});break;case"constraints/global":break;case"ziak":case"coursegroup":r=function(){return h(m)};break;case"hodina":case"hodina/predmetconstraints/seminareadv":case"hodina/predmetconstraints":r=function(){return u.__awaiter(s,void 0,void 0,function(){var e,i,n,o,r;return u.__generator(this,function(t){switch(t.label){case 0:for(e=[],i=m,n=0,o=a.m_Nastav.split("/");n<o.length;n++)switch(r=o[n]){case"hodina":e.push({id:r,title:b.CUtils.GetUINazovSTypom(i),onClick:function(){return h(i)}});break;case"predmetconstraints":e.push({id:r,title:b.CUtils.GetUINazovSTypom(i.m_pPredmet),onClick:function(){return e=i.m_pPredmet,u.__awaiter(s,void 0,void 0,function(){return u.__generator(this,function(t){switch(t.label){case 0:return[4,ASC.blockUI(Promise.resolve().then(function(){return require("./constraints")}))];case 1:return t.sent().showTTDocConstraintsDlg(c,e.m_Table,e.m_Id),[2]}})});var e}});break;case"seminareadv":e.push({id:r,title:l.ttls(3756),onClick:function(){return ASC.blockUI(Promise.resolve().then(function(){return require("./students_dlg")})).then(function(t){return t.showSeminarParametersDlg(c)})}})}return 1!=e.length?[3,1]:(e[0].onClick(),[3,3]);case 1:return[4,ASC.blockUI(Promise.resolve().then(function(){return require("../../react/chooseoption_r")}))];case 2:t.sent().showChooseOption({title:l.ttls(1680),options:e}),t.label=3;case 3:return[2]}})})}}if(r&&$j("<a style='cursor:pointer'>").prependTo(o).click(function(){r()}).text(ASC.ttls(1680)).prepend("<img src='/global/pics/ui/settings_32.png' style='vertical-align:middle;margin-right:3px'>"),!a.ScrollTo()){var _=e.GetPohladForTable(a.GetIdealPohladTable());_&&(e.SetAktPohlad(_),a.ScrollTo())}}},n.prototype.RightClickPendingArea=function(t){var e=[],c=this.m_pRozApp,m=c.m_pRok,h=c.m_pRadSelector;b.CUtils.AddMenuItemSmart(e,"",{text:ASC.ttls(1607),checked:h.JeCelok(),onclick:function(){h.SetCelok(),c.InvalidateSelector()}}),e.push([]);for(var i=0,n=["classes","teachers","subjects","classrooms"];i<n.length;i++){var o=n[i];b.CUtils.AddMenuItemSmart(e,"",{text:b.CUtils.GetTableName(o),checked:h.m_Table==o,submenu:this.OblastMenu(o)})}e.push([]),b.CUtils.AddMenuItemSmart(e,"filter",{text:ASC.ttls(3508),submenu:b.CUtils.AdvFilterMenuBuild(h.m_nAdvFilterOptions),checked:0!=h.m_nAdvFilterOptions}),e.push([]),b.CUtils.AddMenuItemSmart(e,"test",{onclick:function(){if(h.m_nAdvFilterOptions){var t=[],e=c.m_pTriedyView.m_nROJTF,i=h.GetVybraneHodiny(e|k.ROJTF_FILTER_AKT_TWD);t=i.map(function(t){return["lessons",t.m_Id]});for(var n=0,o=m.TableObjects("studentsubjects");n<o.length;n++)for(var r=o[n],a=0,s=i;a<s.length;a++){var l=s[a];if(l.m_pPredmet==r.m_pPredmet&&l.m_KurzyPreTriedy.includes(r.m_pZiak.m_pTrieda)){t.push(["studentsubjects",r.m_Id]);break}}c.ClickGenerate({sel:t})}else c.ClickGenerate({sel:!0})}}),ASC.showContextMenu(e,t,{handler:function(t){"advfilter"==t.cmd&&(h.m_nAdvFilterOptions=b.CUtils.AdvFilterMenuHandle(t,h.m_nAdvFilterOptions),c.InvalidateSelector())}})},n.prototype.OblastMenu=function(t){var e=this,i=[],n=this.m_pRozApp.m_pRadSelector;return this.m_pRok.TableObjects(t).forEach(function(t){b.CUtils.AddMenuItemSmart(i,"",{text:b.CUtils.GetUINazov(t),data:t,checked:n.IsInRad(t),onclick:function(){n.SetCelok(),n.AddRadObject(t),e.m_pRozApp.InvalidateSelector()}})}),i},n.prototype.RightClickKarta=function(t,e){var i=this,n=[],o=this.m_pRozApp,r=e.GetJedinaKarta(),a=o.m_pTriedyView,s="";switch(s=r?b.CUtils.GetUINazov(r,"short"):b.CUtils.GetUINazvy(e.Predmety(),"short"),e.m_nRozView_TypKarty){case 0:s=ASC.ttls(3497)+" - "+s;break;case 1:s=ASC.ttls(3499)+" - "+s;break;case 2:s=ASC.ttls(3493)+" - "+s}var l=s;switch(1<e.m_nRozView_Ciselko&&(s+=" ("+e.m_nRozView_Ciselko+"x)"),e.m_nRozView_TypKarty){case 0:if(b.CUtils.AddMenuItemSmart(n,"",{text:ASC.ttls(4054),onclick:function(){o.Chyt(e)}}),1<e.Karty().length){n.push([]);var c=[];e.Karty().forEach(function(t){b.CUtils.AddMenuItemSmart(c,"",{text:b.CUtils.GetUINazov(t),data:t,onclick:function(){o.ChytKartu(t)}})}),b.CUtils.AddMenuItemSmart(n,"",{text:ASC.ttls(2958),submenu:c})}break;case 1:b.CUtils.AddMenuItemSmart(n,"",{text:ASC.ttls(1761),onclick:function(){o.Chyt(e)}})}n.push([]);var m=e.GetJedinaHodina();m&&(m.UI_HodinaPopup(n,a),n.push({text:ASC.ttls(4029),onclick:function(){return u.__awaiter(i,void 0,void 0,function(){return u.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./quickchanges")})];case 1:return t.sent().showQuickChanges({ttgpid:o.ttgpid,lessonid:m.m_Id}),[2]}})})}})),ASC.showContextMenu(n,t,{header:ASC.escapeHTML(l)})},n);function n(i,t){var e=this;this.m_bInvalid=!1,this.m_bInvalidPodKurzorom=!1,this.m_List=[],this.m_pRozApp=i,this.$div=t,this.m_pRadSelector=this.m_pRozApp.m_pRadSelector,this.m_pRok=this.m_pRozApp.m_pRok,this.$div.addClass("rozview"),this.$pending_d=$j("<div class='pending-area'>").appendTo(this.$div),this.$podkurzorom_d=$j("<div class='podkurzorom'>").appendTo(this.$div),this.$rad_icons_d=$j("<div class='rad_icons'>").appendTo(this.$div),this.$kontrola_d=$j("<div class='kontrola'>").appendTo(this.$div).hide(),this.$kontrola_detail_d=$j("<div class='detail'>").appendTo(this.$kontrola_d),this.$kontrola_chyby_d=$j("<div class='chyby'>").appendTo(this.$kontrola_d),this.$kontrola_podkurzorom_d=$j("<div class='kontrola_podkurzorom'>").appendTo(this.$kontrola_d),this.$div.mousemove(function(t){e.m_pRozApp.CursorMove(t)}),this.$pending_d.click(function(t){e.m_pRozApp.OdhodKartu()}),this.$pending_d.on("contextmenu",function(t){ASC.hideContextMenu(),i.m_TahanaMHodina.IsEmpty()?e.RightClickPendingArea(t):i.OdhodKartu(),t.stopPropagation(),t.preventDefault()});var n=this;this.m_OnMouseClickKarta=function(t){if(ASC.hideContextMenu(),i.m_TahanaMHodina.IsEmpty()){var e=this.ASC_mh;e.m_bRozView_Zasednut?n.RightClickKarta(t,e):n.m_pRozApp.Chyt(e)}else i.OdhodKartu();t.stopPropagation()},this.m_OnMouseRightClickKarta=function(t){if(ASC.hideContextMenu(),i.m_TahanaMHodina.IsEmpty()){var e=this.ASC_mh;n.RightClickKarta(t,e)}else i.OdhodKartu();t.stopPropagation(),t.preventDefault()}}t.CRozView=i;var o,r,a,s=(l.prototype.SetCelok=function(){this.m_Table="globals",this.m_Objects.length=0,this.m_nAdvFilterOptions=0},l.prototype.JeCelok=function(){return"globals"==this.m_Table&&0==this.m_nAdvFilterOptions},l.prototype.AddRadObject=function(t){var e=t.m_Table;e!=this.m_Table&&(this.m_Table=e,this.m_Objects.length=0),this.m_Objects.indexOf(t)<0&&this.m_Objects.push(t)},l.prototype.RemoveRadObject=function(t){t.m_Table==this.m_Table&&(b.CUtils.FastRemove(this.m_Objects,t),0==this.m_Objects.length&&(this.m_Table="globals"))},l.prototype.IsInRad=function(t){return this.m_Table==t.m_Table&&0<=this.m_Objects.indexOf(t)},l.prototype.GetVybraneHodiny=function(t){var e=this,i=this.m_pRok,o=[],n=i.m_ObjectsO.lessons;switch(this.m_Table){case"classes":case"teachers":case"subjects":for(var r=0;r<this.m_Objects.length;r++)b.CUtils.AddListToSet(this.m_Objects[r].GetHodinyMozuSem(t),o);break;default:for(r=0;r<n.length;r++){var a=n[r];o.push(a)}}if(0!=(t&k.ROJTF_FILTER_AKT_TWD))for(var s=this.m_pRozApp.m_pTriedyView.m_pAktObdobie,l=function(i){var n=s[i].GetSumBitov();if(!n.includes("0"))return"continue";o=o.filter(function(t){var e=t.m_pObdobie[i].GetSumBitov();return h.bitfieldIsOverlap(n,e)})},c=0,m=["terms","weeks","days"];c<m.length;c++)l(m[c]);return o=o.filter(function(t){return b.CUtils.AdvFilterPass(e.m_nAdvFilterOptions,t,null)})},l.prototype.GetJediny=function(){return 1==this.m_Objects.length?this.m_Objects[0]:null},l.prototype.GetRadList=function(){return ASC.cloneArray(this.m_Objects)},l.prototype.GetRadStr=function(t){return t!=this.m_Table?"":b.CUtils.GetUINazvy(this.m_Objects,"short")},l.prototype.GetSimplePopis=function(t){void 0===t&&(t=!1);var e="";if("globals"==this.m_Table)t&&0!=this.m_nAdvFilterOptions||(e="All");else{var i=this.GetRadList();if(!i)return"???";e=i.length<=4?b.CUtils.GetUINazvy(i,i.length<=1?"short_name":"short"):i.length+" "+b.CUtils.GetTableItemTypNazov(this.m_Table,i.length)}return e=e.replace("\t"," "),t&&0!=this.m_nAdvFilterOptions&&(""!=e&&(e+=", "),e+=b.CUtils.AdvFilterPopis(this.m_nAdvFilterOptions)),e},l);function l(t){this.m_Table="globals",this.m_Objects=[],this.m_nAdvFilterOptions=0,this.m_pRozApp=t,this.m_pRok=this.m_pRozApp.m_pRok}t.CRadSelector=s,(r=o=t.CHYBAITEMIKONA||(t.CHYBAITEMIKONA={}))[r.CHYBAITEMIKONA_OK=0]="CHYBAITEMIKONA_OK",r[r.CHYBAITEMIKONA_CHYBA=1]="CHYBAITEMIKONA_CHYBA",r[r.CHYBAITEMIKONA_WARNING=2]="CHYBAITEMIKONA_WARNING",r[r.CHYBAITEMIKONA_OPTIMIZE=3]="CHYBAITEMIKONA_OPTIMIZE",(a=t.WARNINGTTYPE||(t.WARNINGTTYPE={}))[a.WT_NIC=0]="WT_NIC",a[a.WT_NESPLNITELNA=1]="WT_NESPLNITELNA",a[a.WT_NEIMPLEMENTOVANA_VIACDELENI=2]="WT_NEIMPLEMENTOVANA_VIACDELENI",a[a.WT_NEIMPLEMENTOVANA_CYKLUSVTRIEDE=3]="WT_NEIMPLEMENTOVANA_CYKLUSVTRIEDE",a[a.WT_VYPNUTA=4]="WT_VYPNUTA",a[a.WT_NEIMPLEMENTOVANA_CYKLUSHODINY=5]="WT_NEIMPLEMENTOVANA_CYKLUSHODINY",a[a.WT_CHYBNA=6]="WT_CHYBNA",a[a.WT_NEIMPLEMENTOVANA=7]="WT_NEIMPLEMENTOVANA",a[a.WT_VYPNUTA_VELA_KARIET=8]="WT_VYPNUTA_VELA_KARIET";var c=(m.prototype.FindRiadok=function(t){for(var e=0,i=this.m_Riadky;e<i.length;e++){var n=i[e];if(n.m_pRiadokObject==t)return n}return null},m.prototype.GridRow=function(){var t={id:this.m_Id,zgrc:"",importance:this.m_Importance,icon:this.m_pKde?this.m_pKde.m_Table:"",object:b.CUtils.GetUINazov2(this.m_pKde,this.m_pKde2,"short_name"),icon2:"",description:this.m_Text,locked:this.m_bLocked};switch(this.m_nIkona){case o.CHYBAITEMIKONA_CHYBA:t.icon2="bad";break;case o.CHYBAITEMIKONA_OK:t.icon2="ok";break;case o.CHYBAITEMIKONA_OPTIMIZE:t.icon2="optimize";break;case o.CHYBAITEMIKONA_WARNING:t.icon2="warning"}if(this.IsZgrcnuta()){t.object=this.m_ZgrcnuteChyby.length+"x",t.zgrc="+";var e=this.m_ZgrcnuteChyby[0];t.icon=e.m_pKde?e.m_pKde.m_Table:""}else this.m_pZgrcParent&&(t.zgrc=".");return this.m_bHeuristika&&(t.description=ASC.ttls(3635)+": "+t.description),""!=this.m_TextAppend&&(t.description+=": "+this.m_TextAppend),t},m.prototype.ScrollTo=function(){var t=this.m_pRok.m_pRozApp,e=t.m_pTriedyView;t.Validate();for(var i=[],n=0,o=e.m_Riadky;n<o.length;n++){var r=o[n];this.FindRiadok(r.m_pRokObject)&&i.push(r)}return 0!=i.length&&(e.ScrollToRiadky(i),!0)},m.prototype.GetIdealPohladTable=function(){for(var t=["teachers","classes","students","classrooms","subjects"],e=0,i=this.m_Riadky;e<i.length;e++){var n=i[e].m_pRiadokObject.m_Table;if(0<=t.indexOf(n))return n}return""},m.prototype.GetKdeTable=function(){return this.m_pKde?this.m_pKde2&&"classes"==this.m_pKde.m_Table&&"subjects"==this.m_pKde2.m_Table?"classsubjects":this.m_pKde.m_Table:""},m.prototype.IsZgrcnuta=function(){return 0<this.m_ZgrcnuteChyby.length},m.nextId=1,m);function m(t,e){var i,n;if(this.m_pKde=null,this.m_pKde2=null,this.m_PodmienkaNazov="",this.m_HelpID="",this.m_Text="",this.m_TextAppend="",this.m_TextDetaily="",this.m_Importance="",this.m_bLocked=!1,this.m_bHeuristika=!1,this.m_nIkona=-1,this.m_nWarningType=-1,this.m_Nastav="",this.m_pNastavObject=null,this.m_ZgrcnuteChyby=[],this.m_pZgrcParent=null,this.m_Riadky=[],this.m_pRok=t,this.m_Id=""+m.nextId++,t.m_pRozApp.m_ChybaItemsI[this.m_Id]=this,e){this.m_PodmienkaNazov=e.m_PodmienkaNazov,this.m_HelpID=e.m_HelpID,this.m_Text=e.m_Text,this.m_TextAppend=e.m_TextAppend,this.m_TextDetaily=e.m_TextDetaily,this.m_Importance=e.importance||((i={})[-1]="default",i[0]="low",i[1]="normal",i[2]="high",i[3]="strict",i[4]="optimize",i[5]="alternative",i[6]="disabled",i[7]="alternative2",i)[e.m_TextZoskupPriorita]||"",(""==this.m_TextAppend||0<(null===(n=e.m_ZgrcnuteChyby)||void 0===n?void 0:n.length))&&e.m_TextZoskupExtraText&&e.m_TextZoskupExtraText!=e.m_Text&&(this.m_TextAppend=e.m_TextZoskupExtraText),this.m_bLocked=e.m_bLocked,this.m_bHeuristika=e.m_bHeuristika,this.m_nIkona=e.m_nIkona,this.m_nWarningType=e.m_nWarningType,this.m_pKde=t.decodeRo(e.m_pKde),this.m_pKde2=t.decodeRo(e.m_pKde2),this.m_Nastav=e.m_Nastav,this.m_pNastavObject=t.decodeRo(e.m_pNastavObject);for(var o=0,r=e.m_Riadky;o<r.length;o++){var a=r[o];this.m_Riadky.push(new _(this,a))}if(e.m_ZgrcnuteChyby)for(var s=0,l=e.m_ZgrcnuteChyby;s<l.length;s++){var c=new m(t,l[s]);this.m_ZgrcnuteChyby.push(c),c.m_pZgrcParent=this}}}t.CChybaItem=c,t.blank_ChybaItem_JSON={m_Text:"",m_TextAppend:"",m_TextDetaily:"",m_TextZoskupPriorita:"",m_TextZoskupExtraText:"",m_Riadky:[]};var _=function(t,e){this.m_RelevantneHodiny={},this.m_ZleKarty={},this.m_pChybaItem=t,this.m_pRiadokObject=t.m_pRok.decodeRo(e.m_pRiadokObject);for(var i=0,n=e.m_RelevantneHodiny;i<n.length;i++){var o=n[i];this.m_RelevantneHodiny[o]=!0}for(var r=0,a=e.m_ZleKarty;r<a.length;r++)o=a[r],this.m_ZleKarty[o]=!0;this.m_pVysvietZle=e.m_pVysvietZle,this.m_pVysviet1=e.m_pVysviet1,this.m_pVysviet2=e.m_pVysviet2};t.CChybaItemRiadok=_},"/timetable/app/rokobject.js":function(n,require,t){n.__esModule=!0;var x=require("tslib");n.nMaxVyucHodin=32,n.nMaxDniVTyzdni=10,n.nMaxTyzdnov=20,n.nMaxTermov=12,n.nMaxDuration=8,n.ttapp_needed_part={globals:["name","settings","year","reg_name"],ttreports:["typ","name","page_tables","row_tables","column_tables","celltype","cellwidth","cellheight","fitwidth","fitheight","landscape","repeatpage","splitpage_w","splitpage_h","withclassroomtt","hideemptyrows","hideemptycolumns","headerwidth","headerheight","cardstyles","cardcolorenabled","cardcolortable1","cardcolortable2","cardcolorpos","classroomsupervisionstyle","gridheadertexts","pageheader","pageheaderprefixenabled","userheader","printlogo","extracolumns","extrarows","settings"],periods:["period","name","short","starttime","endtime","daydata","printinsummary","printinteacher","printinclass","printinclassroom","printonlyinbells"],breaks:["break","name","short","starttime","endtime","daydata","printinsummary","printinteacher","printinclass","printinclassroom","printonlyinbells","printtext"],bells:["bell","perioddata","breakdata"],daysdefs:["name","short","typ","vals","val"],weeksdefs:["name","short","typ","vals","val"],termsdefs:["name","short","typ","vals","val"],teachers:["firstname","lastname","nameprefix","namesuffix","short","bell","color","fontcolorprint","fontcolorprint2","fontcolorscreen","timeoff","gender"],classes:["name","short","teacherid","classroomids","bell","color","timeoff","printsubjectpictures"],groups:["name","classid","entireclass","ascttdivision","okgroup","students_count","color"],subjects:["name","short","color","picture_url","timeoff","contract_weight"],buildings:["name","short","color"],classrooms:["name","short","sharedroom","buildingid","needssupervision","color","nearbyclassroomids"],students:["firstname","lastname","classid","groupids","short"],lessons:["subjectid","teacherids","groupids","classids","count","durationperiods","classroomidss","termsdefid","weeksdefid","daysdefid","terms","seminargroup","bell"],cards:["lessonid","period","days","weeks","classroomids"],studentsubjects:["studentid","subjectid","seminargroup","importance","locked"],classroomsupervisions:["classroomid","teacherid","day","week","term","period","break","locked"],coursegroups:["name"]};var o=(e.prototype.timeoff=function(){return this.m_Data.timeoff||null},e.prototype.InitFromData=function(){},e.prototype.BeforeRemove=function(){},e.prototype.GetNazov=function(t){return void 0===t&&(t="name"),this.m_pRok.dbi.rowName(this.m_Table,this.m_Id,t)},e.prototype.GetSkratka=function(){return this.m_pRok.dbi.rowName(this.m_Table,this.m_Id,"short")},e.prototype.GetColor=function(){return""+this.m_Data.color},e.prototype.GetDBIndex=function(){return this.m_pRok.m_ObjectsO[this.m_Table].indexOf(this)},e.prototype.HodinaMozeSem=function(t,e){return!0},e.prototype.GetHodinyMozuSem=function(t){var e=this.m_pRok.m_ObjectsI.lessons,i=[];for(var n in e){var o=e[n];this.HodinaMozeSem(o,t)&&i.push(o)}return i},e.prototype.GetKartyMozuSem=function(t){var e=[];return this.GetHodinyMozuSem(t).forEach(function(t){$j.merge(e,t.m_Karty)}),e},e.prototype.GetKartyTu=function(t){var e=this.GetHodinyMozuSem(t),i=[];for(var n in e){var o=e[n];for(var r in o.m_Karty){var a=o.m_Karty[r];this.KartaJeTu(a,t)&&i.push(a)}}return i},e.prototype.GetKartyTuTWDH=function(t,e,i,n,o){for(var r=this.GetKartyTu(o),a=[],s=0;s<r.length;s++){var l=r[s];l.JeTu_TWDH(t,e,i,n)&&a.push(l)}return a},e.prototype.KartaJeTu=function(t,e){return!!t.JeUmiestnena()&&this.HodinaMozeSem(t.m_pHodina,e)},e.ListIds=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].m_Id);return e},e.prototype.UI_KartaVyberOdtialto=function(t,e,i,n){return!i.IsLocked()&&(t.InvalidateKarta(i),i.DeUmiestniKarta(),t.InvalidatePending(),t.ChytKartu(i,this),t.CursorMove(n),!0)},e.prototype.UI_ChooseObdobie=function(c,a,m){return x.__awaiter(this,void 0,void 0,function(){var e,i,n,o,r=this;return x.__generator(this,function(t){switch(t.label){case 0:return[4,(e=function(s,l){return x.__awaiter(r,void 0,void 0,function(){var i,e,n,o,r,a;return x.__generator(this,function(t){switch(t.label){case 0:if(i=c.m_pRok,e=c.m_pObdobie[s],0==(n=e.m_BitovePole.filter(function(t){return l<0||"1"==t[l]})).length)return[2,null];if(1==n.length)return[2,n[0]];if("terms"==s&&c.m_Data.terms)for(o=c.m_Data.terms,r=0,a=c.m_Karty;r<a.length;r++)if(a[r].JeUmiestnena()&&o.includes("1"))return[2,o];return[4,new Promise(function(e){ASC.showContextMenu(n.map(function(t){return{text:ot.obdobieName(i.dbi,s,t),onclick:function(){return e(t)}}}),m)})];case 1:return[2,t.sent()]}})})})("terms",a.m_nTerm)];case 1:return(i=t.sent())?[4,e("weeks",a.m_nWeek)]:[2,null];case 2:return(n=t.sent())?[4,e("days",a.m_nDay)]:[2,null];case 3:return(o=t.sent())?[2,{terms:i,weeks:n,days:o}]:[2,null]}})})},e.prototype.UI_KartaUmiestni=function(R,P,O,D){return x.__awaiter(this,void 0,void 0,function(){var e,i,n,o,r,a,s,l,c,m,h,_,u,d,p,f,v,b,y,g,k,T,S,C,A,w,I;return x.__generator(this,function(t){switch(t.label){case 0:for(e=R.m_pRok,i=P.m_Objects.cards,n=null,o=0,r=i;o<r.length;o++)if(!(w=r[o]).JeUmiestnena()){if(!this.HodinaMozeSem(w.m_pHodina,R.m_pTriedyView.m_nROJTF))return[2];n=n||w}return n&&n.Obdobia_MozeSem_TWDH(O.m_nTerm,O.m_nWeek,O.m_nDay,O.period)?[4,this.UI_ChooseObdobie(n.m_pHodina,O,D)]:[2];case 1:if(!(a=t.sent()))return[2];if(s=a.terms,l=a.weeks,c=a.days,m=O.period,1<n.m_pHodina.m_pObdobie.terms.m_BitovePole.length){for(h=[],_=0,u=i;_<u.length;_++)if((w=u[_]).m_pHodina.GetTerm()!=s)for(d=0,p=w.m_pHodina.m_Karty;d<p.length;d++)(f=p[d]).JeUmiestnena()&&h.push(f);if(0<h.length)return alert("Lesson is already in another term"),[2]}for(v=[],b=[],y=0,g=i;y<g.length;y++)w=g[y],e.ChangePosKarta_TWDH(w,s,l,c,m,!1),w.SimpleKolizie(v),w.SimpleKolizie(b,!0),w.DeUmiestniKarta();if(k=function(){i.forEach(function(t){e.ChangePosKarta_TWDH(t,s,l,c,m,!0),R.InvalidateKarta(t)}),R.InvalidatePending();var t=R.m_bTahanaDajKontrolu;R.OdhodKartu(),t&&(R.m_bTahanaDajKontrolu=!1,R.ClickVerification("verification","sel"))},T=function(){v.forEach(function(t){t.IsLocked()||(t.DeUmiestniKarta(),R.InvalidateKarta(t))}),k()},0==v.length)return k(),[2];for(S=!1,C=0,A=v;C<A.length;C++)(w=A[C]).IsLocked()&&(S=!0);return 1!=v.length||S||!this.KartaJeTu(v[0],R.m_pTriedyView.m_nROJTF)||D.shiftKey?(I=[],v.forEach(function(t){I.push({text:Q.CUtils.GetUINazov(t),icon:Q.CUtils.GetIconLocked(t.IsLocked(),!0)||Q.CUtils.GetIconNic(),disabled:S,onclick:function(){T(),R.ChytKartu(t)}})}),I.push([]),S||I.push({text:ASC.ttls(3448),icon:Q.CUtils.GetIconOK(),onclick:function(){T()}}),I.push({text:ASC.ttls(1007),icon:Q.CUtils.GetIconNic(),onclick:function(){}}),I.push([]),I.push({text:ASC.ttls(3449),icon:Q.CUtils.GetIconNic(),onclick:function(){k()}}),ASC.showContextMenu(I,D,{header:ASC.ttls(3447)+":"})):(T(),R.ChytKartu(v[0])),[2]}})})},e.prototype.UI_RiadokPopup=function(t,e){},e.prototype.UI_OnCommand=function(e,t,i){void 0===i&&(i=null);var n=t.m_pRozApp,o=n.ttgpid,r=this.m_Table,a=this.m_Id;switch(e){case"edit":return n.click_func(e,"table="+this.m_Table+"&id="+a),!0;case"timeoff":return void Promise.resolve().then(function(){return require("./timeoff")}).then(function(t){return t.showTTDocTimeoffDlg(o,r,a)});case"lessons":return void Promise.resolve().then(function(){return require("./lesson_dlg")}).then(function(t){var e;return t.showLessonsDlg(o,((e={})[it.DBITools.removeEs(r)+"id"]=a,e))});case"constraints":return Promise.resolve().then(function(){return require("./constraints")}).then(function(t){return t.showTTDocConstraintsDlg(o,r,a)}),!0;case"deletecards":case"lockcards":case"unlockcards":return this.GetKartyTu(t.m_nROJTF).forEach(function(t){switch(e){case"deletecards":t.IsLocked()||(n.InvalidateKarta(t),t.DeUmiestniKarta());break;case"lockcards":t.IsLocked()||(n.InvalidateKarta(t),t.SetLocked(!0));break;case"unlockcards":t.IsLocked()&&(n.InvalidateKarta(t),t.SetLocked(!1))}}),!0;case"removecard":var s=i;n.InvalidateKarta(s),s.DeUmiestniKarta();break;case"lockcard":s=i,n.InvalidateKarta(s),s.SetLocked(!0);break;case"unlockcard":s=i,n.InvalidateKarta(s),s.SetLocked(!1)}return!1},e.prototype.AddKartyTuK=function(t,e,i){if(e.JeUmiestnena())for(var n=e.GetHodinaOd();n<=e.GetHodinaDo();n++)for(var o=0;o<=this.m_pRok.m_nTermov;o++)for(var r=0;r<this.m_pRok.m_nTyzdnov;r++)for(var a=0;a<this.m_pRok.m_nDni;a++)e.JeTu_TWDH(o,r,a,n)&&this.AddKartyTu(t,o,r,a,n,i)},e.prototype.AddKartyTu=function(t,e,i,n,o,r){for(var a=0,s=this.GetKartyTu(r);a<s.length;a++){var l=s[a];l.JeTu_TWDH(e,i,n,o)&&(t.includes(l)||t.push(l))}},e.prototype.GetObsadenieK=function(t){var e=[];return this.AddKartyTuK(e,t,0),e},e.prototype.UI_KartaMozeSem=function(t,e){for(var i=0,n=e.m_Objects.cards;i<n.length;i++){var o=n[i];if(!o.JeUmiestnena()&&this.HodinaMozeSem(o.m_pHodina,t.m_pTriedyView.m_nROJTF))return!0}return!1},e.prototype.UI_GetKartyNaPolicko=function(t,s){var l=this,c=[];return this.GetKartyMozuSem(t.m_nROJTF).forEach(function(t){if(!t.JeUmiestnena()&&t.Obdobia_MozeSem_TWDH(s.m_nTerm,s.m_nWeek,s.m_nDay,s.period,!0)){var e=t.m_pHodina.GetTermPrvyDobry(s.m_nTerm),i=t.m_pHodina.GetWeekPrvyDobry(s.m_nWeek),n=t.m_pHodina.GetDenPrvyDobry(s.m_nDay),o=s.period,r=[];l.m_pRok.ChangePosKarta_TWDH(t,e,i,n,o,!1);var a=l.m_pRok.VhodnostKarty_PUT(t);t.SimpleKolizie(r),t.DeUmiestniKarta(),"0"!=a&&(0<r.length||c.push(t))}}),c},e.prototype.GetSaveID=function(){return this.m_pRok.m_ObjectsO[this.m_Table].indexOf(this)},e.prototype.updateData=function(t){var e=!1;for(var i in t){var n=t[i];void 0!==n&&n!==this.m_Data[i]&&(this.m_Data[i]=n,e=!0)}e&&this.m_pRok.m_pRozApp.InvalidateObject(this)},e);function e(t,e,i){this.m_pRok=t,this.m_Table=e,this.m_Id=""+i.id,this.m_Data=i}n.CRokObject=o;var i,r=(i=o,x.__extends(a,i),a.prototype.StructureFromData=function(){this.m_nHodinyOd=32;for(var t=this.m_nHodinyDo=0;t<n.nMaxVyucHodin;t++)this.GetPeriod(t)&&(this.m_nHodinyOd=Math.min(this.m_nHodinyOd,t),this.m_nHodinyDo=Math.max(this.m_nHodinyDo,t));var e={terms:"",weeks:"",days:""};for(var i in e)for(;this.GetObdobie_One(i,e[i].length);)e[i]+="1";this.m_nDni=e.days.length,this.m_nTyzdnov=e.weeks.length,this.m_nTermov=e.terms.length,this.m_DaysAll=e.days,this.m_WeeksAll=e.weeks,this.m_TermsAll=e.terms},a.prototype.addRow=function(t,e){var i;switch(t){case"cards":i=new M(this,e);break;case"lessons":i=new z(this,e);break;case"classes":i=new p(this,e);break;case"teachers":i=new v(this,e);break;case"subjects":i=new g(this,e);break;case"students":i=new S(this,e);break;case"studentsubjects":i=new w(this,e);break;case"classrooms":i=new P(this,e);break;case"groups":i=new c(this,e);break;case"termsdefs":case"weeksdefs":case"daysdefs":i=new K(this,t,e);break;case"periods":i=new F(this,e);break;case"breaks":i=new J(this,e);break;case"ttreports":i=new et.CTlacZostava(this,e);break;case"ttviews":i=new Q.CPohlad(this,e);break;case"classroomsupervisions":i=new X(this,e);break;default:i=new o(this,t,e)}return this.m_ObjectsO[t].push(i),this.m_ObjectsI[t][e.id]=i},a.prototype.deleteRow=function(t,e){var i=this.m_ObjectsI[t][e];if(i){i.BeforeRemove(),delete this.m_ObjectsI[t][e];var n=this.m_ObjectsO[t],o=n.indexOf(i);n.splice(o,1)}},a.prototype.ids2ro=function(t,e){for(var i=[],n=0;n<e.length;n++)i.push(this.m_ObjectsI[t][e[n]]);return i},a.prototype.ChangePosKarta_TWDH=function(t,e,i,n,o,r){void 0===r&&(r=!1);var a=t.m_pHodina;ASC.assert(a.m_pObdobie.terms.IsCompatible(e)),ASC.assert(a.m_pObdobie.weeks.IsCompatible(i)),ASC.assert(a.m_pObdobie.days.IsCompatible(n)),t.SetPosition(n,o,e,i),r&&t.DajUcebnu()},a.prototype.GetObdobie_bits=function(t,e){for(var i=this.m_ObjectsO[t+"defs"],n=0;n<i.length;n++){var o=i[n];if(1==o.m_BitovePole.length&&o.m_BitovePole[0]==e)return o}return null},a.prototype.GetDen_bits=function(t){return this.GetObdobie_bits("days",t)},a.prototype.GetObdobieCount=function(t){switch(t){case"terms":return this.m_nTermov;case"weeks":return this.m_nTyzdnov;case"days":return this.m_nDni}throw"Error 2260283089"},a.prototype.GetObdobie_One=function(t,e){for(var i=this.m_ObjectsO[t+"defs"],n=0;n<i.length;n++){var o=i[n];if("one"==o.m_Typ&&o.m_Val==e)return o}return null},a.prototype.GetPeriod=function(t,e){return void 0===e&&(e=!1),e?this.m_ObjectsI.breaks[t]:this.m_ObjectsI.periods[t]},a.prototype.VhodnostKarty_PUT=function(t){for(var e=t.m_pHodina,i=t.GetVolno(e.m_pPredmet.timeoff()),n=0,o=e.m_Triedy;n<o.length;n++){var r=o[n];i=rt.defaultVolnoJoiner(i,t.GetVolno(r.timeoff()))}for(var a=0,s=e.m_Ucitelia;a<s.length;a++){var l=s[a];i=rt.defaultVolnoJoiner(i,t.GetVolno(l.timeoff()))}return i},a.prototype.TableObjects=function(t){switch(t){case"days":case"weeks":case"terms":for(var e=[],i=0,n=this.m_ObjectsO[t+"defs"];i<n.length;i++){var o=n[i];"one"==o.m_Typ&&e.push(o)}return e;default:return this.m_ObjectsO[t].slice()}},a.prototype.Obdobia=function(t){switch(t){case"termsdefs":case"weeksdefs":case"daysdefs":return this.TableObjects(t)}throw"Error 8110791570"},a.prototype.GetRegName=function(t){void 0===t&&(t=!1);var e="";this.m_pRozApp&&(e=this.m_pRozApp.jsc.reg_name);var i=this.dbi.rowData("globals","1");return i&&i.reg_name&&(e=i.reg_name),e||"Unregistered version"},a.prototype.decodeRo=function(t){if(!t)return null;var e=t[0],i=t[1];return"globals"==e?this:this.m_ObjectsI[e][i]},a.prototype.object2ro=function(t){return t?this.decodeRo([t.table,t.id]):null},a.prototype.FindTableTlacZostava=function(t){for(var e=0,i=this.m_ObjectsO.ttreports;e<i.length;e++){var n=i[e];if(n.m_PageTables.includes(t))return n}return null},a.prototype.GetDozoryTWDH=function(t,e,i,n,o,r){for(var a=[],s=0,l=this.m_ObjectsO.classroomsupervisions;s<l.length;s++){var c=l[s];c.m_pUcitel!=t&&c.m_pUcebna!=t||(n<0||c.m_Den<0||c.m_Den==n)&&c.m_Hodina==o&&c.m_Prestavka==r&&(i<0||c.m_Tyzden<0||i==c.m_Tyzden)&&(e<0||c.m_Term<0||e==c.m_Term)&&a.push(c)}return a},a.prototype.GetPeriodTime=function(t,e){for(var i=null,n=null,o=null,r=null,a=0,s=t;a<s.length;a++){var l=s[a];l instanceof p&&(i=l),l instanceof S&&(i=l.m_pTrieda),l instanceof v&&(n=l),l instanceof j&&(o=l),"daysdefs"==l.m_Table&&(r=l)}return!i&&e&&0<e.m_Triedy.length&&(i=e.m_Triedy[0]),null==o?{starttime:"00:00",endtime:"00:00"}:o.GetTime(r?r.m_Val:-1,i,n,e)},a.prototype.GetHodinaNazov=function(t,e){void 0===e&&(e=!1);var i=this.GetPeriod(t,e);return i?i.GetSkratka():e?(0<t?this.GetHodinaNazov(t-1,!1):"")+"/"+this.GetHodinaNazov(t,!1):"???"+t},a.prototype.GlobalData=function(){return this.m_ObjectsI.globals[1].m_Data},a.prototype.GetJoinNames=function(t){try{return this.GlobalData().settings.name_format}catch(t){return"FSL"}},a.prototype.FormatTime=function(t){if(!t)return"";var e=t.split(":"),i=parseInt(e[0]),n=parseInt(e[1]),o=i<12?"AM":"PM",r=12<i?i-12:i;function a(t){return t<10?"0"+t:t}switch(parseInt(this.GlobalData().settings.m_nTimeFormat)){case 0:default:return i+":"+a(n);case 1:return a(i)+":"+a(n);case 2:return r+":"+a(n)+" "+o;case 3:return a(r)+":"+a(n)+o;case 4:return r+":"+a(n);case 5:return a(r)+":"+a(n)}},a.prototype.FormatTimeFromTo=function(t,e,i){void 0===i&&(i=" - ");for(var n=this.FormatTime(t),o=this.FormatTime(e),r=0,a=["AM","PM"];r<a.length;r++){var s=a[r];o.includes(s)&&(n=n.replace(s,""))}return n.trim()+i+o.trim()},a);function a(){var t=i.call(this,null,"globals",{})||this;for(var e in t.m_ObjectsO={globals:[],termsdefs:[],weeksdefs:[],daysdefs:[],periods:[],breaks:[],bells:[],teachers:[],classes:[],groups:[],buildings:[],classrooms:[],subjects:[],students:[],lessons:[],cards:[],ttviews:[],ttreports:[],studentsubjects:[],classroomsupervisions:[],cardrelationships:[],coursegroups:[]},t.m_ObjectsI={globals:{},termsdefs:{},weeksdefs:{},daysdefs:{},periods:{},breaks:{},bells:{},teachers:{},classes:{},groups:{},buildings:{},classrooms:{},subjects:{},students:{},lessons:{},cards:{},ttviews:{},ttreports:{},studentsubjects:{},classroomsupervisions:{},cardrelationships:{},coursegroups:{}},t.m_nHodin=10,t.m_nDni=5,t.m_DaysAll="11111",t.m_nTyzdnov=1,t.m_WeeksAll="1",t.m_nTermov=1,t.m_TermsAll="1",t.m_nHodinyOd=0,t.m_pRozApp=null,t.dbi=new it.MutableDBI(nt.client_req),t.m_ObjectsO)new it.DBITable(t.dbi,{id:e});return t.m_nHodinyDo=t.m_nHodin-1,t}n.CRok=r;var _,p=(_=o,x.__extends(s,_),s.prototype.InitFromData=function(){var t=this.m_Data;this.m_nZvonenieID=parseInt(t.bell),this.m_pUcitel=this.m_pRok.m_ObjectsI.teachers[t.teacherid]},s.prototype.HodinaMozeSem=function(t,e){return t.m_Triedy.includes(this)},s.prototype.FindDelenie=function(t,e){for(var i=0;i<this.m_Delenia.length;i++)if((n=this.m_Delenia[i]).divisiontag==t)return n;var n;return e?n=new u(this,t):null},s.prototype.UI_KartaVyberOdtialto=function(t,e,i,n){if(i.IsLocked())return!1;var o=n.ctrlKey,r=n.shiftKey;if(o||r){if(!o){ASC.assert(r);var a=i.m_pHodina.GetPrvaNeumiestnenaKarta();return t.ChytKartu(a,this),!0}for(var s=this.GetKartyTuTWDH(e.m_nTerm,e.m_nWeek,e.m_nDay,e.period,t.m_pTriedyView.m_nROJTF),l=[],c=0;c<s.length;c++)(a=s[c]).IsLocked()||a!=i&&!i.ChytCtrlPridaj_Moze(a)||l.push(a);if(0==l.length)return!1;if(r){var m=[];for(c=0;c<l.length;c++){var h=(a=l[c]).m_pHodina.GetPrvaNeumiestnenaKarta();h&&m.push(h)}return 0<m.length&&t.ChytKarty(m,this),!0}for(c=0;c<l.length;c++)a=l[c],t.InvalidateKarta(a),a.DeUmiestniKarta();return t.ChytKarty(l,this),t.Validate(),t.CursorMove(n),!0}return _.prototype.UI_KartaVyberOdtialto.call(this,t,e,i,n)},s.prototype.UI_RiadokPopup=function(t,e){Q.CUtils.AddMenuItemSmart(t,"edit",{icon:Q.CUtils.GetTableIcon(this.m_Table)}),Q.CUtils.AddMenuItemSmart(t,"timeoff"),Q.CUtils.AddMenuItemSmart(t,"constraints"),Q.CUtils.AddMenuItemSmart(t,"lessons"),Q.CUtils.AddMenuItemSmart(t,"divisions")},s.prototype.UI_OnCommand=function(t,e,i){var n=this;if(void 0===i&&(i=null),_.prototype.UI_OnCommand.call(this,t,e,i))return!0;switch(t){case"divisions":return Promise.resolve().then(function(){return require("./groups")}).then(function(t){return t.showClassDivisionsDlg(n.m_pRok.m_pRozApp.ttgpid,n.m_Id)}),!0}return!1},s.prototype.GetSkupinaCelaTrieda=function(){for(var t=0,e=this.m_Delenia;t<e.length;t++)for(var i=0,n=e[t].m_Skupiny;i<n.length;i++){var o=n[i];if(o.m_bCelaTrieda)return o}return null},s.prototype.GetUcebna=function(){var t=this.m_Data.classroomids[0];return t?this.m_pRok.m_ObjectsI.classrooms[t]:null},s.prototype.JeObed=function(t){var e=this.m_Data.constraints;return"d"!=e.lunch_periodfrom&&"d"!=e.lunch_periodto&&t>=parseInt(e.lunch_periodfrom)&&t<=parseInt(e.lunch_periodto)},s);function s(t,e){var i=_.call(this,t,"classes",e)||this;return i.m_Delenia=[],i.m_Skupiny=[],i.m_nZvonenieID=0,i.m_pUcitel=null,i.InitFromData(),i}n.CTrieda=p;var l,c=(l=o,x.__extends(m,l),m.prototype.GetNazov=function(){return this.m_bCelaTrieda?ASC.ttls(1643):this.m_Data.name},m.prototype.GetColor=function(){return this.m_Data.color||Q.farby[this.m_pTrieda.m_Skupiny.indexOf(this)%Q.farby.length]},m.prototype.InitFromData=function(){var t=this.m_Data;this.m_pTrieda=this.m_pRok.m_ObjectsI.classes[t.classid],this.m_pDelenie=this.m_pTrieda.FindDelenie(this.m_Data.ascttdivision,!0),this.m_pDelenie.m_Skupiny.includes(this)&&this.m_pRok.m_pRozApp.Fail("Error 0188464415"),this.m_nPoradieVDeleni=this.m_pDelenie.m_Skupiny.length,this.m_pDelenie.m_Skupiny.push(this),this.m_pTrieda.m_Skupiny.push(this),this.m_bCelaTrieda=ASC.boolVal(t.entireclass),this.m_bOkGroup=ASC.boolVal(t.okgroup)},m.prototype.BeforeRemove=function(){ASC.remove(this.m_pDelenie.m_Skupiny,this),ASC.remove(this.m_pTrieda.m_Skupiny,this)},m.prototype.HodinaMozeSem=function(t,e){for(var i=0;i<t.m_Skupiny.length;i++){var n=t.m_Skupiny[i];if(n.m_pTrieda==this.m_pTrieda){if(n==this)return!0;if(n.m_pDelenie!=this.m_pDelenie)return!0}}return!1},m);function m(t,e){var i=l.call(this,t,"groups",e)||this;return i.m_bCelaTrieda=!1,i.m_bOkGroup=!1,i.m_bKurz=!1,i.m_Ziaci=[],i.InitFromData(),i}n.CSkupina=c;var h,u=(h=o,x.__extends(d,h),d.prototype.UpdatePoradieSkupin=function(){if(1<this.m_Skupiny.length){this.m_Skupiny.sort(function(t,e){return t.GetDBIndex()-e.GetDBIndex()});var e=0;this.m_Skupiny.forEach(function(t){t.m_nPoradieVDeleni=e++})}},d);function d(t,e){var i=h.call(this,t.m_pRok,"divisions",{})||this;return i.m_Skupiny=[],i.m_pTrieda=t,i.divisiontag=e,i.m_pTrieda.m_Delenia.push(i),i}n.CDelenie=u;var f,v=(f=o,x.__extends(b,f),b.prototype.GetNazov=function(t){return void 0===t&&(t="name"),t&&"name"!=t||(t=this.m_pRok.GetJoinNames(this.m_Table)),f.prototype.GetNazov.call(this,t)},b.prototype.HodinaMozeSem=function(t,e){return t.m_Data.teacherids.includes(this.m_Id)},b.prototype.UI_RiadokPopup=function(t,e){Q.CUtils.AddMenuItemSmart(t,"edit",{icon:Q.CUtils.GetTableIcon(this.m_Table)}),Q.CUtils.AddMenuItemSmart(t,"timeoff"),Q.CUtils.AddMenuItemSmart(t,"constraints"),Q.CUtils.AddMenuItemSmart(t,"lessons")},b.prototype.GetDozory=function(){for(var t=[],e=0,i=this.m_pRok.TableObjects("classroomsupervisions");e<i.length;e++){var n=i[e];n.m_pUcitel==this&&t.push(n)}return t},b.prototype.GetPocetDozorov=function(){for(var t=0,e=0,i=0,n=this.GetDozory();i<n.length;i++)t++,e+=n[i].GetDlzkaVMinutach();return{count:t,minutes:e}},b);function b(t,e){return f.call(this,t,"teachers",e)||this}n.CUcitel=v;var y,g=(y=o,x.__extends(k,y),k.prototype.HodinaMozeSem=function(t,e){return ASC.strEquals(t.m_Data.subjectid,this.m_Id)},k.prototype.UI_RiadokPopup=function(t,e){Q.CUtils.AddMenuItemSmart(t,"edit",{icon:Q.CUtils.GetTableIcon(this.m_Table)}),Q.CUtils.AddMenuItemSmart(t,"timeoff"),Q.CUtils.AddMenuItemSmart(t,"constraints"),Q.CUtils.AddMenuItemSmart(t,"lessons")},k.prototype.GetDoUvazkuRatatAko=function(){var t;return parseFloat(null!==(t=this.m_Data.contract_weight)&&void 0!==t?t:1)},k);function k(t,e){var i=y.call(this,t,"subjects",e)||this;return i.m_Hodiny=[],i}n.CPredmet=g;var T,S=(T=o,x.__extends(C,T),C.prototype.GetNazov=function(t){return void 0===t&&(t="name"),t&&"name"!=t||(t=this.m_pRok.GetJoinNames(this.m_Table)),T.prototype.GetNazov.call(this,t)},C.prototype.LinkSkupina=function(t,e){void 0===e&&(e=!0),t&&(e?(this.m_Skupiny.includes(t)||this.m_Skupiny.push(t),t.m_Ziaci.includes(this)||t.m_Ziaci.push(this)):(ASC.remove(this.m_Skupiny,t),ASC.remove(t.m_Ziaci,this)))},C.prototype.InitFromData=function(){var t=this.m_Data;this.m_pTrieda=this.m_pRok.m_ObjectsI.classes[t.classid],this.LinkSkupina(this.m_pTrieda.GetSkupinaCelaTrieda());for(var e=0,i=t.groupids;e<i.length;e++){var n=i[e],o=this.m_pRok.m_ObjectsI.groups[n];this.LinkSkupina(o)}},C.prototype.HodinaMozeSem=function(t,e){if(!t.m_Triedy.includes(this.m_pTrieda))return!1;if(e&tt.ROJTF_PRIBLIZNE)return this.m_pTrieda.HodinaMozeSem(t,e);if(this.GetZiakPredmet(t))return!0;for(var i=0,n=t.m_Skupiny;i<n.length;i++){var o=n[i];if(this.SkupinaStatus(o)>=(o.m_bOkGroup?1:0))return!0}return!1},C.prototype.GetZiakPredmet=function(t){if(!t.m_KurzyPreTriedy.includes(this.m_pTrieda))return null;if(t.m_nPoradieSeminaru<0)return null;for(var e=0,i=this.m_ZiakPredmety;e<i.length;e++){var n=i[e];if(n.m_pPredmet==t.m_pPredmet&&n.m_nPoradieSeminaru==t.m_nPoradieSeminaru)return n}return null},C.prototype.SkupinaStatus=function(t){if(t.m_pTrieda!=this.m_pTrieda)return-1;if(t.m_bCelaTrieda)return 1;for(var e=0,i=0,n=this.m_Skupiny;i<n.length;i++){var o=n[i];if(o==t)return 1;o.m_pDelenie==t.m_pDelenie&&(e=-1)}return e},C.prototype.UI_RiadokPopup=function(t,e){Q.CUtils.AddMenuItemSmart(t,"edit",{icon:Q.CUtils.GetTableIcon(this.m_Table)})},C.prototype.UI_KartaVyberOdtialto=function(t,e,i,n){var o=this.GetZiakPredmet(i.m_pHodina);return o?!o.m_bLocked&&!!o.SetPoradieSeminaru(-1)&&(t.InvalidateObject(o),t.ChytSeminar(i.m_pHodina.m_pPredmet,this.m_pTrieda),!0):(ASC.showContextMenu([],n,{header:ASC.escapeHTML(Q.CUtils.GetUINazov(i.m_pHodina,"short"))}),!1)},C.prototype.UI_OnCommand=function(i,t,e){var n=this;void 0===e&&(e=null);var o=t.m_pRozApp;switch(i){case"edit":return Promise.resolve().then(function(){return require("./dlg")}).then(function(t){return t.showItemDlg(o.ttgpid,"students",n.m_Id)}),!0;case"lockcard":case"unlockcard":var r=e;return(a=this.GetZiakPredmet(r.m_pHodina))&&(a.SetLocked("lockcard"==i),o.InvalidateObject(a)),!0;case"removecard":var a;return r=e,(a=this.GetZiakPredmet(r.m_pHodina))&&(a.SetPoradieSeminaru(-1),o.InvalidateObject(a)),!0;case"deletecards":case"lockcards":case"unlockcards":return this.GetKartyTu(t.m_nROJTF).forEach(function(t){var e=n.GetZiakPredmet(t.m_pHodina);if(e){switch(i){case"deletecards":e.m_bLocked||e.SetPoradieSeminaru(-1);break;case"lockcards":0<e.m_nPoradieSeminaru&&e.SetLocked(!0);break;case"unlockcards":e.SetLocked(!1)}o.InvalidateObject(e)}}),!0}return!1},C);function C(t,e){var i=T.call(this,t,"students",e)||this;return i.m_pTrieda=null,i.m_ZiakPredmety=[],i.m_Skupiny=[],i.InitFromData(),i}n.CZiak=S;var A,w=(A=o,x.__extends(I,A),I.prototype.InitFromData=function(){var t=this.m_Data;this.m_pZiak=this.m_pRok.m_ObjectsI.students[t.studentid],this.m_pPredmet=this.m_pRok.m_ObjectsI.subjects[t.subjectid];var e=t.seminargroup;this.m_nPoradieSeminaru=e?parseInt(e):-1,this.m_bLocked=!!t.locked,this.m_pZiak.m_ZiakPredmety.push(this)},I.prototype.BeforeRemove=function(){ASC.remove(this.m_pZiak.m_ZiakPredmety,this)},I.prototype.SetPoradieSeminaru=function(t){return this.m_nPoradieSeminaru=t,this.m_Data.seminargroup=this.m_nPoradieSeminaru<0?"":this.m_nPoradieSeminaru,!0},I.prototype.SetLocked=function(t){this.m_bLocked=t,this.m_Data.locked=this.m_bLocked?1:0},I);function I(t,e){var i=A.call(this,t,"studentsubjects",e)||this;return i.m_nPoradieSeminaru=-1,i.m_bLocked=!1,i.InitFromData(),i}n.CZiakPredmet=w;var R,P=(R=o,x.__extends(O,R),O.prototype.InitFromData=function(){this.m_pBudova=this.m_pRok.m_ObjectsI.buildings[this.m_Data.buildingid]},O.prototype.HodinaMozeSem=function(t,e){var i=t.m_Data.classroomidss;if(!i)return console.log("missing classroomidsss for lesson "+t.m_Id),!1;for(var n=0;n<i.length;n++)if(i[n].includes(this.m_Id))return!0;return!1},O.prototype.JeKmenovaPre=function(t){return t.m_Data.classroomids.includes(this.m_Id)},O.prototype.KartaJeTu=function(t){return t.m_Data.classroomids.includes(this.m_Id)},O.prototype.UI_RiadokPopup=function(t,e){Q.CUtils.AddMenuItemSmart(t,"edit",{icon:Q.CUtils.GetTableIcon(this.m_Table)}),Q.CUtils.AddMenuItemSmart(t,"timeoff"),Q.CUtils.AddMenuItemSmart(t,"constraints"),Q.CUtils.AddMenuItemSmart(t,"lessons")},O.prototype.IsVolno=function(t){for(var e=0,i=this.GetObsadenieK(t);e<i.length;e++){var n=i[e];if(!t.MozeKolidovat(n))return!1}return!0},O.prototype.UI_KartaVyberOdtialto=function(t,e,i,n){return!!i.JeUmiestnena()&&!i.IsLocked()&&(t.InvalidateKarta(i),i.FreeUcebnaU(this),t.ChytKartu(i),!0)},O.prototype.UI_KartaMozeSem=function(t,e){for(var i=0,n=e.Karty();i<n.length;i++){var o=n[i],r=o.m_pHodina;if(o.JeUmiestnena()){for(var a=0;a<r.m_nPotrebujeUcebni;a++)if(!o.Ucebna(a)&&r.GetUcebneV(a).includes(this))return!0}else if(this.HodinaMozeSem(o.m_pHodina,t.m_pTriedyView.m_nROJTF))return!0}return!1},O.prototype.UI_KartaUmiestni=function(_,u,d,p){return x.__awaiter(this,void 0,void 0,function(){var e,i,n,o,r,a,s,l,c,m,h;return x.__generator(this,function(t){switch(t.label){case 0:return(e=u.Karty().find(function(t){return!t.JeUmiestnena()||t.JeTu_Policko(d)}))?e.JeUmiestnena()?[3,2]:[4,this.UI_ChooseObdobie(e.m_pHodina,d,p)]:[2];case 1:if(!(i=t.sent()))return[2];if(n=i.terms,o=i.weeks,r=i.days,a=d.period,this.m_pRok.ChangePosKarta_TWDH(e,n,o,r,a,!1),s=[],e.SimpleKolizie(s),s.length)return e.DeUmiestniKarta(),[2];t.label=2;case 2:for(l=-1,c=e.m_pHodina,m=0;m<c.m_nPotrebujeUcebni;m++)if(!e.Ucebna(m)&&c.GetUcebneV(m).includes(this)){l=m;break}return l<0||e.JeTu_Policko(d)&&(h=[],this.AddKartyTuK(h,e,_.m_pTriedyView.m_nROJTF),1<this.m_nHodinNaraz&&(h=[]),e.RemoveMozuKolidovat(h),e.SetUcebna(this,l),_.InvalidateKarta(e),_.OdhodKartu()),[2]}})})},O.prototype.UI_OnCommand=function(t,e,i){var n=this;void 0===i&&(i=null);var o=e.m_pRozApp;switch(t){case"deletecards":return this.GetKartyTu(e.m_nROJTF).forEach(function(t){t.IsLocked()||(o.InvalidateKarta(t),t.FreeUcebnaU(n))}),!0}return!!R.prototype.UI_OnCommand.call(this,t,e,i)},O.prototype.JeBlizkaUcebna=function(t){if(t)return this.m_Data.nearbyclassroomids.includes(t.m_Id)},O.prototype.JeMulityCard=function(){return 1<parseInt(this.m_Data.constraints.maxcardspos)},O.prototype.GetDozory=function(){for(var t=[],e=0,i=this.m_pRok.TableObjects("classroomsupervisions");e<i.length;e++){var n=i[e];n.m_pUcebna==this&&t.push(n)}return t},O);function O(t,e){var i=R.call(this,t,"classrooms",e)||this;return i.m_nHodinNaraz=1,i.m_pBudova=null,i.InitFromData(),i}n.CUcebna=P;var D,z=(D=o,x.__extends(G,D),G.prototype.InitFromData=function(){var e=this,t=this.m_Data,i=this.m_pRok;this.m_Skupiny=[],this.m_Triedy=[],this.m_KurzyPreTriedy=[],this.m_nPoradieSeminaru=-1;for(var n=0;n<t.groupids.length;n++){var o=this.m_pRok.m_ObjectsI.groups[t.groupids[n]];this.m_Skupiny.push(o),this.m_Triedy.includes(o.m_pTrieda)||this.m_Triedy.push(o.m_pTrieda)}t.seminargroup&&(this.m_nPoradieSeminaru=parseInt(t.seminargroup),i.ids2ro("classes",t.classids).forEach(function(t){e.m_Triedy.includes(t)||(e.m_Triedy.push(t),e.m_KurzyPreTriedy.push(t))})),this.m_Ucitelia=i.ids2ro("teachers",t.teacherids),this.m_pPredmet=i.m_ObjectsI.subjects[t.subjectid],this.m_pPredmet&&this.m_pPredmet.m_Hodiny.push(this);for(var r=0,a=["terms","weeks","days"];r<a.length;r++){var s=a[r],l=i.m_ObjectsI[s+"defs"][t[s+"defid"]];ASC.assert(!!l),this.m_pObdobie[s]=l}t.classroomidss?this.m_nPotrebujeUcebni=t.classroomidss.length:console.log("missing classroomidss in lesson "+this.m_Id)},G.prototype.BeforeRemove=function(){this.m_pPredmet&&ASC.remove(this.m_pPredmet.m_Hodiny,this)},G.prototype.JeSeminar=function(){return 0<this.m_KurzyPreTriedy.length},G.prototype.IsBezTriedy=function(){return!(0<this.m_KurzyPreTriedy.length||0<this.m_Skupiny.length)},G.prototype.IsBezUcitela=function(){return 0==this.m_Ucitelia.length},G.prototype.GetDelenie=function(t){for(var e=0,i=this.m_Skupiny;e<i.length;e++){var n=i[e];if(n.m_pTrieda==t)return n.m_pDelenie}return null},G.prototype.GetDelenieSkupinyBity=function(t){for(var e=0,i=0;i<this.m_Skupiny.length;i++){var n=this.m_Skupiny[i];n.m_pTrieda==t&&(e|=1<<n.m_nPoradieVDeleni)}return e},G.prototype.GetDlzka=function(){return this.m_Data.durationperiods-1},G.prototype.GetPocet=function(){return this.m_Karty.length},G.prototype.GetPrvaNeumiestnenaKarta=function(){for(var t=0;t<this.m_Karty.length;t++){var e=this.m_Karty[t];if(!e.JeUmiestnena())return e}return null},G.prototype.GetPrvaUmiestnenaKarta=function(){for(var t=0;t<this.m_Karty.length;t++){var e=this.m_Karty[t];if(e.JeUmiestnena())return e}return null},G.prototype.ChytCtrlPridaj_Moze=function(t){var e=this,i=t;if(e==i)return!1;for(var n=0,o=["terms","weeks","days"];n<o.length;n++){var r=o[n];if(e.m_pObdobie[r]!=i.m_pObdobie[r])return!1}if(e.GetDlzka()!=i.GetDlzka())return!1;for(var a=0;a<e.m_Ucitelia.length;a++)if(i.m_Ucitelia.includes(e.m_Ucitelia[a]))return!1;for(var s=!1,l=0,c=e.m_Skupiny;l<c.length;l++)for(var m=c[l],h=0,_=i.m_Skupiny;h<_.length;h++){var u=_[h];if(m.m_pTrieda==u.m_pTrieda){if(s=!0,m.m_pDelenie!=u.m_pDelenie)return!1;if(m==u)return!1}}for(var d=0,p=e.m_KurzyPreTriedy;d<p.length;d++){var f=p[d];i.m_KurzyPreTriedy.includes(f)&&(s=!0)}return!!s},G.prototype.GetTermPrvyDobry=function(t){return-1==t&&this.m_pObdobie.terms.IsCompatible(this.GetTerm())?this.GetTerm():this.GetPrvaUmiestnenaKarta()?this.GetTerm():this.m_pObdobie.terms.GetPrveDobrePole(t)},G.prototype.GetWeekPrvyDobry=function(t){return this.m_pObdobie.weeks.GetPrveDobrePole(t)},G.prototype.GetDenPrvyDobry=function(t){return this.m_pObdobie.days.GetPrveDobrePole(t)},G.prototype.GetTerm=function(){return this.m_Data.terms},G.prototype.SetTerm=function(t){ASC.assert(this.m_pObdobie.terms.IsCompatible(t)),this.m_Data.terms=t},G.prototype.GetUcebneV=function(t){return t<0||t>=this.m_nPotrebujeUcebni?[]:this.m_pRok.ids2ro("classrooms",this.m_Data.classroomidss[t])},G.prototype.IsUvazujUcebne=function(){return 0<this.m_nPotrebujeUcebni},G.prototype.UI_HodinaPopup=function(t,e){var i=this;Q.CUtils.AddMenuItemSmart(t,"editlesson",{onclick:function(){return x.__awaiter(i,void 0,void 0,function(){return x.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./dlg")})];case 1:return[2,t.sent().showItemDlg(this.m_pRok.m_pRozApp.ttgpid,"lessons",this.m_Id)]}})})}})},G.prototype.GetZiaci=function(){for(var t=[],e=0,i=this.m_KurzyPreTriedy;e<i.length;e++){var n=i[e].GetSkupinaCelaTrieda();if(n)for(var o=0,r=n.m_Ziaci;o<r.length;o++)for(var a=r[o],s=0,l=a.m_ZiakPredmety;s<l.length;s++){var c=l[s];if(c.m_pPredmet==this.m_pPredmet&&c.m_nPoradieSeminaru==this.m_nPoradieSeminaru){t.push(a);break}}}return t},G.prototype.GetPocetZiakov=function(){return this.GetZiaci().length},G);function G(t,e){var i=D.call(this,t,"lessons",e)||this;return i.m_Karty=[],i.m_Skupiny=[],i.m_Triedy=[],i.m_KurzyPreTriedy=[],i.m_nPoradieSeminaru=-1,i.m_nPotrebujeUcebni=0,i.m_Ucitelia=[],i.m_pPredmet=null,i.m_pObdobie={terms:null,weeks:null,days:null},i.InitFromData(),i}n.CHodina=z;var V,M=(V=o,x.__extends(U,V),U.prototype.InitFromData=function(){var t=this.m_Data;this.m_pHodina=this.m_pRok.m_ObjectsI.lessons[t.lessonid],this.m_pHodina.m_Karty.push(this)},U.prototype.BeforeRemove=function(){ASC.remove(this.m_pHodina.m_Karty,this)},U.prototype.Ucebne=function(){var e=this,t=this.m_Data.classroomids,i=[];return t.forEach(function(t){t&&i.push(e.m_pRok.m_ObjectsI.classrooms[t])}),i},U.prototype.GetHodina=function(){return 0|this.m_Data.period},U.prototype.GetDlzka=function(){return this.m_pHodina.GetDlzka()},U.prototype.durationperiods=function(){return this.m_pHodina.m_Data.durationperiods},U.prototype.days=function(){return this.JeUmiestnena()?this.m_Data.days:""},U.prototype.weeks=function(){return this.JeUmiestnena()?this.m_Data.weeks:""},U.prototype.terms=function(){return this.JeUmiestnena()?this.m_pHodina.m_Data.terms:""},U.prototype.GetVolno=function(t){return rt.timeoff_getByBits(t,this.terms(),this.weeks(),this.days(),this.GetHodina(),this.durationperiods())},U.prototype.JeTu_Policko=function(t){return this.JeTu_TWDH(t.m_nTerm,t.m_nWeek,t.m_nDay,t.period)},U.prototype.JeTu_TWDH=function(t,e,i,n){if(!this.JeUmiestnena())return!1;if(0<=t&&"1"!=this.m_pHodina.m_Data.terms[t])return!1;if(0<=e&&"1"!=this.m_Data.weeks[e])return!1;if(0<=i&&"1"!=this.m_Data.days[i])return!1;if(0<=n){var o=this.GetHodina(),r=o+this.GetDlzka();if(n<o||r<n)return!1}return!0},U.prototype.GetTableIds=function(t){switch(t){case"subjects":return[this.m_pHodina.m_Data.subjectid];case"classes":return this.m_pHodina.m_Data.classids;case"teachers":return this.m_pHodina.m_Data.teacherids;case"classrooms":return this.m_Data.classroomids;case"buildings":for(var e=[],i=0;i<this.m_pHodina.m_nPotrebujeUcebni;i++){var n=this.Ucebna(i);n&&n.m_pBudova&&e.push(n.m_pBudova.m_Id)}return e;case"groups":return this.m_pHodina.m_Data.groupids}return[]},U.prototype.GetFarby=function(t){var e=[];if("seminargroup"==t){var i=this.m_pHodina.m_nPoradieSeminaru;0<i&&e.push(Q.CUtils.GetFarbaIndex(i-1))}else for(var n=this.GetTableIds(t),o=0;o<n.length;o++){var r=this.m_pRok.m_ObjectsI[t][n[o]];r&&e.push(r.GetColor())}return e},U.prototype.GetFarbyChyby=function(){var t=[];return"0"==this.m_pRok.VhodnostKarty_PUT(this)&&t.push("#ff0000"),this.VsetkyUcebneValid()||t.push("#ffffff"),t},U.prototype.GetFarbyFazy=function(){return this.JeUmiestnena()&&ot.fazyColors([this.terms(),this.weeks()])||[]},U.prototype.GetTexty=function(t,e,i){void 0===e&&(e="short");for(var n="",o=this.m_pHodina,r=0;r<t.length;r++){0<r&&(n+="\n");var a=t[r];switch(a){case"groupnames":for(var s=[],l=0,c=o.m_Skupiny;l<c.length;l++){var m=c[l];if(!(m.m_bCelaTrieda||i instanceof p&&i!=m.m_pTrieda)){var h=m.GetNazov();s.includes(h)||s.push(h)}}n+=s.join(" ");break;case"seminargroup":0<o.m_nPoradieSeminaru&&(n+=o.m_nPoradieSeminaru);break;case"subjects":if(n+=this.m_pRok.dbi.rowName(a,o.m_pPredmet.m_Id,e),0<o.m_nPoradieSeminaru){for(var _=!1,u=0,d=o.m_pPredmet.m_Hodiny;u<d.length;u++)if(1<d[u].m_nPoradieSeminaru){_=!0;break}_&&(n+=o.m_nPoradieSeminaru)}break;case"students_count":n+="("+o.GetPocetZiakov()+")";break;default:n+=this.m_pRok.dbi.rowNames(a,this.GetTableIds(a),e)}}return n},U.prototype.GetDelenieSkupin=function(t){var e=this.m_pHodina.GetDelenie(t);return e?e.m_Skupiny.length:-1},U.prototype.GetDelenieSkupinyBity=function(t){return this.m_pHodina.GetDelenieSkupinyBity(t)},U.prototype.JeUmiestnena=function(){return!!this.m_Data.days},U.prototype.CyklovaniePo=function(){var t=0;return this.m_Data.days!=this.m_pRok.m_DaysAll&&(t|=1),this.m_Data.weeks!=this.m_pRok.m_WeeksAll&&(t|=2),this.m_pHodina.m_Data.terms!=this.m_pRok.m_TermsAll&&(t|=4),t},U.prototype.DeUmiestniKarta=function(){this.m_Data.days="",this.m_Data.weeks="",this.m_Data.period=-1,this.m_Data.classroomids.length=0},U.prototype.IsLocked=function(){return ASC.boolVal(this.m_Data.locked)},U.prototype.SetLocked=function(t){this.m_Data.locked=t?1:0},U.prototype.ChytCtrlPridaj_Moze=function(t){return t!=this&&t.m_pHodina!=this.m_pHodina&&t.JeUmiestnena()==this.JeUmiestnena()&&this.m_pHodina.ChytCtrlPridaj_Moze(t.m_pHodina)},U.prototype.Obdobia_MozeSem_TWDH=function(t,e,i,n,o){if(void 0===o&&(o=!1),this.JeTu_TWDH(t,e,i,n))return!0;if(0<=t){if(o&&this.m_pHodina.GetPrvaUmiestnenaKarta()&&"1"!=this.m_pHodina.GetTerm()[t])return!1;if(!this.m_pHodina.m_pObdobie.terms.JeMoznyBit(t))return!1}if(0<=e&&!this.m_pHodina.m_pObdobie.weeks.JeMoznyBit(e))return!1;if(0<=i&&!this.m_pHodina.m_pObdobie.days.JeMoznyBit(i))return!1;if(0<=n){if(n<this.m_pRok.m_nHodinyOd)return!1;if(n+this.m_pHodina.GetDlzka()>this.m_pRok.m_nHodinyDo)return!1}return!0},U.prototype.SetPosition=function(t,e,i,n){t&&i&&n||ASC.assert(!1),this.m_Data.days=t,this.m_Data.period=e,this.m_pHodina.SetTerm(i),this.m_Data.weeks=n},U.prototype.SimpleKolizie=function(t,e){void 0===e&&(e=!1);for(var i=0,n=this.m_pHodina.m_Ucitelia;i<n.length;i++)n[i].AddKartyTuK(t,this,0);for(var o=0,r=this.m_pHodina.m_Skupiny;o<r.length;o++)r[o].AddKartyTuK(t,this,0);Q.CUtils.FastRemove(t,this)},U.prototype.GetHodinaOd=function(){return parseInt(this.m_Data.period)},U.prototype.GetHodinaDo=function(){return this.GetHodinaOd()+this.m_pHodina.GetDlzka()},U.prototype.VsetkyUcebneValid=function(){for(var t=0;t<this.m_pHodina.m_nPotrebujeUcebni;t++)if(!this.Ucebna(t))return!1;return!0},U.prototype.Ucebna=function(t){if(void 0===t&&(t=0),t<0||t>=this.m_pHodina.m_nPotrebujeUcebni)return null;var e=this.m_Data.classroomids[t];return e?this.m_pRok.m_ObjectsI.classrooms[e]:null},U.prototype.MozeKolidovat=function(t){return t==this||(this.m_pHodina,t.m_pHodina,!1)},U.prototype.RemoveMozuKolidovat=function(t){for(var e=t.length-1;0<=e;e--)this.MozeKolidovat(t[e])&&t.splice(e,1)},U.prototype.SetUcebna=function(t,e){void 0===e&&(e=0),e<0||e>=this.m_pHodina.m_nPotrebujeUcebni||(this.m_Data.classroomids[e]=t?t.m_Id:"")},U.prototype.FreeUcebna=function(t){if(void 0===t&&(t=-1),-1!=t)t<0||t>=this.m_pHodina.m_nPotrebujeUcebni||this.Ucebna(t)&&(this.m_Data.classroomids[t]="");else for(t=0;t<this.m_pHodina.m_nPotrebujeUcebni;t++)this.FreeUcebna(t)},U.prototype.FreeUcebnaU=function(t){for(var e=0;e<this.m_pHodina.m_nPotrebujeUcebni;e++)this.Ucebna(e)==t&&this.FreeUcebna(e)},U.prototype.DajUcebnu=function(){if(!this.JeUmiestnena())return!0;for(var t=!0,e=0;e<this.m_pHodina.m_nPotrebujeUcebni;e++)if(!this.Ucebna(e)){var i=this.m_pHodina.GetUcebneV(e);if(0!=i.length){for(var n=null,o=0,r=i;o<r.length;o++){var a=r[o];if("0"!=this.GetVolno(a.timeoff())&&(1<a.m_nHodinNaraz||a.IsVolno(this))){n=a;break}}n?this.SetUcebna(a,e):t=!1}}return t},U);function U(t,e){var i=V.call(this,t,"cards",e)||this;return i.InitFromData(),i}n.CKarta=M;var H,K=(H=o,x.__extends(E,H),E.prototype.InitFromData=function(){var t=this.m_Data;this.m_BitovePole=t.vals},E.prototype.JeMoznyBit=function(t){for(var e=0;e<this.m_BitovePole.length;e++)if("1"==this.m_BitovePole[e][t])return!0;return!1},E.prototype.GetSumBitov=function(){for(var t=this.m_BitovePole,e=t[0],i=1;i<t.length;i++)e=ot.bitfieldOr(e,t[i]);return e},E.prototype.IsCompatible=function(t){for(var e=0;e<this.m_BitovePole.length;e++)if(this.m_BitovePole[e]==t)return!0;return!1},E.prototype.GetPrveDobrePole=function(t){if(t<0)return this.m_BitovePole[0];for(var e=0;e<this.m_BitovePole.length;e++)if("1"==this.m_BitovePole[e][t])return this.m_BitovePole[e];this.m_BitovePole[0]},E.prototype.GetNazov=function(t){if(void 0===t&&(t="name"),"number"==t){if("one"==this.m_Typ)return Q.CUtils.GetTableItemTypNazov(this.m_Table,1)+" "+(this.m_Val+1);t="short"}return H.prototype.GetNazov.call(this,t)},E.prototype.KartaJeTu=function(t,e){if(!t.JeUmiestnena())return!1;switch(this.m_Typ){case"all":case"any":return!0;case"one":var i=this.m_Val;switch(this.m_Table){case"daysdefs":return"1"==t.days()[i];case"weeksdefs":return"1"==t.weeks()[i]}}return!1},E.prototype.GetDlzka=function(){switch(this.m_Typ){case"one":case"any":return 1;case"all":return this.m_pRok.GetObdobieCount(this.m_ItemTable)}for(var t=0,e=this.m_BitovePole[0],i=0;i<e.length;i++)"1"==e[i]&&t++;return t},E.prototype.AvgPokrytieBitov=function(){return this.GetDlzka()/this.m_pRok.GetObdobieCount(this.m_ItemTable)},E);function E(t,e,i){var n=H.call(this,t,e,i)||this;return n.m_Val=null,n.m_BitovePole=[],n.m_ItemTable=e.substring(0,e.length-4),n.m_Typ=i.typ,"one"==n.m_Typ&&(n.m_Val=parseInt(i.val)),n.InitFromData(),n}n.CObdobie=K;var N,j=(N=o,x.__extends(Z,N),Z.prototype.InitFromData=function(){this.m_nHodina=parseInt(this.m_Id)},Z.prototype.GetTime=function(t,e,i,n){void 0===t&&(t=-1);var o=this.m_Data,r={starttime:o.starttime,endtime:o.endtime},a=null,s=0;if(e?s=e.m_nZvonenieID:i&&(s=parseInt(i.m_Data.bell)),n&&""!=ASC.strVal(n.m_Data.bell)&&(s=parseInt(n.m_Data.bell)),0<s){var l=this.m_pRok.m_ObjectsI.bells[s];l&&(a=l.m_Data["periods"==this.m_Table?"perioddata":"breakdata"][this.m_nHodina])}if(a&&(a.starttime&&(r.starttime=a.starttime),a.endtime&&(r.endtime=a.endtime)),0<=t){var c=o.daydata[t];a&&a.daydata&&(c=a.daydata[t]),c&&(c.starttime&&(r.starttime=c.starttime),c.endtime&&(r.endtime=c.endtime))}return r},Z.prototype.GetDlzkaVMinutach=function(t){void 0===t&&(t=-1);var e=this.GetTime(t);return Q.CUtils.minutes(e.endtime)-Q.CUtils.minutes(e.starttime)},Z.prototype.JeValidPreTriedu=function(t){var e=this.m_Data.printonlyinbells;if(Array.isArray(e))return 0==e.length||0<=ASC.indexOf2(e,t.m_nZvonenieID);var i=this.m_Data.printonlyinbell;return!!ASC.strEmpty(i)||parseInt(i)==t.m_nZvonenieID},Z);function Z(t,e,i){var n=N.call(this,t,e,i)||this;return n.InitFromData(),n}n.CPeriodOrBreak=j;var $,F=($=j,x.__extends(L,$),L.prototype.KartaJeTu=function(t,e){if(!t.JeUmiestnena())return!1;var i=this.m_nHodina,n=t.GetHodinaOd(),o=t.GetHodinaDo();return n<=i&&i<=o},L.GetMedzera=function(t,e,i){var n=e.GetTime(t),o=i.GetTime(t);return Q.CUtils.minutes(o.starttime)-Q.CUtils.minutes(n.endtime)},L);function L(t,e){return $.call(this,t,"periods",e)||this}n.CPeriod=F;var B,J=(B=j,x.__extends(W,B),W.prototype.KartaJeTu=function(t,e){return!1},W);function W(t,e){return B.call(this,t,"breaks",e)||this}n.CBreak=J;var Y,X=(Y=o,x.__extends(q,Y),q.prototype.InitFromData=function(){var t=this.m_Data,e=this.m_pRok;this.m_pUcebna=e.m_ObjectsI.classrooms[t.classroomid],this.m_pUcitel=e.m_ObjectsI.teachers[t.teacherid],this.m_Den=Q.CUtils.blank2minus(t.day),this.m_Tyzden=Q.CUtils.blank2minus(t.week),this.m_Term=Q.CUtils.blank2minus(t.term),""!=ASC.strVal(t.break)?(this.m_Hodina=parseInt(t.break),this.m_Prestavka=!0):(this.m_Hodina=parseInt(t.period),this.m_Prestavka=!1),this.m_bLocked=ASC.boolVal(t.locked)},q.prototype.SetLocked=function(t){this.m_Data.locked=t?1:0,this.m_bLocked=ASC.boolVal(this.m_Data.locked)},q.prototype.SetUcitel=function(t){this.m_Data.teacherid=t?t.m_Id:"",this.m_pUcitel=t},q.prototype.GetHodinaText=function(){return this.m_pRok.GetHodinaNazov(this.m_Hodina,this.m_Prestavka)},q.prototype.GetDlzkaVMinutach=function(){if(this.m_Prestavka){var t=this.m_pRok.GetPeriod(this.m_Hodina,!0);if(t)return t.GetDlzkaVMinutach(this.m_Den);var e=this.m_pRok.GetPeriod(this.m_Hodina,!1),i=this.m_pRok.GetPeriod(this.m_Hodina-1,!1);return e&&i?F.GetMedzera(this.m_Den,i,e):10}return(e=this.m_pRok.GetPeriod(this.m_Hodina,!1))?e.GetDlzkaVMinutach(this.m_Den):10},q);function q(t,e){var i=Y.call(this,t,"classroomsupervisions",e)||this;return i.m_pUcitel=null,i.m_pUcebna=null,i.m_Den=-1,i.m_Tyzden=-1,i.m_Term=-1,i.m_Hodina=0,i.m_Prestavka=!1,i.m_bLocked=!1,i.m_bTemp=!1,i.InitFromData(),i}n.CDozor=X;var Q=require("./online"),tt=require("./tview"),et=require("./print"),it=require("../../rpr/dbi"),nt=require("../../asc/edurequest"),ot=require("./ttdoc"),rt=require("../timeoff_r")},"/timetable/app/tview.js":function(i,require,t){i.__esModule=!0;var I=require("tslib"),e=require("react"),b=require("react-dom"),$=require("./online"),F=require("./rokobject"),n=require("./ttrowrenderer"),o=require("../../asc/asc_react"),L=require("../timeoff_r"),B=require("./ttdoc"),R=require("./server/dozory"),r=e.lazy(function(){return Promise.resolve().then(function(){return require("./lessongrid")})});i.ROJTF_PRIBLIZNE=1,i.ROJTF_SEMINARE_BEZ_ZIAKOV=2,i.ROJTF_SEMINARE_NESLIZUJ=4,i.ROJTF_FILTER_AKT_TWD=8,i.ROJTF_TERM=16,i.ROJTF_TERM_SHIFT=5,i.ROJTF_TERM_MASK=2032,i.nDefaultVyskaRiadok=25;var a=(s.prototype.RenderLessonGrid=function(){b.render(e.createElement(e.Suspense,{fallback:e.createElement(o.Loading,null)},e.createElement(r,{ttgpid:this.m_pRozApp.ttgpid,rowheight:this.m_nVyskaRiadok,pTView:this})),this.$div.get(0))},s.prototype.UpdateStruct=function(){var e=this;if(this.lastPohlad==this.m_pAktPohlad&&this.JePohladLessonGrid())this.RenderLessonGrid();else{if(this.m_Riadky.length=0,this.m_Policka.length=0,b.unmountComponentAtNode(this.$div.get(0)),this.$div.empty(),this.$div.off(),this.$content_d=null,this.$header_d=null,this.$toolbar_d=null,!this.m_pAktPohlad){for(var t=0,i=this.m_pRok.TableObjects("ttviews");t<i.length;t++){var n=i[t];if(!n.m_Hidden){this.m_pAktPohlad=n,this.m_pRozApp.InvalidatePohladSwitcher();break}}if(!this.m_pAktPohlad)return}if(this.lastPohlad=this.m_pAktPohlad,this.FillRibbonCombos(),this.JePohladLessonGrid())return this.RenderLessonGrid(),void this.$div.keydown(function(t){if([107,109].indexOf(t.keyCode)<0)return!0;e.OnKeyDown(t)});this.$toolbar_d=$j("<div class='toolbar'>").appendTo(this.$div),this.$header_d=$j("<div class='header'>").appendTo(this.$div),this.$content_d=$j("<div class='content'>").appendTo(this.$div),this.$header_d.css("height",this.m_nVyskaMenoDna-1+"px"),this.$content_d.mousemove(function(t){e.OnMouseMove(t),e.m_pRozApp.CursorMove(t)}),this.$content_d.on("scroll",function(){var t=e.m_pAktPohlad;t&&(t.m_nScrollPos=e.$content_d[0].scrollTop),e.m_pRozApp.Invalidate()}),this.$div.keydown(function(t){if(e.JePohladLessonGrid()&&[107,109].indexOf(t.keyCode)<0)return!0;e.OnKeyDown(t)}),this.$div.mousedown(function(t){ASC.hidePopups(),e.$div.focus(),t.preventDefault()}),this.$div.mouseup(function(t){t.preventDefault()}),this.$div.click(function(t){return!!e.JePohladLessonGrid()||(ASC.hideContextMenu(),e.OnLButtonClick(t),!1)}),this.$div.on("contextmenu",function(t){return!!e.JePohladLessonGrid()||(e.OnRButtonClick(t),!1)});var o=this.m_pAktPohlad.GetRiadkyObjects();for(var r in o){var a=o[r];this.m_Riadky.push(new y(this,a))}this.$content_d[0].scrollTop=this.m_pAktPohlad.m_nScrollPos;for(var s=this.m_pRok,l={terms:-1,weeks:-1,days:-1},c={terms:-1,weeks:-1,days:-1},m=0,h=["terms","weeks","days"];m<h.length;m++){var _=h[m],u=this.m_pAktObdobie[_];u&&("one"==u.m_Typ&&(l[_]=c[_]=u.m_Val),"any"==u.m_Typ&&(l[_]=0,c[_]=this.m_pRok.GetObdobieCount(_)-1))}for(var d=l.terms;d<=c.terms;d++)for(var p=l.weeks;p<=c.weeks;p++)for(var f=l.days;f<=c.days;f++)for(var v=s.m_nHodinyOd;v<=s.m_nHodinyDo;v++)this.m_Policka.push(new g(this,d,p,f,v,this.m_Policka.length));for(var r in this.m_Policka)this.m_Policka[r].UpdateX();this.m_nSirkaPolicko=(this.$content_d.width()-this.m_nSirkaStlpecMenoTriedy)/Math.max(1,this.m_Policka.length),this.m_nSirkaPolicko||(this.m_nSirkaPolicko=20),this.m_Policka[this.m_Policka.length-1].$div.addClass("last"),this.m_nOldContentWidth=this.$content_d.get(0).clientWidth}},s.prototype.Zoom=function(t){switch(t){case"+":this.m_nVyskaRiadok*=2;break;case"-":this.m_nVyskaRiadok/=2;break;case"0":this.m_nVyskaRiadok=i.nDefaultVyskaRiadok;break;case"/":0<this.m_Riadky.length&&(this.m_nVyskaRiadok=Math.floor(this.$content_d.height()/this.m_Riadky.length)-1);break;default:"%"==t.charAt(t.length-1)&&(this.m_nVyskaRiadok=parseInt(t.substr(0,t.length-1))*i.nDefaultVyskaRiadok/100)}this.m_nVyskaRiadok=Math.min(2e3,Math.max(2,Math.round(this.m_nVyskaRiadok))),this.m_pAktPohlad.m_nVyskaRiadok=this.m_nVyskaRiadok,this.m_pRozApp.InvalidateTriedyView(),this.m_pRozApp.InvalidatePending()},s.prototype.Scroll=function(t){var e=0,i=this.m_nVyskaRiadok+1,n=Math.max(1,Math.floor(this.$content_d.height()/i))*i;switch(t){case"up":e=-i;break;case"down":e=+i;break;case"pgup":e=-n;break;case"pgdown":e=+n}this.$content_d.get(0).scrollTop+=e},s.prototype.SetCursor=function(t,e){void 0!==t&&(this.m_pCursorRiadok&&this.m_pCursorRiadok.$div.removeClass("cursor"),this.m_pCursorRiadok=t||null,this.m_pCursorRiadok&&this.m_pCursorRiadok.$div.addClass("cursor")),void 0!==e&&(this.m_pCursorPolicko&&this.m_pCursorPolicko.$div.removeClass("cursor"),this.m_pCursorPolicko=e||null,this.m_pCursorPolicko&&this.m_pCursorPolicko.$div.addClass("cursor"))},s.prototype.OnMouseMove=function(t){this.SetCursor(this.GetRiadokE(t),this.GetPolickoE(t))},s.prototype.OnKeyDown=function(t){switch(t.keyCode){case 107:this.Zoom("+");break;case 109:this.Zoom("-");break;case 111:this.Zoom("/");break;case 38:this.Scroll("up");break;case 40:this.Scroll("down");break;case 33:this.Scroll("pgup");break;case 34:this.Scroll("pgdown");break;case 68:t.ctrlKey&&t.shiftKey;break;default:return}t.stopPropagation()},s.prototype.OnLButtonClick=function(t){this.$div.focus(),this.m_pRozApp.ZrusKontrolu(),this.ClickRiadok(t)||this.ClickRozvrh(t)||(t.stopPropagation(),t.preventDefault())},s.prototype.OnRButtonClick=function(t){this.RightClickRiadok(t)||this.RightClickDenHodina(t)||(this.m_pRozApp.m_TahanaMHodina.IsEmpty()?this.RightClickRozvrhVolno(t):this.m_pRozApp.OdhodKartu())},s.prototype.ClickRiadok=function(t){var e=this.Event2XY(t);if(e.x<0||e.x>=this.m_nSirkaStlpecMenoTriedy||e.y<this.m_nVyskaMenoDna)return!1;var i=this.GetRiadokE(t).m_pRokObject,n=this.m_pRozApp.m_pRadSelector;if(t.shiftKey){n.m_Table!=i.m_Table&&n.AddRadObject(i);var o,r,a=[];r=o=!1;for(var s=this.m_Riadky.length-1;0<=s;s--)if((l=this.m_Riadky[s].m_pRokObject)==i&&(o=!0),o&&(a.indexOf(l)<0&&a.push(l),n.IsInRad(l))){r=!0;break}if(!r)for(r=o=!1,s=a.length=0;s<this.m_Riadky.length;s++)if((l=this.m_Riadky[s].m_pRokObject)==i&&(o=!0),o&&(a.indexOf(l)<0&&a.push(l),n.IsInRad(l))){r=!0;break}if(r)for(s=0;s<a.length;s++){var l=a[s];n.AddRadObject(l)}return this.m_pRozApp.InvalidateSelector(),!0}return t.ctrlKey?n.IsInRad(i)?n.RemoveRadObject(i):n.AddRadObject(i):(n.SetCelok(),n.AddRadObject(i)),this.m_pRozApp.InvalidatePending(),this.m_bInvalidFarbyRiadkov=!0},s.prototype.JePohladDozory=function(){return this.m_pAktPohlad&&"classroomsupervision"==this.m_pAktPohlad.m_Typ},s.prototype.JePohladLessonGrid=function(){return this.m_pAktPohlad&&"lessongrid"==this.m_pAktPohlad.m_Typ},s.prototype.RightClickRiadok=function(t){var a=this,e=this.Event2XY(t);if(e.x<0||e.x>=this.m_nSirkaStlpecMenoTriedy||e.y<this.m_nVyskaMenoDna)return!1;var i=this.GetRiadokE(t);if(!i)return!1;var n=i.m_pRokObject,s=this.m_pRozApp,o=s.m_pRadSelector;if(!o.IsInRad(n)&&!this.ClickRiadok(t))return!1;s.ZrusKontrolu();var l=o.GetJediny(),c=o.GetRadList(),m=null;c.length&&(m=c[0]);var r=[];if($.CUtils.AddMenuItemSmart(r,"test"),r.push([]),(l||m)&&l&&l.UI_RiadokPopup(r,this),r.push([]),$.CUtils.AddMenuItemSmart(r,"printpreview"),this.JePohladDozory()){if(l){var h=l.m_Id,_=this.m_Policka.map(function(t){return t.toDozorPolicko()});r.push([]);for(var u=function(t,e){r.push({text:t,onclick:function(){return ASC.blockUI(R.dozoryAddMulti(null,s.ttgpid,{classroomid:h,type:e,policka:_}))}})},d=0,p=[[ASC.ttls(3122)+" ("+ASC.ttls(1063)+")","period"],[ASC.ttls(3122)+" ("+ASC.ttls(2707)+")","break"]];d<p.length;d++){var f=p[d];u(f[0],f[1])}if(0<m.GetDozory().length){r.push([]);for(var v=function(t,e){r.push({text:t,onclick:function(){return R.dozoryRemoveMulti(null,s.ttgpid,{classroomid:h,policka:_,clear_teacher:e})}})},b=0,y=[[ASC.ttls(3123),!1],[ASC.ttls(3123)+" - "+$.CUtils.GetTableName("teachers"),!0]];b<y.length;b++){var g=y[b];v(g[0],g[1])}}}}else{r.push([]),$.CUtils.AddMenuItemSmart(r,"verification"),$.CUtils.AddMenuItemSmart(r,"listconstraints"),r.push([]),$.CUtils.AddMenuItemSmart(r,"deletecards"),$.CUtils.AddMenuItemSmart(r,"lockcards",{text:ASC.ttls(1713),icon:$.CUtils.GetIconLocked(!0)}),$.CUtils.AddMenuItemSmart(r,"unlockcards",{text:ASC.ttls(1729),icon:$.CUtils.GetIconLocked(!1)});var k=o.GetVybraneHodiny(s.m_pTriedyView.m_nROJTF).map(function(t){return t.m_Id});if(0<k.length){r.push([]);var T=[];$.CUtils.AddMenuItemSmart(T,"",{text:ASC.ttls(4344),onclick:function(){return I.__awaiter(a,void 0,void 0,function(){return I.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./server/refactor")})];case 1:return t.sent().refactorSinglesToDoubles(null,s.ttgpid,k),[2]}})})}}),r.push({text:ASC.ttls(4029),submenu:T})}}return ASC.showContextMenu(r,t,{header:ASC.escapeHTML(o.GetSimplePopis()),handler:function(t){var e=t.cmd;if(!l||!l.UI_OnCommand(e,a))switch(e){case"deletecards":case"lockcards":case"unlockcards":return void c.forEach(function(t){t.UI_OnCommand(e,a)});case"test":return void s.ClickGenerate({sel:!0});case"verification":return void s.ClickVerification("verification","sel");case"listconstraints":return void s.ClickVerification("listconstraints","sel");case"printpreview":for(var i={},n=0,o=c;n<o.length;n++){var r=o[n];i[r.m_Table]||(i[r.m_Table]=[]),i[r.m_Table].push(r.m_Id)}return s.PrintPreview(),s.m_pPrintPreview.SetZostava(m.m_Table),void s.PrintSetFilter(i)}}}),!0},s.prototype.RightClickRozvrhVolno=function(o){var r=this,t=this.GetRiadokE(o),a=this.GetPolickoE(o);if(!t||!a)return!1;var s=t.m_pRokObject,l=this.m_pRok;if(!this.JePohladDozory()){var e,i=[],n=s.UI_GetKartyNaPolicko(this,a),c=[],m=[];n.forEach(function(t){t.JeUmiestnena()?m.push(t):c.indexOf(t.m_pHodina)<0&&(c.push(t.m_pHodina),m.push(t))}),0==m.length?$.CUtils.AddMenuItemSmart(i,"",{text:ASC.ttls(1711),disabled:!0}):m.forEach(function(t){$.CUtils.AddMenuItemSmart(i,"putcard",{data:t})}),i.push([]),$.CUtils.AddMenuItemSmart(i,"deletecards");var h=s.timeoff();if(h){var _=L.timeoff_get(h,a.m_nTerm,a.m_nWeek,a.m_nDay,a.period);e=[],["0","?","1"].forEach(function(t){$.CUtils.AddMenuItemSmart(e,"timeoff:"+t,{checked:t==_})}),i.push([]),$.CUtils.AddMenuItemSmart(i,"timeoff",{submenu:e})}return ASC.showContextMenu(i,o,{header:ASC.escapeHTML($.CUtils.GetUINazov(s,"short_name")),handler:function(t){var e=t.cmd;switch(e){case"putcard":var i=t.data,n=new k(r.m_pRok);return n.Add(i),n.FinishAdding(),void s.UI_KartaUmiestni(r.m_pRozApp,n,a,o);case"deletecards":return void s.UI_OnCommand(e,r);case"timeoff:0":case"timeoff:?":case"timeoff:1":return void s.updateData({timeoff:L.timeoff_set(h,l.dbi,a.m_nTerm,a.m_nWeek,a.m_nDay,a.period,e.substr(8))})}}}),!0}for(var u=[],d=this.Event2XY(o).x>(a.x1+a.x2)/2,p=0,f=[!0,!1];p<f.length;p++){var v=f[p],b=new F.CDozor(this.m_pRok,{classroomid:s.m_Id,teacherid:"",term:$.CUtils.minus2blank(a.m_nTerm),week:$.CUtils.minus2blank(a.m_nWeek),day:$.CUtils.minus2blank(a.m_nDay),period:v?"":a.period,break:v?a.period+(d?1:0):""});b.m_Hodina<l.m_nHodinyOd||b.m_Hodina>l.m_nHodinyDo||(b.m_bTemp=!0,u.push(b))}this.RightClickDozor(o,u[0],{adddozory:u})},s.prototype.ClickRozvrh=function(t){var e=this.GetRiadokE(t),i=this.GetPolickoE(t);if(!e||!i)return!1;var n=e.m_pRokObject;if(!this.m_pRozApp.m_TahanaMHodina.IsEmpty())return n.UI_KartaUmiestni(this.m_pRozApp,this.m_pRozApp.m_TahanaMHodina,i,t),!0;var o=this.GetKartaOnPositionE(t);return!!o&&(n.UI_KartaVyberOdtialto(this.m_pRozApp,i,o,t),!0)},s.prototype.RightClickKarta=function(t,c){var i=this,e=c.m_pHodina,n=this.GetRiadokE(t);if(!n)return!1;if(!this.GetPolickoE(t))return!1;var m=this.m_pRozApp,o=m.m_pRok,r=n.m_pRokObject,a=new k(o);a.SetPozicia(r),a.Add(c),a.FinishAdding();var h,s=a.IsLocked(!0),l=I.__spreadArrays([e.m_pPredmet],e.m_Triedy,e.m_Ucitelia),_=[];s?$.CUtils.AddMenuItemSmart(_,"unlockcard",{text:ASC.ttls(1619)}):($.CUtils.AddMenuItemSmart(_,"removecard",{text:ASC.ttls(1025)}),$.CUtils.AddMenuItemSmart(_,"lockcard",{text:ASC.ttls(1618)})),_.push([]),$.CUtils.AddMenuItemSmart(_,"deletecards"),_.push([]),h=[];for(var u=0;u<e.m_nPotrebujeUcebni;u++)!function(s){var l=c.Ucebna(s);e.GetUcebneV(s).forEach(function(e){var t=e.JeMulityCard(),i={};i.text=$.CUtils.GetUINazov(e),i.checked=e==l;var n=c.GetVolno(e.timeoff());"1"!=n&&(i.icon=$.CUtils.GetIconVhodnost(n));var o=[];if(e.AddKartyTuK(o,c,0),o.length){var r=!1,a=!0;o.forEach(function(t){t.IsLocked()&&(r=!0),c.MozeKolidovat(t)||(a=!1)}),a?"1"==n&&e!=l&&(i.icon=$.CUtils.GetIconVhodnost("1")):(i.icon=$.CUtils.GetIconVhodnost(t?"?":"0"),t&&(i.icon="/timetable/pics/app/office/no_green_32.png"),r&&(i.disabled=!0))}i.onclick=function(){m.InvalidateKarta(c),c.FreeUcebna(s),t||o.forEach(function(t){c.MozeKolidovat(t)||(m.InvalidateKarta(t),t.FreeUcebnaU(e))}),c.SetUcebna(e,s),m.InvalidateKarta(c)},$.CUtils.AddMenuItemSmart(h,"",i)}),h.push([])}(u);if($.CUtils.AddMenuItemSmart(h,"",{text:ASC.ttls(1723),onclick:function(){m.InvalidateKarta(c),c.FreeUcebna()}}),$.CUtils.AddMenuItemSmart(_,"",{submenu:h,text:ASC.ttls(1092)}),_.push([]),e.UI_HodinaPopup(_,this),0<e.m_KurzyPreTriedy.length){var d=ASC.ttls(2604),p=e.GetZiaci();d+=" ("+p.length+")",_.push([]),h=[];for(var f=0,v=p;f<v.length;f++){var b=v[f];$.CUtils.AddMenuItemSmart(h,"",{data:b})}$.CUtils.AddMenuItemSmart(_,"",{submenu:h,text:d})}_.push([]),h=[],l.forEach(function(t){$.CUtils.AddMenuItemSmart(h,"",{text:$.CUtils.GetUINazov(t),data:t,onclick:function(){m.click_func("zadanie","table="+t.m_Table+"&id="+t.m_Id)}})}),$.CUtils.AddMenuItemSmart(_,"",{submenu:h,text:ASC.ttls(3621)}),_.push([]),h=[],l.forEach(function(t){var e=t.timeoff();if(e){var i=c.GetVolno(e);$.CUtils.AddMenuItemSmart(h,"timeoff:"+i,{text:$.CUtils.GetUINazov(t),onclick:function(){m.click_func("timeoff","table="+t.m_Table+"&id="+t.m_Id)}})}}),$.CUtils.AddMenuItemSmart(_,"timeoff",{submenu:h}),_.push({text:ASC.ttls(4029),onclick:function(){return I.__awaiter(i,void 0,void 0,function(){return I.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./quickchanges")})];case 1:return t.sent().showQuickChanges({ttgpid:m.ttgpid,cardid:c.m_Id}),[2]}})})}}),ASC.showContextMenu(_,t,{header:ASC.escapeHTML($.CUtils.GetUINazov(c,"short")),handler:function(t){var e=t.cmd;r.UI_OnCommand(e,i,c)}})},s.prototype.RightClickDenHodina=function(t){var c=this;if(this.Event2XY(t).y>=this.m_nVyskaMenoDna)return!1;var m=this.GetPolickoE(t);if(!m)return!1;for(var e=[],i=0,n=[["terms",m.m_nTerm],["weeks",m.m_nWeek],["days",m.m_nDay]];i<n.length;i++){var o=n[i],r=o[0],a=o[1];a<0||e.push(this.m_pRok.GetObdobie_One(r,a).GetNazov())}for(var s=[],l=function(l,t){s.push({text:t,icon:$.CUtils.GetIconLocked(l),onclick:function(){for(var t=[],e=0,i=c.m_Riadky;e<i.length;e++)for(var n=0,o=i[e].m_pRokObject.GetKartyMozuSem(c.m_nROJTF);n<o.length;n++)(s=o[n]).JeTu_TWDH(m.m_nTerm,m.m_nWeek,m.m_nDay)&&(t.includes(s)||t.push(s));for(var r=0,a=t;r<a.length;r++){var s;(s=a[r]).IsLocked()!=l&&(c.m_pRozApp.InvalidateKarta(s),s.SetLocked(l))}}})},h=0,_=[[!0,ASC.ttls(1618)],[!1,ASC.ttls(1619)]];h<_.length;h++){var u=_[h];l(u[0],u[1])}return 0<s.length&&ASC.showContextMenu(s,t,{header:e.join(", ")}),!0},s.prototype.d2p=function(t,e){var i="";return i=t.m_Prestavka?"break="+t.m_Hodina:"period="+t.m_Hodina,t.m_bTemp||(i+="&id="+t.m_Id),0<=e.m_nDay&&(i+="&day="+e.m_nDay),0<=e.m_nWeek&&(i+="&week="+e.m_nWeek),0<=e.m_nTerm&&(i+="&term="+e.m_nTerm),i},s.prototype.RightClickDozor=function(t,i,e){var n=this;void 0===e&&(e={});var o=this.GetRiadokE(t);if(!o)return!1;var r=this.GetPolickoE(t);if(!r)return!1;var a=o.m_pRokObject,s=null;a instanceof F.CRokObject&&(s=a);var l,c=this.m_pRozApp,m=c.m_pRok,h=[],_=this.d2p(i,r);if(a instanceof F.CUcitel&&(_+="&teacherid="+a.m_Id),a instanceof F.CUcebna&&(_+="&classroomid="+a.m_Id),i.m_bTemp)for(var u=e.adddozory||[i],d=function(t){if(0<m.GetDozoryTWDH(s,r.m_nTerm,r.m_nWeek,r.m_nDay,t.m_Hodina,t.m_Prestavka).length)return"continue";if(r.m_nDay<0)return"continue";var e=p.d2p(t,r);h.push({text:ASC.ttls(3122)+" ("+t.GetHodinaText()+")",icon:$.CUtils.GetIconNic(),onclick:function(){c.click_func("dozor",e+"&cmd=add&classroomid="+a.m_Id)}})},p=this,f=0,v=u;f<v.length;f++)d(v[f]);else"teachers"==a.m_Table&&h.push({text:ASC.ttls(3123),onclick:function(){c.InvalidateDozor(i),i.SetUcitel(null)},icon:$.CUtils.GetIconNic()}),"classrooms"==a.m_Table&&h.push({text:ASC.ttls(3123),onclick:function(){return ASC.blockUI(R.dozoryRemoveMulti(null,c.ttgpid,{ids:[i.m_Id]}))},icon:$.CUtils.GetIconNic()});if(!i.m_bTemp){if(i.m_bLocked?h.push({text:ASC.ttls(1619),icon:$.CUtils.GetIconLocked(!1),onclick:function(){i.SetLocked(!1),c.InvalidateDozor(i)}}):h.push({text:ASC.ttls(1618),icon:$.CUtils.GetIconLocked(!0),onclick:function(){i.SetLocked(!0),c.InvalidateDozor(i)}}),!i.m_bLocked&&s){u=m.GetDozoryTWDH(s,r.m_nTerm,r.m_nWeek,r.m_nDay,i.m_Hodina,i.m_Prestavka),l=[];for(var b=function(t){l.push({text:""+t,checked:t==u.length,onclick:function(){c.click_func("dozor",_+"&cmd=setcount&count="+t)}})},y=1;y<=10;y++)b(y);h.push({text:ASC.ttls(1266),submenu:l,icon:$.CUtils.GetIconNic()})}if(!i.m_bLocked){h.push([]),h.push({text:ASC.ttls(1090),icon:$.CUtils.GetIconNic(),onclick:function(){return I.__awaiter(n,void 0,void 0,function(){return I.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./dozory")})];case 1:return t.sent().showStartGenerDozory(c.ttgpid),[2]}})})}}),h.push({text:ASC.ttls(4267),icon:$.CUtils.GetIconNic(),onclick:function(){c.click_func("dozor",_+"&cmd=removeallteachers")}}),h.push([]),h.push({text:ASC.ttls(3118),icon:$.CUtils.GetIconNic(),onclick:function(){n.m_pRozApp.InvalidateDozor(i),i.SetUcitel(null)},selected:!i.m_pUcitel});for(var g=[],k=0,T=m.TableObjects("teachers");k<T.length;k++){var S=T[k];g.push(new P(i,S))}g.sort(function(t,e){return e.poradie-t.poradie});for(var C=0,A=g;C<A.length;C++){var w=A[C];h.push(w.MenuItem())}}}ASC.showContextMenu(h,t,{header:ASC.escapeHTML(i.GetHodinaText()+" ("+i.GetDlzkaVMinutach()+")"),handler:function(t){var e=t.cmd;a.UI_OnCommand(e,n,i)}})},s.prototype.GetKartaOnPositionE=function(t){var e=this.GetRiadokE(t);return e?e.GetKartaOnPositionE(t):null},s.prototype.Event2XY=function(t){var e=this.$div.offset();return{x:ertl(!0,!1)?t.pageX-e.left:e.left+this.$div.width()-t.pageX,y:t.pageY-e.top}},s.prototype.OnClick=function(t){var e=t.x-this.$content_d.offset().left,i=t.y-this.$content_d.offset().top+this.$content_d.get(0).scrollTop,n=this.GetRiadok(i),o=this.GetPolicko(e);n&&o&&(this.m_pRozApp.m_TahanaMHodina.IsEmpty()||n.m_pRokObject.UI_KartaUmiestni(this.m_pRozApp,this.m_pRozApp.m_TahanaMHodina,o,t))},s.prototype.FindRiadok=function(t){for(var e=0;e<this.m_Riadky.length;e++){var i=this.m_Riadky[e];if(i.m_pRokObject==t)return i}return null},s.prototype.GetRiadok=function(t){if(t<this.m_nVyskaMenoDna)return null;var e=Math.floor((t-this.m_nVyskaMenoDna+this.$content_d.get(0).scrollTop)/(this.m_nVyskaRiadok+1));return 0<=e&&e<this.m_Riadky.length?this.m_Riadky[e]:null},s.prototype.GetRiadokE=function(t){return this.GetRiadok(this.Event2XY(t).y)},s.prototype.GetPolicko=function(t){for(var e=0;e<this.m_Policka.length;e++){var i=this.m_Policka[e];if(t>=i.x1&&t<=i.x2+1)return i}return null},s.prototype.GetPolickoE=function(t){return this.GetPolicko(this.Event2XY(t).x)},s.prototype.FillRibbonCombos=function(){var e=this;if(!this.m_pRozApp.ttviewer){var i=this.m_pRozApp.$rg_pohlad_div,n="width:150px; display:block; margin-bottom: 2px";this.m_pComboPohlad||(this.m_pComboPohlad=new ASC.ui.ComboBox(i,this.m_pAktPohlad?this.m_pAktPohlad.m_Id:"",[],{style:n,fn:function(){return I.__awaiter(e,void 0,void 0,function(){return I.__generator(this,function(t){switch(t.label){case 0:switch(this.m_pComboPohlad.value){case"view_manage":return[3,1];case"view_edit":return[3,3]}return[3,5];case 1:return this.m_pComboPohlad.ASC_set(this.m_pAktPohlad.m_Id),[4,Promise.resolve().then(function(){return require("./zadanie")})];case 2:return t.sent().showZadanieDlg(this.m_pRozApp.ttgpid,{table:"ttviews"}),[3,6];case 3:return this.m_pComboPohlad.ASC_set(this.m_pAktPohlad.m_Id),[4,Promise.resolve().then(function(){return require("./dlg")})];case 4:return t.sent().showItemDlg(this.m_pRozApp.ttgpid,"ttviews",this.m_pAktPohlad.m_Id),[3,6];case 5:this.SetAktPohlad(this.m_pComboPohlad.value),t.label=6;case 6:return[2]}})})}})),["terms","weeks","days"].forEach(function(t){e.m_ComboObdobia[t]||(e.m_ComboObdobia[t]=new ASC.ui.ComboBox(i,"",[],{style:n,fn:function(){e.SetAktObdobie(t,e.m_ComboObdobia[t].value)}}))});for(var t=[],o=0,r=this.m_pRok.TableObjects("ttviews");o<r.length;o++){var a=r[o];a.m_Hidden||t.push({value:a.m_Id,name:a.GetNazov(),icon:a.m_Icon})}t.push([]),t.push({name:ASC.ttls(1161),value:"view_manage"}),t.push({name:ASC.ttls(3303),value:"view_edit"}),this.m_pComboPohlad.setItems(t),this.m_pAktPohlad&&this.m_pComboPohlad.ASC_set(this.m_pAktPohlad.m_Id,!1);for(var s=0,l=["terms","weeks","days"];s<l.length;s++){var c=l[s],m=this.m_ComboObdobia[c],h=!1;"days"==c&&(h=!0),1==this.m_pRok.GetObdobieCount(c)&&(h=!0),h?m.$div.hide():m.$div.show();var _=c+"defs",u=!(t=[]),d=null,p=null,f=this.m_pRok.GetObdobieCount(c),v=f;v<2&&(v=2),4<v&&(v=4);for(var b=0,y=this.m_pRok.Obdobia(_);b<y.length;b++){var g=y[b];switch(g==this.m_pAktObdobie[c]&&(u=!0),g.m_Typ){case"one":var k="";2<=f&&f<=4&&("terms"==c&&(k="b_"+v+"_"+(g.m_Val+1)),"weeks"==c&&(k="g_"+v+"_"+(g.m_Val+1))),t.push({value:g.m_Id,name:g.GetNazov(),icon:k?"/timetable/pics/app/term_week_day/"+k+".png":null});break;case"all":var T=(d=g).GetNazov();k="","terms"==c&&(T=ASC.ttls(3552),k="b_"+v+"_A"),"weeks"==c&&(T=ASC.ttls(3444),k="g_"+v+"_A"),t.push({value:g.m_Id,name:T,icon:k?"/timetable/pics/app/term_week_day/"+k+".png":null});break;case"any":T=(p=g).GetNazov(),"terms"==c&&(T=ASC.ttls(3553),k="b_x"),"weeks"==c&&(T=ASC.ttls(3443),k="g_x"),t.push({value:g.m_Id,name:T,icon:k?"/timetable/pics/app/term_week_day/"+k+".png":null})}}u||(this.m_pAktObdobie[c]="days"==c?p:d),m.setItems(t),this.m_pAktObdobie[c]&&m.ASC_set(this.m_pAktObdobie[c].m_Id,!1)}}},s.prototype.SetAktPohlad=function(t){if(ASC.isString(t))for(var e=0,i=this.m_pRok.TableObjects("ttviews");e<i.length;e++){var n=i[e];if(n.m_Id==t){t=n;break}}var o=t;0<(this.m_pAktPohlad=o).m_nVyskaRiadok&&(this.m_nVyskaRiadok=o.m_nVyskaRiadok),this.m_pComboPohlad&&this.m_pComboPohlad.ASC_set(o.m_Id,!1),this.m_pRozApp.InvalidateTriedyView(),this.m_pRozApp.InvalidatePending(),this.m_pRozApp.InvalidatePohladSwitcher()},s.prototype.SetAktObdobie=function(t,e){var i;i=ASC.isString(e)?this.m_pRok.m_ObjectsI[t+"defs"][e]:e,console.log([t,e,i,this.m_pAktObdobie]),i&&(this.m_pAktObdobie[t]=i,this.m_pRozApp.InvalidateTriedyView(),this.m_pRozApp.InvalidatePending())},s.prototype.GetPohladForTable=function(t){for(var e=0,i=this.m_pRok.TableObjects("ttviews");e<i.length;e++){var n=i[e];if(n.m_Data.table==t)return n}return null},s.prototype.InvalidateMHodina=function(t){for(var e=0;e<this.m_Riadky.length;e++){var i=this.m_Riadky[e],n=i.m_pRokObject;t.m_ObjectsI[n.m_Table][n.m_Id]&&(i.m_bInvalid=!0)}},s.prototype.InvalidateObject=function(a){var s=this;this.m_Riadky.forEach(function(t){if(!t.m_bInvalid){var e=t.m_pRokObject,i=!1;if(e==a)i=!0;else for(var n=e.GetHodinyMozuSem(s.m_nROJTF),o=0;o<n.length;o++){var r=n[o];switch(a.m_Table){case"classes":i=0<=r.m_Triedy.indexOf(a);break;case"teachers":i=0<=r.m_Ucitelia.indexOf(a);break;case"subjects":i=r.m_pPredmet==a}if(i)break}i&&(t.m_bInvalid=!0)}})},s.prototype.Validate=function(){if((this.m_bInvalidAll||this.$content_d&&this.$content_d.get(0).clientWidth!=this.m_nOldContentWidth)&&(this.UpdateStruct(),this.m_bInvalidAll=!1),!this.m_pRozApp.ttviewer){for(var t=this.m_nDefaultSirkaStlpecMenoTriedy,e=0,i=this.m_Riadky;e<i.length;e++){var n=i[e];n.m_bInvalid&&n.DrawMeno0()}for(var o=0,r=this.m_Riadky;o<r.length;o++){var a=r[o];a.$name_s&&(t=Math.max(t,a.$name_s.width()+4))}(t=Math.min(t,150))!=this.m_nSirkaStlpecMenoTriedy&&(this.m_nSirkaStlpecMenoTriedy=t,this.UpdateStruct());var s=[];if(50<=this.m_Riadky.length)for(var l=this.$content_d.scrollTop(),c=this.$content_d.height(),m=l-.3*c,h=l+1.3*c,_=0,u=this.m_Riadky;_<u.length;_++){var d=u[_];d.m_bInvalid&&!d.isOutOfView(m,h)&&s.push(d)}else $j.merge(s,this.m_Riadky);for(var p=0,f=s;p<f.length;p++){var v=f[p];v.m_bInvalid&&v.Draw()}this.m_bInvalidFarbyRiadkov&&this.UpdateFarbyRiadkov(),this.m_bInvalidFarbyStlpcov&&this.UpdateFarbyStlpcov()}},s.prototype.UpdateFarbyRiadkov=function(){this.m_Riadky.forEach(function(t){t.UpdateFarbaRiadku()}),this.m_bInvalidFarbyRiadkov=!1},s.prototype.UpdateFarbyStlpcov=function(){this.m_Policka.forEach(function(t){t.UpdateFarbaStlpca()}),this.m_bInvalidFarbyStlpcov=!1},s.prototype.BuildRVKarta=function(t){var e=this.m_pAktPohlad,i=document.createElement("div");i.className="rvcard";var n=this.m_nVyskaRiadok;50<n&&(n=50);var o=this.m_nSirkaPolicko;50<o&&(o=50),o*=t.GetMaxDlzka()+1,i.style.width=o+"px",i.style.height=n+"px";var r=this.m_pTTRowRenderer;r.Clear(),r.m_bIgnoreFilters=!0,r.m_bVsetkoNaJednuPoziciu=!0,r.m_SuggestedKarty=t.m_Objects.cards,r.m_pHorizontalRokObject=t.m_Pozicia.classes,0<t.m_nRozView_TypKarty&&1<r.m_SuggestedKarty.length&&(r.m_SuggestedKarty=[r.m_SuggestedKarty[0]]),r.Compute(),ASC.assert(0<r.m_Cells.length);for(var a=0;a<r.m_Cells.length;a++){var s=r.m_Cells[a],l=document.createElement("div");l.className="card",i.appendChild(l),l.innerHTML=ASC.escapeHTML(s.m_pKarta.GetTexty(e.texttables)),l.ASC_karta=s.m_pKarta,l.style.left="0px",l.style.right="0px",l.style.top=100*s.y1+"%",l.style.bottom=100-100*s.y2+"%";var c=s.m_pKarta.GetFarby(e.colortable);if(c&&0!=c.length||(c=["#ffffff"]),"teachers"==e.colortable){var m=s.m_pKarta.m_pHodina.m_Ucitelia[0];m&&m.m_Data.fontcolorscreen&&(l.style.color=m.m_Data.fontcolorscreen)}t.m_bRozView_Zasednut&&(c=$.CUtils.ZasedniColors(c)),ASC.strippedBackground(l,c)}return i},s.prototype.PaintMH=function(t,e,i,n,o,r){var a=this.m_pAktPohlad,s=this.m_pTTRowRenderer;s.Clear(),s.m_bIgnoreFilters=!0,s.m_bVsetkoNaJednuPoziciu=!0,s.m_SuggestedKarty=r.m_Objects.cards,s.m_pHorizontalRokObject=r.m_Pozicia.classes,s.Compute(),ASC.assert(0<s.m_Cells.length);for(var l=0;l<s.m_Cells.length;l++){var c=s.m_Cells[l],m=c.m_pKarta.GetTexty(a.texttables),h=c.m_pKarta.GetFarby(a.colortable),_=Math.round(i+o*c.y1),u=Math.round(i+o*c.y2);if($.CUtils.PaintFarbyToRect(h,t,e,_,n,u-_),t.font="Arial 11px",t.fillStyle="#000000","teachers"==a.colortable){var d=c.m_pKarta.m_pHodina.m_Ucitelia[0];d&&d.m_Data.fontcolorscreen&&(t.fillStyle=d.m_Data.fontcolorscreen)}$.CUtils.PaintTextToRect(m,t,e,_,n,u-_)}},s.prototype.GetPreviewMHodina=function(){return this.m_bPreviewPodKurzorom?this.m_pRozApp.m_PodKurzoromMHodina:this.m_pRozApp.m_TahanaMHodina},s.prototype.ScrollToRiadky=function(t){if(0!=t.length){for(var e=this.m_pRozApp.m_pTriedyView.$content_d[0],i=1e6,n=0,o=0,r=t;o<r.length;o++){var a=r[o].$div[0],s=a.offsetTop,l=s+a.offsetHeight;i=Math.min(i,s),n=Math.max(n,l)}var c=e.scrollTop;c=Math.max(c,n-e.clientHeight),c=Math.min(c,i),e.scrollTop=c}},s);function s(t,e){this.m_Riadky=[],this.m_Policka=[],this.m_nVyskaMenoDna=22,this.m_nVyskaRiadok=i.nDefaultVyskaRiadok,this.m_nDefaultSirkaStlpecMenoTriedy=28,this.m_pAktObdobie={},this.m_bPreviewPodKurzorom=!1,this.m_pCursorRiadok=null,this.m_pCursorPolicko=null,this.m_pComboPohlad=null,this.m_ComboObdobia={},this.m_nOldContentWidth=-1,this.m_bInvalidAll=!1,this.m_bInvalidFarbyRiadkov=!1,this.m_bInvalidFarbyStlpcov=!1,this.m_nROJTF=0,this.lastPohlad=null,this.m_pRozApp=t,this.m_pRok=this.m_pRozApp.m_pRok,this.$div=e,this.$div.addClass("triedyview"),this.m_pAktPohlad=null,this.m_nVyskaRiadok=i.nDefaultVyskaRiadok,this.m_nSirkaStlpecMenoTriedy=this.m_nDefaultSirkaStlpecMenoTriedy,this.m_nSirkaPolicko=20,this.m_pTTRowRenderer=new n.CTTRowRenderer(this.m_pRok),this.$div.attr("tabindex","0")}i.CTriedyView=a;var y=(l.prototype.isOutOfView=function(t,e){var i=this.$div[0].offsetTop;return i<t||e<i},l.prototype.DrawMeno0=function(){this.$name_d&&this.$name_d.remove(),this.$name_d=$j("<div class='name'>").prependTo(this.$div).css("width",this.m_pTriedyView.m_nSirkaStlpecMenoTriedy+1+"px"),this.$name_s=$j("<span>").text(this.m_pRokObject.GetSkratka()).appendTo(this.$name_d)},l.prototype.Draw=function(){var s=this.$div,t=this.m_pTriedyView,e=t.m_pRozApp,i=t.m_Policka,n=t.m_pAktPohlad,o=e.m_pKontrolaItem,r=null;o&&(r=o.FindRiadok(this.m_pRokObject));var a,l=this.m_pRokObject instanceof F.CTrieda?this.m_pRokObject:null;if(s.empty(),this.DrawMeno0(),16<=t.m_nVyskaRiadok){for(var c=0,m=0,h=this.m_pRokObject.GetHodinyMozuSem(t.m_nROJTF);m<h.length;m++)for(var _=0,u=h[m].m_Karty;_<u.length;_++)u[_].JeUmiestnena()||c++;0<c&&$j("<span class='neumiestnenych'>").text(""+c).appendTo(this.$name_d)}for(var d=0;d<i.length;d++){var p=i[d];a=(0!=d&&((j=document.createElement("div")).className="vline",s.append(j),j.style[ertl("left","right")]=p.x1-1+"px",p.m_pGroup!=a.m_pGroup&&ASC.setClass(j,"first")),p)}var f=this.m_pRokObject.GetKartyTu(t.m_nROJTF);s.get(0).ASC_karty=f;var v=t.m_pTTRowRenderer;v.Clear();for(var b=!0,y=0;y<i.length;y++){var g=i[y];b&&(v.Clear(),v.m_pHorizontalRokObject=this.m_pRokObject,v.m_horizontalTimeoff=this.m_pRokObject.timeoff(),v.m_nDay=g.m_nDay,v.m_nWeek=g.m_nWeek,v.m_nTerm=g.m_nTerm,v.m_nVerticalHodinyOd=g.period,v.m_SuggestedKarty=f,b=!1),v.m_Policka.push(g);var k=!0,T=i[y+1];if(T&&T.JeRovnakyDen(g)&&(k=!1),k){if(v.m_nVerticalHodinyDo=g.period,v.Compute(),v.m_horizontalTimeoff)for(var S=0;S<v.m_nXCount;S++)for(var C=v.m_nVerticalHodinyOd+S,A=v.m_nXFaz[S],w=0;w<A;w++){var I=0;if("0"==v.GetVolno(w,S)?I=1:l&&l.JeObed(C)&&(I=2),0<I){var R=v.m_Policka[S].x1,P=v.m_Policka[S].x2;switch((j=document.createElement("div")).style[ertl("left","right")]=R+"px",j.style.width=P-R+"px",j.style.top="0%",j.style.bottom="0%",I){case 1:j.className="krizik";break;case 2:j.className="obed"}s.append(j)}}for(d=0;d<v.m_Cells.length;d++){var O=v.m_Cells[d],D=O.m_pKarta;(j=document.createElement("div")).className="card",s.append(j);var x=D.GetTexty(n.texttables);ASC.createText(j,x),j.ASC_karta=D,R=v.m_Policka[O.x1].x1,P=v.m_Policka[O.x2].x2,j.style.boxSizing="border-box",j.style[ertl("left","right")]=R+"px",j.style.width=P-R+"px",j.style.top=100*O.y1+"%",j.style.bottom=100-100*O.y2+"%";var z=D.GetFarby(n.colortable);if(z&&0!=z.length||(z=["#ffffff"]),"teachers"==n.colortable){var G=D.m_pHodina.m_Ucitelia[0];G&&G.m_Data.fontcolorscreen&&(j.style.color=G.m_Data.fontcolorscreen)}var V=!1,M=!1;o&&(V=!0,r&&(r.m_RelevantneHodiny[D.m_pHodina.m_Id]&&(V=!1),r.m_ZleKarty[D.m_Id]&&(V=!(M=!0)))),V&&(z=$.CUtils.ZasedniColors(z));var U=(O.y2-O.y1)*t.m_nVyskaRiadok;ASC.strippedBackground(j,z,P-R,U,!0),M&&(j.style.border="2px solid red");var H=O.m_pKarta.GetFarbyChyby();0<H.length&&(ASC.createDiv(j,"pruzok").style.background=B.strippedBackground(H,0));var K=O.m_pKarta.GetFarbyFazy();0<K.length&&(ASC.createDiv(j,"pruzok_l").style.background=B.strippedBackground(K,0));var E=!1;if("students"==this.m_pRokObject.m_Table){var N=this.m_pRokObject.GetZiakPredmet(D.m_pHodina);N&&N.m_bLocked&&(E=!0)}else E=O.m_pKarta.IsLocked();E&&ASC.createDiv(j,"locked"),j.onmouseover=e.m_OnMouseOverKarta,j.onmouseout=e.m_OnMouseOutKarta,t.JePohladDozory()||(j.onclick=e.m_OnMouseClickKarta,j.oncontextmenu=e.m_OnMouseRightClickKarta),j.onmouseup=e.m_OnMouse_StopEvent}if(1<v.m_nMaxFaz)for(S=0;S<v.m_nXCount;S++)if(!((A=v.m_nXFaz[S])<=1))for(p=v.m_Policka[S],w=1;w<A;w++){var j;(j=document.createElement("div")).className="cyklus",j.style[ertl("left","right")]=p.x1+"px",j.style.width=p.x2-p.x1+"px",j.style.top=100*w/A+"%",s.append(j)}if(r){var Z=function(t,e){if(t)for(var i=null,n=0,o=0,r=0;r<v.m_nXCount;r++){var a=v.m_Policka[r];"1"==L.timeoff_get(t,a.m_nTerm,a.m_nWeek,a.m_nDay,a.period)?i?i.style.width=a.x2-n+"px":((i=document.createElement("div")).className="vysvietpos",i.style.borderColor=e,n=a.x1,o=a.x2,i.style.left=n+"px",i.style.width=o-n+"px",s.append(i)):i=null}};Z(r.m_pVysviet2,"#fce872"),Z(r.m_pVysviet1,"#ff8040"),Z(r.m_pVysvietZle,"#ff0000")}b=!0}}this.m_bInvalid=!1,this.UpdateFarbaRiadku(),this.DrawDozory()},l.prototype.DrawDozory=function(){var t=this.m_pRokObject,e=t.m_pRok;if(0!=e.m_ObjectsO.classroomsupervisions.length)for(var i=this.m_pRozApp.m_pTriedyView,n=i.m_pRozApp,o=i.m_nVyskaRiadok-1,r=null,a=0,s=[!1,!0];a<s.length;a++)for(var l=s[a],c=0,m=this.m_pTriedyView.m_Policka;c<m.length;c++){var h=m[c],_=e.GetDozoryTWDH(t,h.m_nTerm,h.m_nWeek,h.m_nDay,h.period,l);if(_.length)for(var u=0;u<_.length;u++){var d=_[u],p=document.createElement("span");p.className="dozor";var f=.25+.5*u/_.length,v=.25+.5*(u+1)/_.length;p.style.top=o*f+"px",p.style.bottom=o*(1-v)-1+"px";var b=h.x1,y=(h.x2-b)/2;b--,l?r&&h.JeRovnakyDen(r)?b-=y/2:y/=2:b+=y/2,p.style.left=b+"px",p.style.width=y+"px",d.m_bLocked&&ASC.createDiv(p,"locked");var g="#c0c0c0";t instanceof F.CUcebna&&(d.m_pUcitel?g=d.m_pUcitel.GetColor():ASC.setClass(p,"otaznik")),p.style.backgroundColor=g,0<=d.m_Tyzden&&(ASC.createDiv(p,"pruzok_l").style.backgroundColor=B.getFarbaFazy(d.m_Tyzden,e.m_nTyzdnov)),p.ASC_dozor=d,p.oncontextmenu=n.m_OnMouseRightClickDozor,p.onmouseover=n.m_OnMouseOverKarta,p.onmouseout=n.m_OnMouseOutKarta,i.JePohladDozory()&&(p.onclick=n.m_OnMouseRightClickDozor),this.$div.append(p)}r=h}},l.prototype.MozeSemIst=function(t){return!t.IsEmpty()&&this.m_pRokObject.UI_KartaMozeSem(this.m_pRozApp,t)},l.prototype.UpdateFarbaRiadku=function(){var t=!1,e=!1;if(this.$name_d){var i=this.m_pRozApp.m_TahanaMHodina;i.IsEmpty()||this.MozeSemIst(i)&&(t=!0),this.m_pRozApp.m_pRadSelector.IsInRad(this.m_pRokObject)&&(e=!0),this.$name_d.toggleClass("mozesem",t),this.$div.toggleClass("selrad",e);var n=this.m_pRozApp.m_pSync.GetFarbyUserov(this.m_pRokObject);if(n){var o=this.$name_d.find(".users");o.length||(o=$j("<div class='users'>").appendTo(this.$name_d)),o.css("background-color",n[0]),this.$name_d.addClass("users")}else this.$name_d.find(".users").remove(),this.$name_d.removeClass("users")}},l.prototype.GetKartaOnPositionE=function(n){return this.$div.children().each(function(t,e){var i=e.ASC_karta;if(i&&$.CUtils.IsEventInside(n,$j(e)))return $.CUtils.IsEventInside(n,$j(e)),i}),null},l);function l(t,e){this.$name_d=null,this.$name_s=null,this.m_bInvalid=!0,this.m_pRozApp=t.m_pRozApp,this.m_pTriedyView=t,this.m_pRokObject=e,this.$div=$j("<div class='vriadok'>").appendTo(this.m_pTriedyView.$content_d).css("height",t.m_nVyskaRiadok+"px"),this.$div.get(0).ASC_vriadok=this}i.CVRiadok=y;var g=(c.prototype.UpdateX=function(){var t=this.m_pTriedyView.$content_d.get(0).clientWidth,e=this.m_pTriedyView.m_nSirkaStlpecMenoTriedy;t-=e,this.x1=Math.round(e+t*this.index/this.m_pTriedyView.m_Policka.length+1),this.x2=Math.round(e+t*(this.index+1)/this.m_pTriedyView.m_Policka.length),this.$div.css(ertl("left","right"),this.x1-1+"px"),this.$div.css("width",this.x2-this.x1+"px"),this.m_pGroup.UpdateX()},c.prototype.JeRovnakyDen=function(t){return this.m_nTerm==t.m_nTerm&&this.m_nWeek==t.m_nWeek&&this.m_nDay==t.m_nDay},c.prototype.UpdateFarbaStlpca=function(){var t="",e=this.m_pTriedyView.GetPreviewMHodina();e.IsEmpty()||(t=this.m_pTriedyView.m_pAktPohlad.UI_VhodnostTahanejMHodiny(e,this)),this.$div.toggleClass("obsadene","x"==t),this.$div.toggleClass("volne","1"==t),this.$div.toggleClass("otaznikove","?"==t)},c.prototype.toDozorPolicko=function(){return{w:this.m_nWeek,d:this.m_nDay,h:this.period}},c);function c(t,e,i,n,o,r){if(this.m_pGroup=null,this.m_pRozApp=t.m_pRozApp,this.m_pTriedyView=t,this.m_nTerm=e,this.m_nWeek=i,this.m_nDay=n,this.period=o,this.index=r,this.x1=0,this.x2=20,this.$div=$j("<div class='vpolicko'>").appendTo(this.m_pTriedyView.$header_d),ASC.createSpanText(this.$div.get(0),this.m_pRozApp.dbi.rowName("periods",""+this.period,"short"),"","display:block;margin-top:-0px"),this.m_pRozApp.m_pRok.m_ObjectsI.breaks[o]&&this.$div.addClass("break"),0<t.m_Policka.length){var a=t.m_Policka[t.m_Policka.length-1];a.m_nDay==this.m_nDay&&a.m_nWeek==this.m_nWeek&&a.m_nTerm==this.m_nTerm&&(this.m_pGroup=a.m_pGroup,this.m_pGroup.m_pLast=this)}this.m_pGroup||(this.m_pGroup=new m(this),this.$div.addClass("first"))}i.CVPolicko=g;var m=(h.prototype.UpdateX=function(){var t=this.m_pFirst.x1,e=this.m_pLast.x2;this.$div.css(ertl("left","right"),t-1+"px"),this.$div.css("width",e-t+"px")},h);function h(t){var e=t.m_pTriedyView;this.m_pRozApp=e.m_pRozApp,this.m_pTriedyView=e,this.m_pFirst=t,this.m_pLast=t,this.$div=$j("<div class='vpolickogroup'>").appendTo(this.m_pTriedyView.$header_d);var i=this.m_pRozApp.m_pRok,n="";0<=this.m_pFirst.m_nTerm&&(n&&(n+="-"),n+=i.GetObdobie_One("terms",this.m_pFirst.m_nTerm).GetNazov()),0<=this.m_pFirst.m_nWeek&&(n&&(n+="-"),n+=i.GetObdobie_One("weeks",this.m_pFirst.m_nWeek).GetNazov()),0<=this.m_pFirst.m_nDay&&(n&&(n+="-"),n+=i.GetObdobie_One("days",this.m_pFirst.m_nDay).GetNazov()),ASC.createSpanText(this.$div.get(0),n,"","display:block;margin-top:-0px")}i.CVPolickoGroup=m;var k=(_.prototype.Clear=function(){for(var t in this.m_ModeTable="",this.m_Pozicia={},this.m_Skupiny=[],this.m_Objects)this.m_Objects[t]=[],this.m_ObjectsI[t]={};this.m_pDelenie=null,this.m_bSeminar=!1,this.m_nPoradieSeminaru=-1,this.m_dHodin=0,this.m_bRoznePoctyHodin=!1},_.prototype.SetPozicia=function(t){this.m_Pozicia[t.m_Table]=t},_.prototype.Add0=function(t){var e=t.m_Table,i=t.m_Id;this.m_ObjectsI[e][i]||(this.m_Objects[e].push(t),this.m_ObjectsI[e][i]=t)},_.prototype.Add0_array=function(t){for(var e=0;e<t.length;e++)this.Add0(t[e])},_.prototype.Add0_id=function(t,e){this.Add0_array(this.m_pRok.ids2ro(t,[e]))},_.prototype.Add0_ids=function(t,e){this.Add0_array(this.m_pRok.ids2ro(t,e))},_.prototype.Add=function(t){var e=t.m_Table;ASC.assert(""==this.m_ModeTable||this.m_ModeTable==e),this.m_ModeTable=e,this.Add0(t)},_.prototype.Add_array=function(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];this.Add(n)}},_.prototype.FinishAdding=function(){var i=this,n=this.m_Pozicia.classes;switch(this.m_ModeTable){case"cards":for(var t=0;t<this.m_Objects.cards.length;t++){var e=this.m_Objects.cards[t],o=e.m_pHodina;this.Add0(o),this.Add0_array(e.Ucebne())}break;case"lessons":for(t=0;t<this.m_Objects.lessons.length;t++)o=this.m_Objects.lessons[t],this.Add0(o);break;case"classroomsupervisions":for(var r=0,a=this.m_Objects.classroomsupervisions;r<a.length;r++){var s=a[r];this.Add0(s.m_pUcebna),s.m_pUcitel&&this.Add0(s.m_pUcitel)}}if("lessons"==this.m_ModeTable||"cards"==this.m_ModeTable){var l=!1;n=this.m_Pozicia.classes,this.m_Objects.lessons.forEach(function(t){i.Add0_array(t.m_Ucitelia),i.Add0(t.m_pPredmet),i.Add0_array(t.m_Triedy),t.m_Skupiny.forEach(function(t){var e=t.m_pTrieda;n&&e!=n||(i.m_pDelenie?i.m_pDelenie!=t.m_pDelenie&&(l=!0):i.m_pDelenie=t.m_pDelenie,t.m_bCelaTrieda||t.m_bKurz||i.m_Skupiny.indexOf(t.GetNazov())<0&&i.m_Skupiny.push(t.GetNazov()))}),0<t.m_KurzyPreTriedy.length&&(i.m_nPoradieSeminaru!=t.m_nPoradieSeminaru&&(-1==i.m_nPoradieSeminaru?i.m_nPoradieSeminaru=t.m_nPoradieSeminaru:i.m_nPoradieSeminaru=-2),n?0<=t.m_KurzyPreTriedy.indexOf(n)&&(i.m_bSeminar=!0):i.m_bSeminar=!0)}),l&&(this.m_pDelenie=null)}this.m_dHodin=0,this.m_bRoznePoctyHodin=!1;var c=this.m_Objects.lessons;if(n){for(var m=0,h=n.m_Delenia;m<h.length;m++){for(var _=-1,u=0,d=h[m].m_Skupiny;u<d.length;u++){for(var p=d[u],f=0,v=0,b=c;v<b.length;v++)(o=b[v]).m_Skupiny.indexOf(p)<0||(f+=this.DHodin(o));_=_<0?f:(.001<Math.abs(_-f)&&(this.m_bRoznePoctyHodin=!0),Math.max(_,f))}0<_&&(this.m_dHodin+=_)}this.m_bSeminar}else{var y=0;c.forEach(function(t){y+=i.DHodin(t)}),this.m_dHodin=y}},_.prototype.GetMaxDlzka=function(){for(var t=0,e=0;e<this.m_Objects.lessons.length;e++)t=Math.max(t,this.m_Objects.lessons[e].GetDlzka());return t},_.prototype.DHodin=function(t){var e=1;return this.m_bUvazujDlzkuPreUvazokUcitela&&(e=t.m_pPredmet.GetDoUvazkuRatatAko()),t.m_pObdobie.terms.AvgPokrytieBitov()*t.m_pObdobie.weeks.AvgPokrytieBitov()*t.m_pObdobie.days.GetDlzka()*(t.GetDlzka()+1)*e*this.PocetKarietDoSuctuHodin(t)},_.prototype.PocetKarietDoSuctuHodin=function(t){var e=this;if("cards"!=this.m_ModeTable)return t.GetPocet();var i=0;return t.m_Karty.forEach(function(t){t.JeUmiestnena()&&(e.m_Objects.cards.indexOf(t)<0||i++)}),i},_.prototype.IsEmpty=function(){switch(this.m_ModeTable){case"lessons":case"cards":return 0==this.m_Objects[this.m_ModeTable].length;default:return!(0<this.m_Objects.lessons.length||0<this.m_Objects.cards.length||0<this.m_Objects.teachers.length||0<this.m_Objects.classes.length||0<this.m_Objects.classrooms.length||0<this.m_Objects.subjects.length)}},_.prototype.Set=function(t){for(var e in this.Clear(),t.m_Pozicia)this.m_Pozicia[e]=t.m_Pozicia[e];switch(t.m_ModeTable){case"cards":case"lessons":case"classroomsupervisions":this.m_ModeTable=t.m_ModeTable,this.Add0_array(t.m_Objects[t.m_ModeTable]);break;default:for(var e in this.m_Objects)this.Add0_array(t.m_Objects[e])}this.FinishAdding()},_.prototype.Equals=function(t){for(var e in this.m_Objects)if(!$.CUtils.RovnakyList(this.m_Objects[e],t.m_Objects[e]))return!1;return!0},_.prototype.GetText=function(t,e){switch(t){case"classes":return $.CUtils.GetUINazvy(this.m_Objects.classes,e);case"subjects":return $.CUtils.GetUINazvy(this.m_Objects.subjects,e);case"teachers":return $.CUtils.GetUINazvy(this.m_Objects.teachers,e);case"classrooms":return $.CUtils.GetUINazvy(this.m_Objects.classrooms,e);case"groupnames":case"groups":return this.m_Skupiny.join(", ")}return"HU"+t},_.prototype.GetFarby=function(t){var e=[],i=this.m_Objects[t];return i&&i.forEach(function(t){e.push(t.GetColor())}),e},_.prototype.GetTexty=function(t){var e=this,i="";return t.forEach(function(t){""!=i&&(i+="\n"),i+=e.GetText(t)}),i},_.prototype.IsLocked=function(t){void 0===t&&(t=!1);var e=this.m_Pozicia.students;if(e){for(var i=!1,n=0,o=this.Hodiny();n<o.length;n++){var r=o[n],a=e.GetZiakPredmet(r);if(a)if(i=!0,a.m_bLocked){if(!t)return!0}else if(t)return!1}return!!i&&t}var s=this.m_Objects.cards;if(0==s.length)return!1;for(var l=0;l<s.length;l++){var c=s[l];if(c.JeUmiestnena()&&c.IsLocked()){if(!t)return!0}else if(t)return!1}return t},_.prototype.Karty=function(){return this.m_Objects.cards},_.prototype.Hodiny=function(){return this.m_Objects.lessons},_.prototype.Ucitelia=function(){return this.m_Objects.teachers},_.prototype.Predmety=function(){return this.m_Objects.subjects},_.prototype.Triedy=function(){return this.m_Objects.classes},_.prototype.GetJedinaKarta=function(){return 1==this.m_Objects.cards.length?this.m_Objects.cards[0]:null},_.prototype.GetJedinaHodina=function(){return 1==this.m_Objects.lessons.length?this.m_Objects.lessons[0]:null},_);function _(t){this.m_Objects={classes:[],teachers:[],subjects:[],students:[],classrooms:[],lessons:[],cards:[],classroomsupervisions:[]},this.m_ObjectsI={classes:{},teachers:{},subjects:{},students:{},classrooms:{},lessons:{},cards:{},classroomsupervisions:{}},this.m_Skupiny=[],this.m_pDelenie=null,this.m_bSeminar=!1,this.m_nPoradieSeminaru=-1,this.m_dHodin=0,this.m_bRoznePoctyHodin=!1,this.m_bUvazujDlzkuPreUvazokUcitela=!1,this.m_nRozView_Ciselko=0,this.m_nRozView_TypKarty=0,this.m_bRozView_Zasednut=!1,this.m_pRok=t,this.Clear()}i.CMHodina=k;var u=(d.prototype.SetEnabled=function(t){(t=ASC.boolVal(t))!=this.m_bEnabled&&(this.m_bEnabled=t,this.m_pRozApp.InvalidatePohladSwitcher())},d.prototype.Validate=function(){var n=this;if(this.m_bInvalid)if(this.m_bEnabled){this.$div.show(),this.$div.empty();for(var t=function(t){if(t.m_Hidden)return"continue";var e=$j("<div class='tab'>").appendTo(o.$div),i=$j("<span>").text(t.GetNazov()).appendTo(e).outerWidth();e.css("height",i+"px"),o.m_pRozApp.m_pTriedyView.m_pAktPohlad==t&&e.addClass("selected"),e.click(function(){n.m_pRozApp.m_pTriedyView.SetAktPohlad(t)})},o=this,e=0,i=this.m_pRok.TableObjects("ttviews");e<i.length;e++)t(i[e]);this.m_bInvalid=!1}else this.$div.hide()},d);function d(t,e){this.m_bEnabled=!0,this.m_bInvalid=!0,this.m_pRozApp=t,this.m_pRok=this.m_pRozApp.m_pRok,this.$div=e,this.$div.addClass("pohladswitcher")}i.CPohladSwitcher=u;var P=(p.prototype.MenuItem=function(){var t=this,e="";e=this.m_pUcitel?$.CUtils.GetUINazov(this.m_pUcitel,"short_name"):ASC.ttls(3118);var i=$.CUtils.GetIconNic(),n="/timetable/pics/app/supervision/";i=this.obsadeny?n+"uh0.png":n+"uh"+this.p1+this.p2+".png";var o=this.m_pUcitel.m_Data.constraints,r=this.m_pUcitel.GetPocetDozorov(),a=!ASC.strEmpty(o.m_nMaxDozorovPocet)||!ASC.strEmpty(o.m_nMaxDozorovMinut);return(r.count||a)&&(e+=" ("+r.minutes+"/"+r.count+")"),a&&(e+=" (",e+=ASC.strEmpty(o.m_nMaxDozorovMinut)?"-":o.m_nMaxDozorovMinut,e+="/",e+=ASC.strEmpty(o.m_nMaxDozorovPocet)?"-":o.m_nMaxDozorovPocet,e+=" "+ASC.ttls(3001)+")"),{text:e,icon:i,selected:this.m_pUcitel==this.m_pDozor.m_pUcitel,onclick:function(){t.m_pRozApp.InvalidateDozor(t.m_pDozor),t.m_pDozor.SetUcitel(t.m_pUcitel),t.m_pRozApp.InvalidateDozor(t.m_pDozor)}}},p);function p(t,e){this.p1=0,this.p2=0,this.obsadeny=!1,this.poradie=0,this.m_pRozApp=t.m_pRok.m_pRozApp,this.m_pDozor=t,this.m_pUcitel=e;var i=t.m_pRok,n=t.m_Hodina,o=t.m_Prestavka,r=!1,a=i.GetDozoryTWDH(e,t.m_Term,t.m_Tyzden,t.m_Den,n,o);(1<a.length||1==a.length&&a[0]!=t)&&(r=!0),o||e.GetKartyTuTWDH(t.m_Term,t.m_Tyzden,t.m_Den,n,0).length&&(r=!0);var s=!1,l=0,c=0,m=!0;if(o){var h=d="0"!=L.timeoff_get(e.timeoff(),t.m_Term,t.m_Tyzden,t.m_Den,n);if(n>i.m_nHodinyOd&&(h="0"!=L.timeoff_get(e.timeoff(),t.m_Term,t.m_Tyzden,t.m_Den,n-1)),d||h||(m=!1),0<n)if(0<(f=e.GetKartyTuTWDH(t.m_Term,t.m_Tyzden,t.m_Den,n-1,0)).length)l=1,t.m_pUcebna.JeBlizkaUcebna(f[0].Ucebna(0))&&(l=2),f[0].GetHodina()+f[0].GetDlzka()>=n&&(s=!0);else{var _=n-1,u=!1;(p=i.GetDozoryTWDH(e,t.m_Term,t.m_Tyzden,t.m_Den,_,u)).length&&(l=1,t.m_pUcebna.JeBlizkaUcebna(p[0].m_pUcebna)&&(l=2))}if(0<(f=e.GetKartyTuTWDH(t.m_Term,t.m_Tyzden,t.m_Den,n,0)).length)c=1,t.m_pUcebna.JeBlizkaUcebna(f[0].Ucebna(0))&&(c=2);else{_=n,u=!1;(p=i.GetDozoryTWDH(e,t.m_Term,t.m_Tyzden,t.m_Den,_,u)).length&&(c=1,t.m_pUcebna.JeBlizkaUcebna(p[0].m_pUcebna)&&(c=2))}}else{var d;(d="0"!=L.timeoff_get(e.timeoff(),t.m_Term,t.m_Tyzden,t.m_Den,n))||(m=!1);var p,f;_=n,u=!0;if((p=i.GetDozoryTWDH(e,t.m_Term,t.m_Tyzden,t.m_Den,_,u)).length)l=1,t.m_pUcebna.JeBlizkaUcebna(p[0].m_pUcebna)&&(l=2);else 0<(f=e.GetKartyTuTWDH(t.m_Term,t.m_Tyzden,t.m_Den,n-1,0)).length&&(l=1,t.m_pUcebna.JeBlizkaUcebna(f[0].Ucebna(0))&&(l=2));if(_=n+1,u=!0,(p=i.GetDozoryTWDH(e,t.m_Term,t.m_Tyzden,t.m_Den,_,u)).length)c=1,t.m_pUcebna.JeBlizkaUcebna(p[0].m_pUcebna)&&(c=2);else 0<(f=e.GetKartyTuTWDH(t.m_Term,t.m_Tyzden,t.m_Den,n+1,0)).length&&(c=1,t.m_pUcebna.JeBlizkaUcebna(f[0].Ucebna(0))&&(c=2))}m||(r=!0);var v=0;r||!m?v=-1e3:(v=100+100*Math.max(l,c)+12*l+10*c,s&&(v-=1)),this.p1=l,this.p2=c,this.obsadeny=r,this.poradie=v+(1e3-this.m_pUcitel.GetSaveID())/1e3}},"/timetable/app/ttrowrenderer.js":function(t,require,e){t.__esModule=!0;var r=require("./online"),i=require("../timeoff_r"),n=(o.prototype.Clear=function(){this.m_pHorizontalRokObject=null,this.m_nROJTF=0,this.m_horizontalTimeoff=null,this.m_bVsetkoNaJednuPoziciu=!1,this.m_bSpojNaViacHodinovku=!1,this.m_bIgnoreFilters=!1,this.m_nVerticalHodinyOd=this.m_pRok.m_nHodinyOd,this.m_nVerticalHodinyDo=this.m_pRok.m_nHodinyDo,this.m_nDay=-1,this.m_nWeek=-1,this.m_nTerm=-1,this.m_Cells.length=0,this.m_Policka.length=0},o.prototype.Compute=function(){this.m_nXCount=this.m_nVerticalHodinyDo-this.m_nVerticalHodinyOd+1,this.m_bVsetkoNaJednuPoziciu&&(this.m_nXCount=1),0<this.m_Policka.length&&ASC.assert(this.m_nXCount==this.m_Policka.length);for(var t=this.m_SuggestedKarty,e=[0,0],i=0,n=t=t||this.m_pHorizontalRokObject.GetKartyTu(this.m_nROJTF);i<n.length;i++){var o=n[i];if(this.HorizontalCheck(o)&&this.OtherCheck(o)&&this.VerticalCheck(o,e)){var r=e[0],a=e[1],s=this.NewCell();if(s.x1=r,s.x2=a,s.m_pKarta=o,s.m_nFaza=0,this.m_bRozdelNaJednohodinovky&&r<a)for(var l=(s.x2=r)+1;l<=a;l++){var c=this.SplitCell(s);c.x1=c.x2=l}}}if(this.m_bSpojNaViacHodinovku){this.m_Cells.sort(function(t,e){return t.x1-e.x1});for(var m=0;m<this.m_Cells.length;m++)for(var h=this.m_Cells[m],_=m+1;_<this.m_Cells.length;_++)h.SpojNaViacHodinovku(this.m_Cells[_])&&(this.m_Cells.splice(_,1),_--)}for(this.m_nMaxFaz=1,this.m_nXFaz.length=0,this.m_nXCyklovaniePo.length=0,G=this.m_bXJeSeminar.length=0;G<this.m_nXCount;G++)this.m_nXFaz[G]=1,this.m_nXCyklovaniePo[G]=0,this.m_bXJeSeminar[G]=!1;if(!this.m_bVsetkoNaJednuPoziciu){var u=!1,d=!1;switch(this.m_pHorizontalRokObject.m_Table){case"classes":u=!0;break;case"globals":d=!0}var p=0;for(this.m_nDay<0&&(p|=1),this.m_nWeek<0&&(p|=2),this.m_nTerm<0&&(p|=4),G=0;G<this.m_Cells.length;G++){var f=this.m_Cells[G];this.m_nXCyklovaniePo[f.x1]|=f.CyklovaniePo()&p,f.JeSeminar()&&(this.m_bXJeSeminar[f.x1]=!0)}var v=[];for(G=0;G<this.m_nXCount;G++)v[G]=!1;for(G=0;G<this.m_Cells.length;G++)for(var b=(f=this.m_Cells[G]).x1;b<f.x2;b++)v[b]=!0;for(G=0;G<this.m_nXCount-1;G++)v[G]&&(this.m_nXCyklovaniePo[G+1]|=this.m_nXCyklovaniePo[G],u&&this.m_bXJeSeminar[G]&&(this.m_bXJeSeminar[G+1]=!0));for(G=this.m_nXCount-2;0<=G;G--)v[G]&&(this.m_nXCyklovaniePo[G]|=this.m_nXCyklovaniePo[G+1],u&&this.m_bXJeSeminar[G+1]&&(this.m_bXJeSeminar[G]=!0));for(this.m_nMaxFaz=1,G=0;G<this.m_nXCount;G++)d||u&&this.m_bXJeSeminar[G]?(this.m_nXFaz[G]=1,this.m_nXCyklovaniePo[G]=0):this.m_nXFaz[G]=this.FazyFaz(this.m_nXCyklovaniePo[G]),this.m_nMaxFaz=Math.max(this.m_nMaxFaz,this.m_nXFaz[G]);var y=this.m_Cells.length;for(G=0;G<y;G++){f=this.m_Cells[G];var g=this.m_nXCyklovaniePo[f.x1];if(0!=g){var k=0;4&g&&(k=this.m_pRok.m_nTermov-1);var T=0;2&g&&(T=this.m_pRok.m_nTyzdnov-1);var S=0;1&g&&(S=this.m_pRok.m_nDni-1);for(var C=!1,A=0,w=0;w<=k;w++)for(var I=0;I<=T;I++)for(var R=0;R<=S;R++){var P=!0;0==k||f.m_pKarta.JeTu_TWDH(w)||(P=!1),0==T||f.m_pKarta.JeTu_TWDH(-1,I)||(P=!1),0==S||f.m_pKarta.JeTu_TWDH(-1,-1,R)||(P=!1),P&&(C?this.SplitCell(f).m_nFaza=A:(f.m_nFaza=A,C=!0)),A++}}}}var O=this.m_pHorizontalRokObject&&"classes"==this.m_pHorizontalRokObject.m_Table,D=[],x=[],z=[];for(A=0;A<this.m_nMaxFaz;A++){for(var G=0;G<this.m_nXCount;G++)D[G]=O;if(O){var V=[],M=[];for(G=0;G<this.m_nXCount;G++)V[G]=-1,M[G]=0;for(G=0;G<this.m_Cells.length;G++)if((f=this.m_Cells[G]).m_nFaza==A)for(b=f.x1;b<=f.x2;b++)if(D[b]){var U=f.m_pKarta.GetDelenieSkupin(this.m_pHorizontalRokObject);if(U<0){D[b]=!1;break}if(30<U){D[b]=!1;break}if(V[b]!=U){if(0<=V[b]){D[b]=!1;break}V[b]=U}var H=f.m_pKarta.GetDelenieSkupinyBity(this.m_pHorizontalRokObject);if(0!=(M[b]&H)){D[b]=!1;break}M[b]|=H}for(v=[],G=0;G<this.m_nXCount;G++)v[G]=!1;for(G=0;G<this.m_Cells.length;G++)if((f=this.m_Cells[G]).m_nFaza==A)for(b=f.x1;b<f.x2;b++)v[b]=!0;var K=0,E=!1;for(G=0;G<this.m_nXCount;G++)if(0==D[G]&&(E=!0),!v[G]){if(E)for(var N=K;N<=G;N++)D[N]=!1;E=!1,K=G+1}for(y=this.m_Cells.length,G=0;G<y;G++)if((f=this.m_Cells[G]).m_nFaza==A&&D[f.x1]){var j=f.m_pKarta.GetDelenieSkupin(this.m_pHorizontalRokObject);if(j<1)ASC.assert(!1);else for(var Z=f.m_pKarta.GetDelenieSkupinyBity(this.m_pHorizontalRokObject),$=(C=!1,null),F=0;F<j;F++)0!=(Z&1<<F)?($||(C?$=this.SplitCell(f):($=f,C=!0),$.y1=F/j),$.y2=(F+1)/j):$=null}}for(G=0;G<this.m_nXCount;G++)x[G]=0,z[G]=!1;for(G=0;G<this.m_Cells.length;G++)if((f=this.m_Cells[G]).m_nFaza==A&&!D[f.x1]){var L=0;for(b=f.x1;b<=f.x2;b++)L=Math.max(L,x[b]);for(f.m_nTempOrder=L,b=f.x1;b<=f.x2;b++)x[b]=L+1,b<f.x2&&(z[b]=!0)}var B=K=0;for(b=0;b<this.m_nXCount;b++)if(B=Math.max(B,x[b]),!z[b]){for(var J=K;J<=b;J++)x[J]=B;K=b+1,B=0}for(G=0;G<this.m_Cells.length;G++)if((f=this.m_Cells[G]).m_nFaza==A){if(!D[f.x1]){var W=x[f.x1];L=f.m_nTempOrder,f.y1=L/W,f.y2=(L+1)/W}var Y=this.m_nXFaz[f.x1];1<Y&&(f.y1=(f.y1+f.m_nFaza)/Y,f.y2=(f.y2+f.m_nFaza)/Y)}}},o.prototype.HorizontalCheck=function(t){return!!this.m_bIgnoreFilters||this.m_pHorizontalRokObject.KartaJeTu(t,this.m_nROJTF)},o.prototype.OtherCheck=function(t){return!!this.m_bIgnoreFilters||!!t.JeTu_TWDH(this.m_nTerm,this.m_nWeek,this.m_nDay)},o.prototype.VerticalCheck=function(t,e){if(this.m_bIgnoreFilters&&this.m_bVsetkoNaJednuPoziciu)return o=r=0,!0;if(!t.JeUmiestnena())return!1;var i=t.GetHodina(),n=i+t.GetDlzka(),o=i-this.m_nVerticalHodinyOd,r=n-this.m_nVerticalHodinyOd;return o=Math.max(o,0),!((r=Math.min(r,this.m_nXCount-1))<o||(e[0]=o,e[1]=r,0))},o.prototype.NewCell=function(){var t=new a(this);return this.m_Cells.push(t),t},o.prototype.SplitCell=function(t){var e=this.NewCell();return e.Set(t),e},o.prototype.FazyFaz=function(t){var e=1;return 1&t&&(e*=this.m_pRok.m_nDni),2&t&&(e*=this.m_pRok.m_nTyzdnov),4&t&&(e*=this.m_pRok.m_nTermov),e},o.prototype.GetVolno=function(t,e){return this.m_horizontalTimeoff?i.timeoff_get(this.m_horizontalTimeoff,this.m_nTerm,this.m_nWeek,this.m_nDay,this.m_nVerticalHodinyOd+e):""},o.prototype.GetPeriodX=function(t){return this.m_pRok.GetPeriod(this.m_nVerticalHodinyOd+t)},o);function o(t){this.m_pHorizontalRokObject=null,this.m_nROJTF=0,this.m_horizontalTimeoff=null,this.m_nDay=-1,this.m_nWeek=-1,this.m_nTerm=-1,this.m_nVerticalHodinyOd=0,this.m_nVerticalHodinyDo=5,this.m_SuggestedKarty=null,this.m_bVsetkoNaJednuPoziciu=!1,this.m_bSpojNaViacHodinovku=!1,this.m_bRozdelNaJednohodinovky=!1,this.m_bIgnoreFilters=!1,this.m_Cells=[],this.m_nXCount=5,this.m_Policka=[],this.m_nXFaz=[],this.m_nXCyklovaniePo=[],this.m_bXJeSeminar=[],this.m_pRok=t}t.CTTRowRenderer=n;var a=(s.prototype.Set=function(t){this.m_pKarta=t.m_pKarta,this.m_MHodina=t.m_MHodina,this.x1=t.x1,this.x2=t.x2,this.y1=t.y1,this.y2=t.y2,this.m_nTempOrder=t.m_nTempOrder,this.m_nFaza=t.m_nFaza},s.prototype.CyklovaniePo=function(){return this.m_pKarta?this.m_pKarta.CyklovaniePo():0},s.prototype.JeSeminar=function(){return!!this.m_pKarta&&this.m_pKarta.m_pHodina.JeSeminar()},s.prototype.SpojNaViacHodinovku=function(t){if(t.x2+1!=this.x1&&this.x2+1!=t.x1)return!1;if(!this.m_pKarta)return!1;var e=this.m_pKarta,i=t.m_pKarta,n=e.m_pHodina,o=i.m_pHodina;if(n!=o){if(n.m_pPredmet!=o.m_pPredmet)return!1;if(!r.CUtils.RovnakyList(n.m_Ucitelia,o.m_Ucitelia))return!1;if(!r.CUtils.RovnakyList(n.m_Triedy,o.m_Triedy))return!1;if(!r.CUtils.RovnakyList(n.m_Skupiny,o.m_Skupiny))return!1;if(!r.CUtils.RovnakyList(n.m_KurzyPreTriedy,o.m_KurzyPreTriedy))return!1;if(n.m_nPoradieSeminaru!=o.m_nPoradieSeminaru)return!1;if(n.GetTerm()!=o.GetTerm())return!1}return!!r.CUtils.RovnakyList(e.Ucebne(),i.Ucebne())&&e.days()==i.days()&&e.weeks()==i.weeks()&&(this.x1=Math.min(this.x1,t.x1),this.x2=Math.max(this.x2,t.x2),!0)},s);function s(t){this.x1=0,this.x2=0,this.y1=0,this.y2=1,this.m_nTempOrder=0,this.m_nFaza=0,this.m_pKarta=null,this.m_MHodina=null,this.m_pTTRowRenderer=t}t.CTTRowCell=a},"/timetable/app/server/dozory.js":function(t,require,e){e.implementRpc(["dozoryAddMulti","dozoryRemoveMulti"])},"/timetable/app/print.js":function(t,require,e){t.__esModule=!0;var At=require("tslib"),wt=require("./rokobject"),W=require("./online"),It=require("./ttrowrenderer"),Rt=require("./tview"),Pt=require("../../asc/edurequest"),Ot=require("./ttdoc"),l=require("./server/designs"),Dt=require("../../asc/lib_date"),xt=(o.prototype.width=function(){return this.x2-this.x1},o.prototype.height=function(){return this.y2-this.y1},o.prototype.pad=function(t,e){void 0===e&&(e=t);var i=this.width()*t,n=this.height()*e;return new o(this.x1+i,this.y1+n,this.x2-i,this.y2-n)},o);function o(t,e,i,n){this.x1=t,this.y1=e,this.x2=i,this.y2=n}var n,G=function(t,e){this.m_pTlacZostava=t,this.data=e,this.size=.1,this.size=e.size/100,0<this.size||(this.size=.1)},i=(n=wt.CRokObject,At.__extends(r,n),r.prototype.InitFromData=function(){this.m_PageTables=this.m_Data.page_tables,this.m_RowTables=this.m_Data.row_tables,this.m_ColumnTables=this.m_Data.column_tables,this.m_nTypStredu=this.m_Data.celltype,this.m_PrintKartaStyles=this.m_Data.cardstyles,this.m_ExtraColumns=this.m_Data.extracolumns,this.m_ExtraRows=this.m_Data.extrarows},r.prototype.GetIcon=function(){return this.m_Data.icon},r.prototype.Render=function(t){var e=this,i=this.m_Data,n=[],o=t.filter,r=o;t.m_bTTViewer&&(r=this.m_pRok.m_pRozApp.ttviewer_options.filter);var a=this.Roznasob(this.m_pRok,this.m_PageTables,r,{withclassroomtt:i.withclassroomtt}),s=this.Roznasob(this.m_pRok,this.m_RowTables,o),l=this.Roznasob(this.m_pRok,this.m_ColumnTables,o),c=(i.extrarows||[]).map(function(t){return new G(e,t)}),m=(i.extracolumns||[]).map(function(t){return new G(e,t)}),h={6:"teachers_summary",5:"classes_summary",7:"classrooms_summary"}[i.typ];h&&h in r&&(r[h].length||(a=[]));for(var _=0,u=a;_<u.length;_++){var d=u[_],p=new U(this,d,this.PurgeSliziky(d,s,ASC.boolVal(i.hideemptyrows)),this.PurgeSliziky(d,l,ASC.boolVal(i.hideemptycolumns)));t.fixTTColors&&(p.fixTTColors=!0),t.designData&&(p.designData=t.designData),p.m_ExtraColumns=m,p.m_ExtraRows=c,n.push(p)}if(1<this.m_Data.repeatpage){var f=n;n=[];for(var v=0,b=f;v<b.length;v++){p=b[v];for(var y=0;y<this.m_Data.repeatpage;y++)n.push(p)}}if(!this.m_Data.fitwidth){for(var g=Math.max(1,Math.floor(1/i.cellwidth)),k=[],T=0,S=n;T<S.length;T++)if((R=S[T])instanceof V){p=R;var C=null;for(y=0;y<p.m_Columns.length;y+=g)(P=new U(this,p.m_Page,p.m_Rows,p.m_Columns.slice(y,y+g))).m_ExtraRows=p.m_ExtraRows,k.push(P),C=P;C&&(C.m_ExtraColumns=p.m_ExtraColumns)}n=k}if(!this.m_Data.fitheight){for(var A=Math.max(1,Math.floor(1/i.cellheight)),w=(k=[],0),I=n;w<I.length;w++){var R;if((R=I[w])instanceof V){for(p=R,C=null,y=0;y<p.m_Rows.length;y+=A){var P;(P=new U(this,p.m_Page,p.m_Rows.slice(y,y+A),p.m_Columns)).m_ExtraColumns=p.m_ExtraColumns,k.push(P),C=P}C&&(C.m_ExtraRows=p.m_ExtraRows)}}n=k}var O=this.Dimensions(!0);if(1<O.splitpage_w||1<O.splitpage_h){f=n,n=[];for(var D=null,x=0,z=f;x<z.length;x++)p=z[x],null==D&&(D=new M(this),n.push(D)),D.subpages.push(p),D.subpages.length>=O.splitpage_w*O.splitpage_h&&(D=null)}return n},r.prototype.PurgeSliziky=function(t,e,i){for(var n=null,o=Gt(t),r=0,a=t;r<a.length;r++)(k=a[r])instanceof wt.CTrieda&&(n=k),k instanceof wt.CZiak&&(n=k.m_pTrieda);var s=this.m_pRok.m_ObjectsO.cards;i&&o&&(s=o.GetKartyTu(0));for(var l=[],c=0,m=e;c<m.length;c++){for(var h=m[c],_=!1,u=0,d=h;u<d.length;u++)(k=d[u])instanceof wt.CPeriodOrBreak&&n&&!k.JeValidPreTriedu(n)&&(_=!0);if(i&&!_){_=!0;for(var p=0,f=s;p<f.length;p++){var v=f[p];if(v.JeUmiestnena()){for(var b=!0,y=0,g=h;y<g.length;y++){var k;if(!(k=g[y]).KartaJeTu(v,0)){b=!1;break}}if(b){_=!1;break}}}}_||l.push(h)}return l},r.prototype.Dimensions=function(t){var e=6*zt,i=5*zt,n={page_width:297*zt,page_height:210*zt,pad_w:e,pad_h:e,tt_basex:e,tt_basey:25*zt,tt_space_bottom:15*zt,tt_width:0,tt_height:0,splitpage_w:t?this.m_Data.splitpage_w:1,splitpage_h:t?this.m_Data.splitpage_h:1};if(!this.m_Data.landscape){var o=n.page_width;n.page_width=n.page_height,n.page_height=o}(1<n.splitpage_w||1<n.splitpage_h)&&(n.tt_basex-=n.pad_w,n.page_width-=2*n.pad_w,n.pad_w=0,n.tt_basey-=n.pad_h,n.tt_space_bottom-=n.pad_h,n.page_height-=2*n.pad_h,n.pad_h=0);var r=0;1<n.splitpage_w&&(n.page_width=(n.page_width+i)/n.splitpage_w,n.tt_basex/=n.splitpage_w,r=i);var a=0;return 1<n.splitpage_h&&(n.page_height=(n.page_height+i)/n.splitpage_h,n.tt_basey/=n.splitpage_h,n.tt_space_bottom/=n.splitpage_h,a=i),n.tt_width=n.page_width-2*n.tt_basex-r,n.tt_height=n.page_height-n.tt_basey-n.tt_space_bottom-a,n},r.prototype.IsSuhrn=function(){for(var t=0,e=["teachers","classes","classrooms","subjects","students"];t<e.length;t++){var i=e[t];if(this.m_RowTables.includes(i))return!0;if(this.m_ColumnTables.includes(i))return!0}return!1},r.prototype.Roznasob=function(t,e,i,n){void 0===n&&(n={});for(var o=[[]],r=0,a=e;r<a.length;r++){var s=a[r],l=o;o=[];for(var c=0,m=l;c<m.length;c++){var h=m[c],_=t.TableObjects(s);if("periods"==s){for(var u=[],d=0,p=_;d<p.length;d++){var f=p[d],v=t.m_ObjectsI.breaks[f.m_Id];v&&u.push(v),u.push(f)}_=[];for(var b=0,y=u;b<y.length;b++){var g=y[b];this.TlacPeriodu(g)&&_.push(g)}}for(var k=0,T=_;k<T.length;k++){var S=T[k];if(i[s]){var C=S.m_Id;if("days"!=s&&"weeks"!=s&&"terms"!=s||(C=""+S.m_Val),ASC.indexOf2(i[s],C)<0)continue}if(!("students"==S.m_Table&&i.classes&&ASC.indexOf2(i.classes,S.m_pTrieda.m_Id)<0)){var A=h.slice();if(A.push(S),o.push(A),"classes"==s&&n.withclassroomtt){var w=S.GetUcebna();if(w){var I=At.__spreadArrays(A);I.pop(),I.push(w),o.push(I)}}}}}}return o},r.prototype.TlacPeriodu=function(t){var e=t.m_Data;return this.IsSuhrn()?ASC.boolVal(e.printinsummary):this.m_PageTables.includes("teachers")?ASC.boolVal(e.printinteacher):this.m_PageTables.includes("classes")||this.m_PageTables.includes("students")?ASC.boolVal(e.printinclass):!this.m_PageTables.includes("classrooms")||ASC.boolVal(e.printinclassroom)},r.prototype.GetPrintKartaStyle=function(t,e,i){for(var n=0,o=this.m_PrintKartaStyles;n<o.length;n++)if((s=o[n]).m_nDlzka==t&&s.m_nPocetRiadkov==e&&s.m_nBezTriedyAleboUcitela==i)return s;for(var r=0,a=this.m_PrintKartaStyles;r<a.length;r++){var s;if((s=a[r]).m_nDlzka==t&&0==s.m_nPocetRiadkov&&s.m_nBezTriedyAleboUcitela==i)return s}return this.m_PrintKartaStyles[0]},r.prototype.UpdateSetting=function(t,e){this.m_pRok.m_pRozApp.click_func("print_setting","tzid="+this.m_Id+"&s="+t+"&v="+e)},r);function r(t,e){var i=n.call(this,t,"ttreports",e)||this;return i.m_PageTables=[],i.m_RowTables=[],i.m_ColumnTables=[],i.m_nTypStredu=0,i.m_PrintKartaStyles=[],i.m_bTTViewerDisableCardColor=!1,i.m_ExtraColumns=[],i.m_ExtraRows=[],i.InitFromData(),i}t.CTlacZostava=i;var zt=10,S=["il","rb"].includes(ASC.lang),a=(v.prototype.SetScale=function(t,e){var i=this.m_Scale;this.m_Scale=t;var n=this.m_Pages[this.m_nPage];if(n&&(n.UpdateSheetScale(this.m_Scale),e)){var o=e.offsetX/i,r=e.offsetY/i,a=n.$svg.offset().left+o*t,s=n.$svg.offset().top+r*t,l=this.$sheet.parent();l[0].scrollLeft+=a-e.pageX,l[0].scrollTop+=s-e.pageY}},v.prototype.Zoom=function(t,e){var i=this.m_Scales[0];if(e)i=this.m_Scale*e,i=Math.max(i,this.m_Scales[0]),i=Math.min(i,this.m_Scales[this.m_Scales.length-1]);else for(var n=1;n<this.m_Scales.length;n++){var o=this.m_Scales[n];if(o>=1.05*this.m_Scale){i=o;break}}this.SetScale(i,t)},v.prototype.ZoomFit=function(){this.ZoomFit0(),this.m_Scales=ASC.clone(v.default_scales),this.m_Scales.push(this.m_Scale),this.m_Scales.sort(function(t,e){return t-e})},v.prototype.ZoomFit0=function(){var t=this.m_Pages[0];if(t){var e=(this.$div.innerHeight()-13)/t.height;e=Math.min(e,(this.$div.innerWidth()-13)/t.width),e*=zt,10<(e=Math.max(e,1.5))||this.SetScale(e)}},v.prototype.Render=function(){if(this.m_Pages=this.m_pTlacZostava.Render(this),0==this.m_Pages.length){var t=new m(this.m_pTlacZostava);this.m_Pages.push(t)}},v.prototype.IsNoPage=function(){return 0==this.m_Pages.length||this.m_Pages[0]instanceof m},v.prototype.Update=function(){this.Render(),this.m_nPage>=this.m_Pages.length&&(this.m_nPage=0),this.UpdatePage()},v.prototype.UpdatePage=function(){var t=this.m_Pages[this.m_nPage];this.$sheet.empty(),this.UpdateRibbon(),t.RenderSheet(this.$sheet,this.m_Scale,!this.m_bTTViewer)},v.prototype.UpdateRibbon=function(){var d=this;this.$pagenum_d.text(ASC.ttls(1750)+" "+(this.m_nPage+1)+"/"+this.m_Pages.length);var a=this.m_pRozApp,p=this.m_pRok;if(a.ribbonMenu.findButtonsByCmd("printpreview_prev").forEach(function(t){t.enabled(0<d.m_nPage)}),a.ribbonMenu.findButtonsByCmd("printpreview_next").forEach(function(t){t.enabled(d.m_nPage+1<d.m_Pages.length)}),this.m_bTTViewer){for(var f=a.ttviewer_options.filter,v=this.TTViewer_CurrentObject(),t=function(u){a.ribbonMenu.findButtonsByCmd("ttviewer_"+u).forEach(function(t){var e=[];if("students"==u){for(var i={},n=function(t){if(ASC.indexOf2(f[u],t.m_Id)<0)return"continue";var e=t.m_pTrieda.m_Id;i[e]||(i[e]=[]),i[e].push({text:ASC.escapeHTML(t.GetNazov()),checked:t==v,onclick:function(){d.TTViewer_SetCurrentObject(t)}})},o=0,r=p.TableObjects(u);o<r.length;o++)n(r[o]);for(var a=0,s=p.TableObjects("classes");a<s.length;a++){var l=s[a],c=l.m_Id;i[c]&&e.push({text:ASC.escapeHTML(l.GetNazov()),submenu:i[c]})}}else for(var m=function(t){if(ASC.indexOf2(f[u],t.m_Id)<0)return"continue";e.push({text:ASC.escapeHTML(t.GetNazov()),checked:t==v,onclick:function(){d.TTViewer_SetCurrentObject(t)}})},h=0,_=p.TableObjects(u);h<_.length;h++)m(_[h]);t.enabled(0<e.length),t.selected(v&&v.m_Table==u),t.menu=e})},e=0,i=["subjects","classes","teachers","classrooms","students"];e<i.length;e++)t(i[e]);a.ribbonMenu.findButtonsByCmd("ttviewer_summary").forEach(function(t){for(var n=[],o=!1,e=function(t){var e=t.t+"_summary";if(0==f[e].length)return"continue";var i=d.m_pTlacZostava.m_Data.typ==t.pt;o=o||i,n.push({text:ASC.escapeHTML(t.l),checked:i,onclick:function(){d.TTViewer_SetTable(e)}})},i=0,r=[{t:"teachers",l:ASC.ls(1656),pt:6},{t:"classes",l:ASC.ls(1657),pt:5},{t:"classrooms",l:ASC.ls(1658),pt:7}];i<r.length;i++)e(r[i]);n.length&&!a.ttviewer_options.kiosk&&(0<n.length&&n.push([]),n.push({text:ASC.ls(2838),onclick:function(){var t="/timetable/view.php";document.location.href.indexOf("fullscreen=1")<0&&(t+="?fullscreen=1"),document.location.href=t}})),t.enabled(0<n.length),t.selected(o),t.menu=n})}},v.prototype.TTViewer_Select=function(t){if(!t)return!1;var e=t.split(":");return this.TTViewer_Sel(e[0],e[1])},v.prototype.TTViewer_Sel=function(t,e){var i=this.m_pRok;if(i.m_ObjectsI[t]){var n=i.m_ObjectsI[t][e];if(n)return this.TTViewer_SetCurrentObject(n),!0}return this.TTViewer_SetTable(t)},v.prototype.TTViewer_AutoSelect=function(){for(var t=0,e=["classes","classes_summary","teachers","teachers_summary","subjects"];t<e.length;t++){var i=e[t];if(this.TTViewer_SetTable(i),!this.IsNoPage())break}},v.prototype.TTViewer_SetTable=function(t){var e={teachers_summary:6,classes_summary:5,classrooms_summary:7}[t];if(e){for(var i=0,n=this.m_pRok.TableObjects("ttreports");i<n.length;i++)if((a=n[i]).m_Data.typ==e)return this.SetZostava(a),!0;return!1}if(this.m_pTlacZostava.m_PageTables.includes(t))return 0==this.m_Pages.length&&this.Update(),!0;for(var o=0,r=this.m_pRok.TableObjects("ttreports");o<r.length;o++){var a;if((a=r[o]).m_PageTables.includes(t))return this.SetZostava(a),!0}return!1},v.prototype.TTViewer_SetCurrentObject=function(t){if(t&&this.TTViewer_SetTable(t.m_Table))for(var e=0;e<this.m_Pages.length;e++){var i=this.m_Pages[e];if(!(i instanceof U))return;if(i.m_Page.includes(t)){this.m_nPage=e,this.UpdatePage();break}}},v.prototype.TTViewer_CurrentObject=function(){var t=this.m_Pages[this.m_nPage];if(!t)return null;if(t instanceof U){for(var e=0,i=t.m_Page;e<i.length;e++){var n=i[e];if(["subjects","classes","teachers","classrooms","students"].includes(n.m_Table))return n}return null}},v.prototype.TTViewer_GetSelected=function(){var t=this.TTViewer_CurrentObject();return t?t.m_Table+":"+t.m_Id:null},v.prototype.PrevPage=function(){this.m_nPage<=0||(this.m_nPage--,this.UpdatePage())},v.prototype.NextPage=function(){this.m_nPage+1>=this.m_Pages.length||(this.m_nPage++,this.UpdatePage())},v.prototype.SetZostava=function(t){var e,i,n=this,o="";if("string"==typeof t){var r=t.split("."),a=r[0];o=(o=r[1]||"")||"",t=(t=this.m_pRok.m_ObjectsI.ttreports[a])||this.m_pRok.FindTableTlacZostava(a)}if(this.m_pTlacZostava!=t||(null!==(i=null===(e=this.designData)||void 0===e?void 0:e.id)&&void 0!==i?i:"")!==o){t||this.m_pRozApp.Fail("Error 6995307472"),this.m_pTlacZostava=t,this.designData=null;var s=this.m_pTlacZostava.m_Id+(o?"."+o:"");this.m_pZostavaCombo.value!=s&&this.m_pZostavaCombo.ASC_set(s),this.m_nPage=0,this.Update(),o&&ASC.blockUI(l.getDesignData(null,this.m_pRozApp.ttgpid,o)).then(function(t){n.designData=t,n.Update()})}},v.prototype.Print=function(t){void 0===t&&(t={}),f(t.selected_page?[this.m_Pages[this.m_nPage]]:this.m_Pages)},v.prototype.ClickFilter=function(){Promise.resolve().then(function(){return require("./print_filter")}).then(function(t){return t.showPrintFilterDlg()})},v.prototype.SetFilter=function(t){JSON.stringify(t)!=JSON.stringify(this.filter)&&(this.filter=t,this.Update())},v.prototype.SettingsChanged=function(){var t=this;this.m_pRozApp.SyncNow().then(function(){t.Update()})},v.prototype.Validate=function(){this.m_bInvalid&&(this.m_bInvalid=!1,this.Update())},v.prototype.Destroy=function(){},v.default_scales=[2,3,4,6,10],v);function v(t,e){var h=this;void 0===e&&(e={}),this.m_pTlacZostava=null,this.designData=null,this.m_pZostavaCombo=null,this.m_Pages=[],this.m_nPage=0,this.m_Scale=4,this.m_Scales=ASC.clone(v.default_scales),this.filter={},this.m_bInvalid=!1,this.m_bTTViewer=!1;var i=Pt.client_req;this.m_pRozApp=t,this.m_pRok=t.m_pRok,this.m_pRozApp.m_pPrintPreview=this,e.ttviewer&&(this.m_bTTViewer=!0);var n=t.$rg_printpreview_div;n.css("margin-top","4px"),n.empty();for(var o=[],r=0,a=($j("<div style='margin-bottom:4px'>").appendTo(n).text(ASC.ttls(3341)).get(0).ASC_printpreview=this).m_pRok.m_ObjectsO.ttreports;r<a.length;r++){var s=a[r];this.m_pTlacZostava||(this.m_pTlacZostava=s);var l=[{}],c="ascpalo"==i.edupage,m="de"==i.school_country||c;switch(parseInt(s.m_Data.typ)){case Ot.PRINTAREA.INSPEKCIA:l=[{designid:"internal_table"}],"sk"==i.school_country?l=[{designid:"internal_table_sk"}]:c&&l.push({designid:"internal_table_sk",name:"SK tlacivo"}),m&&l.push({name:"Vorlage Schulamt",designid:"internal_table_de_1"});break;case Ot.PRINTAREA.INSPEKCIA_UCITEL:l=[{designid:"internal_table_teacher"}],m&&(c||(l=[]),l.push({name:"Stundenplan fÃ¼r jeden Lehrer - mit Tabelle",designid:"internal_table_teacher_de_3"}),l.push({name:"Vorlage Schulamt erweitert LehrerIn",designid:"internal_table_teacher_de_1"}),l.push({name:"Neu Schulamt Tab Unterschrift Klassen",designid:"internal_table_teacher_de_2"}))}for(var _=0,u=l;_<u.length;_++){var d=u[_],p=d.name||s.GetNazov();o.push({value:s.m_Id+(d.designid?"."+d.designid:""),name:p,icon:s.GetIcon(),html:"<img src='"+s.GetIcon()+"' style='height:24px;vertical-align:middle;padding-right:10px'>"+ASC.escapeHTML(p)})}}this.m_pZostavaCombo=new ASC.ui.ComboBox(n,this.m_pTlacZostava.m_Id,o,{style:"width:100%",fn:function(t){h.SetZostava(t)}}),this.$pagenum_d=$j("<div style='margin-top:4px'>").appendTo(n),this.$div=t.$printpreview_d,this.$div.empty(),this.$sheet=$j("<div class='print-sheet' style='cursor:zoom-in'>").appendTo(this.$div),this.$sheet.on("mousedown",function(t){0==t.button&&(t.shiftKey?h.ZoomFit():h.Zoom(t),t.preventDefault(),ASC.hideContextMenu())}),this.$sheet.on("contextmenu",function(t){var e=[];e.push({text:ASC.ttls(2551)+": "+ASC.ttls(2829),onclick:function(){h.ZoomFit()}});var i=h.m_pTlacZostava;i.m_Data.cardcolorenabled&&(e.push([]),e.push({text:ASC.ttls(1438),checked:!i.m_bTTViewerDisableCardColor,onclick:function(){i.m_bTTViewerDisableCardColor=!i.m_bTTViewerDisableCardColor,h.Update()}})),h.m_bTTViewer&&(e.push([]),e.push({text:ASC.ls(1248),onclick:function(){var t="https://"+ASC.edupage+".edupage.org/timetable/view.php",e=[],i=""+h.m_pRozApp.ttviewer_options.num;i&&(""+parseInt(i)==i?e.push("num="+h.m_pRozApp.ttviewer_options.num):"week:"==i.substr(0,5)&&i!="week:"+Dt.date_week(Pt.client_req,Pt.client_req.timezone_date())&&e.push("week="+i.substr(5)));var n=h.m_Pages[h.m_nPage];if(n instanceof U){for(var o="",r=0,a=n.m_Page;r<a.length;r++){var s=a[r];if(["classes","teachers","classrooms","subjects","students"].includes(s.m_Table)){o=ASC.tt.removeEs(s.m_Table)+"="+s.m_Id;break}}if(!o)for(var l=0,c=h.m_pTlacZostava.m_RowTables;l<c.length;l++){var m=c[l];if(["classes","teachers","classrooms"].includes(m)){o="summary="+m;break}}o&&e.push(o)}prompt(ASC.ls(1248)+":",t+"?"+e.join("&"))}})),ASC.showContextMenu(e,t),t.preventDefault()}),this.m_bTTViewer&&ASC.edupage;if(this.$sheet.on("mousedown mouseup",function(t){t.preventDefault()}),this.m_bTTViewer){var f=null;t.ttviewer_options.browser_jsc&&(t.ttviewer_options.browser_jsc.app&&(f=t.ttviewer_options.browser_jsc.app.m_pPrintPreview.TTViewer_GetSelected()),t.ttviewer_options.browser_jsc.app=t),!f&&t.ttviewer_options.select&&(f=t.ttviewer_options.select),f&&this.TTViewer_Select(f),this.IsNoPage()&&this.TTViewer_AutoSelect()}this.IsNoPage()&&this.Render(),"interactive"==document.readyState?$j(window).load(function(){h.ZoomFit0(),h.Update()}):(this.ZoomFit0(),this.Update())}function tt(t,e){return void 0===e&&(e=null),$j(function(t,e){void 0===e&&(e=null);e=e||document;return e.createElementNS("http://www.w3.org/2000/svg",t)}(t,e))}function C(t){return t.get(0).getBBox()}t.CPrintPreview=a;var A=1,V=(s.prototype.RenderSheet=function(t,e,i){this.$sheet=t,this.preview=i,t.css({minHeight:"0px",padding:"0px"}),this.page_document=t[0].ownerDocument,this.$svg=$j("<svg style='position:absolute;left:0px;top:0px;direction:ltr'>").attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("stroke","#000000").attr("stroke-width","0").attr("fill","#000000").appendTo(t),this.$defs=tt("defs",this.page_document).appendTo(this.$svg),this.$page=tt("g",this.page_document).appendTo(this.$svg),this.UpdateSheetScale(e),this.Render()},s.prototype.UpdateSheetScale=function(t){if(this.$sheet){var e=t/zt,i=e*this.width,n=e*this.height;this.$sheet.css({width:i+"px",height:.995*n+"px",minHeight:"0px",padding:"0px"}),this.$svg.attr({width:i,height:n}),S?this.$page.attr({"transform-origin":"0 0",transform:"scale("+-e+","+e+") translate("+-this.width+")"}):this.$page.attr({transform:"scale("+e+")"})}},s.prototype.Render=function(){},s);function s(t){this.width=100,this.height=100,this.preview=!1,this.fixTTColors=!1,this.designData=null,this.m_pTlacZostava=t,this.dimensions=t.Dimensions(this instanceof U),this.width=this.dimensions.page_width,this.height=this.dimensions.page_height}t.CPrintPage=V;var c,m=(c=V,At.__extends(h,c),h);function h(){return null!==c&&c.apply(this,arguments)||this}t.CDummyPage=m;var _,M=(_=V,At.__extends(u,_),u.prototype.Render=function(){for(var t=this.m_pTlacZostava.Dimensions(!1),e=this.m_pTlacZostava.Dimensions(!0),i=0,n=0,o=t.pad_w,r=t.pad_h,a=0,s=this.subpages;a<s.length;a++){var l=s[a];l.page_document=this.page_document;var c=tt("g",this.page_document).appendTo(this.$page).attr("transform","translate("+o+","+r+")");l.$page=c,l.$defs=this.$defs,l.preview=this.preview,l.Render(),this.m_pTlacZostava.m_Data.splitpageorder?(n++,r+=l.height,n>=e.splitpage_h&&(n=0,r=t.pad_h,i++,o+=l.width)):(i++,o+=l.width,i>=e.splitpage_w&&(i=0,o=t.pad_w,n++,r+=l.height))}},u);function u(t){var e=_.call(this,t)||this;return e.subpages=[],e}function Gt(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];switch(n.m_Table){case"classes":case"teachers":case"subjects":case"classrooms":case"students":return n}}return null}t.CPrintPageSplit=M,t.HorizontalRO=Gt;var d,U=(d=V,At.__extends(p,d),p.prototype.Render=function(){var i=this;if(this.designData)this.RenderDesign();else{var t=this.dimensions,e=this.m_pTlacZostava_objekt.m_Data.userheader,n=this.m_pTlacZostava_objekt.m_Data.pageheader,o=t.pad_w,r=t.tt_basey,a=this.m_pTlacZostava.m_pRok.m_ObjectsI.globals[1].m_Data.settings.m_strPrintHeaderText;if(""!=a){var s=(r-o)/4;this.TextBox(new xt(t.tt_basex,o,t.tt_basex+t.tt_width,o+s),t.tt_height*e.size,a,0,1,e,e),o+=s/2}var l=this.m_pTlacZostava.m_Data.printlogo_url;l&&this.Image(new xt(t.tt_basex,t.pad_h,t.tt_basex+t.tt_width,t.tt_basey-2),l,-1,0).css("pointer-events","none");var c=t.tt_basex,m=o,h=t.tt_basex+t.tt_width,_=new xt(c,m,h,r);this.TextBox(_,t.tt_height*n.size,this.m_Title,0,0,n,n),this.preview&&this.Rect(_,"transparent",0).on("contextmenu",function(t){var e=i.m_pTlacZostava_objekt;Promise.resolve().then(function(){return require("./print_settings")}).then(function(t){return t.showPrintPageHeaderDlg(e.m_pRok.m_pRozApp.ttgpid,e.m_Id)}),t.preventDefault(),t.stopPropagation()}),this.RenderTT(t.tt_basex,t.tt_basey,t.tt_width,t.tt_height)}},p.prototype.RenderDesign=function(){for(var E=this,N=this.m_pTlacZostava.m_pRok,j=this.designData,t=this.dimensions,Z=new xt(100,100,t.page_width-100,t.page_height-100),$=this.m_Page[0],F=Z.width()/1e6,L=Z.height()/1e6,B=.005*Z.width(),e=function(t){var e=t.m_text,i=new xt(Z.x1+t.m_rect.left*F,Z.y1+t.m_rect.top*L,Z.x1+t.m_rect.right*F,Z.y1+t.m_rect.bottom*L);switch(t.m_nTyp){case 0:J.RenderTT(i.x1,i.y1,i.width(),i.height(),!0);break;case 1:if(e){e=(e=e.replace(/\{!#([0-9]{4})\}/g,function(t,e){return ASC.ttls(parseInt(e))})).replace(/\{([^}]+)\}/g,function(t,e){var i,n,o=e.split(":");if(1==o.length)e.startsWith("!#")?t=ASC.ttls(parseInt(t.substr(2))):"#1635"==e&&(t=$.GetNazov());else if(2==o.length){var r=o[0],a=o[1];if("#1035"==r&&$ instanceof wt.CTrieda){var s,l=j.class_data[$.m_Id]||{};"#1635"==a&&(t=$.GetNazov()),"#1067"==a&&(t=null===(i=$.GetUcebna())||void 0===i?void 0:i.GetNazov()),"#1532"==a&&(t=null===(n=$.m_pUcitel)||void 0===n?void 0:n.GetNazov()),"#3956"==a&&(t=l.sk_vyucovaci_jazyk||""),"TlaÄivo - typ"==a&&(t=l.sk_tlacivo_typ||""),"TlaÄivo - nÃ¡zov"==a&&(t=l.sk_tlacivo_nazov||""),"#1159"==a&&((s=new Rt.CMHodina(N)).SetPozicia($),s.Add0_array($.GetHodinyMozuSem(0)),s.FinishAdding(),t=E.GetMHText(s,"count"))}"#1048"==r&&$ instanceof wt.CUcitel&&("#1052"==a&&(t=W.CUtils.GetUINazvy(N.m_ObjectsO.classes.filter(function(t){return t.m_pUcitel==$}))),"#1635"==a&&(t=$.GetNazov()),"#3314"==a&&((s=new Rt.CMHodina(N)).m_bUvazujDlzkuPreUvazokUcitela=!0,s.Add0_array($.GetHodinyMozuSem(0)),s.FinishAdding(),t=E.GetMHText(s,"count"))),"#3148"==r&&("#1166"!=a&&"#3205"!=a||(t=j.school_name),"#2975"!=a&&"#3975"!=a||(t=j.headmaster_name),"#1167"==a&&(t=j.year_name))}return t||""});var n=et(t.m_align),o=n.ax,r=n.ay;J.TextBox(i,t.font.ratio*Z.height()*.87,e,o,r,{},{shrink:!0})}var a=function(t,e,i,n,o){if(o){var r=.1*((o-1)%3+1),a=Math.floor((o-1)/3),s=E.Line(t,e,i,n,r);2==a&&s.attr("stroke-dasharray","3 6")}};a(i.x1,i.y1,i.x2,i.y1,t.m_lineTop),a(i.x1,i.y2,i.x2,i.y2,t.m_lineBottom),a(i.x1,(i.y1+i.y2)/2,i.x2,(i.y1+i.y2)/2,t.m_lineMiddle),a(i.x1,i.y1,i.x1,i.y2,t.m_lineLeft),a(i.x2,i.y1,i.x2,i.y2,t.m_lineRight);break;case 3:var s=t.Reportdata;J.Rect(i,"#fff",.2);var l=i.y1+i.height()*s.m_nHeaderHeight/100,c=i.y2-i.height()*s.m_nFooterHeight/100;J.HLine(i.x1,l,i.width(),.2),J.HLine(i.x1,c,i.width(),.2);var m=i.x1,h=J.m_Page[0],_=new Rt.CMHodina(N),u=[];_.SetPozicia(h);var d=h.GetHodinyMozuSem(0);_.Add_array(d);for(var p=function(e){var t=u.find(function(t){return!!s.m_bGroupBySubject&&t.m_Pozicia.subjects==e.m_pPredmet});t||((t=new Rt.CMHodina(N)).SetPozicia(h),t.SetPozicia(e.m_pPredmet),u.push(t)),t.Add(e)},f=0,v=d;f<v.length;f++)p(v[f]);_.FinishAdding();for(var b=0,y=u;b<y.length;b++)(U=y[b]).FinishAdding();u.sort(function(t,e){return t.m_Pozicia.subjects.GetDBIndex()-e.m_Pozicia.subjects.GetDBIndex()});for(var g=t.font.ratio*Z.height()*1.3,k=0;k<s.columns.length;k++){var T=s.columns[k],S=m+i.width()*T.nWidth/100,C=m+B,A=S-B,w=T.nID;0<k&&J.VLine(m,i.y1,i.height(),.1);for(var I=0,R=[[T.strUserHeaderName,t.fontheader,i.y1,l],[T.strUserFooterName,t.fontfooter,c,i.y2]];I<R.length;I++){var P=R[I],O=P[0],D=P[1],x=P[2],z=P[3];"#"==O[0]&&(O=ASC.ttls(parseInt(O.substr(1)))),"{sum}"==O&&(O=J.GetMHText(_,"count")),"{}"==O&&28001==w&&(O=ASC.ttls(1035)),J.TextBox(new xt(C,x,A,z),D.ratio*Z.height(),O,-1,0,{},{shrink:!0})}for(var G=l,V=0,M=u;V<M.length;V++){var U=M[V],H=G+g;0==k&&J.HLine(i.x1,H,i.width(),.1);var K=""+w;0==w&&(K=""),28e3==w&&(K=U.GetText("subjects","name")),28001==w&&(K=U.GetText("classes","name")),28004==w&&(K=J.GetMHText(U,"count")),28018==w&&(K=""+(null===(n=U.m_Objects.subjects[0])||void 0===n?void 0:n.GetDoUvazkuRatatAko())),J.TextBox(new xt(C,G,A,H),t.font.ratio*Z.height(),K,-1,0,{},{clip:!0}),G=H}m=S}}},J=this,i=0,n=j.objects;i<n.length;i++)e(n[i])},p.prototype.RenderTT=function(v,b,l,y,t){var g,J=this;void 0===t&&(t=!1);var W=this.m_pTTRowRenderer,Y=this.m_pTlacZostava.m_pRok,X=this.m_pTlacZostava.m_Data,_=X.gridheadertexts,u=this.m_Columns,q=this.m_Rows,e=this.m_pTlacZostava.m_ColumnTables,i=this.m_pTlacZostava.m_RowTables,n=u.length,o=q.length,k=l*X.headerwidth,T=y*X.headerheight,r=0;this.m_ExtraColumns.forEach(function(t){return r+=t.size*l});var a=0;this.m_ExtraRows.forEach(function(t){return a+=t.size*y});var Q=X.cellwidth*(l-k-r),tt=X.cellheight*(y-T-a);function d(t,e,i,n){var o=0,r=0;if(i&&i.pos)switch(i.pos){case 1:o=r=-1;break;case 2:r=-1,o=1;break;case 3:o=-(r=1);break;case 4:o=r=1;break;case 5:r=1,o=0;break;case 6:r=-1,o=0;break;case 7:r=0,o=-1;break;case 8:r=0,o=1}var a=i?i.size:0;return a=a||.4,J.TextBox(t.pad(.05),e*a,n,o,r,i,{shrink:!0})}function s(t,e,i,n,o,r){var a=i;_[a]||(a="objects");var s=_[a],l="";if(l=s&&s.column?n.GetNazov(s.column):"periods"==i?n.GetNazov():n.GetSkratka(),d(t,e,s,l),"periods"==i&&_.time&&_.time.enabled){var c=At.__spreadArrays(J.m_Page);0<=o&&c.push.apply(c,u[o]),0<=r&&c.push.apply(c,q[r]);var m=Y.GetPeriodTime(c);0<=o&&(p[o]=m),0<=r&&(f[r]=m);var h=Y.FormatTimeFromTo(m.starttime,m.endtime,"2lines"==_.time.column?"\n":void 0);d(t,e,_.time,h)}J.CustomizeRect(t,function(){var e=J.m_pTlacZostava;Promise.resolve().then(function(){return require("./print_settings")}).then(function(t){return t.showPrintGridHeaderTextDlg(Y.m_pRozApp.ttgpid,e.m_Id,a)})})}X.fitwidth&&0<n&&(Q=(l-k-r)/n),X.fitheight&&0<o&&(tt=(y-T-a)/o);var S=v+k+n*Q,C=b+T+o*tt,c=S+r,m=C+a,p=[],f=[];function h(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];if(n instanceof wt.CBreak)return n}return null}var et=[],it=[],A=_.days.size;A?(e.includes("days")&&(A*=e.length),i.includes("days")&&(A*=i.length)):A=.5;for(var w=0;w<n;w++){var I=h(u[w]);if(I){var R=new xt(G=v+k+w*Q,M=b+T+tt/3,V=v+k+(w+1)*Q,x=C-tt/3);this.Rect(R,"#fff",0),I.m_Data.printtext&&this.TextBoxRotated(R,A*Q,I.m_Data.printtext,0,0,{},{shrink:!0}),et[w]=I}}for(w=0;w<o;w++){var P=h(q[w]);P&&(R=new xt(G=v+k,M=b+T+w*tt,V=S,x=b+T+(1+w)*tt),this.Rect(R,"#fff",0),P.m_Data.printtext&&this.TextBox(R,A*tt,P.m_Data.printtext),it[w]=P)}for(var O=function(t,e,i,n,o,r,a){for(var s=0;s<o;s++)if(!r[s]){for(var l=s+1;l<o&&!r[l];)l++;J.Line(t+s*i,e+s*n,t+l*i,e+l*n,a),s=l}},nt=[],D=0;D<e.length;D++){var x=(M=b+D*T/e.length)+T/e.length;0<D&&this.HLine(v+k,M,n*Q,.1);var z=null,G=0;for(w=0;w<n;w++)(U=u[w][D])!=z&&(G=v+k+w*Q,z&&(D+1<e.length&&(nt[w]=!0),this.VLine(G,M,x-M,nt[w]?.2:.1))),(n<=w+1||u[w+1][D]!=U)&&s(new xt(G,M,V=v+k+(w+1)*Q,x),T,e[D],U,w,-1),z=U}for(w=1;w<n;w++)O(v+k+w*Q,b+T,0,tt,o,it,nt[w]?.2:.1);var ot=[];for(D=0;D<i.length;D++){var V=(G=v+D*k/i.length)+k/i.length;0<D&&this.VLine(G,b+T,o*tt,.1),z=null;var M=0;for(w=0;w<o;w++){var U;(U=q[w][D])!=z&&(M=b+T+w*tt,z&&(D+1<i.length&&(ot[w]=!0),this.HLine(G,M,V-G,ot[w]?.2:.1))),(o<=w+1||q[w+1][D]!=U)&&s(new xt(G,M,V,x=b+T+(w+1)*tt),tt,i[D],U,-1,w),z=U}}for(w=1;w<o;w++)O(v+k,b+T+w*tt,Q,0,n,et,ot[w]?.2:.1);function rt(t){for(var e=0,i=t;e<i.length;e++)if(i[e]instanceof wt.CPeriod)return!0;return!1}function at(t,e){for(var i=0,n=e;i<n.length;i++){var o=n[i];switch(o.m_Table){case"termsdefs":t[0]=o.m_Val;break;case"weeksdefs":t[1]=o.m_Val;break;case"daysdefs":t[2]=o.m_Val;break;case"periods":case"breaks":t[3]=o.m_nHodina}}}function st(t){for(var e=0,i=t;e<i.length;e++){var n=i[e];if(n instanceof wt.CUcitel)return n;if(n instanceof wt.CUcebna)return n}return null}function H(t,e,i,n){for(var o=e==q,r=o?1:0,a=1-r,s=o?ot:nt,l=o?it:et,c=!0,m=0,h=[0,0],_=[0,0],u=[h,_],d=0;d<e.length;d++)if(rt(O=e[d])){c&&(J.TTR_Init(J.m_Page.concat(t,O)),c=!1,m=d);var p=d+1>=e.length;if(p||rt(e[d+1])||(p=!0),p||J.TTR_TryContinue(e[d+1])||(p=!0),p){W.Compute();for(var f=At.__spreadArrays(J.m_Page,t),v=0,b=W.m_Cells;v<b.length;v++){var y=b[v],g=At.__spreadArrays(f,e[m+y.x1]),k=At.__spreadArrays(f,e[m+y.x2]);h[r]=lt[r]+ct[r]+(m+y.x1)*mt[r],_[r]=h[r]+(y.x2-y.x1+1)*mt[r],h[a]=lt[a]+ct[a]+(n+y.y1)*mt[a],_[a]=lt[a]+ct[a]+(n+y.y2)*mt[a];var T=h[0],S=h[1],C=_[0],A=_[1];J.RenderCell(new xt(T,S,C,A),Q,tt,y,!1,g,k,i[m+y.x1],i[m+y.x2]);var w=void 0;w=J.Line(u[0][0],u[0][1],u[a][0],u[r][1],.1),0<y.y1&&w.attr("stroke-dasharray","0.7,0.7"),w=J.Line(u[r][0],u[a][1],u[1][0],u[1][1],.1),y.y2<1&&w.attr("stroke-dasharray","0.7,0.7"),w=J.Line(u[0][0],u[0][1],u[r][0],u[a][1],s[m+y.x1]?.2:.1),w=J.Line(u[a][0],u[r][1],u[1][0],u[1][1],s[m+y.x1+1]?.2:.1)}c=!0}}var I=Y.GlobalData().settings;if(J.m_pTlacZostava.IsSuhrn()?I.m_bPrintDozoryVSuhrnnych:I.m_bPrintDozory){var R=[-1,-1,-1,-1];at(R,J.m_Page),at(R,t);var P=st(J.m_Page)||st(t);for(d=0;d<e.length;d++){var O=e[d];at(R,O);var D=st(O);if(D&&(P=D),P)for(var x=0,z=[!0,!1];x<z.length;x++){var G=z[x],V=null;if(l[d]){if(G)continue;V=Y.GetDozoryTWDH(P,R[0],R[1],R[2],R[3],!0)}else{if(G){var M=l[d-1];if(M&&M.m_nHodina==R[3])continue}V=Y.GetDozoryTWDH(P,R[0],R[1],R[2],R[3],G)}if(V&&V.length){G?(h[r]=lt[r]+ct[r]+Math.max(0,d-.1)*mt[r],_[r]=lt[r]+ct[r]+(d+.1)*mt[r]):(h[r]=lt[r]+ct[r]+(d+.3)*mt[r],_[r]=lt[r]+ct[r]+(d+.7)*mt[r]);for(var U=V.length,H=0;H<U;H++){var K=V[H];h[a]=lt[a]+ct[a]+(n+.2+.6*H/U)*mt[a],_[a]=lt[a]+ct[a]+(n+.2+.6*(H+1)/U)*mt[a];var E="",N="",j=null;P instanceof wt.CUcebna?K.m_pUcitel&&(j=K.m_pUcitel):j=K.m_pUcebna,j&&(E=j.GetSkratka(),N=j.GetNazov());var Z=new xt(h[0],h[1],_[0],_[1]),$=J.Rect(Z,I.m_bPrintDozoryColor&&j&&!J.m_pTlacZostava.m_bTTViewerDisableCardColor?j.GetColor():"#fff",.1);""!=N&&J.Tootlip($,N);var F=X.classroomsupervisionstyle,L={shrink:!0},B=mt[r]*F.size;0==r?J.TextBoxRotated(Z,B,E,0,0,F,L):J.TextBox(Z,B,E,0,0,F,L),K.m_Data.substed&&J.SubstBox(Z),J.preview&&$.on("contextmenu",function(t){Promise.resolve().then(function(){return require("./print_settings")}).then(function(t){return t.showPrintDozorStyleDlg(Y.m_pRozApp.ttgpid,J.m_pTlacZostava.m_Id)}),t.preventDefault(),t.stopPropagation()})}}}}}}var lt=[v,b],ct=[k,T],mt=[Q,tt];if(this.m_pTlacZostava.m_nTypStredu==Ot.TLACDEF_STRED.HODINA){if("periods"==e[e.length-1])for(D=0;D<o;D++)H(q[D],u,p,D);else if("periods"==i[i.length-1])for(D=0;D<n;D++)H(u[D],q,f,D)}else{var K=function(t,e){for(var i=0;i<e.length;i++)if(!e[i].KartaJeTu(t,0))return!1;return!0},E=At.__spreadArrays(Y.TableObjects("cards")),N=[];E.forEach(function(t){K(t,J.m_Page)&&N.push(t)});var j,Z=Gt(this.m_Page),$=function(t){var s=b+T+t*tt,l=s+tt;j=q[t];var c=[];N.forEach(function(t){K(t,j)&&c.push(t)});for(var m=Z||Gt(j),e=function(t){var e=v+k+t*Q,i=e+Q,n=u[t],o=new Rt.CMHodina(Y);if(o.SetPozicia(m||Gt(n)),c.forEach(function(t){K(t,n)&&o.Add(t)}),o.IsEmpty())return"continue";o.FinishAdding();var r=new It.CTTRowCell(W);r.m_MHodina=o;var a=new xt(e,s,i,l);F.RenderCell(a,Q,tt,r,!1,[],[],p[t],p[t]),F.Rect(a,"none",.1)},i=0;i<n;i++)e(i)},F=this;for(D=0;D<o;D++)$(D)}for(var L=function(r,d,p,f){for(var a=S,s=C,t=function(t){var c=r.indexOf(t),m=t.data,h=m.typ,_=m.cellstyle,e=m.headerstyle,i=t.size*(f?l:y);t!=r[0]&&(f?B.VLine(a,b,C-b,.1):B.HLine(v,s,S-v,.1));var u=f?new xt(a,b,a+i,b+T):new xt(v,s,v+k,s+i);B.TextBox(u.pad(.05),u.height()*(e.size||.4),t.data.name,0,0,e,{wrap:!0}),B.CustomizeRect(u,function(){return At.__awaiter(J,void 0,void 0,function(){return At.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./extracolumns")})];case 1:return[2,t.sent().showExtraColumnStyleDlg(Y.m_pRozApp.ttgpid,this.m_pTlacZostava.m_Id,p,c,"headerstyle")]}})})});for(var n=function(t){var e=f?new xt(u.x1,b+T+tt*t,u.x2,b+T+tt*(t+1)):new xt(v+k+Q*t,u.y1,v+k+Q*(t+1),u.y2),i=1==d[t].length?d[t][0]:null,n="";switch(h){case"empty":break;case"classrooms":case"teachers":case"subjects":case"count":var o=new Rt.CMHodina(Y),r=At.__spreadArrays(B.m_Page,d[t]),a=Gt(r);a&&o.SetPozicia(a);var s=a?a.GetKartyTu(0):Y.m_ObjectsO.cards;s=s.filter(function(e){return!r.find(function(t){return!t.KartaJeTu(e,0)})}),o.Add_array(s),o.FinishAdding(),"count"==h?(n=o.m_bRoznePoctyHodin?"*":"",n+=Math.round(100*o.m_dHodin)/100):n=o.GetText(h);break;case"name":case"short":n=null==i?void 0:i.GetNazov(h);break;default:var l=h.split(".");if(2==l.length&&i&&l[0]==i.m_Table)switch(h){case"classes.teacherid":n=null===(m=i.m_pUcitel)||void 0===m?void 0:m.GetNazov();break;case"classes.classroomid":n=null===(g=i.GetUcebna())||void 0===g?void 0:g.GetNazov()}}n&&(B.TextBox(e.pad(.05),e.height()*(_.size||.4),n,0,0,_,{wrap:!0}),B.CustomizeRect(e,function(){return At.__awaiter(J,void 0,void 0,function(){return At.__generator(this,function(t){switch(t.label){case 0:return[4,Promise.resolve().then(function(){return require("./extracolumns")})];case 1:return[2,t.sent().showExtraColumnStyleDlg(Y.m_pRozApp.ttgpid,this.m_pTlacZostava.m_Id,p,c,"cellstyle")]}})})})),0<t&&(f?B.HLine(e.x1,e.y1,e.width(),.1):B.VLine(e.x1,e.y1,e.height(),.1))},o=0;o<d.length;o++)n(o);f?a+=i:s+=i},e=0,i=r;e<i.length;e++)t(i[e])},B=this,ht=0,_t=[[this.m_ExtraColumns,q,"extracolumns",!0],[this.m_ExtraRows,u,"extrarows",!1]];ht<_t.length;ht++){var ut=_t[ht];L(ut[0],ut[1],ut[2],ut[3])}this.Box(v,b,c,m,.3),this.VLine(v+k,b,m-b,.3),this.HLine(v,b+T,c-v,.3),0<r&&this.VLine(c-r,b,m-b,.3),0<a&&this.HLine(v,m-a,c-v,.3),this.preview&&(new Vt(this.$page,!0,X.headerwidth,v,b,v+l,m,function(t){J.m_pTlacZostava.UpdateSetting("headerwidth",t)}),new Vt(this.$page,!1,X.headerheight,v,b,c,b+y,function(t){J.m_pTlacZostava.UpdateSetting("headerheight",t)}),X.fitwidth||new Vt(this.$page,!0,X.cellwidth,v+k,b,v+l-r,b+T,function(t){J.m_pTlacZostava.UpdateSetting("cellwidth",t)}),X.fitheight||new Vt(this.$page,!1,X.cellheight,v,b+T,v+k,b+y-a,function(t){J.m_pTlacZostava.UpdateSetting("cellheight",t)}));var dt=.02*y,pt=.2*dt;if(this.TextBox(new xt(v,0,c,b-pt),dt,this.m_pTlacZostava.m_pRok.GetRegName(!0),X.printlogo_url?0:-1,1),!t){var ft=null,vt=Gt(this.m_Page);if(vt instanceof wt.CTrieda&&(ft=vt),ft){var bt=[];ft.GetUcebna()&&bt.push(ft.GetUcebna().GetSkratka()),ft.m_pUcitel&&bt.push(("F"==ft.m_pUcitel.m_Data.gender?ASC.ls(1209):ASC.ls(1199))+": "+ft.m_pUcitel.GetNazov());for(var yt=b-pt,gt=0,kt=bt;gt<kt.length;gt++){var Tt=kt[gt];this.TextBox(new xt(v,0,c,yt),dt,Tt,1,1),yt-=dt+pt}}}var St=Y.GlobalData().settings.m_strDateBellowTimeTable||"";if(""==St){var Ct=Pt.client_req;St=Ct.ttls(1854)+": "+Dt.date_format_date(Ct,Ct.timezone_date())}this.TextBox(new xt(v,m+pt,c,m+30*zt),dt,St,-1,-1),this.TextBox(new xt(v,m+pt,c,m+30*zt),dt,"aSc "+ASC.ls(1687),1,-1),Y.m_pRozApp&&Y.m_pRozApp.jsc.unregistered&&(R=new xt(c-.35*l,m-.35*y,c,m),this.Rect(R,"rgba(255,255,255,0.8)",0),this.TextBox(R,.05*y,ASC.ttls(2061),0,0,{},{shrink:!0}))},p.prototype.RenderCell=function(t,e,i,n,o,r,a,s,l){var c,m=this,h=this.m_pTlacZostava.m_pRok,_=this.m_pTlacZostava.m_Data,u=n.m_pKarta,d=n.m_MHodina,p=this.m_pTlacZostava_objekt.m_Data,f=Gt(r),v=t.x1,b=null;if(p.cardcolorenabled&&!this.m_pTlacZostava.m_bTTViewerDisableCardColor){var y=p.cardcolortable1;y=y||(this.m_pTlacZostava.m_PageTables.includes("teachers")?"classes":"teachers");var g=u?this.GetKartaFarby(u,y):d.GetFarby(y),k=u?this.GetKartaFarby(u,p.cardcolortable2):[];"teachers"==y&&(b=u?u.m_pHodina.m_Ucitelia[0]:d.m_Objects.teachers[0]),this.fixTTColors&&(g=g.map(function(t){return Ot.fixTTColor(t)}),k=k.map(function(t){return Ot.fixTTColor(t)}),b=null);var T=null,S=null,C=null,A=null;"left"==p.cardcolorpos?S=g:"topleft"==p.cardcolorpos?A=g:(T=g,C=k);var w="#fff";if(T&&0<T.length&&(w=this.FillFarby(T,t.width(),t.height())),c=this.Rect(t,w,0),S&&0<S.length){var I=t.x1+t.width()/5;this.Rect(new xt(t.x1,t.y1,I,t.y2),this.FillFarby(S,0,t.width()),0),v=I}if(C&&0<C.length&&this.Rect(new xt(t.x1,t.y1+3*t.height()/4,t.x2,t.y2),this.FillFarby(C,t.x2-t.x1,0),0),A&&0<A.length){var R=Math.max(e,i)/5,P=(I=t.x1+R,t.y1+R);tt("polygon",this.page_document).appendTo(this.$page).attr({points:[t.x1,t.y1,I,t.y1,t.x1,P].join(","),stroke:"none",style:"fill:"+this.FillFarby(A,R,R,!0)})}}else c=this.Rect(t,"#fff",0);if(0==_.typ&&u){for(var O=null,D=0,x=this.m_Page;D<x.length;D++){var z=x[D];z instanceof wt.CTrieda&&(O=z)}var G=ASC.strVal(u.m_pHodina.m_pPredmet.m_Data.picture_url);""!=G&&O&&ASC.boolVal(O.m_Data.printsubjectpictures)&&this.Image(t.pad(.2),G).css("pointer-events","none")}var V=1;u&&u.m_pHodina&&(V=u.m_pHodina.IsBezTriedy()?0:u.m_pHodina.IsBezUcitela()?2:1);var M=1/(n.y2-n.y1);(!(M=Math.round(M-.01)-1)||M<0)&&(M=0);for(var U=n.x2-n.x1,H=this.m_pTlacZostava_objekt.GetPrintKartaStyle(U,M,V),K="",E=0,N=["subjects","classes","groupnames","teachers","classrooms","time","count"];E<N.length;E++){var j=N[E],Z=H.texts[j];if(Z&&Z.enabled){var $=et(Z.pos),F=$.ax,L=$.ay,B="",J="";if("time"==j){var W=n.m_pKarta;if(W){var Y=h.GetPeriodTime(r,W.m_pHodina),X=h.GetPeriodTime(a,W.m_pHodina);s&&l&&s.starttime==Y.starttime&&l.endtime==X.endtime||(B=h.FormatTimeFromTo(Y.starttime,X.endtime)),J=B}}else B=u?this.GetKartaText(n.m_pKarta,j,Z.autohide,f,Z.name_col):this.GetMHText(d,j,Z.name_col||"short"),J=u?this.GetKartaText(n.m_pKarta,j,Z.autohide,f,"name"):d.GetText(j,"name");if(""!=B){var q=this.TextBox(new xt(v,t.y1,t.x2,t.y2).pad(.05),i*Z.size,B,F,L,Z,{wrap:!0,clip:!0});if(this.preview&&q.css("pointer-events","none"),b){var Q=b.m_Data[0==F&&0==L?"fontcolorprint":"fontcolorprint2"];Q&&q.attr("fill",Q)}}""!=J&&(K&&(K+="\n"),K+=J)}}this.Tootlip(c,K),u&&u.m_Data.substed&&this.SubstBox(t),this.preview&&c.on("contextmenu",function(t){var e=m.m_pTlacZostava_objekt,i=e.m_PrintKartaStyles.indexOf(H);Promise.resolve().then(function(){return require("./print_settings")}).then(function(t){return t.showPrintCellStyleDlg(h.m_pRozApp.ttgpid,e.m_Id,{ksi:i,m_nDlzka:U,m_nPocetRiadkov:M,m_nBezTriedyAleboUcitela:V})}),t.preventDefault(),t.stopPropagation()})},p.prototype.GetKartaText=function(t,e,i,n,o){var r;switch(void 0===o&&(o="short"),o=o||"short",e){case"subjects":var a=t.m_pHodina,s=a.m_pPredmet.GetNazov(o);return 1<=a.m_nPoradieSeminaru&&("short"==o?("0"<=s.substr(-1)&&s.substr(-1)<="9"&&(s+="-"),s+=a.m_nPoradieSeminaru):s+=" ("+a.m_nPoradieSeminaru+")"),s;case"groups":case"groupnames":r=[];for(var l=0,c=t.m_pHodina.m_Skupiny;l<c.length;l++){var m=c[l];m.m_bCelaTrieda&&i||n instanceof wt.CTrieda&&n!=m.m_pTrieda||(s=m.GetNazov(),r.includes(s)||r.push(s))}return r.join("/");case"teachers":r=[];for(var h=0,_=t.m_pHodina.m_Ucitelia;h<_.length;h++){var u=_[h];r.push(u.GetNazov(o))}return r.join(" / ");case"classes":r=[];for(var d=0,p=t.m_pHodina.m_Triedy;d<p.length;d++){var f=p[d];r.push(f.GetNazov(o))}return r.join("/");case"classrooms":r=[];for(var v=0,b=t.Ucebne();v<b.length;v++){var y=b[v];if(y){if(i){for(var g=!1,k=0,T=t.m_pHodina.m_Triedy;k<T.length;k++)f=T[k],y.JeKmenovaPre(f)&&(g=!0);if(g)continue}r.push(y.GetNazov(o))}}return r.join(" / ");default:return t.GetTexty([e],o,n)}},p.prototype.GetKartaFarby=function(t,e){var i=[];switch(e){case"teachers":for(var n=0,o=t.m_pHodina.m_Ucitelia;n<o.length;n++){var r=o[n];i.push(r.GetColor())}break;case"subjects":i.push(t.m_pHodina.m_pPredmet.GetColor());break;case"classes":for(var a=0,s=t.m_pHodina.m_Triedy;a<s.length;a++)r=s[a],i.push(r.GetColor());break;case"groupnames":case"groups":for(var l=0,c=t.m_pHodina.m_Skupiny;l<c.length;l++)r=c[l],i.push(r.GetColor());break;case"classrooms":for(var m=0,h=t.Ucebne();m<h.length;m++)(r=h[m])&&i.push(r.GetColor());break;case"buildings":for(var _=0,u=t.Ucebne();_<u.length;_++)(r=u[_])&&r.m_pBudova&&i.push(r.m_pBudova.GetColor())}return i},p.prototype.GetMHText=function(t,e,i){switch(e){case"teachers":case"classes":case"subjects":case"classrooms":case"groups":case"groupnames":return t.GetText(e,i);case"count":return(t.m_bRoznePoctyHodin?"*":"")+Math.round(100*t.m_dHodin)/100}return e+"?"},p.prototype.Line=function(t,e,i,n,o){return tt("line",this.page_document).attr({x1:t,y1:e,x2:i,y2:n,"stroke-width":o*zt}).appendTo(this.$page)},p.prototype.VLine=function(t,e,i,n){return this.Line(t,e,t,e+i,n)},p.prototype.HLine=function(t,e,i,n){return this.Line(t,e,t+i,e,n)},p.prototype.Box=function(t,e,i,n,o){var r=this.Line(t,e,i,e,o);return r=(r=(r=r.add(this.Line(i,e,i,n,o))).add(this.Line(i,n,t,n,o))).add(this.Line(t,n,t,e,o))},p.prototype.Rect=function(t,e,i){var n=tt("rect",this.page_document).attr({x:t.x1,y:t.y1,width:t.width(),height:t.height(),style:"fill:"+e}).appendTo(this.$page);return 0<i?n.attr("stroke-width",i*zt):n.attr("stroke","none"),n},p.prototype.CustomizeRect=function(t,e){this.preview&&this.Rect(t,"transparent",0).on("contextmenu",function(t){t.preventDefault(),t.stopPropagation(),e()})},p.prototype.Tootlip=function(t,e){tt("title",this.page_document).text(e).prependTo(t)},p.prototype.Image=function(e,t,i,n){void 0===i&&(i=0),void 0===n&&(n=0);var o=tt("image",this.page_document),r=document.createAttributeNS("http://www.w3.org/1999/xlink","href");r.nodeValue=t,o[0].attributes.setNamedItemNS(r),o.appendTo(this.$page).attr({x:e.x1,y:e.y1});var a=e.width(),s=e.height();if(i||n){var l=C(o),c=function(){var t=Math.min(a/l.width,s/l.height);a=l.width*t,s=l.height*t,0==i?o.attr("width",e.width()):0<i&&o.attr({x:e.x2-a,width:a}),0==n?o.attr("height",e.height()):0<i&&o.attr({y:e.y2-s,width:s})};l.width?c():o.load(function(){l=C(o),c()})}else o.attr({width:a,height:s});if(S){var m=C(o);o.attr({transform:"scale(-1 1) translate("+(-2*m.x-m.width)+")"})}return o},p.prototype.FillFarby=function(t,e,i,n){if(0==t.length)return"#fff";if(1==t.length)return t[0];for(var o="LG_"+A++,r=tt("linearGradient",this.page_document).appendTo(this.$defs).attr({id:o,x1:0,y1:0,x2:0<e?1:0,y2:0<i?1:0}),a=(n?.5:1)/t.length,s=0;s<t.length;s++)tt("stop",this.page_document).appendTo(r).attr({offset:s*a,"stop-color":t[s]}),tt("stop",this.page_document).appendTo(r).attr({offset:(s+1)*a,"stop-color":t[s]});return"url(#"+o+")"},p.prototype.FixFont=function(t){return["arial","courier","times new roman"].includes(t.toLowerCase())?t:t+",Arial"},p.prototype.TextBox=function(t,r,e,i,n,o,a){var s=this;if(void 0===i&&(i=0),void 0===n&&(n=0),void 0===o&&(o={}),void 0===a&&(a={}),r=Math.min(r,t.height()),o.vertical)return delete(o=At.__assign({},o)).vertical,this.TextBoxRotated(t,r,e,i,n,o,a);var l=tt("text",this.page_document).attr({"font-size":r,"text-rendering":"geometricPrecision","text-anchor":i<0?"start":0<i?"end":"middle","dominant-baseline":n<0?"text-before-edge":0<n?"text-after-edge":"central"}).appendTo(this.$page).css("pointer-events","none").css("white-space","pre").text(e);o.bold&&l.css("font-weight","bold"),o.italic&&l.css("font-style","italic"),o.underline&&l.css("text-decoration","underline"),o.font&&l.css("font-family",this.FixFont(o.font));var c=l[0];function m(t){l.empty();for(var e=0,i=t;e<i.length;e++){var n=i[e],o=tt("tspan",s.page_document).appendTo(l).text(n);n!=t[0]&&o.attr({dy:r})}u=t.length}r>t.height()&&(r=t.height(),l.attr("font-size",r));var h=t.width(),_=t.height(),u=1;if(e.includes("\n"))m(e.split("\n"));else{var d=c.getComputedTextLength();if(h<d)if(a.wrap){for(var p=[],f=0;f<e.length;){for(var v=f,b=!1;v<e.length;){var y=v+1;if(b||(y=e.indexOf(" ",y))<0&&(y=e.length),c.getSubStringLength(f,y-f)>h){if(f<v)break;if(b){v=e.length;break}b=!0,v=f}else v=y}for(p.push(e.substring(f,v).trim()),f=v;" "==e.charAt(f);)f++}m(p)}else a.shrink&&(r=r*h/d,l.attr("font-size",r))}if((1<u?l.find("tspan"):l).attr("x",t.x1+(1+i)*h/2),l.attr("y",t.y1+(1+n)*(_-(u-1)*r)/2),!(["edge","ie11","ie10"].includes(ASC.browser)||"safari"==ASC.browser&&0<n)||(T=C(l)).height&&l.attr("y",parseFloat(l.attr("y"))+t.y1-T.y+(t.height()-T.height)*(1+n)/2),a&&a.clip&&((T=C(l)).width>h||T.height>_)){var g="CP_"+A++,k=tt("clipPath",this.page_document).appendTo(this.$page).attr("id",g);tt("rect",this.page_document).appendTo(k).attr({x:t.x1,y:t.y1,width:h,height:_}),l.attr("clip-path","url(#"+g+")")}if(S){var T=C(l);l.attr({transform:"scale(-1 1) translate("+(-2*T.x-T.width)+")"})}return l},p.prototype.TextBoxRotated=function(t,e,i,n,o,r,a){void 0===n&&(n=0),void 0===o&&(o=0);var s=t.width(),l=t.height(),c=this.TextBox(new xt(t.x1-l,t.y1,t.x1,t.y1+s),e,i,n,o,r,a);return c.attr("transform","rotate(-90 "+t.x1+" "+t.y1+")"),c},p.prototype.SubstBox=function(t){var e=this.Rect(new xt(t.x1+.35,t.y1+.35,t.x2-.35,t.y2-.35),"none",.7);return e.attr("stroke-dasharray","2,2"),e},p.prototype.TTR_Init=function(t){var e=this.m_pTTRowRenderer;e.Clear();for(var i=0,n=t;i<n.length;i++){var o=n[i];if("periods"==o.m_Table){var r=o;e.m_nVerticalHodinyOd=r.m_nHodina,e.m_nVerticalHodinyDo=r.m_nHodina}if("daysdefs"==o.m_Table){var a=o;e.m_nDay=a.m_Val}"weeksdefs"==o.m_Table&&(a=o,e.m_nWeek=a.m_Val),"termsdefs"==o.m_Table&&(a=o,e.m_nTerm=a.m_Val)}if(e.m_pHorizontalRokObject=Gt(t),e.m_bSpojNaViacHodinovku=ASC.boolVal(e.m_pRok.GlobalData().settings.m_bPrintSinglesSpolu),e.m_bRozdelNaJednohodinovky=ASC.boolVal(e.m_pRok.GlobalData().settings.m_bPrintDoublesAsSingles),!e.m_pHorizontalRokObject)throw"Error 7857072888"},p.prototype.TTR_TryContinue=function(t){for(var e=!1,i=this.m_pTTRowRenderer,n=0,o=t;n<o.length;n++){var r=o[n];if("periods"==r.m_Table){if(r.m_nHodina!=i.m_nVerticalHodinyDo+1)return!1;e=!0}}return!!e&&(i.m_nVerticalHodinyDo++,!0)},p);function p(t,e,i,n){var o=d.call(this,t)||this;o.m_Title="",o.m_Page=[],o.m_Rows=[],o.m_Columns=[],o.m_ExtraRows=[],o.m_ExtraColumns=[],o.m_pTlacZostava=t,o.m_pTlacZostava_objekt=t;for(var r=0,a=e;r<a.length;r++){if("classrooms"==a[r].m_Table&&!t.m_PageTables.includes("classrooms"))for(var s=0,l=t.m_pRok.m_ObjectsO.ttreports;s<l.length;s++){var c=l[s];if(3==c.m_Data.typ){o.m_pTlacZostava_objekt=c;break}}}if(o.m_Page=e,o.m_Rows=i,o.m_Columns=n,0<e.length)for(var m=0,h=e;m<h.length;m++){var _=h[m];""!=o.m_Title&&(o.m_Title+=" - "),o.m_pTlacZostava_objekt.m_Data.pageheaderprefixenabled&&_.m_Data.printheaderprefix&&(o.m_Title+=_.m_Data.printheaderprefix+" "),o.m_Title+=W.CUtils.GetUINazov(_,"name")}else o.m_Title=o.m_pTlacZostava.GetNazov();return o.m_pTTRowRenderer=new It.CTTRowRenderer(o.m_pTlacZostava.m_pRok),o}function et(t){var e=0,i=0;switch(t){case 1:e=i=-1;break;case 2:i=-1,e=1;break;case 3:e=-(i=1);break;case 4:e=i=1;break;case 5:i=1,e=0;break;case 6:i=-1,e=0;break;case 7:i=0,e=-1;break;case 8:i=0,e=1}return{ax:e,ay:i}}function f(t){var e=window.open("","_blank"),i=e.document,n=$j(i.head).empty(),o=$j(i.body).empty();o.css({margin:"0px",padding:"0px"});try{$j("<base>").attr("href","https://"+document.location.host).appendTo(n),$j("link[type='text/css']").each(function(t,e){$j(e).clone().appendTo(n)})}catch(t){console.error(t)}$j("<style type='text/css'>@page {margin: 0px;margin-bottom: -5cm;}</style>").appendTo(n);for(var r=[],a=function(e){r.push(function(){var t=$j("<div class='print-sheet-manual'>").appendTo(o);t.css({width:5*e.width+"px",height:5*e.height-100+"px"}),e.RenderSheet(t,5,!1)})},s=0,l=t;s<l.length;s++){a(l[s])}r.push(function(){$j(i).ready(function(){setTimeout(function(){e.print()},100)})});var c=new ASC.ui.ProgressBar(r);c.safetyCounterMax=Math.max(c.safetyCounterMax,r.length+10)}t.CPrintPageGrid=U,t.printPagesPrint=f,t.phpPrintPosField=function(t,e,i,n,o){void 0===i&&(i={}),n[o]=new b(t,e,i).input};var b=(y.prototype.setValue=function(t){this.input.value=""+t,this.$div.find("div").removeClass("selected"),this.$pos[t].addClass("selected")},y);function y(t,i,e){var n=this;void 0===e&&(e={}),this.$pos=[],i=parseInt(i),this.$div=$j("<div class='ttonline-print-pos-field'>").appendTo(t),this.input=$j("<input type='hidden'>").appendTo(t).get(0),this.input.value=""+i,e.style&&(this.$div[0].style.cssText+=";"+e.style);[1,6,2,7,0,8,3,5,4].forEach(function(t,e){n.$pos[t]=$j("<div>").appendTo(n.$div).toggleClass("selected",t==i).click(function(){n.setValue(t)}),2!=e&&5!=e||$j("<br>").appendTo(n.$div)})}t.PrintPosField=b;var Vt=(g.prototype.updatePos=function(){if(this.vertical){var t=this.s_min+this.s_delta*this.v;this.$l.attr({x1:t,x2:t})}else{var e=this.s_min+this.s_delta*this.v;this.$l.attr({y1:e,y2:e})}},g);function g(t,e,i,n,o,r,a,s){var l=this;this.v_min=.01,this.v_max=.99,this.vertical=!1;var c=$j(t)[0].ownerDocument;this.$l=tt("line",c).appendTo(t).attr({"stroke-width":2*zt,cursor:e?"w-resize":"n-resize","stroke-opacity":0}),this.$f=tt("line",c).appendTo(t).attr({x1:n,y1:o,x2:r,y2:a,"stroke-width":1*zt,"stroke-opacity":0}),this.v=i,this.vertical=e,this.fn=s,e?(this.s_min=n,this.s_delta=r-n,this.$l.attr({y1:o,y2:a})):(this.s_min=o,this.s_delta=a-o,this.$l.attr({x1:n,x2:r})),this.updatePos(),this.$l.mousedown(function(a){l.$l.attr("stroke-opacity",1);function e(t){var e,i,n,o=l.v,r=l.$f[0].getBoundingClientRect();n=l.vertical?(e=t.pageX,i=r.left,r.width):(e=t.pageY,i=r.top,r.height),o=(e-i)/n,o=Math.max(l.v_min,Math.min(l.v_max,o)),(s||1<Math.abs(t.pageX-a.pageX)+Math.abs(t.pageY-a.pageY))&&(l.v=o,l.updatePos(),s=!0),t.stopPropagation(),t.preventDefault(),l.updatePos()}var s=!1,i=function(t){$j(document).off("mousemove",e).off("mouseup",i),l.$l.attr("stroke-opacity",0),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),s&&l.fn(l.v)};$j(document).mousemove(e).mouseup(i),a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation()})}t.Potahovatko=Vt},"/timetable/app/server/designs.js":function(t,require,e){e.implementRpc(["getDesignData"])},"/timetable/app/server/generator.js":function(t,require,e){e.implementRpc(["listTTGenerators_local","listTTGenerators_global","scTTGeneratorFind","runTTVerification","rozExportDownloadLink","ttdocDbForGen","generatorStart","generatorPing","generatorStop","testStart","testPing","testStop","getDraftOptions"])}});
